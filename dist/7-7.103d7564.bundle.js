webpackJsonp([7],{

/***/ 964:
/***/ (function(module, exports, __webpack_require__) {

eval("var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/*!\n * =====================================================\n * Mui v3.7.0 (http://dev.dcloud.net.cn/mui)\n * =====================================================\n */\n/**\n * MUI核心JS\n * @type _L4.$|Function\n */\nvar mui = (function(document, undefined) {\n\tvar readyRE = /complete|loaded|interactive/;\n\tvar idSelectorRE = /^#([\\w-]+)$/;\n\tvar classSelectorRE = /^\\.([\\w-]+)$/;\n\tvar tagSelectorRE = /^[\\w-]+$/;\n\tvar translateRE = /translate(?:3d)?\\((.+?)\\)/;\n\tvar translateMatrixRE = /matrix(3d)?\\((.+?)\\)/;\n\n\tvar $ = function(selector, context) {\n\t\tcontext = context || document;\n\t\tif (!selector)\n\t\t\treturn wrap();\n\t\tif (typeof selector === 'object')\n\t\t\tif ($.isArrayLike(selector)) {\n\t\t\t\treturn wrap($.slice.call(selector), null);\n\t\t\t} else {\n\t\t\t\treturn wrap([selector], null);\n\t\t\t}\n\t\tif (typeof selector === 'function')\n\t\t\treturn $.ready(selector);\n\t\tif (typeof selector === 'string') {\n\t\t\ttry {\n\t\t\t\tselector = selector.trim();\n\t\t\t\tif (idSelectorRE.test(selector)) {\n\t\t\t\t\tvar found = document.getElementById(RegExp.$1);\n\t\t\t\t\treturn wrap(found ? [found] : []);\n\t\t\t\t}\n\t\t\t\treturn wrap($.qsa(selector, context), selector);\n\t\t\t} catch (e) {}\n\t\t}\n\t\treturn wrap();\n\t};\n\n\tvar wrap = function(dom, selector) {\n\t\tdom = dom || [];\n\t\tObject.setPrototypeOf(dom, $.fn);\n\t\tdom.selector = selector || '';\n\t\treturn dom;\n\t};\n\n\t$.uuid = 0;\n\n\t$.data = {};\n\t/**\n\t * extend(simple)\n\t * @param {type} target\n\t * @param {type} source\n\t * @param {type} deep\n\t * @returns {unresolved}\n\t */\n\t$.extend = function() { //from jquery2\n\t\tvar options, name, src, copy, copyIsArray, clone,\n\t\t\ttarget = arguments[0] || {},\n\t\t\ti = 1,\n\t\t\tlength = arguments.length,\n\t\t\tdeep = false;\n\n\t\tif (typeof target === \"boolean\") {\n\t\t\tdeep = target;\n\n\t\t\ttarget = arguments[i] || {};\n\t\t\ti++;\n\t\t}\n\n\t\tif (typeof target !== \"object\" && !$.isFunction(target)) {\n\t\t\ttarget = {};\n\t\t}\n\n\t\tif (i === length) {\n\t\t\ttarget = this;\n\t\t\ti--;\n\t\t}\n\n\t\tfor (; i < length; i++) {\n\t\t\tif ((options = arguments[i]) != null) {\n\t\t\t\tfor (name in options) {\n\t\t\t\t\tsrc = target[name];\n\t\t\t\t\tcopy = options[name];\n\n\t\t\t\t\tif (target === copy) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (deep && copy && ($.isPlainObject(copy) || (copyIsArray = $.isArray(copy)))) {\n\t\t\t\t\t\tif (copyIsArray) {\n\t\t\t\t\t\t\tcopyIsArray = false;\n\t\t\t\t\t\t\tclone = src && $.isArray(src) ? src : [];\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tclone = src && $.isPlainObject(src) ? src : {};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttarget[name] = $.extend(deep, clone, copy);\n\n\t\t\t\t\t} else if (copy !== undefined) {\n\t\t\t\t\t\ttarget[name] = copy;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn target;\n\t};\n\t/**\n\t * mui noop(function)\n\t */\n\t$.noop = function() {};\n\t/**\n\t * mui slice(array)\n\t */\n\t$.slice = [].slice;\n\t/**\n\t * mui filter(array)\n\t */\n\t$.filter = [].filter;\n\n\t$.type = function(obj) {\n\t\treturn obj == null ? String(obj) : class2type[{}.toString.call(obj)] || \"object\";\n\t};\n\t/**\n\t * mui isArray\n\t */\n\t$.isArray = Array.isArray ||\n\t\tfunction(object) {\n\t\t\treturn object instanceof Array;\n\t\t};\n\t/**\n\t * mui isArrayLike\n\t * @param {Object} obj\n\t */\n\t$.isArrayLike = function(obj) {\n\t\tvar length = !!obj && \"length\" in obj && obj.length;\n\t\tvar type = $.type(obj);\n\t\tif (type === \"function\" || $.isWindow(obj)) {\n\t\t\treturn false;\n\t\t}\n\t\treturn type === \"array\" || length === 0 ||\n\t\t\ttypeof length === \"number\" && length > 0 && (length - 1) in obj;\n\t};\n\t/**\n\t * mui isWindow(需考虑obj为undefined的情况)\n\t */\n\t$.isWindow = function(obj) {\n\t\treturn obj != null && obj === obj.window;\n\t};\n\t/**\n\t * mui isObject\n\t */\n\t$.isObject = function(obj) {\n\t\treturn $.type(obj) === \"object\";\n\t};\n\t/**\n\t * mui isPlainObject\n\t */\n\t$.isPlainObject = function(obj) {\n\t\treturn $.isObject(obj) && !$.isWindow(obj) && Object.getPrototypeOf(obj) === Object.prototype;\n\t};\n\t/**\n\t * mui isEmptyObject\n\t * @param {Object} o\n\t */\n\t$.isEmptyObject = function(o) {\n\t\tfor (var p in o) {\n\t\t\tif (p !== undefined) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t};\n\t/**\n\t * mui isFunction\n\t */\n\t$.isFunction = function(value) {\n\t\treturn $.type(value) === \"function\";\n\t};\n\t/**\n\t * mui querySelectorAll\n\t * @param {type} selector\n\t * @param {type} context\n\t * @returns {Array}\n\t */\n\t$.qsa = function(selector, context) {\n\t\tcontext = context || document;\n\t\treturn $.slice.call(classSelectorRE.test(selector) ? context.getElementsByClassName(RegExp.$1) : tagSelectorRE.test(selector) ? context.getElementsByTagName(selector) : context.querySelectorAll(selector));\n\t};\n\t/**\n\t * ready(DOMContentLoaded)\n\t * @param {type} callback\n\t * @returns {_L6.$}\n\t */\n\t$.ready = function(callback) {\n\t\tif (readyRE.test(document.readyState)) {\n\t\t\tcallback($);\n\t\t} else {\n\t\t\tdocument.addEventListener('DOMContentLoaded', function() {\n\t\t\t\tcallback($);\n\t\t\t}, false);\n\t\t}\n\t\treturn this;\n\t};\n\t/**\n\t * 将 fn 缓存一段时间后, 再被调用执行\n\t * 此方法为了避免在 ms 段时间内, 执行 fn 多次. 常用于 resize , scroll , mousemove 等连续性事件中;\n\t * 当 ms 设置为 -1, 表示立即执行 fn, 即和直接调用 fn 一样;\n\t * 调用返回函数的 stop 停止最后一次的 buffer 效果\n\t * @param {Object} fn\n\t * @param {Object} ms\n\t * @param {Object} context\n\t */\n\t$.buffer = function(fn, ms, context) {\n\t\tvar timer;\n\t\tvar lastStart = 0;\n\t\tvar lastEnd = 0;\n\t\tvar ms = ms || 150;\n\n\t\tfunction run() {\n\t\t\tif (timer) {\n\t\t\t\ttimer.cancel();\n\t\t\t\ttimer = 0;\n\t\t\t}\n\t\t\tlastStart = $.now();\n\t\t\tfn.apply(context || this, arguments);\n\t\t\tlastEnd = $.now();\n\t\t}\n\n\t\treturn $.extend(function() {\n\t\t\tif (\n\t\t\t\t(!lastStart) || // 从未运行过\n\t\t\t\t(lastEnd >= lastStart && $.now() - lastEnd > ms) || // 上次运行成功后已经超过ms毫秒\n\t\t\t\t(lastEnd < lastStart && $.now() - lastStart > ms * 8) // 上次运行或未完成，后8*ms毫秒\n\t\t\t) {\n\t\t\t\trun.apply(this, arguments);\n\t\t\t} else {\n\t\t\t\tif (timer) {\n\t\t\t\t\ttimer.cancel();\n\t\t\t\t}\n\t\t\t\ttimer = $.later(run, ms, null, $.slice.call(arguments));\n\t\t\t}\n\t\t}, {\n\t\t\tstop: function() {\n\t\t\t\tif (timer) {\n\t\t\t\t\ttimer.cancel();\n\t\t\t\t\ttimer = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\t/**\n\t * each\n\t * @param {type} elements\n\t * @param {type} callback\n\t * @returns {_L8.$}\n\t */\n\t$.each = function(elements, callback, hasOwnProperty) {\n\t\tif (!elements) {\n\t\t\treturn this;\n\t\t}\n\t\tif (typeof elements.length === 'number') {\n\t\t\t[].every.call(elements, function(el, idx) {\n\t\t\t\treturn callback.call(el, idx, el) !== false;\n\t\t\t});\n\t\t} else {\n\t\t\tfor (var key in elements) {\n\t\t\t\tif (hasOwnProperty) {\n\t\t\t\t\tif (elements.hasOwnProperty(key)) {\n\t\t\t\t\t\tif (callback.call(elements[key], key, elements[key]) === false) return elements;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (callback.call(elements[key], key, elements[key]) === false) return elements;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t};\n\t$.focus = function(element) {\n\t\tif ($.os.ios) {\n\t\t\tsetTimeout(function() {\n\t\t\t\telement.focus();\n\t\t\t}, 10);\n\t\t} else {\n\t\t\telement.focus();\n\t\t}\n\t};\n\t/**\n\t * trigger event\n\t * @param {type} element\n\t * @param {type} eventType\n\t * @param {type} eventData\n\t * @returns {_L8.$}\n\t */\n\t$.trigger = function(element, eventType, eventData) {\n\t\telement.dispatchEvent(new CustomEvent(eventType, {\n\t\t\tdetail: eventData,\n\t\t\tbubbles: true,\n\t\t\tcancelable: true\n\t\t}));\n\t\treturn this;\n\t};\n\t/**\n\t * getStyles\n\t * @param {type} element\n\t * @param {type} property\n\t * @returns {styles}\n\t */\n\t$.getStyles = function(element, property) {\n\t\tvar styles = element.ownerDocument.defaultView.getComputedStyle(element, null);\n\t\tif (property) {\n\t\t\treturn styles.getPropertyValue(property) || styles[property];\n\t\t}\n\t\treturn styles;\n\t};\n\t/**\n\t * parseTranslate\n\t * @param {type} translateString\n\t * @param {type} position\n\t * @returns {Object}\n\t */\n\t$.parseTranslate = function(translateString, position) {\n\t\tvar result = translateString.match(translateRE || '');\n\t\tif (!result || !result[1]) {\n\t\t\tresult = ['', '0,0,0'];\n\t\t}\n\t\tresult = result[1].split(\",\");\n\t\tresult = {\n\t\t\tx: parseFloat(result[0]),\n\t\t\ty: parseFloat(result[1]),\n\t\t\tz: parseFloat(result[2])\n\t\t};\n\t\tif (position && result.hasOwnProperty(position)) {\n\t\t\treturn result[position];\n\t\t}\n\t\treturn result;\n\t};\n\t/**\n\t * parseTranslateMatrix\n\t * @param {type} translateString\n\t * @param {type} position\n\t * @returns {Object}\n\t */\n\t$.parseTranslateMatrix = function(translateString, position) {\n\t\tvar matrix = translateString.match(translateMatrixRE);\n\t\tvar is3D = matrix && matrix[1];\n\t\tif (matrix) {\n\t\t\tmatrix = matrix[2].split(\",\");\n\t\t\tif (is3D === \"3d\")\n\t\t\t\tmatrix = matrix.slice(12, 15);\n\t\t\telse {\n\t\t\t\tmatrix.push(0);\n\t\t\t\tmatrix = matrix.slice(4, 7);\n\t\t\t}\n\t\t} else {\n\t\t\tmatrix = [0, 0, 0];\n\t\t}\n\t\tvar result = {\n\t\t\tx: parseFloat(matrix[0]),\n\t\t\ty: parseFloat(matrix[1]),\n\t\t\tz: parseFloat(matrix[2])\n\t\t};\n\t\tif (position && result.hasOwnProperty(position)) {\n\t\t\treturn result[position];\n\t\t}\n\t\treturn result;\n\t};\n\t$.hooks = {};\n\t$.addAction = function(type, hook) {\n\t\tvar hooks = $.hooks[type];\n\t\tif (!hooks) {\n\t\t\thooks = [];\n\t\t}\n\t\thook.index = hook.index || 1000;\n\t\thooks.push(hook);\n\t\thooks.sort(function(a, b) {\n\t\t\treturn a.index - b.index;\n\t\t});\n\t\t$.hooks[type] = hooks;\n\t\treturn $.hooks[type];\n\t};\n\t$.doAction = function(type, callback) {\n\t\tif ($.isFunction(callback)) { //指定了callback\n\t\t\t$.each($.hooks[type], callback);\n\t\t} else { //未指定callback，直接执行\n\t\t\t$.each($.hooks[type], function(index, hook) {\n\t\t\t\treturn !hook.handle();\n\t\t\t});\n\t\t}\n\t};\n\t/**\n\t * setTimeout封装\n\t * @param {Object} fn\n\t * @param {Object} when\n\t * @param {Object} context\n\t * @param {Object} data\n\t */\n\t$.later = function(fn, when, context, data) {\n\t\twhen = when || 0;\n\t\tvar m = fn;\n\t\tvar d = data;\n\t\tvar f;\n\t\tvar r;\n\n\t\tif (typeof fn === 'string') {\n\t\t\tm = context[fn];\n\t\t}\n\n\t\tf = function() {\n\t\t\tm.apply(context, $.isArray(d) ? d : [d]);\n\t\t};\n\n\t\tr = setTimeout(f, when);\n\n\t\treturn {\n\t\t\tid: r,\n\t\t\tcancel: function() {\n\t\t\t\tclearTimeout(r);\n\t\t\t}\n\t\t};\n\t};\n\t$.now = Date.now || function() {\n\t\treturn +new Date();\n\t};\n\tvar class2type = {};\n\t$.each(['Boolean', 'Number', 'String', 'Function', 'Array', 'Date', 'RegExp', 'Object', 'Error'], function(i, name) {\n\t\tclass2type[\"[object \" + name + \"]\"] = name.toLowerCase();\n\t});\n\tif (window.JSON) {\n\t\t$.parseJSON = JSON.parse;\n\t}\n\t/**\n\t * $.fn\n\t */\n\t$.fn = {\n\t\teach: function(callback) {\n\t\t\t[].every.call(this, function(el, idx) {\n\t\t\t\treturn callback.call(el, idx, el) !== false;\n\t\t\t});\n\t\t\treturn this;\n\t\t}\n\t};\n\n\t/**\n\t * 兼容 AMD 模块\n\t **/\n\tif (true) {\n\t\t!(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_RESULT__ = function() {\n\t\t\treturn $;\n\t\t}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t}\n\n\treturn $;\n})(document);\n//window.mui = mui;\n//'$' in window || (window.$ = mui);\n/**\n * $.os\n * @param {type} $\n * @returns {undefined}\n */\n(function($, window) {\n\tfunction detect(ua) {\n\t\tthis.os = {};\n\t\tvar funcs = [\n\n\t\t\tfunction() { //wechat\n\t\t\t\tvar wechat = ua.match(/(MicroMessenger)\\/([\\d\\.]+)/i);\n\t\t\t\tif (wechat) { //wechat\n\t\t\t\t\tthis.os.wechat = {\n\t\t\t\t\t\tversion: wechat[2].replace(/_/g, '.')\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tfunction() { //android\n\t\t\t\tvar android = ua.match(/(Android);?[\\s\\/]+([\\d.]+)?/);\n\t\t\t\tif (android) {\n\t\t\t\t\tthis.os.android = true;\n\t\t\t\t\tthis.os.version = android[2];\n\n\t\t\t\t\tthis.os.isBadAndroid = !(/Chrome\\/\\d/.test(window.navigator.appVersion));\n\t\t\t\t}\n\t\t\t\treturn this.os.android === true;\n\t\t\t},\n\t\t\tfunction() { //ios\n\t\t\t\tvar iphone = ua.match(/(iPhone\\sOS)\\s([\\d_]+)/);\n\t\t\t\tif (iphone) { //iphone\n\t\t\t\t\tthis.os.ios = this.os.iphone = true;\n\t\t\t\t\tthis.os.version = iphone[2].replace(/_/g, '.');\n\t\t\t\t} else {\n\t\t\t\t\tvar ipad = ua.match(/(iPad).*OS\\s([\\d_]+)/);\n\t\t\t\t\tif (ipad) { //ipad\n\t\t\t\t\t\tthis.os.ios = this.os.ipad = true;\n\t\t\t\t\t\tthis.os.version = ipad[2].replace(/_/g, '.');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this.os.ios === true;\n\t\t\t}\n\t\t];\n\t\t[].every.call(funcs, function(func) {\n\t\t\treturn !func.call($);\n\t\t});\n\t}\n\tdetect.call($, navigator.userAgent);\n})(mui, window);\n/**\n * $.os.plus\n * @param {type} $\n * @returns {undefined}\n */\n(function($, document) {\n\tfunction detect(ua) {\n\t\tthis.os = this.os || {};\n\t\tvar plus = ua.match(/Html5Plus/i); //TODO 5\\+Browser?\n\t\tif (plus) {\n\t\t\tthis.os.plus = true;\n\t\t\t$(function() {\n\t\t\t\tdocument.body.classList.add('mui-plus');\n\t\t\t});\n\t\t\tif (ua.match(/StreamApp/i)) { //TODO 最好有流应用自己的标识\n\t\t\t\tthis.os.stream = true;\n\t\t\t\t$(function() {\n\t\t\t\t\tdocument.body.classList.add('mui-plus-stream');\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\tdetect.call($, navigator.userAgent);\n})(mui, document);\n/**\n * 仅提供简单的on，off(仅支持事件委托，不支持当前元素绑定，当前元素绑定请直接使用addEventListener,removeEventListener)\n * @param {Object} $\n */\n(function($) {\n\tif ('ontouchstart' in window) {\n\t\t$.isTouchable = true;\n\t\t$.EVENT_START = 'touchstart';\n\t\t$.EVENT_MOVE = 'touchmove';\n\t\t$.EVENT_END = 'touchend';\n\t} else {\n\t\t$.isTouchable = false;\n\t\t$.EVENT_START = 'mousedown';\n\t\t$.EVENT_MOVE = 'mousemove';\n\t\t$.EVENT_END = 'mouseup';\n\t}\n\t$.EVENT_CANCEL = 'touchcancel';\n\t$.EVENT_CLICK = 'click';\n\n\tvar _mid = 1;\n\tvar delegates = {};\n\t//需要wrap的函数\n\tvar eventMethods = {\n\t\tpreventDefault: 'isDefaultPrevented',\n\t\tstopImmediatePropagation: 'isImmediatePropagationStopped',\n\t\tstopPropagation: 'isPropagationStopped'\n\t};\n\t//默认true返回函数\n\tvar returnTrue = function() {\n\t\treturn true\n\t};\n\t//默认false返回函数\n\tvar returnFalse = function() {\n\t\treturn false\n\t};\n\t//wrap浏览器事件\n\tvar compatible = function(event, target) {\n\t\tif (!event.detail) {\n\t\t\tevent.detail = {\n\t\t\t\tcurrentTarget: target\n\t\t\t};\n\t\t} else {\n\t\t\tevent.detail.currentTarget = target;\n\t\t}\n\t\t$.each(eventMethods, function(name, predicate) {\n\t\t\tvar sourceMethod = event[name];\n\t\t\tevent[name] = function() {\n\t\t\t\tthis[predicate] = returnTrue;\n\t\t\t\treturn sourceMethod && sourceMethod.apply(event, arguments)\n\t\t\t}\n\t\t\tevent[predicate] = returnFalse;\n\t\t}, true);\n\t\treturn event;\n\t};\n\t//简单的wrap对象_mid\n\tvar mid = function(obj) {\n\t\treturn obj && (obj._mid || (obj._mid = _mid++));\n\t};\n\t//事件委托对象绑定的事件回调列表\n\tvar delegateFns = {};\n\t//返回事件委托的wrap事件回调\n\tvar delegateFn = function(element, event, selector, callback) {\n\t\treturn function(e) {\n\t\t\t//same event\n\t\t\tvar callbackObjs = delegates[element._mid][event];\n\t\t\tvar handlerQueue = [];\n\t\t\tvar target = e.target;\n\t\t\tvar selectorAlls = {};\n\t\t\tfor (; target && target !== document; target = target.parentNode) {\n\t\t\t\tif (target === element) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (~['click', 'tap', 'doubletap', 'longtap', 'hold'].indexOf(event) && (target.disabled || target.classList.contains('mui-disabled'))) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tvar matches = {};\n\t\t\t\t$.each(callbackObjs, function(selector, callbacks) { //same selector\n\t\t\t\t\tselectorAlls[selector] || (selectorAlls[selector] = $.qsa(selector, element));\n\t\t\t\t\tif (selectorAlls[selector] && ~(selectorAlls[selector]).indexOf(target)) {\n\t\t\t\t\t\tif (!matches[selector]) {\n\t\t\t\t\t\t\tmatches[selector] = callbacks;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, true);\n\t\t\t\tif (!$.isEmptyObject(matches)) {\n\t\t\t\t\thandlerQueue.push({\n\t\t\t\t\t\telement: target,\n\t\t\t\t\t\thandlers: matches\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tselectorAlls = null;\n\t\t\te = compatible(e); //compatible event\n\t\t\t$.each(handlerQueue, function(index, handler) {\n\t\t\t\ttarget = handler.element;\n\t\t\t\tvar tagName = target.tagName;\n\t\t\t\tif (event === 'tap' && (tagName !== 'INPUT' && tagName !== 'TEXTAREA' && tagName !== 'SELECT')) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.detail && e.detail.gesture && e.detail.gesture.preventDefault();\n\t\t\t\t}\n\t\t\t\t$.each(handler.handlers, function(index, handler) {\n\t\t\t\t\t$.each(handler, function(index, callback) {\n\t\t\t\t\t\tif (callback.call(target, e) === false) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, true);\n\t\t\t\t}, true)\n\t\t\t\tif (e.isPropagationStopped()) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}, true);\n\t\t};\n\t};\n\tvar findDelegateFn = function(element, event) {\n\t\tvar delegateCallbacks = delegateFns[mid(element)];\n\t\tvar result = [];\n\t\tif (delegateCallbacks) {\n\t\t\tresult = [];\n\t\t\tif (event) {\n\t\t\t\tvar filterFn = function(fn) {\n\t\t\t\t\treturn fn.type === event;\n\t\t\t\t}\n\t\t\t\treturn delegateCallbacks.filter(filterFn);\n\t\t\t} else {\n\t\t\t\tresult = delegateCallbacks;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t};\n\tvar preventDefaultException = /^(INPUT|TEXTAREA|BUTTON|SELECT)$/;\n\t/**\n\t * mui delegate events\n\t * @param {type} event\n\t * @param {type} selector\n\t * @param {type} callback\n\t * @returns {undefined}\n\t */\n\t$.fn.on = function(event, selector, callback) { //仅支持简单的事件委托,主要是tap事件使用，类似mouse,focus之类暂不封装支持\n\t\treturn this.each(function() {\n\t\t\tvar element = this;\n\t\t\tmid(element);\n\t\t\tmid(callback);\n\t\t\tvar isAddEventListener = false;\n\t\t\tvar delegateEvents = delegates[element._mid] || (delegates[element._mid] = {});\n\t\t\tvar delegateCallbackObjs = delegateEvents[event] || ((delegateEvents[event] = {}));\n\t\t\tif ($.isEmptyObject(delegateCallbackObjs)) {\n\t\t\t\tisAddEventListener = true;\n\t\t\t}\n\t\t\tvar delegateCallbacks = delegateCallbackObjs[selector] || (delegateCallbackObjs[selector] = []);\n\t\t\tdelegateCallbacks.push(callback);\n\t\t\tif (isAddEventListener) {\n\t\t\t\tvar delegateFnArray = delegateFns[mid(element)];\n\t\t\t\tif (!delegateFnArray) {\n\t\t\t\t\tdelegateFnArray = [];\n\t\t\t\t}\n\t\t\t\tvar delegateCallback = delegateFn(element, event, selector, callback);\n\t\t\t\tdelegateFnArray.push(delegateCallback);\n\t\t\t\tdelegateCallback.i = delegateFnArray.length - 1;\n\t\t\t\tdelegateCallback.type = event;\n\t\t\t\tdelegateFns[mid(element)] = delegateFnArray;\n\t\t\t\telement.addEventListener(event, delegateCallback);\n\t\t\t\tif (event === 'tap') { //TODO 需要找个更好的解决方案\n\t\t\t\t\telement.addEventListener('click', function(e) {\n\t\t\t\t\t\tif (e.target) {\n\t\t\t\t\t\t\tvar tagName = e.target.tagName;\n\t\t\t\t\t\t\tif (!preventDefaultException.test(tagName)) {\n\t\t\t\t\t\t\t\tif (tagName === 'A') {\n\t\t\t\t\t\t\t\t\tvar href = e.target.href;\n\t\t\t\t\t\t\t\t\tif (!(href && ~href.indexOf('tel:'))) {\n\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\t$.fn.off = function(event, selector, callback) {\n\t\treturn this.each(function() {\n\t\t\tvar _mid = mid(this);\n\t\t\tif (!event) { //mui(selector).off();\n\t\t\t\tdelegates[_mid] && delete delegates[_mid];\n\t\t\t} else if (!selector) { //mui(selector).off(event);\n\t\t\t\tdelegates[_mid] && delete delegates[_mid][event];\n\t\t\t} else if (!callback) { //mui(selector).off(event,selector);\n\t\t\t\tdelegates[_mid] && delegates[_mid][event] && delete delegates[_mid][event][selector];\n\t\t\t} else { //mui(selector).off(event,selector,callback);\n\t\t\t\tvar delegateCallbacks = delegates[_mid] && delegates[_mid][event] && delegates[_mid][event][selector];\n\t\t\t\t$.each(delegateCallbacks, function(index, delegateCallback) {\n\t\t\t\t\tif (mid(delegateCallback) === mid(callback)) {\n\t\t\t\t\t\tdelegateCallbacks.splice(index, 1);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}, true);\n\t\t\t}\n\t\t\tif (delegates[_mid]) {\n\t\t\t\t//如果off掉了所有当前element的指定的event事件，则remove掉当前element的delegate回调\n\t\t\t\tif ((!delegates[_mid][event] || $.isEmptyObject(delegates[_mid][event]))) {\n\t\t\t\t\tfindDelegateFn(this, event).forEach(function(fn) {\n\t\t\t\t\t\tthis.removeEventListener(fn.type, fn);\n\t\t\t\t\t\tdelete delegateFns[_mid][fn.i];\n\t\t\t\t\t}.bind(this));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t//如果delegates[_mid]已不存在，删除所有\n\t\t\t\tfindDelegateFn(this).forEach(function(fn) {\n\t\t\t\t\tthis.removeEventListener(fn.type, fn);\n\t\t\t\t\tdelete delegateFns[_mid][fn.i];\n\t\t\t\t}.bind(this));\n\t\t\t}\n\t\t});\n\n\t};\n})(mui);\n/**\n * mui target(action>popover>modal>tab>toggle)\n */\n(function($, window, document) {\n\t/**\n\t * targets\n\t */\n\t$.targets = {};\n\t/**\n\t * target handles\n\t */\n\t$.targetHandles = [];\n\t/**\n\t * register target\n\t * @param {type} target\n\t * @returns {$.targets}\n\t */\n\t$.registerTarget = function(target) {\n\n\t\ttarget.index = target.index || 1000;\n\n\t\t$.targetHandles.push(target);\n\n\t\t$.targetHandles.sort(function(a, b) {\n\t\t\treturn a.index - b.index;\n\t\t});\n\n\t\treturn $.targetHandles;\n\t};\n\twindow.addEventListener($.EVENT_START, function(event) {\n\t\tvar target = event.target;\n\t\tvar founds = {};\n\t\tfor (; target && target !== document; target = target.parentNode) {\n\t\t\tvar isFound = false;\n\t\t\t$.each($.targetHandles, function(index, targetHandle) {\n\t\t\t\tvar name = targetHandle.name;\n\t\t\t\tif (!isFound && !founds[name] && targetHandle.hasOwnProperty('handle')) {\n\t\t\t\t\t$.targets[name] = targetHandle.handle(event, target);\n\t\t\t\t\tif ($.targets[name]) {\n\t\t\t\t\t\tfounds[name] = true;\n\t\t\t\t\t\tif (targetHandle.isContinue !== true) {\n\t\t\t\t\t\t\tisFound = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (!founds[name]) {\n\t\t\t\t\t\tif (targetHandle.isReset !== false)\n\t\t\t\t\t\t\t$.targets[name] = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (isFound) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t});\n\twindow.addEventListener('click', function(event) { //解决touch与click的target不一致的问题(比如链接边缘点击时，touch的target为html，而click的target为A)\n\t\tvar target = event.target;\n\t\tvar isFound = false;\n\t\tfor (; target && target !== document; target = target.parentNode) {\n\t\t\tif (target.tagName === 'A') {\n\t\t\t\t$.each($.targetHandles, function(index, targetHandle) {\n\t\t\t\t\tvar name = targetHandle.name;\n\t\t\t\t\tif (targetHandle.hasOwnProperty('handle')) {\n\t\t\t\t\t\tif (targetHandle.handle(event, target)) {\n\t\t\t\t\t\t\tisFound = true;\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (isFound) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n})(mui, window, document);\n/**\n * fixed trim\n * @param {type} undefined\n * @returns {undefined}\n */\n(function(undefined) {\n\tif (String.prototype.trim === undefined) { // fix for iOS 3.2\n\t\tString.prototype.trim = function() {\n\t\t\treturn this.replace(/^\\s+|\\s+$/g, '');\n\t\t};\n\t}\n\tObject.setPrototypeOf = Object.setPrototypeOf || function(obj, proto) {\n\t\tobj['__proto__'] = proto;\n\t\treturn obj;\n\t};\n\n})();\n/**\n * fixed CustomEvent\n */\n(function() {\n\tif (typeof window.CustomEvent === 'undefined') {\n\t\tfunction CustomEvent(event, params) {\n\t\t\tparams = params || {\n\t\t\t\tbubbles: false,\n\t\t\t\tcancelable: false,\n\t\t\t\tdetail: undefined\n\t\t\t};\n\t\t\tvar evt = document.createEvent('Events');\n\t\t\tvar bubbles = true;\n\t\t\tfor (var name in params) {\n\t\t\t\t(name === 'bubbles') ? (bubbles = !!params[name]) : (evt[name] = params[name]);\n\t\t\t}\n\t\t\tevt.initEvent(event, bubbles, true);\n\t\t\treturn evt;\n\t\t};\n\t\tCustomEvent.prototype = window.Event.prototype;\n\t\twindow.CustomEvent = CustomEvent;\n\t}\n})();\n/*\n\tA shim for non ES5 supporting browsers.\n\tAdds function bind to Function prototype, so that you can do partial application.\n\tWorks even with the nasty thing, where the first word is the opposite of extranet, the second one is the profession of Columbus, and the version number is 9, flipped 180 degrees.\n*/\n\nFunction.prototype.bind = Function.prototype.bind || function(to) {\n\t// Make an array of our arguments, starting from second argument\n\tvar partial = Array.prototype.splice.call(arguments, 1),\n\t\t// We'll need the original function.\n\t\tfn = this;\n\tvar bound = function() {\n\t\t\t// Join the already applied arguments to the now called ones (after converting to an array again).\n\t\t\tvar args = partial.concat(Array.prototype.splice.call(arguments, 0));\n\t\t\t// If not being called as a constructor\n\t\t\tif (!(this instanceof bound)) {\n\t\t\t\t// return the result of the function called bound to target and partially applied.\n\t\t\t\treturn fn.apply(to, args);\n\t\t\t}\n\t\t\t// If being called as a constructor, apply the function bound to self.\n\t\t\tfn.apply(this, args);\n\t\t}\n\t\t// Attach the prototype of the function to our newly created function.\n\tbound.prototype = fn.prototype;\n\treturn bound;\n};\n/**\n * mui fixed classList\n * @param {type} document\n * @returns {undefined}\n */\n(function(document) {\n    if (!(\"classList\" in document.documentElement) && Object.defineProperty && typeof HTMLElement !== 'undefined') {\n\n        Object.defineProperty(HTMLElement.prototype, 'classList', {\n            get: function() {\n                var self = this;\n                function update(fn) {\n                    return function(value) {\n                        var classes = self.className.split(/\\s+/),\n                                index = classes.indexOf(value);\n\n                        fn(classes, index, value);\n                        self.className = classes.join(\" \");\n                    };\n                }\n\n                var ret = {\n                    add: update(function(classes, index, value) {\n                        ~index || classes.push(value);\n                    }),\n                    remove: update(function(classes, index) {\n                        ~index && classes.splice(index, 1);\n                    }),\n                    toggle: update(function(classes, index, value) {\n                        ~index ? classes.splice(index, 1) : classes.push(value);\n                    }),\n                    contains: function(value) {\n                        return !!~self.className.split(/\\s+/).indexOf(value);\n                    },\n                    item: function(i) {\n                        return self.className.split(/\\s+/)[i] || null;\n                    }\n                };\n\n                Object.defineProperty(ret, 'length', {\n                    get: function() {\n                        return self.className.split(/\\s+/).length;\n                    }\n                });\n\n                return ret;\n            }\n        });\n    }\n})(document);\n\n/**\n * mui fixed requestAnimationFrame\n * @param {type} window\n * @returns {undefined}\n */\n(function(window) {\n\tif (!window.requestAnimationFrame) {\n\t\tvar lastTime = 0;\n\t\twindow.requestAnimationFrame = window.webkitRequestAnimationFrame || function(callback, element) {\n\t\t\tvar currTime = new Date().getTime();\n\t\t\tvar timeToCall = Math.max(0, 16.7 - (currTime - lastTime));\n\t\t\tvar id = window.setTimeout(function() {\n\t\t\t\tcallback(currTime + timeToCall);\n\t\t\t}, timeToCall);\n\t\t\tlastTime = currTime + timeToCall;\n\t\t\treturn id;\n\t\t};\n\t\twindow.cancelAnimationFrame = window.webkitCancelAnimationFrame || window.webkitCancelRequestAnimationFrame || function(id) {\n\t\t\tclearTimeout(id);\n\t\t};\n\t};\n}(window));\n/**\n * fastclick(only for radio,checkbox)\n */\n(function($, window, name) {\n\tif (!$.os.android && !$.os.ios) { //目前仅识别android和ios\n\t\treturn;\n\t}\n\tif (window.FastClick) {\n\t\treturn;\n\t}\n\n\tvar handle = function(event, target) {\n\t\tif (target.tagName === 'LABEL') {\n\t\t\tif (target.parentNode) {\n\t\t\t\ttarget = target.parentNode.querySelector('input');\n\t\t\t}\n\t\t}\n\t\tif (target && (target.type === 'radio' || target.type === 'checkbox')) {\n\t\t\tif (!target.disabled) { //disabled\n\t\t\t\treturn target;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t};\n\n\t$.registerTarget({\n\t\tname: name,\n\t\tindex: 40,\n\t\thandle: handle,\n\t\ttarget: false\n\t});\n\tvar dispatchEvent = function(event) {\n\t\tvar targetElement = $.targets.click;\n\t\tif (targetElement) {\n\t\t\tvar clickEvent, touch;\n\t\t\t// On some Android devices activeElement needs to be blurred otherwise the synthetic click will have no effect\n\t\t\tif (document.activeElement && document.activeElement !== targetElement) {\n\t\t\t\tdocument.activeElement.blur();\n\t\t\t}\n\t\t\ttouch = event.detail.gesture.changedTouches[0];\n\t\t\t// Synthesise a click event, with an extra attribute so it can be tracked\n\t\t\tclickEvent = document.createEvent('MouseEvents');\n\t\t\tclickEvent.initMouseEvent('click', true, true, window, 1, touch.screenX, touch.screenY, touch.clientX, touch.clientY, false, false, false, false, 0, null);\n\t\t\tclickEvent.forwardedTouchEvent = true;\n\t\t\ttargetElement.dispatchEvent(clickEvent);\n\t\t\tevent.detail && event.detail.gesture.preventDefault();\n\t\t}\n\t};\n\twindow.addEventListener('tap', dispatchEvent);\n\twindow.addEventListener('doubletap', dispatchEvent);\n\t//捕获\n\twindow.addEventListener('click', function(event) {\n\t\tif ($.targets.click) {\n\t\t\tif (!event.forwardedTouchEvent) { //stop click\n\t\t\t\tif (event.stopImmediatePropagation) {\n\t\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t\t} else {\n\t\t\t\t\t// Part of the hack for browsers that don't support Event#stopImmediatePropagation\n\t\t\t\t\tevent.propagationStopped = true;\n\t\t\t\t}\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tevent.preventDefault();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}, true);\n\n})(mui, window, 'click');\n(function($, document) {\n\t$(function() {\n\t\tif (!$.os.ios) {\n\t\t\treturn;\n\t\t}\n\t\tvar CLASS_FOCUSIN = 'mui-focusin';\n\t\tvar CLASS_BAR_TAB = 'mui-bar-tab';\n\t\tvar CLASS_BAR_FOOTER = 'mui-bar-footer';\n\t\tvar CLASS_BAR_FOOTER_SECONDARY = 'mui-bar-footer-secondary';\n\t\tvar CLASS_BAR_FOOTER_SECONDARY_TAB = 'mui-bar-footer-secondary-tab';\n\t\t// var content = document.querySelector('.' + CLASS_CONTENT);\n\t\t// if (content) {\n\t\t// \tdocument.body.insertBefore(content, document.body.firstElementChild);\n\t\t// }\n\t\tdocument.addEventListener('focusin', function(e) {\n\t\t\tif ($.os.plus) { //在父webview里边不fix\n\t\t\t\tif (window.plus) {\n\t\t\t\t\tif (plus.webview.currentWebview().children().length > 0) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar target = e.target;\n\t\t\t//TODO 需考虑所有键盘弹起的情况\n\t\t\tif (target.tagName && (target.tagName === 'TEXTAREA' || (target.tagName === 'INPUT' && (target.type === 'text' || target.type === 'search' || target.type === 'number')))) {\n\t\t\t\tif (target.disabled || target.readOnly) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tdocument.body.classList.add(CLASS_FOCUSIN);\n\t\t\t\tvar isFooter = false;\n\t\t\t\tfor (; target && target !== document; target = target.parentNode) {\n\t\t\t\t\tvar classList = target.classList;\n\t\t\t\t\tif (classList && classList.contains(CLASS_BAR_TAB) || classList.contains(CLASS_BAR_FOOTER) || classList.contains(CLASS_BAR_FOOTER_SECONDARY) || classList.contains(CLASS_BAR_FOOTER_SECONDARY_TAB)) {\n\t\t\t\t\t\tisFooter = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (isFooter) {\n\t\t\t\t\tvar scrollTop = document.body.scrollHeight;\n\t\t\t\t\tvar scrollLeft = document.body.scrollLeft;\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\twindow.scrollTo(scrollLeft, scrollTop);\n\t\t\t\t\t}, 20);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tdocument.addEventListener('focusout', function(e) {\n\t\t\tvar classList = document.body.classList;\n\t\t\tif (classList.contains(CLASS_FOCUSIN)) {\n\t\t\t\tclassList.remove(CLASS_FOCUSIN);\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\twindow.scrollTo(document.body.scrollLeft, document.body.scrollTop);\n\t\t\t\t}, 20);\n\t\t\t}\n\t\t});\n\t});\n})(mui, document);\n/**\n * mui namespace(optimization)\n * @param {type} $\n * @returns {undefined}\n */\n(function($) {\n\t$.namespace = 'mui';\n\t$.classNamePrefix = $.namespace + '-';\n\t$.classSelectorPrefix = '.' + $.classNamePrefix;\n\t/**\n\t * 返回正确的className\n\t * @param {type} className\n\t * @returns {String}\n\t */\n\t$.className = function(className) {\n\t\treturn $.classNamePrefix + className;\n\t};\n\t/**\n\t * 返回正确的classSelector\n\t * @param {type} classSelector\n\t * @returns {String}\n\t */\n\t$.classSelector = function(classSelector) {\n\t\treturn classSelector.replace(/\\./g, $.classSelectorPrefix);\n\t};\n\t/**\n         * 返回正确的eventName\n         * @param {type} event\n         * @param {type} module\n         * @returns {String}\n         */\n\t$.eventName = function(event, module) {\n\t\treturn event + ($.namespace ? ('.' + $.namespace) : '') + ( module ? ('.' + module) : '');\n\t};\n})(mui);\n\n/**\n * mui gestures\n * @param {type} $\n * @param {type} window\n * @returns {undefined}\n */\n(function($, window) {\n\t$.gestures = {\n\t\tsession: {}\n\t};\n\t/**\n\t * Gesture preventDefault\n\t * @param {type} e\n\t * @returns {undefined}\n\t */\n\t$.preventDefault = function(e) {\n\t\te.preventDefault();\n\t};\n\t/**\n\t * Gesture stopPropagation\n\t * @param {type} e\n\t * @returns {undefined}\n\t */\n\t$.stopPropagation = function(e) {\n\t\te.stopPropagation();\n\t};\n\n\t/**\n\t * register gesture\n\t * @param {type} gesture\n\t * @returns {$.gestures}\n\t */\n\t$.addGesture = function(gesture) {\n\t\treturn $.addAction('gestures', gesture);\n\n\t};\n\n\tvar round = Math.round;\n\tvar abs = Math.abs;\n\tvar sqrt = Math.sqrt;\n\tvar atan = Math.atan;\n\tvar atan2 = Math.atan2;\n\t/**\n\t * distance\n\t * @param {type} p1\n\t * @param {type} p2\n\t * @returns {Number}\n\t */\n\tvar getDistance = function(p1, p2, props) {\n\t\tif (!props) {\n\t\t\tprops = ['x', 'y'];\n\t\t}\n\t\tvar x = p2[props[0]] - p1[props[0]];\n\t\tvar y = p2[props[1]] - p1[props[1]];\n\t\treturn sqrt((x * x) + (y * y));\n\t};\n\t/**\n\t * scale\n\t * @param {Object} starts\n\t * @param {Object} moves\n\t */\n\tvar getScale = function(starts, moves) {\n\t\tif (starts.length >= 2 && moves.length >= 2) {\n\t\t\tvar props = ['pageX', 'pageY'];\n\t\t\treturn getDistance(moves[1], moves[0], props) / getDistance(starts[1], starts[0], props);\n\t\t}\n\t\treturn 1;\n\t};\n\t/**\n\t * angle\n\t * @param {type} p1\n\t * @param {type} p2\n\t * @returns {Number}\n\t */\n\tvar getAngle = function(p1, p2, props) {\n\t\tif (!props) {\n\t\t\tprops = ['x', 'y'];\n\t\t}\n\t\tvar x = p2[props[0]] - p1[props[0]];\n\t\tvar y = p2[props[1]] - p1[props[1]];\n\t\treturn atan2(y, x) * 180 / Math.PI;\n\t};\n\t/**\n\t * direction\n\t * @param {Object} x\n\t * @param {Object} y\n\t */\n\tvar getDirection = function(x, y) {\n\t\tif (x === y) {\n\t\t\treturn '';\n\t\t}\n\t\tif (abs(x) >= abs(y)) {\n\t\t\treturn x > 0 ? 'left' : 'right';\n\t\t}\n\t\treturn y > 0 ? 'up' : 'down';\n\t};\n\t/**\n\t * rotation\n\t * @param {Object} start\n\t * @param {Object} end\n\t */\n\tvar getRotation = function(start, end) {\n\t\tvar props = ['pageX', 'pageY'];\n\t\treturn getAngle(end[1], end[0], props) - getAngle(start[1], start[0], props);\n\t};\n\t/**\n\t * px per ms\n\t * @param {Object} deltaTime\n\t * @param {Object} x\n\t * @param {Object} y\n\t */\n\tvar getVelocity = function(deltaTime, x, y) {\n\t\treturn {\n\t\t\tx: x / deltaTime || 0,\n\t\t\ty: y / deltaTime || 0\n\t\t};\n\t};\n\t/**\n\t * detect gestures\n\t * @param {type} event\n\t * @param {type} touch\n\t * @returns {undefined}\n\t */\n\tvar detect = function(event, touch) {\n\t\tif ($.gestures.stoped) {\n\t\t\treturn;\n\t\t}\n\t\t$.doAction('gestures', function(index, gesture) {\n\t\t\tif (!$.gestures.stoped) {\n\t\t\t\tif ($.options.gestureConfig[gesture.name] !== false) {\n\t\t\t\t\tgesture.handle(event, touch);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\t/**\n\t * 暂时无用\n\t * @param {Object} node\n\t * @param {Object} parent\n\t */\n\tvar hasParent = function(node, parent) {\n\t\twhile (node) {\n\t\t\tif (node == parent) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tnode = node.parentNode;\n\t\t}\n\t\treturn false;\n\t};\n\n\tvar uniqueArray = function(src, key, sort) {\n\t\tvar results = [];\n\t\tvar values = [];\n\t\tvar i = 0;\n\n\t\twhile (i < src.length) {\n\t\t\tvar val = key ? src[i][key] : src[i];\n\t\t\tif (values.indexOf(val) < 0) {\n\t\t\t\tresults.push(src[i]);\n\t\t\t}\n\t\t\tvalues[i] = val;\n\t\t\ti++;\n\t\t}\n\n\t\tif (sort) {\n\t\t\tif (!key) {\n\t\t\t\tresults = results.sort();\n\t\t\t} else {\n\t\t\t\tresults = results.sort(function sortUniqueArray(a, b) {\n\t\t\t\t\treturn a[key] > b[key];\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn results;\n\t};\n\tvar getMultiCenter = function(touches) {\n\t\tvar touchesLength = touches.length;\n\t\tif (touchesLength === 1) {\n\t\t\treturn {\n\t\t\t\tx: round(touches[0].pageX),\n\t\t\t\ty: round(touches[0].pageY)\n\t\t\t};\n\t\t}\n\n\t\tvar x = 0;\n\t\tvar y = 0;\n\t\tvar i = 0;\n\t\twhile (i < touchesLength) {\n\t\t\tx += touches[i].pageX;\n\t\t\ty += touches[i].pageY;\n\t\t\ti++;\n\t\t}\n\n\t\treturn {\n\t\t\tx: round(x / touchesLength),\n\t\t\ty: round(y / touchesLength)\n\t\t};\n\t};\n\tvar multiTouch = function() {\n\t\treturn $.options.gestureConfig.pinch;\n\t};\n\tvar copySimpleTouchData = function(touch) {\n\t\tvar touches = [];\n\t\tvar i = 0;\n\t\twhile (i < touch.touches.length) {\n\t\t\ttouches[i] = {\n\t\t\t\tpageX: round(touch.touches[i].pageX),\n\t\t\t\tpageY: round(touch.touches[i].pageY)\n\t\t\t};\n\t\t\ti++;\n\t\t}\n\t\treturn {\n\t\t\ttimestamp: $.now(),\n\t\t\tgesture: touch.gesture,\n\t\t\ttouches: touches,\n\t\t\tcenter: getMultiCenter(touch.touches),\n\t\t\tdeltaX: touch.deltaX,\n\t\t\tdeltaY: touch.deltaY\n\t\t};\n\t};\n\n\tvar calDelta = function(touch) {\n\t\tvar session = $.gestures.session;\n\t\tvar center = touch.center;\n\t\tvar offset = session.offsetDelta || {};\n\t\tvar prevDelta = session.prevDelta || {};\n\t\tvar prevTouch = session.prevTouch || {};\n\n\t\tif (touch.gesture.type === $.EVENT_START || touch.gesture.type === $.EVENT_END) {\n\t\t\tprevDelta = session.prevDelta = {\n\t\t\t\tx: prevTouch.deltaX || 0,\n\t\t\t\ty: prevTouch.deltaY || 0\n\t\t\t};\n\n\t\t\toffset = session.offsetDelta = {\n\t\t\t\tx: center.x,\n\t\t\t\ty: center.y\n\t\t\t};\n\t\t}\n\t\ttouch.deltaX = prevDelta.x + (center.x - offset.x);\n\t\ttouch.deltaY = prevDelta.y + (center.y - offset.y);\n\t};\n\tvar calTouchData = function(touch) {\n\t\tvar session = $.gestures.session;\n\t\tvar touches = touch.touches;\n\t\tvar touchesLength = touches.length;\n\n\t\tif (!session.firstTouch) {\n\t\t\tsession.firstTouch = copySimpleTouchData(touch);\n\t\t}\n\n\t\tif (multiTouch() && touchesLength > 1 && !session.firstMultiTouch) {\n\t\t\tsession.firstMultiTouch = copySimpleTouchData(touch);\n\t\t} else if (touchesLength === 1) {\n\t\t\tsession.firstMultiTouch = false;\n\t\t}\n\n\t\tvar firstTouch = session.firstTouch;\n\t\tvar firstMultiTouch = session.firstMultiTouch;\n\t\tvar offsetCenter = firstMultiTouch ? firstMultiTouch.center : firstTouch.center;\n\n\t\tvar center = touch.center = getMultiCenter(touches);\n\t\ttouch.timestamp = $.now();\n\t\ttouch.deltaTime = touch.timestamp - firstTouch.timestamp;\n\n\t\ttouch.angle = getAngle(offsetCenter, center);\n\t\ttouch.distance = getDistance(offsetCenter, center);\n\n\t\tcalDelta(touch);\n\n\t\ttouch.offsetDirection = getDirection(touch.deltaX, touch.deltaY);\n\n\t\ttouch.scale = firstMultiTouch ? getScale(firstMultiTouch.touches, touches) : 1;\n\t\ttouch.rotation = firstMultiTouch ? getRotation(firstMultiTouch.touches, touches) : 0;\n\n\t\tcalIntervalTouchData(touch);\n\n\t};\n\tvar CAL_INTERVAL = 25;\n\tvar calIntervalTouchData = function(touch) {\n\t\tvar session = $.gestures.session;\n\t\tvar last = session.lastInterval || touch;\n\t\tvar deltaTime = touch.timestamp - last.timestamp;\n\t\tvar velocity;\n\t\tvar velocityX;\n\t\tvar velocityY;\n\t\tvar direction;\n\n\t\tif (touch.gesture.type != $.EVENT_CANCEL && (deltaTime > CAL_INTERVAL || last.velocity === undefined)) {\n\t\t\tvar deltaX = last.deltaX - touch.deltaX;\n\t\t\tvar deltaY = last.deltaY - touch.deltaY;\n\n\t\t\tvar v = getVelocity(deltaTime, deltaX, deltaY);\n\t\t\tvelocityX = v.x;\n\t\t\tvelocityY = v.y;\n\t\t\tvelocity = (abs(v.x) > abs(v.y)) ? v.x : v.y;\n\t\t\tdirection = getDirection(deltaX, deltaY) || last.direction;\n\n\t\t\tsession.lastInterval = touch;\n\t\t} else {\n\t\t\tvelocity = last.velocity;\n\t\t\tvelocityX = last.velocityX;\n\t\t\tvelocityY = last.velocityY;\n\t\t\tdirection = last.direction;\n\t\t}\n\n\t\ttouch.velocity = velocity;\n\t\ttouch.velocityX = velocityX;\n\t\ttouch.velocityY = velocityY;\n\t\ttouch.direction = direction;\n\t};\n\tvar targetIds = {};\n\tvar convertTouches = function(touches) {\n\t\tfor (var i = 0; i < touches.length; i++) {\n\t\t\t!touches['identifier'] && (touches['identifier'] = 0);\n\t\t}\n\t\treturn touches;\n\t};\n\tvar getTouches = function(event, touch) {\n\t\tvar allTouches = convertTouches($.slice.call(event.touches || [event]));\n\n\t\tvar type = event.type;\n\n\t\tvar targetTouches = [];\n\t\tvar changedTargetTouches = [];\n\n\t\t//当touchstart或touchmove且touches长度为1，直接获得all和changed\n\t\tif ((type === $.EVENT_START || type === $.EVENT_MOVE) && allTouches.length === 1) {\n\t\t\ttargetIds[allTouches[0].identifier] = true;\n\t\t\ttargetTouches = allTouches;\n\t\t\tchangedTargetTouches = allTouches;\n\t\t\ttouch.target = event.target;\n\t\t} else {\n\t\t\tvar i = 0;\n\t\t\tvar targetTouches = [];\n\t\t\tvar changedTargetTouches = [];\n\t\t\tvar changedTouches = convertTouches($.slice.call(event.changedTouches || [event]));\n\n\t\t\ttouch.target = event.target;\n\t\t\tvar sessionTarget = $.gestures.session.target || event.target;\n\t\t\ttargetTouches = allTouches.filter(function(touch) {\n\t\t\t\treturn hasParent(touch.target, sessionTarget);\n\t\t\t});\n\n\t\t\tif (type === $.EVENT_START) {\n\t\t\t\ti = 0;\n\t\t\t\twhile (i < targetTouches.length) {\n\t\t\t\t\ttargetIds[targetTouches[i].identifier] = true;\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ti = 0;\n\t\t\twhile (i < changedTouches.length) {\n\t\t\t\tif (targetIds[changedTouches[i].identifier]) {\n\t\t\t\t\tchangedTargetTouches.push(changedTouches[i]);\n\t\t\t\t}\n\t\t\t\tif (type === $.EVENT_END || type === $.EVENT_CANCEL) {\n\t\t\t\t\tdelete targetIds[changedTouches[i].identifier];\n\t\t\t\t}\n\t\t\t\ti++;\n\t\t\t}\n\n\t\t\tif (!changedTargetTouches.length) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\ttargetTouches = uniqueArray(targetTouches.concat(changedTargetTouches), 'identifier', true);\n\t\tvar touchesLength = targetTouches.length;\n\t\tvar changedTouchesLength = changedTargetTouches.length;\n\t\tif (type === $.EVENT_START && touchesLength - changedTouchesLength === 0) { //first\n\t\t\ttouch.isFirst = true;\n\t\t\t$.gestures.touch = $.gestures.session = {\n\t\t\t\ttarget: event.target\n\t\t\t};\n\t\t}\n\t\ttouch.isFinal = ((type === $.EVENT_END || type === $.EVENT_CANCEL) && (touchesLength - changedTouchesLength === 0));\n\n\t\ttouch.touches = targetTouches;\n\t\ttouch.changedTouches = changedTargetTouches;\n\t\treturn true;\n\n\t};\n\tvar handleTouchEvent = function(event) {\n\t\tvar touch = {\n\t\t\tgesture: event\n\t\t};\n\t\tvar touches = getTouches(event, touch);\n\t\tif (!touches) {\n\t\t\treturn;\n\t\t}\n\t\tcalTouchData(touch);\n\t\tdetect(event, touch);\n\t\t$.gestures.session.prevTouch = touch;\n\t\tif (event.type === $.EVENT_END && !$.isTouchable) {\n\t\t\t$.gestures.touch = $.gestures.session = {};\n\t\t}\n\t};\n\twindow.addEventListener($.EVENT_START, handleTouchEvent);\n\twindow.addEventListener($.EVENT_MOVE, handleTouchEvent);\n\twindow.addEventListener($.EVENT_END, handleTouchEvent);\n\twindow.addEventListener($.EVENT_CANCEL, handleTouchEvent);\n\t//fixed hashchange(android)\n\twindow.addEventListener($.EVENT_CLICK, function(e) {\n\t\t//TODO 应该判断当前target是不是在targets.popover内部，而不是非要相等\n\t\tif (($.os.android || $.os.ios) && (($.targets.popover && e.target === $.targets.popover) || ($.targets.tab) || $.targets.offcanvas || $.targets.modal)) {\n\t\t\te.preventDefault();\n\t\t}\n\t}, true);\n\n\n\t//增加原生滚动识别\n\t$.isScrolling = false;\n\tvar scrollingTimeout = null;\n\twindow.addEventListener('scroll', function() {\n\t\t$.isScrolling = true;\n\t\tscrollingTimeout && clearTimeout(scrollingTimeout);\n\t\tscrollingTimeout = setTimeout(function() {\n\t\t\t$.isScrolling = false;\n\t\t}, 250);\n\t});\n})(mui, window);\n/**\n * mui gesture flick[left|right|up|down]\n * @param {type} $\n * @param {type} name\n * @returns {undefined}\n */\n(function($, name) {\n\tvar flickStartTime = 0;\n\tvar handle = function(event, touch) {\n\t\tvar session = $.gestures.session;\n\t\tvar options = this.options;\n\t\tvar now = $.now();\n\t\tswitch (event.type) {\n\t\t\tcase $.EVENT_MOVE:\n\t\t\t\tif (now - flickStartTime > 300) {\n\t\t\t\t\tflickStartTime = now;\n\t\t\t\t\tsession.flickStart = touch.center;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase $.EVENT_END:\n\t\t\tcase $.EVENT_CANCEL:\n\t\t\t\ttouch.flick = false;\n\t\t\t\tif (session.flickStart && options.flickMaxTime > (now - flickStartTime) && touch.distance > options.flickMinDistince) {\n\t\t\t\t\ttouch.flick = true;\n\t\t\t\t\ttouch.flickTime = now - flickStartTime;\n\t\t\t\t\ttouch.flickDistanceX = touch.center.x - session.flickStart.x;\n\t\t\t\t\ttouch.flickDistanceY = touch.center.y - session.flickStart.y;\n\t\t\t\t\t$.trigger(session.target, name, touch);\n\t\t\t\t\t$.trigger(session.target, name + touch.direction, touch);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t};\n\t/**\n\t * mui gesture flick\n\t */\n\t$.addGesture({\n\t\tname: name,\n\t\tindex: 5,\n\t\thandle: handle,\n\t\toptions: {\n\t\t\tflickMaxTime: 200,\n\t\t\tflickMinDistince: 10\n\t\t}\n\t});\n})(mui, 'flick');\n/**\n * mui gesture swipe[left|right|up|down]\n * @param {type} $\n * @param {type} name\n * @returns {undefined}\n */\n(function($, name) {\n\tvar handle = function(event, touch) {\n\t\tvar session = $.gestures.session;\n\t\tif (event.type === $.EVENT_END || event.type === $.EVENT_CANCEL) {\n\t\t\tvar options = this.options;\n\t\t\ttouch.swipe = false;\n\t\t\t//TODO 后续根据velocity计算\n\t\t\tif (touch.direction && options.swipeMaxTime > touch.deltaTime && touch.distance > options.swipeMinDistince) {\n\t\t\t\ttouch.swipe = true;\n\t\t\t\t$.trigger(session.target, name, touch);\n\t\t\t\t$.trigger(session.target, name + touch.direction, touch);\n\t\t\t}\n\t\t}\n\t};\n\t/**\n\t * mui gesture swipe\n\t */\n\t$.addGesture({\n\t\tname: name,\n\t\tindex: 10,\n\t\thandle: handle,\n\t\toptions: {\n\t\t\tswipeMaxTime: 300,\n\t\t\tswipeMinDistince: 18\n\t\t}\n\t});\n})(mui, 'swipe');\n/**\n * mui gesture drag[start|left|right|up|down|end]\n * @param {type} $\n * @param {type} name\n * @returns {undefined}\n */\n(function($, name) {\n\tvar handle = function(event, touch) {\n\t\tvar session = $.gestures.session;\n\t\tswitch (event.type) {\n\t\t\tcase $.EVENT_START:\n\t\t\t\tbreak;\n\t\t\tcase $.EVENT_MOVE:\n\t\t\t\tif (!touch.direction || !session.target) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t//修正direction,可在session期间自行锁定拖拽方向，方便开发scroll类不同方向拖拽插件嵌套\n\t\t\t\tif (session.lockDirection && session.startDirection) {\n\t\t\t\t\tif (session.startDirection && session.startDirection !== touch.direction) {\n\t\t\t\t\t\tif (session.startDirection === 'up' || session.startDirection === 'down') {\n\t\t\t\t\t\t\ttouch.direction = touch.deltaY < 0 ? 'up' : 'down';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttouch.direction = touch.deltaX < 0 ? 'left' : 'right';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!session.drag) {\n\t\t\t\t\tsession.drag = true;\n\t\t\t\t\t$.trigger(session.target, name + 'start', touch);\n\t\t\t\t}\n\t\t\t\t$.trigger(session.target, name, touch);\n\t\t\t\t$.trigger(session.target, name + touch.direction, touch);\n\t\t\t\tbreak;\n\t\t\tcase $.EVENT_END:\n\t\t\tcase $.EVENT_CANCEL:\n\t\t\t\tif (session.drag && touch.isFinal) {\n\t\t\t\t\t$.trigger(session.target, name + 'end', touch);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t};\n\t/**\n\t * mui gesture drag\n\t */\n\t$.addGesture({\n\t\tname: name,\n\t\tindex: 20,\n\t\thandle: handle,\n\t\toptions: {\n\t\t\tfingers: 1\n\t\t}\n\t});\n})(mui, 'drag');\n/**\n * mui gesture tap and doubleTap\n * @param {type} $\n * @param {type} name\n * @returns {undefined}\n */\n(function($, name) {\n\tvar lastTarget;\n\tvar lastTapTime;\n\tvar handle = function(event, touch) {\n\t\tvar session = $.gestures.session;\n\t\tvar options = this.options;\n\t\tswitch (event.type) {\n\t\t\tcase $.EVENT_END:\n\t\t\t\tif (!touch.isFinal) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar target = session.target;\n\t\t\t\tif (!target || (target.disabled || (target.classList && target.classList.contains('mui-disabled')))) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (touch.distance < options.tapMaxDistance && touch.deltaTime < options.tapMaxTime) {\n\t\t\t\t\tif ($.options.gestureConfig.doubletap && lastTarget && (lastTarget === target)) { //same target\n\t\t\t\t\t\tif (lastTapTime && (touch.timestamp - lastTapTime) < options.tapMaxInterval) {\n\t\t\t\t\t\t\t$.trigger(target, 'doubletap', touch);\n\t\t\t\t\t\t\tlastTapTime = $.now();\n\t\t\t\t\t\t\tlastTarget = target;\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t$.trigger(target, name, touch);\n\t\t\t\t\tlastTapTime = $.now();\n\t\t\t\t\tlastTarget = target;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t};\n\t/**\n\t * mui gesture tap\n\t */\n\t$.addGesture({\n\t\tname: name,\n\t\tindex: 30,\n\t\thandle: handle,\n\t\toptions: {\n\t\t\tfingers: 1,\n\t\t\ttapMaxInterval: 300,\n\t\t\ttapMaxDistance: 5,\n\t\t\ttapMaxTime: 250\n\t\t}\n\t});\n})(mui, 'tap');\n/**\n * mui gesture longtap\n * @param {type} $\n * @param {type} name\n * @returns {undefined}\n */\n(function($, name) {\n\tvar timer;\n\tvar handle = function(event, touch) {\n\t\tvar session = $.gestures.session;\n\t\tvar options = this.options;\n\t\tswitch (event.type) {\n\t\t\tcase $.EVENT_START:\n\t\t\t\tclearTimeout(timer);\n\t\t\t\ttimer = setTimeout(function() {\n\t\t\t\t\t$.trigger(session.target, name, touch);\n\t\t\t\t}, options.holdTimeout);\n\t\t\t\tbreak;\n\t\t\tcase $.EVENT_MOVE:\n\t\t\t\tif (touch.distance > options.holdThreshold) {\n\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase $.EVENT_END:\n\t\t\tcase $.EVENT_CANCEL:\n\t\t\t\tclearTimeout(timer);\n\t\t\t\tbreak;\n\t\t}\n\t};\n\t/**\n\t * mui gesture longtap\n\t */\n\t$.addGesture({\n\t\tname: name,\n\t\tindex: 10,\n\t\thandle: handle,\n\t\toptions: {\n\t\t\tfingers: 1,\n\t\t\tholdTimeout: 500,\n\t\t\tholdThreshold: 2\n\t\t}\n\t});\n})(mui, 'longtap');\n/**\n * mui gesture hold\n * @param {type} $\n * @param {type} name\n * @returns {undefined}\n */\n(function($, name) {\n\tvar timer;\n\tvar handle = function(event, touch) {\n\t\tvar session = $.gestures.session;\n\t\tvar options = this.options;\n\t\tswitch (event.type) {\n\t\t\tcase $.EVENT_START:\n\t\t\t\tif ($.options.gestureConfig.hold) {\n\t\t\t\t\ttimer && clearTimeout(timer);\n\t\t\t\t\ttimer = setTimeout(function() {\n\t\t\t\t\t\ttouch.hold = true;\n\t\t\t\t\t\t$.trigger(session.target, name, touch);\n\t\t\t\t\t}, options.holdTimeout);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase $.EVENT_MOVE:\n\t\t\t\tbreak;\n\t\t\tcase $.EVENT_END:\n\t\t\tcase $.EVENT_CANCEL:\n\t\t\t\tif (timer) {\n\t\t\t\t\tclearTimeout(timer) && (timer = null);\n\t\t\t\t\t$.trigger(session.target, 'release', touch);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t};\n\t/**\n\t * mui gesture hold\n\t */\n\t$.addGesture({\n\t\tname: name,\n\t\tindex: 10,\n\t\thandle: handle,\n\t\toptions: {\n\t\t\tfingers: 1,\n\t\t\tholdTimeout: 0\n\t\t}\n\t});\n})(mui, 'hold');\n/**\n * mui gesture pinch\n * @param {type} $\n * @param {type} name\n * @returns {undefined}\n */\n(function($, name) {\n\tvar handle = function(event, touch) {\n\t\tvar options = this.options;\n\t\tvar session = $.gestures.session;\n\t\tswitch (event.type) {\n\t\t\tcase $.EVENT_START:\n\t\t\t\tbreak;\n\t\t\tcase $.EVENT_MOVE:\n\t\t\t\tif ($.options.gestureConfig.pinch) {\n\t\t\t\t\tif (touch.touches.length < 2) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (!session.pinch) { //start\n\t\t\t\t\t\tsession.pinch = true;\n\t\t\t\t\t\t$.trigger(session.target, name + 'start', touch);\n\t\t\t\t\t}\n\t\t\t\t\t$.trigger(session.target, name, touch);\n\t\t\t\t\tvar scale = touch.scale;\n\t\t\t\t\tvar rotation = touch.rotation;\n\t\t\t\t\tvar lastScale = typeof touch.lastScale === 'undefined' ? 1 : touch.lastScale;\n\t\t\t\t\tvar scaleDiff = 0.000000000001; //防止scale与lastScale相等，不触发事件的情况。\n\t\t\t\t\tif (scale > lastScale) { //out\n\t\t\t\t\t\tlastScale = scale - scaleDiff;\n\t\t\t\t\t\t$.trigger(session.target, name + 'out', touch);\n\t\t\t\t\t} //in\n\t\t\t\t\telse if (scale < lastScale) {\n\t\t\t\t\t\tlastScale = scale + scaleDiff;\n\t\t\t\t\t\t$.trigger(session.target, name + 'in', touch);\n\t\t\t\t\t}\n\t\t\t\t\tif (Math.abs(rotation) > options.minRotationAngle) {\n\t\t\t\t\t\t$.trigger(session.target, 'rotate', touch);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase $.EVENT_END:\n\t\t\tcase $.EVENT_CANCEL:\n\t\t\t\tif ($.options.gestureConfig.pinch && session.pinch && touch.touches.length === 2) {\n\t\t\t\t\tsession.pinch = false;\n\t\t\t\t\t$.trigger(session.target, name + 'end', touch);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t};\n\t/**\n\t * mui gesture pinch\n\t */\n\t$.addGesture({\n\t\tname: name,\n\t\tindex: 10,\n\t\thandle: handle,\n\t\toptions: {\n\t\t\tminRotationAngle: 0\n\t\t}\n\t});\n})(mui, 'pinch');\n/**\n * mui.init\n * @param {type} $\n * @returns {undefined}\n */\n(function($) {\n\t$.global = $.options = {\n\t\tgestureConfig: {\n\t\t\ttap: true,\n\t\t\tdoubletap: false,\n\t\t\tlongtap: false,\n\t\t\thold: false,\n\t\t\tflick: true,\n\t\t\tswipe: true,\n\t\t\tdrag: true,\n\t\t\tpinch: false\n\t\t}\n\t};\n\t/**\n\t *\n\t * @param {type} options\n\t * @returns {undefined}\n\t */\n\t$.initGlobal = function(options) {\n\t\t$.options = $.extend(true, $.global, options);\n\t\treturn this;\n\t};\n\tvar inits = {};\n\n\t/**\n\t * 单页配置 初始化\n\t * @param {object} options\n\t */\n\t$.init = function(options) {\n\t\t$.options = $.extend(true, $.global, options || {});\n\t\t$.ready(function() {\n\t\t\t$.doAction('inits', function(index, init) {\n\t\t\t\tvar isInit = !!(!inits[init.name] || init.repeat);\n\t\t\t\tif (isInit) {\n\t\t\t\t\tinit.handle.call($);\n\t\t\t\t\tinits[init.name] = true;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\treturn this;\n\t};\n\n\t/**\n\t * 增加初始化执行流程\n\t * @param {function} init\n\t */\n\t$.addInit = function(init) {\n\t\treturn $.addAction('inits', init);\n\t};\n\t/**\n\t * 处理html5版本subpages\n\t */\n\t$.addInit({\n\t\tname: 'iframe',\n\t\tindex: 100,\n\t\thandle: function() {\n\t\t\tvar options = $.options;\n\t\t\tvar subpages = options.subpages || [];\n\t\t\tif (!$.os.plus && subpages.length) {\n\t\t\t\t//暂时只处理单个subpage。后续可以考虑支持多个subpage\n\t\t\t\tcreateIframe(subpages[0]);\n\t\t\t}\n\t\t}\n\t});\n\tvar createIframe = function(options) {\n\t\tvar wrapper = document.createElement('div');\n\t\twrapper.className = 'mui-iframe-wrapper';\n\t\tvar styles = options.styles || {};\n\t\tif (typeof styles.top !== 'string') {\n\t\t\tstyles.top = '0px';\n\t\t}\n\t\tif (typeof styles.bottom !== 'string') {\n\t\t\tstyles.bottom = '0px';\n\t\t}\n\t\twrapper.style.top = styles.top;\n\t\twrapper.style.bottom = styles.bottom;\n\t\tvar iframe = document.createElement('iframe');\n\t\tiframe.src = options.url;\n\t\tiframe.id = options.id || options.url;\n\t\tiframe.name = iframe.id;\n\t\twrapper.appendChild(iframe);\n\t\tdocument.body.appendChild(wrapper);\n\t\t//目前仅处理微信\n\t\t$.os.wechat && handleScroll(wrapper, iframe);\n\t};\n\n\tfunction handleScroll(wrapper, iframe) {\n\t\tvar key = 'MUI_SCROLL_POSITION_' + document.location.href + '_' + iframe.src;\n\t\tvar scrollTop = (parseFloat(localStorage.getItem(key)) || 0);\n\t\tif (scrollTop) {\n\t\t\t(function(y) {\n\t\t\t\tiframe.onload = function() {\n\t\t\t\t\twindow.scrollTo(0, y);\n\t\t\t\t};\n\t\t\t})(scrollTop);\n\t\t}\n\t\tsetInterval(function() {\n\t\t\tvar _scrollTop = window.scrollY;\n\t\t\tif (scrollTop !== _scrollTop) {\n\t\t\t\tlocalStorage.setItem(key, _scrollTop + '');\n\t\t\t\tscrollTop = _scrollTop;\n\t\t\t}\n\t\t}, 100);\n\t};\n\t$(function() {\n\t\tvar classList = document.body.classList;\n\t\tvar os = [];\n\t\tif ($.os.ios) {\n\t\t\tos.push({\n\t\t\t\tos: 'ios',\n\t\t\t\tversion: $.os.version\n\t\t\t});\n\t\t\tclassList.add('mui-ios');\n\t\t} else if ($.os.android) {\n\t\t\tos.push({\n\t\t\t\tos: 'android',\n\t\t\t\tversion: $.os.version\n\t\t\t});\n\t\t\tclassList.add('mui-android');\n\t\t}\n\t\tif ($.os.wechat) {\n\t\t\tos.push({\n\t\t\t\tos: 'wechat',\n\t\t\t\tversion: $.os.wechat.version\n\t\t\t});\n\t\t\tclassList.add('mui-wechat');\n\t\t}\n\t\tif (os.length) {\n\t\t\t$.each(os, function(index, osObj) {\n\t\t\t\tvar version = '';\n\t\t\t\tvar classArray = [];\n\t\t\t\tif (osObj.version) {\n\t\t\t\t\t$.each(osObj.version.split('.'), function(i, v) {\n\t\t\t\t\t\tversion = version + (version ? '-' : '') + v;\n\t\t\t\t\t\tclassList.add($.className(osObj.os + '-' + version));\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});\n})(mui);\n/**\n * mui.init 5+\n * @param {type} $\n * @returns {undefined}\n */\n(function($) {\n\tvar defaultOptions = {\n\t\tswipeBack: false,\n\t\tpreloadPages: [], //5+ lazyLoad webview\n\t\tpreloadLimit: 10, //预加载窗口的数量限制(一旦超出，先进先出)\n\t\tkeyEventBind: {\n\t\t\tbackbutton: true,\n\t\t\tmenubutton: true\n\t\t},\n\t\ttitleConfig: {\n\t\t\theight: \"44px\",\n\t\t\tbackgroundColor: \"#f7f7f7\", //导航栏背景色\n\t\t\tbottomBorderColor: \"#cccccc\", //底部边线颜色\n\t\t\ttitle: { //标题配置\n\t\t\t\ttext: \"\", //标题文字\n\t\t\t\tposition: {\n\t\t\t\t\ttop: 0,\n\t\t\t\t\tleft: 0,\n\t\t\t\t\twidth: \"100%\",\n\t\t\t\t\theight: \"100%\"\n\t\t\t\t},\n\t\t\t\tstyles: {\n\t\t\t\t\tcolor: \"#000000\",\n\t\t\t\t\talign: \"center\",\n\t\t\t\t\tfamily: \"'Helvetica Neue',Helvetica,sans-serif\",\n\t\t\t\t\tsize: \"17px\",\n\t\t\t\t\tstyle: \"normal\",\n\t\t\t\t\tweight: \"normal\",\n\t\t\t\t\tfontSrc: \"\"\n\t\t\t\t}\n\t\t\t},\n\t\t\tback: {\n\t\t\t\timage: {\n\t\t\t\t\tbase64Data: '',\n\t\t\t\t\timgSrc: '',\n\t\t\t\t\tsprite: {\n\t\t\t\t\t\ttop: '0px',\n\t\t\t\t\t\tleft: '0px',\n\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\theight: '100%'\n\t\t\t\t\t},\n\t\t\t\t\tposition: {\n\t\t\t\t\t\ttop: \"10px\",\n\t\t\t\t\t\tleft: \"10px\",\n\t\t\t\t\t\twidth: \"24px\",\n\t\t\t\t\t\theight: \"24px\"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\t//默认页面动画\n\tvar defaultShow = {\n\t\tevent:\"titleUpdate\",\n\t\tautoShow: true,\n\t\tduration: 300,\n\t\taniShow: 'slide-in-right',\n\t\textras:{}\n\t};\n\t//若执行了显示动画初始化操作，则要覆盖默认配置\n\tif($.options.show) {\n\t\tdefaultShow = $.extend(true, defaultShow, $.options.show);\n\t}\n\n\t$.currentWebview = null;\n\n\t$.extend(true, $.global, defaultOptions);\n\t$.extend(true, $.options, defaultOptions);\n\t/**\n\t * 等待动画配置\n\t * @param {type} options\n\t * @returns {Object}\n\t */\n\t$.waitingOptions = function(options) {\n\t\treturn $.extend(true, {}, {\n\t\t\tautoShow: true,\n\t\t\ttitle: '',\n\t\t\tmodal: false\n\t\t}, options);\n\t};\n\t/**\n\t * 窗口显示配置\n\t * @param {type} options\n\t * @returns {Object}\n\t */\n\t$.showOptions = function(options) {\n\t\treturn $.extend(true, {}, defaultShow, options);\n\t};\n\t/**\n\t * 窗口默认配置\n\t * @param {type} options\n\t * @returns {Object}\n\t */\n\t$.windowOptions = function(options) {\n\t\treturn $.extend({\n\t\t\tscalable: false,\n\t\t\tbounce: \"\" //vertical\n\t\t}, options);\n\t};\n\t/**\n\t * plusReady\n\t * @param {type} callback\n\t * @returns {_L6.$}\n\t */\n\t$.plusReady = function(callback) {\n\t\tif(window.plus) {\n\t\t\tsetTimeout(function() { //解决callback与plusready事件的执行时机问题(典型案例:showWaiting,closeWaiting)\n\t\t\t\tcallback();\n\t\t\t}, 0);\n\t\t} else {\n\t\t\tdocument.addEventListener(\"plusready\", function() {\n\t\t\t\tcallback();\n\t\t\t}, false);\n\t\t}\n\t\treturn this;\n\t};\n\t/**\n\t * 5+ event(5+没提供之前我自己实现)\n\t * @param {type} webview\n\t * @param {type} eventType\n\t * @param {type} data\n\t * @returns {undefined}\n\t */\n\t$.fire = function(webview, eventType, data) {\n\t\tif(webview) {\n\t\t\tif(typeof data === 'undefined') {\n\t\t\t\tdata = '';\n\t\t\t} else if(typeof data === 'boolean' || typeof data === 'number') {\n\t\t\t\twebview.evalJS(\"typeof mui!=='undefined'&&mui.receive('\" + eventType + \"',\" + data + \")\");\n\t\t\t\treturn;\n\t\t\t} else if($.isPlainObject(data) || $.isArray(data)) {\n\t\t\t\tdata = JSON.stringify(data || {}).replace(/\\'/g, \"\\\\u0027\").replace(/\\\\/g, \"\\\\u005c\");\n\t\t\t}\n\t\t\twebview.evalJS(\"typeof mui!=='undefined'&&mui.receive('\" + eventType + \"','\" + data + \"')\");\n\t\t}\n\t};\n\t/**\n\t * 5+ event(5+没提供之前我自己实现)\n\t * @param {type} eventType\n\t * @param {type} data\n\t * @returns {undefined}\n\t */\n\t$.receive = function(eventType, data) {\n\t\tif(eventType) {\n\t\t\ttry {\n\t\t\t\tif(data && typeof data === 'string') {\n\t\t\t\t\tdata = JSON.parse(data);\n\t\t\t\t}\n\t\t\t} catch(e) {}\n\t\t\t$.trigger(document, eventType, data);\n\t\t}\n\t};\n\tvar triggerPreload = function(webview) {\n\t\tif(!webview.preloaded) { //保证仅触发一次\n\t\t\t$.fire(webview, 'preload');\n\t\t\tvar list = webview.children();\n\t\t\tfor(var i = 0; i < list.length; i++) {\n\t\t\t\t$.fire(list[i], 'preload');\n\t\t\t}\n\t\t\twebview.preloaded = true;\n\t\t}\n\t};\n\tvar trigger = function(webview, eventType, timeChecked) {\n\t\tif(timeChecked) {\n\t\t\tif(!webview[eventType + 'ed']) {\n\t\t\t\t$.fire(webview, eventType);\n\t\t\t\tvar list = webview.children();\n\t\t\t\tfor(var i = 0; i < list.length; i++) {\n\t\t\t\t\t$.fire(list[i], eventType);\n\t\t\t\t}\n\t\t\t\twebview[eventType + 'ed'] = true;\n\t\t\t}\n\t\t} else {\n\t\t\t$.fire(webview, eventType);\n\t\t\tvar list = webview.children();\n\t\t\tfor(var i = 0; i < list.length; i++) {\n\t\t\t\t$.fire(list[i], eventType);\n\t\t\t}\n\t\t}\n\n\t};\n\t/**\n\t * 打开新窗口\n\t * @param {string} url 要打开的页面地址\n\t * @param {string} id 指定页面ID\n\t * @param {object} options 可选:参数,等待,窗口,显示配置{params:{},waiting:{},styles:{},show:{}}\n\t */\n\t$.openWindow = function(url, id, options) {\n\t\tif(typeof url === 'object') {\n\t\t\toptions = url;\n\t\t\turl = options.url;\n\t\t\tid = options.id || url;\n\t\t} else {\n\t\t\tif(typeof id === 'object') {\n\t\t\t\toptions = id;\n\t\t\t\tid = options.id || url;\n\t\t\t} else {\n\t\t\t\tid = id || url;\n\t\t\t}\n\t\t}\n\t\tif(!$.os.plus) {\n\t\t\t//TODO 先临时这么处理：手机上顶层跳，PC上parent跳\n\t\t\tif($.os.ios || $.os.android) {\n\t\t\t\twindow.top.location.href = url;\n\t\t\t} else {\n\t\t\t\twindow.parent.location.href = url;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif(!window.plus) {\n\t\t\treturn;\n\t\t}\n\n\t\toptions = options || {};\n\t\tvar params = options.params || {};\n\t\tvar webview = null,\n\t\t\twebviewCache = null,\n\t\t\tnShow, nWaiting;\n\n\t\tif($.webviews[id]) {\n\t\t\twebviewCache = $.webviews[id];\n\t\t\t//webview真实存在，才能获取\n\t\t\tif(plus.webview.getWebviewById(id)) {\n\t\t\t\twebview = webviewCache.webview;\n\t\t\t}\n\t\t} else if(options.createNew !== true) {\n\t\t\twebview = plus.webview.getWebviewById(id);\n\t\t}\n\n\t\tif(webview) { //已缓存\n\t\t\t//每次show都需要传递动画参数；\n\t\t\t//预加载的动画参数优先级：openWindow配置>preloadPages配置>mui默认配置；\n\t\t\tnShow = webviewCache ? webviewCache.show : defaultShow;\n\t\t\tnShow = options.show ? $.extend(nShow, options.show) : nShow;\n\t\t\tnShow.autoShow && webview.show(nShow.aniShow, nShow.duration, function() {\n\t\t\t\ttriggerPreload(webview);\n\t\t\t\ttrigger(webview, 'pagebeforeshow', false);\n\t\t\t});\n\t\t\tif(webviewCache) {\n\t\t\t\twebviewCache.afterShowMethodName && webview.evalJS(webviewCache.afterShowMethodName + '(\\'' + JSON.stringify(params) + '\\')');\n\t\t\t}\n\t\t\treturn webview;\n\t\t} else { //新窗口\n\t\t\tif(!url) {\n\t\t\t\tthrow new Error('webview[' + id + '] does not exist');\n\t\t\t}\n\n\t\t\t//显示waiting\n\t\t\tvar waitingConfig = $.waitingOptions(options.waiting);\n\t\t\tif(waitingConfig.autoShow) {\n\t\t\t\tnWaiting = plus.nativeUI.showWaiting(waitingConfig.title, waitingConfig.options);\n\t\t\t}\n\n\t\t\t//创建页面\n\t\t\toptions = $.extend(options, {\n\t\t\t\tid: id,\n\t\t\t\turl: url\n\t\t\t});\n\n\t\t\twebview = $.createWindow(options);\n\n\t\t\t//显示\n\t\t\tnShow = $.showOptions(options.show);\n\t\t\tif(nShow.autoShow) {\n\t\t\t\tvar showWebview = function() {\n\t\t\t\t\t//关闭等待框\n\t\t\t\t\tif(nWaiting) {\n\t\t\t\t\t\tnWaiting.close();\n\t\t\t\t\t}\n\t\t\t\t\t//显示页面\n\t\t\t\t\twebview.show(nShow.aniShow, nShow.duration, function() {},nShow.extras);\n\t\t\t\t\toptions.afterShowMethodName && webview.evalJS(options.afterShowMethodName + '(\\'' + JSON.stringify(params) + '\\')');\n\t\t\t\t};\n\t\t\t\t//titleUpdate触发时机早于loaded，更换为titleUpdate后，可以更早的显示webview\n\t\t\t\twebview.addEventListener(nShow.event, showWebview, false);\n\t\t\t\t//loaded事件发生后，触发预加载和pagebeforeshow事件\n\t\t\t\twebview.addEventListener(\"loaded\", function() {\n\t\t\t\t\ttriggerPreload(webview);\n\t\t\t\t\ttrigger(webview, 'pagebeforeshow', false);\n\t\t\t\t}, false);\n\t\t\t}\n\t\t}\n\t\treturn webview;\n\t};\n\n\t$.openWindowWithTitle = function(options, titleConfig) {\n\t\toptions = options || {};\n\t\tvar url = options.url;\n\t\tvar id = options.id || url;\n\n\t\tif(!$.os.plus) {\n\t\t\t//TODO 先临时这么处理：手机上顶层跳，PC上parent跳\n\t\t\tif($.os.ios || $.os.android) {\n\t\t\t\twindow.top.location.href = url;\n\t\t\t} else {\n\t\t\t\twindow.parent.location.href = url;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif(!window.plus) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar params = options.params || {};\n\t\tvar webview = null,\n\t\t\twebviewCache = null,\n\t\t\tnShow, nWaiting;\n\n\t\tif($.webviews[id]) {\n\t\t\twebviewCache = $.webviews[id];\n\t\t\t//webview真实存在，才能获取\n\t\t\tif(plus.webview.getWebviewById(id)) {\n\t\t\t\twebview = webviewCache.webview;\n\t\t\t}\n\t\t} else if(options.createNew !== true) {\n\t\t\twebview = plus.webview.getWebviewById(id);\n\t\t}\n\n\t\tif(webview) { //已缓存\n\t\t\t//每次show都需要传递动画参数；\n\t\t\t//预加载的动画参数优先级：openWindow配置>preloadPages配置>mui默认配置；\n\t\t\tnShow = webviewCache ? webviewCache.show : defaultShow;\n\t\t\tnShow = options.show ? $.extend(nShow, options.show) : nShow;\n\t\t\tnShow.autoShow && webview.show(nShow.aniShow, nShow.duration, function() {\n\t\t\t\ttriggerPreload(webview);\n\t\t\t\ttrigger(webview, 'pagebeforeshow', false);\n\t\t\t});\n\t\t\tif(webviewCache) {\n\t\t\t\twebviewCache.afterShowMethodName && webview.evalJS(webviewCache.afterShowMethodName + '(\\'' + JSON.stringify(params) + '\\')');\n\t\t\t}\n\t\t\treturn webview;\n\t\t} else { //新窗口\n\t\t\tif(!url) {\n\t\t\t\tthrow new Error('webview[' + id + '] does not exist');\n\t\t\t}\n\n\t\t\t//显示waiting\n\t\t\tvar waitingConfig = $.waitingOptions(options.waiting);\n\t\t\tif(waitingConfig.autoShow) {\n\t\t\t\tnWaiting = plus.nativeUI.showWaiting(waitingConfig.title, waitingConfig.options);\n\t\t\t}\n\n\t\t\t//创建页面\n\t\t\toptions = $.extend(options, {\n\t\t\t\tid: id,\n\t\t\t\turl: url\n\t\t\t});\n\n\t\t\twebview = $.createWindow(options);\n\n\t\t\tif(titleConfig) { //处理原生头\n\t\t\t\t$.extend(true, $.options.titleConfig, titleConfig);\n\t\t\t\tvar tid = $.options.titleConfig.id ? $.options.titleConfig.id : id + \"_title\";\n\t\t\t\tvar view = new plus.nativeObj.View(tid, {\n\t\t\t\t\ttop: 0,\n\t\t\t\t\theight: $.options.titleConfig.height,\n\t\t\t\t\twidth: \"100%\",\n\t\t\t\t\tdock: \"top\",\n\t\t\t\t\tposition: \"dock\"\n\t\t\t\t});\n\t\t\t\tview.drawRect($.options.titleConfig.backgroundColor); //绘制背景色\n\t\t\t\tvar _b = parseInt($.options.titleConfig.height) - 1;\n\t\t\t\tview.drawRect($.options.titleConfig.bottomBorderColor, {\n\t\t\t\t\ttop: _b + \"px\",\n\t\t\t\t\tleft: \"0px\"\n\t\t\t\t}); //绘制底部边线\n\n\t\t\t\t//绘制文字\n\t\t\t\tif($.options.titleConfig.title.text){\n\t\t\t\t\tvar _title = $.options.titleConfig.title;\n\t\t\t\t\tview.drawText(_title.text,_title.position , _title.styles);\n\t\t\t\t}\n\n\t\t\t\t//返回图标绘制\n\t\t\t\tvar _back = $.options.titleConfig.back;\n\t\t\t\tvar backClick = null;\n\t\t\t\t//优先字体\n\n\t\t\t\t//其次是图片\n\t\t\t\tvar _backImage = _back.image;\n\t\t\t\tif(_backImage.base64Data || _backImage.imgSrc) {\n\t\t\t\t\t//TODO 此处需要处理百分比的情况\n\t\t\t\t\tbackClick = {\n\t\t\t\t\t\tleft:parseInt(_backImage.position.left),\n\t\t\t\t\t\tright:parseInt(_backImage.position.left) + parseInt(_backImage.position.width)\n\t\t\t\t\t};\n\t\t\t\t\tvar bitmap = new plus.nativeObj.Bitmap(id + \"_back\");\n\t\t\t\t\tif(_backImage.base64Data) { //优先base64编码字符串\n\t\t\t\t\t\tbitmap.loadBase64Data(_backImage.base64Data);\n\t\t\t\t\t} else { //其次加载图片文件\n\t\t\t\t\t\tbitmap.load(_backImage.imgSrc);\n\t\t\t\t\t}\n\t\t\t\t\tview.drawBitmap(bitmap,_backImage.sprite , _backImage.position);\n\t\t\t\t}\n\n\t\t\t\t//处理点击事件\n\t\t\t\tview.setTouchEventRect({\n\t\t\t\t\ttop: \"0px\",\n\t\t\t\t\tleft: \"0px\",\n\t\t\t\t\twidth: \"100%\",\n\t\t\t\t\theight: \"100%\"\n\t\t\t\t});\n\t\t\t\tview.interceptTouchEvent(true);\n\t\t\t\tview.addEventListener(\"click\", function(e) {\n\t\t\t\t\tvar x = e.clientX;\n\n\t\t\t\t\t//返回按钮点击\n\t\t\t\t\tif(backClick&& x > backClick.left && x < backClick.right){\n\t\t\t\t\t\tif( _back.click && $.isFunction(_back.click)){\n\t\t\t\t\t\t\t_back.click();\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\twebview.evalJS(\"window.mui&&mui.back();\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, false);\n\t\t\t\twebview.append(view);\n\n\t\t\t}\n\n\t\t\t//显示\n\t\t\tnShow = $.showOptions(options.show);\n\t\t\tif(nShow.autoShow) {\n\t\t\t\t//titleUpdate触发时机早于loaded，更换为titleUpdate后，可以更早的显示webview\n\t\t\t\twebview.addEventListener(nShow.event, function () {\n\t\t\t\t\t//关闭等待框\n\t\t\t\t\tif(nWaiting) {\n\t\t\t\t\t\tnWaiting.close();\n\t\t\t\t\t}\n\t\t\t\t\t//显示页面\n\t\t\t\t\twebview.show(nShow.aniShow, nShow.duration, function() {},nShow.extras);\n\t\t\t\t}, false);\n\t\t\t}\n\t\t}\n\t\treturn webview;\n\t};\n\n\t/**\n\t * 根据配置信息创建一个webview\n\t * @param {type} options\n\t * @param {type} isCreate\n\t * @returns {webview}\n\t */\n\t$.createWindow = function(options, isCreate) {\n\t\tif(!window.plus) {\n\t\t\treturn;\n\t\t}\n\t\tvar id = options.id || options.url;\n\t\tvar webview;\n\t\tif(options.preload) {\n\t\t\tif($.webviews[id] && $.webviews[id].webview.getURL()) { //已经cache\n\t\t\t\twebview = $.webviews[id].webview;\n\t\t\t} else { //新增预加载窗口\n\t\t\t\t//判断是否携带createNew参数，默认为false\n\t\t\t\tif(options.createNew !== true) {\n\t\t\t\t\twebview = plus.webview.getWebviewById(id);\n\t\t\t\t}\n\n\t\t\t\t//之前没有，那就新创建\n\t\t\t\tif(!webview) {\n\t\t\t\t\twebview = plus.webview.create(options.url, id, $.windowOptions(options.styles), $.extend({\n\t\t\t\t\t\tpreload: true\n\t\t\t\t\t}, options.extras));\n\t\t\t\t\tif(options.subpages) {\n\t\t\t\t\t\t$.each(options.subpages, function(index, subpage) {\n\t\t\t\t\t\t\tvar subpageId = subpage.id || subpage.url;\n\t\t\t\t\t\t\tif(subpageId) { //过滤空对象\n\t\t\t\t\t\t\t\tvar subWebview = plus.webview.getWebviewById(subpageId);\n\t\t\t\t\t\t\t\tif(!subWebview) { //如果该webview不存在，则创建\n\t\t\t\t\t\t\t\t\tsubWebview = plus.webview.create(subpage.url, subpageId, $.windowOptions(subpage.styles), $.extend({\n\t\t\t\t\t\t\t\t\t\tpreload: true\n\t\t\t\t\t\t\t\t\t}, subpage.extras));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\twebview.append(subWebview);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//TODO 理论上，子webview也应该计算到预加载队列中，但这样就麻烦了，要退必须退整体，否则可能出现问题；\n\t\t\t$.webviews[id] = {\n\t\t\t\twebview: webview, //目前仅preload的缓存webview\n\t\t\t\tpreload: true,\n\t\t\t\tshow: $.showOptions(options.show),\n\t\t\t\tafterShowMethodName: options.afterShowMethodName //就不应该用evalJS。应该是通过事件消息通讯\n\t\t\t};\n\t\t\t//索引该预加载窗口\n\t\t\tvar preloads = $.data.preloads;\n\t\t\tvar index = preloads.indexOf(id);\n\t\t\tif(~index) { //删除已存在的(变相调整插入位置)\n\t\t\t\tpreloads.splice(index, 1);\n\t\t\t}\n\t\t\tpreloads.push(id);\n\t\t\tif(preloads.length > $.options.preloadLimit) {\n\t\t\t\t//先进先出\n\t\t\t\tvar first = $.data.preloads.shift();\n\t\t\t\tvar webviewCache = $.webviews[first];\n\t\t\t\tif(webviewCache && webviewCache.webview) {\n\t\t\t\t\t//需要将自己打开的所有页面，全部close；\n\t\t\t\t\t//关闭该预加载webview\n\t\t\t\t\t$.closeAll(webviewCache.webview);\n\t\t\t\t}\n\t\t\t\t//删除缓存\n\t\t\t\tdelete $.webviews[first];\n\t\t\t}\n\t\t} else {\n\t\t\tif(isCreate !== false) { //直接创建非预加载窗口\n\t\t\t\twebview = plus.webview.create(options.url, id, $.windowOptions(options.styles), options.extras);\n\t\t\t\tif(options.subpages) {\n\t\t\t\t\t$.each(options.subpages, function(index, subpage) {\n\t\t\t\t\t\tvar subpageId = subpage.id || subpage.url;\n\t\t\t\t\t\tvar subWebview = plus.webview.getWebviewById(subpageId);\n\t\t\t\t\t\tif(!subWebview) {\n\t\t\t\t\t\t\tsubWebview = plus.webview.create(subpage.url, subpageId, $.windowOptions(subpage.styles), subpage.extras);\n\t\t\t\t\t\t}\n\t\t\t\t\t\twebview.append(subWebview);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn webview;\n\t};\n\n\t/**\n\t * 预加载\n\t */\n\t$.preload = function(options) {\n\t\t//调用预加载函数，不管是否传递preload参数，强制变为true\n\t\tif(!options.preload) {\n\t\t\toptions.preload = true;\n\t\t}\n\t\treturn $.createWindow(options);\n\t};\n\n\t/**\n\t *关闭当前webview打开的所有webview；\n\t */\n\t$.closeOpened = function(webview) {\n\t\tvar opened = webview.opened();\n\t\tif(opened) {\n\t\t\tfor(var i = 0, len = opened.length; i < len; i++) {\n\t\t\t\tvar openedWebview = opened[i];\n\t\t\t\tvar open_open = openedWebview.opened();\n\t\t\t\tif(open_open && open_open.length > 0) {\n\t\t\t\t\t//关闭打开的webview\n\t\t\t\t\t$.closeOpened(openedWebview);\n\t\t\t\t\t//关闭自己\n\t\t\t\t\topenedWebview.close(\"none\");\n\t\t\t\t} else {\n\t\t\t\t\t//如果直接孩子节点，就不用关闭了，因为父关闭的时候，会自动关闭子；\n\t\t\t\t\tif(openedWebview.parent() !== webview) {\n\t\t\t\t\t\topenedWebview.close('none');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\t$.closeAll = function(webview, aniShow) {\n\t\t$.closeOpened(webview);\n\t\tif(aniShow) {\n\t\t\twebview.close(aniShow);\n\t\t} else {\n\t\t\twebview.close();\n\t\t}\n\t};\n\n\t/**\n\t * 批量创建webview\n\t * @param {type} options\n\t * @returns {undefined}\n\t */\n\t$.createWindows = function(options) {\n\t\t$.each(options, function(index, option) {\n\t\t\t//初始化预加载窗口(创建)和非预加载窗口(仅配置，不创建)\n\t\t\t$.createWindow(option, false);\n\t\t});\n\t};\n\t/**\n\t * 创建当前页面的子webview\n\t * @param {type} options\n\t * @returns {webview}\n\t */\n\t$.appendWebview = function(options) {\n\t\tif(!window.plus) {\n\t\t\treturn;\n\t\t}\n\t\tvar id = options.id || options.url;\n\t\tvar webview;\n\t\tif(!$.webviews[id]) { //保证执行一遍\n\t\t\t//TODO 这里也有隐患，比如某个webview不是作为subpage创建的，而是作为target webview的话；\n\t\t\tif(!plus.webview.getWebviewById(id)) {\n\t\t\t\twebview = plus.webview.create(options.url, id, options.styles, options.extras);\n\t\t\t}\n\t\t\t//之前的实现方案：子窗口loaded之后再append到父窗口中；\n\t\t\t//问题：部分子窗口loaded事件发生较晚，此时执行父窗口的children方法会返回空，导致父子通讯失败；\n\t\t\t//     比如父页面执行完preload事件后，需触发子页面的preload事件，此时未append的话，就无法触发；\n\t\t\t//修改方式：不再监控loaded事件，直接append\n\t\t\t//by chb@20150521\n\t\t\t// webview.addEventListener('loaded', function() {\n\t\t\tplus.webview.currentWebview().append(webview);\n\t\t\t// });\n\t\t\t$.webviews[id] = options;\n\n\t\t}\n\t\treturn webview;\n\t};\n\n\t//全局webviews\n\t$.webviews = {};\n\t//预加载窗口索引\n\t$.data.preloads = [];\n\t//$.currentWebview\n\t$.plusReady(function() {\n\t\t$.currentWebview = plus.webview.currentWebview();\n\t});\n\t$.addInit({\n\t\tname: '5+',\n\t\tindex: 100,\n\t\thandle: function() {\n\t\t\tvar options = $.options;\n\t\t\tvar subpages = options.subpages || [];\n\t\t\tif($.os.plus) {\n\t\t\t\t$.plusReady(function() {\n\t\t\t\t\t//TODO  这里需要判断一下，最好等子窗口加载完毕后，再调用主窗口的show方法；\n\t\t\t\t\t//或者：在openwindow方法中，监听实现；\n\t\t\t\t\t$.each(subpages, function(index, subpage) {\n\t\t\t\t\t\t$.appendWebview(subpage);\n\t\t\t\t\t});\n\t\t\t\t\t//判断是否首页\n\t\t\t\t\tif(plus.webview.currentWebview() === plus.webview.getWebviewById(plus.runtime.appid)) {\n\t\t\t\t\t\t//首页需要自己激活预加载；\n\t\t\t\t\t\t//timeout因为子页面loaded之后才append的，防止子页面尚未append、从而导致其preload未触发的问题；\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\ttriggerPreload(plus.webview.currentWebview());\n\t\t\t\t\t\t}, 300);\n\t\t\t\t\t}\n\t\t\t\t\t//设置ios顶部状态栏颜色；\n\t\t\t\t\tif($.os.ios && $.options.statusBarBackground) {\n\t\t\t\t\t\tplus.navigator.setStatusBarBackground($.options.statusBarBackground);\n\t\t\t\t\t}\n\t\t\t\t\tif($.os.android && parseFloat($.os.version) < 4.4) {\n\t\t\t\t\t\t//解决Android平台4.4版本以下，resume后，父窗体标题延迟渲染的问题；\n\t\t\t\t\t\tif(plus.webview.currentWebview().parent() == null) {\n\t\t\t\t\t\t\tdocument.addEventListener(\"resume\", function() {\n\t\t\t\t\t\t\t\tvar body = document.body;\n\t\t\t\t\t\t\t\tbody.style.display = 'none';\n\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\tbody.style.display = '';\n\t\t\t\t\t\t\t\t}, 10);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t//已支持iframe嵌入\n\t\t\t\t//\t\t\t\tif (subpages.length > 0) {\n\t\t\t\t//\t\t\t\t\tvar err = document.createElement('div');\n\t\t\t\t//\t\t\t\t\terr.className = 'mui-error';\n\t\t\t\t//\t\t\t\t\t//文字描述\n\t\t\t\t//\t\t\t\t\tvar span = document.createElement('span');\n\t\t\t\t//\t\t\t\t\tspan.innerHTML = '在该浏览器下，不支持创建子页面，具体参考';\n\t\t\t\t//\t\t\t\t\terr.appendChild(span);\n\t\t\t\t//\t\t\t\t\tvar a = document.createElement('a');\n\t\t\t\t//\t\t\t\t\ta.innerHTML = '\"mui框架适用场景\"';\n\t\t\t\t//\t\t\t\t\ta.href = 'http://ask.dcloud.net.cn/article/113';\n\t\t\t\t//\t\t\t\t\terr.appendChild(a);\n\t\t\t\t//\t\t\t\t\tdocument.body.appendChild(err);\n\t\t\t\t//\t\t\t\t\tconsole.log('在该浏览器下，不支持创建子页面');\n\t\t\t\t//\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\t});\n\twindow.addEventListener('preload', function() {\n\t\t//处理预加载部分\n\t\tvar webviews = $.options.preloadPages || [];\n\t\t$.plusReady(function() {\n\t\t\t$.each(webviews, function(index, webview) {\n\t\t\t\t$.createWindow($.extend(webview, {\n\t\t\t\t\tpreload: true\n\t\t\t\t}));\n\t\t\t});\n\n\t\t});\n\t});\n\t$.supportStatusbarOffset = function() {\n\t\treturn $.os.plus && $.os.ios && parseFloat($.os.version) >= 7;\n\t};\n\t$.ready(function() {\n\t\t//标识当前环境支持statusbar\n\t\tif($.supportStatusbarOffset()) {\n\t\t\tdocument.body.classList.add('mui-statusbar');\n\t\t}\n\t});\n})(mui);\n\n/**\n * mui back\n * @param {type} $\n * @param {type} window\n * @returns {undefined}\n */\n(function($, window) {\n\t/**\n\t * register back\n\t * @param {type} back\n\t * @returns {$.gestures}\n\t */\n\t$.addBack = function(back) {\n\t\treturn $.addAction('backs', back);\n\t};\n\t/**\n\t * default\n\t */\n\t$.addBack({\n\t\tname: 'browser',\n\t\tindex: 100,\n\t\thandle: function() {\n\t\t\tif (window.history.length > 1) {\n\t\t\t\twindow.history.back();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t});\n\t/**\n\t * 后退\n\t */\n\t$.back = function() {\n\t\tif (typeof $.options.beforeback === 'function') {\n\t\t\tif ($.options.beforeback() === false) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t$.doAction('backs');\n\t};\n\twindow.addEventListener('tap', function(e) {\n\t\tvar action = $.targets.action;\n\t\tif (action && action.classList.contains('mui-action-back')) {\n\t\t\t$.back();\n\t\t\t$.targets.action = false;\n\t\t}\n\t});\n\twindow.addEventListener('swiperight', function(e) {\n\t\tvar detail = e.detail;\n\t\tif ($.options.swipeBack === true && Math.abs(detail.angle) < 3) {\n\t\t\t$.back();\n\t\t}\n\t});\n\n})(mui, window);\n/**\n * mui back 5+\n * @param {type} $\n * @param {type} window\n * @returns {undefined}\n */\n(function($, window) {\n\tif ($.os.plus && $.os.android) {\n\t\t$.addBack({\n\t\t\tname: 'mui',\n\t\t\tindex: 5,\n\t\t\thandle: function() {\n\t\t\t\t//后续重新设计此处，将back放到各个空间内部实现\n\t\t\t\t//popover\n\t\t\t\tif ($.targets._popover && $.targets._popover.classList.contains('mui-active')) {\n\t\t\t\t\t$($.targets._popover).popover('hide');\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\t//offcanvas\n\t\t\t\tvar offCanvas = document.querySelector('.mui-off-canvas-wrap.mui-active');\n\t\t\t\tif (offCanvas) {\n\t\t\t\t\t$(offCanvas).offCanvas('close');\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tvar previewImage = $.isFunction($.getPreviewImage) && $.getPreviewImage();\n\t\t\t\tif (previewImage && previewImage.isShown()) {\n\t\t\t\t\tpreviewImage.close();\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\t//popup\n\t\t\t\treturn $.closePopup();\n\t\t\t}\n\t\t});\n\t}\n\t//首次按下back按键的时间\n\t$.__back__first = null;\n\t/**\n\t * 5+ back\n\t */\n\t$.addBack({\n\t\tname: '5+',\n\t\tindex: 10,\n\t\thandle: function() {\n\t\t\tif (!window.plus) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar wobj = plus.webview.currentWebview();\n\t\t\tvar parent = wobj.parent();\n\t\t\tif (parent) {\n\t\t\t\tparent.evalJS('mui&&mui.back();');\n\t\t\t} else {\n\t\t\t\twobj.canBack(function(e) {\n\t\t\t\t\t//by chb 暂时注释，在碰到类似popover之类的锚点的时候，需多次点击才能返回；\n\t\t\t\t\tif (e.canBack) { //webview history back\n\t\t\t\t\t\twindow.history.back();\n\t\t\t\t\t} else { //webview close or hide\n\t\t\t\t\t\t//fixed by fxy 此处不应该用opener判断，因为用户有可能自己close掉当前窗口的opener。这样的话。opener就为空了，导致不能执行close\n\t\t\t\t\t\tif (wobj.id === plus.runtime.appid) { //首页\n\t\t\t\t\t\t\t//首页不存在opener的情况下，后退实际上应该是退出应用；\n\t\t\t\t\t\t\t//首次按键，提示‘再按一次退出应用’\n\t\t\t\t\t\t\tif (!$.__back__first) {\n\t\t\t\t\t\t\t\t$.__back__first = new Date().getTime();\n\t\t\t\t\t\t\t\tmui.toast('再按一次退出应用');\n\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\t$.__back__first = null;\n\t\t\t\t\t\t\t\t}, 2000);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (new Date().getTime() - $.__back__first < 2000) {\n\t\t\t\t\t\t\t\t\tplus.runtime.quit();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else { //其他页面，\n\t\t\t\t\t\t\tif (wobj.preload) {\n\t\t\t\t\t\t\t\twobj.hide(\"auto\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t//关闭页面时，需要将其打开的所有子页面全部关闭；\n\t\t\t\t\t\t\t\t$.closeAll(wobj);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t});\n\n\n\t$.menu = function() {\n\t\tvar menu = document.querySelector('.mui-action-menu');\n\t\tif (menu) {\n\t\t\t$.trigger(menu, $.EVENT_START); //临时处理menu无touchstart的话，找不到当前targets的问题\n\t\t\t$.trigger(menu, 'tap');\n\t\t} else { //执行父窗口的menu\n\t\t\tif (window.plus) {\n\t\t\t\tvar wobj = $.currentWebview;\n\t\t\t\tvar parent = wobj.parent();\n\t\t\t\tif (parent) { //又得evalJS\n\t\t\t\t\tparent.evalJS('mui&&mui.menu();');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\tvar __back = function() {\n\t\t$.back();\n\t};\n\tvar __menu = function() {\n\t\t$.menu();\n\t};\n\t//默认监听\n\t$.plusReady(function() {\n\t\tif ($.options.keyEventBind.backbutton) {\n\t\t\tplus.key.addEventListener('backbutton', __back, false);\n\t\t}\n\t\tif ($.options.keyEventBind.menubutton) {\n\t\t\tplus.key.addEventListener('menubutton', __menu, false);\n\t\t}\n\t});\n\t//处理按键监听事件\n\t$.addInit({\n\t\tname: 'keyEventBind',\n\t\tindex: 1000,\n\t\thandle: function() {\n\t\t\t$.plusReady(function() {\n\t\t\t\t//如果不为true，则移除默认监听\n\t\t\t\tif (!$.options.keyEventBind.backbutton) {\n\t\t\t\t\tplus.key.removeEventListener('backbutton', __back);\n\t\t\t\t}\n\t\t\t\tif (!$.options.keyEventBind.menubutton) {\n\t\t\t\t\tplus.key.removeEventListener('menubutton', __menu);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});\n})(mui, window);\n/**\n * mui.init pulldownRefresh\n * @param {type} $\n * @returns {undefined}\n */\n(function($) {\n\t$.addInit({\n\t\tname: 'pullrefresh',\n\t\tindex: 1000,\n\t\thandle: function() {\n\t\t\tvar options = $.options;\n\t\t\tvar pullRefreshOptions = options.pullRefresh || {};\n\t\t\tvar hasPulldown = pullRefreshOptions.down && pullRefreshOptions.down.hasOwnProperty('callback');\n\t\t\tvar hasPullup = pullRefreshOptions.up && pullRefreshOptions.up.hasOwnProperty('callback');\n\t\t\tif(hasPulldown || hasPullup) {\n\t\t\t\tvar container = pullRefreshOptions.container;\n\t\t\t\tif(container) {\n\t\t\t\t\tvar $container = $(container);\n\t\t\t\t\tif($container.length === 1) {\n\t\t\t\t\t\tif($.os.plus) { //5+环境\n\t\t\t\t\t\t\tif(hasPulldown && pullRefreshOptions.down.style == \"circle\") { //原生转圈\n\t\t\t\t\t\t\t\t$.plusReady(function() {\n\t\t\t\t\t\t\t\t\t//这里改写$.fn.pullRefresh\n\t\t\t\t\t\t\t\t\t$.fn.pullRefresh = $.fn.pullRefresh_native;\n\t\t\t\t\t\t\t\t\t//var webview = plus.webview.currentWebview();\n\t\t\t\t\t\t\t\t\t//downOptions.down.callback = '_CALLBACK';\n\t\t\t\t\t\t\t\t\t$container.pullRefresh(pullRefreshOptions);\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t} else if($.os.android) { //非原生转圈，但是Android环境\n\t\t\t\t\t\t\t\t$.plusReady(function() {\n\t\t\t\t\t\t\t\t\t//这里改写$.fn.pullRefresh\n\t\t\t\t\t\t\t\t\t$.fn.pullRefresh = $.fn.pullRefresh_native\n\t\t\t\t\t\t\t\t\tif(window.__NWin_Enable__ === false) { //不支持多webview\n\t\t\t\t\t\t\t\t\t\t$container.pullRefresh(pullRefreshOptions);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tif(hasPullup) {\n\t\t\t\t\t\t\t\t\t\t\t//当前页面初始化pullup\n\t\t\t\t\t\t\t\t\t\t\tvar upOptions = {};\n\t\t\t\t\t\t\t\t\t\t\tupOptions.up = pullRefreshOptions.up;\n\t\t\t\t\t\t\t\t\t\t\tupOptions.webviewId = webview.id || webview.getURL();\n\t\t\t\t\t\t\t\t\t\t\t$container.pullRefresh(upOptions);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif(hasPulldown) {\n\t\t\t\t\t\t\t\t\t\t\tvar parent = webview.parent();\n\t\t\t\t\t\t\t\t\t\t\tvar id = webview.id || webview.getURL();\n\t\t\t\t\t\t\t\t\t\t\tif(parent) {\n\t\t\t\t\t\t\t\t\t\t\t\tif(!hasPullup) { //如果没有上拉加载，需要手动初始化一个默认的pullRefresh，以便当前页面容器可以调用endPulldownToRefresh等方法\n\t\t\t\t\t\t\t\t\t\t\t\t\t$container.pullRefresh({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twebviewId: id\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tvar downOptions = {\n\t\t\t\t\t\t\t\t\t\t\t\t\twebviewId: id//子页面id\n\t\t\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\t\t\tdownOptions.down = $.extend({}, pullRefreshOptions.down);\n\t\t\t\t\t\t\t\t\t\t\t\tdownOptions.down.callback = '_CALLBACK';\n\t\t\t\t\t\t\t\t\t\t\t\t//父页面初始化pulldown\n\t\t\t\t\t\t\t\t\t\t\t\tparent.evalJS(\"mui&&mui(document.querySelector('.mui-content')).pullRefresh('\" + JSON.stringify(downOptions) + \"')\");\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else { //非原生转圈，iOS环境\n\t\t\t\t\t\t\t\t$container.pullRefresh(pullRefreshOptions);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$container.pullRefresh(pullRefreshOptions);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n})(mui);\n/**\n * mui ajax\n * @param {type} $\n * @returns {undefined}\n */\n(function($, window, undefined) {\n\n\tvar jsonType = 'application/json';\n\tvar htmlType = 'text/html';\n\tvar rscript = /<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi;\n\tvar scriptTypeRE = /^(?:text|application)\\/javascript/i;\n\tvar xmlTypeRE = /^(?:text|application)\\/xml/i;\n\tvar blankRE = /^\\s*$/;\n\n\t$.ajaxSettings = {\n\t\ttype: 'GET',\n\t\tbeforeSend: $.noop,\n\t\tsuccess: $.noop,\n\t\terror: $.noop,\n\t\tcomplete: $.noop,\n\t\tcontext: null,\n\t\txhr: function(protocol) {\n\t\t\treturn new window.XMLHttpRequest();\n\t\t},\n\t\taccepts: {\n\t\t\tscript: 'text/javascript, application/javascript, application/x-javascript',\n\t\t\tjson: jsonType,\n\t\t\txml: 'application/xml, text/xml',\n\t\t\thtml: htmlType,\n\t\t\ttext: 'text/plain'\n\t\t},\n\t\ttimeout: 0,\n\t\tprocessData: true,\n\t\tcache: true\n\t};\n\tvar ajaxBeforeSend = function(xhr, settings) {\n\t\tvar context = settings.context\n\t\tif(settings.beforeSend.call(context, xhr, settings) === false) {\n\t\t\treturn false;\n\t\t}\n\t};\n\tvar ajaxSuccess = function(data, xhr, settings) {\n\t\tsettings.success.call(settings.context, data, 'success', xhr);\n\t\tajaxComplete('success', xhr, settings);\n\t};\n\t// type: \"timeout\", \"error\", \"abort\", \"parsererror\"\n\tvar ajaxError = function(error, type, xhr, settings) {\n\t\tsettings.error.call(settings.context, xhr, type, error);\n\t\tajaxComplete(type, xhr, settings);\n\t};\n\t// status: \"success\", \"notmodified\", \"error\", \"timeout\", \"abort\", \"parsererror\"\n\tvar ajaxComplete = function(status, xhr, settings) {\n\t\tsettings.complete.call(settings.context, xhr, status);\n\t};\n\n\tvar serialize = function(params, obj, traditional, scope) {\n\t\tvar type, array = $.isArray(obj),\n\t\t\thash = $.isPlainObject(obj);\n\t\t$.each(obj, function(key, value) {\n\t\t\ttype = $.type(value);\n\t\t\tif(scope) {\n\t\t\t\tkey = traditional ? scope :\n\t\t\t\t\tscope + '[' + (hash || type === 'object' || type === 'array' ? key : '') + ']';\n\t\t\t}\n\t\t\t// handle data in serializeArray() format\n\t\t\tif(!scope && array) {\n\t\t\t\tparams.add(value.name, value.value);\n\t\t\t}\n\t\t\t// recurse into nested objects\n\t\t\telse if(type === \"array\" || (!traditional && type === \"object\")) {\n\t\t\t\tserialize(params, value, traditional, key);\n\t\t\t} else {\n\t\t\t\tparams.add(key, value);\n\t\t\t}\n\t\t});\n\t};\n\tvar serializeData = function(options) {\n\t\tif(options.processData && options.data && typeof options.data !== \"string\") {\n\t\t\tvar contentType = options.contentType;\n\t\t\tif(!contentType && options.headers) {\n\t\t\t\tcontentType = options.headers['Content-Type'];\n\t\t\t}\n\t\t\tif(contentType && ~contentType.indexOf(jsonType)) { //application/json\n\t\t\t\toptions.data = JSON.stringify(options.data);\n\t\t\t} else {\n\t\t\t\toptions.data = $.param(options.data, options.traditional);\n\t\t\t}\n\t\t}\n\t\tif(options.data && (!options.type || options.type.toUpperCase() === 'GET')) {\n\t\t\toptions.url = appendQuery(options.url, options.data);\n\t\t\toptions.data = undefined;\n\t\t}\n\t};\n\tvar appendQuery = function(url, query) {\n\t\tif(query === '') {\n\t\t\treturn url;\n\t\t}\n\t\treturn(url + '&' + query).replace(/[&?]{1,2}/, '?');\n\t};\n\tvar mimeToDataType = function(mime) {\n\t\tif(mime) {\n\t\t\tmime = mime.split(';', 2)[0];\n\t\t}\n\t\treturn mime && (mime === htmlType ? 'html' :\n\t\t\tmime === jsonType ? 'json' :\n\t\t\tscriptTypeRE.test(mime) ? 'script' :\n\t\t\txmlTypeRE.test(mime) && 'xml') || 'text';\n\t};\n\tvar parseArguments = function(url, data, success, dataType) {\n\t\tif($.isFunction(data)) {\n\t\t\tdataType = success, success = data, data = undefined;\n\t\t}\n\t\tif(!$.isFunction(success)) {\n\t\t\tdataType = success, success = undefined;\n\t\t}\n\t\treturn {\n\t\t\turl: url,\n\t\t\tdata: data,\n\t\t\tsuccess: success,\n\t\t\tdataType: dataType\n\t\t};\n\t};\n\t$.ajax = function(url, options) {\n\t\tif(typeof url === \"object\") {\n\t\t\toptions = url;\n\t\t\turl = undefined;\n\t\t}\n\t\tvar settings = options || {};\n\t\tsettings.url = url || settings.url;\n\t\tfor(var key in $.ajaxSettings) {\n\t\t\tif(settings[key] === undefined) {\n\t\t\t\tsettings[key] = $.ajaxSettings[key];\n\t\t\t}\n\t\t}\n\t\tserializeData(settings);\n\t\tvar dataType = settings.dataType;\n\n\t\tif(settings.cache === false || ((!options || options.cache !== true) && ('script' === dataType))) {\n\t\t\tsettings.url = appendQuery(settings.url, '_=' + $.now());\n\t\t}\n\t\tvar mime = settings.accepts[dataType && dataType.toLowerCase()];\n\t\tvar headers = {};\n\t\tvar setHeader = function(name, value) {\n\t\t\theaders[name.toLowerCase()] = [name, value];\n\t\t};\n\t\tvar protocol = /^([\\w-]+:)\\/\\//.test(settings.url) ? RegExp.$1 : window.location.protocol;\n\t\tvar xhr = settings.xhr(settings);\n\t\tvar nativeSetHeader = xhr.setRequestHeader;\n\t\tvar abortTimeout;\n\n\t\tsetHeader('X-Requested-With', 'XMLHttpRequest');\n\t\tsetHeader('Accept', mime || '*/*');\n\t\tif(!!(mime = settings.mimeType || mime)) {\n\t\t\tif(mime.indexOf(',') > -1) {\n\t\t\t\tmime = mime.split(',', 2)[0];\n\t\t\t}\n\t\t\txhr.overrideMimeType && xhr.overrideMimeType(mime);\n\t\t}\n\t\tif(settings.contentType || (settings.contentType !== false && settings.data && settings.type.toUpperCase() !== 'GET')) {\n\t\t\tsetHeader('Content-Type', settings.contentType || 'application/x-www-form-urlencoded');\n\t\t}\n\t\tif(settings.headers) {\n\t\t\tfor(var name in settings.headers)\n\t\t\t\tsetHeader(name, settings.headers[name]);\n\t\t}\n\t\txhr.setRequestHeader = setHeader;\n\n\t\txhr.onreadystatechange = function() {\n\t\t\tif(xhr.readyState === 4) {\n\t\t\t\txhr.onreadystatechange = $.noop;\n\t\t\t\tclearTimeout(abortTimeout);\n\t\t\t\tvar result, error = false;\n\t\t\t\tvar isLocal = protocol === 'file:';\n\t\t\t\tif((xhr.status >= 200 && xhr.status < 300) || xhr.status === 304 || (xhr.status === 0 && isLocal && xhr.responseText)) {\n\t\t\t\t\tdataType = dataType || mimeToDataType(settings.mimeType || xhr.getResponseHeader('content-type'));\n\t\t\t\t\tresult = xhr.responseText;\n\t\t\t\t\ttry {\n\t\t\t\t\t\t// http://perfectionkills.com/global-eval-what-are-the-options/\n\t\t\t\t\t\tif(dataType === 'script') {\n\t\t\t\t\t\t\t(1, eval)(result);\n\t\t\t\t\t\t} else if(dataType === 'xml') {\n\t\t\t\t\t\t\tresult = xhr.responseXML;\n\t\t\t\t\t\t} else if(dataType === 'json') {\n\t\t\t\t\t\t\tresult = blankRE.test(result) ? null : $.parseJSON(result);\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\terror = e;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(error) {\n\t\t\t\t\t\tajaxError(error, 'parsererror', xhr, settings);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tajaxSuccess(result, xhr, settings);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvar status = xhr.status ? 'error' : 'abort';\n\t\t\t\t\tvar statusText = xhr.statusText || null;\n\t\t\t\t\tif(isLocal) {\n\t\t\t\t\t\tstatus = 'error';\n\t\t\t\t\t\tstatusText = '404';\n\t\t\t\t\t}\n\t\t\t\t\tajaxError(statusText, status, xhr, settings);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tif(ajaxBeforeSend(xhr, settings) === false) {\n\t\t\txhr.abort();\n\t\t\tajaxError(null, 'abort', xhr, settings);\n\t\t\treturn xhr;\n\t\t}\n\n\t\tif(settings.xhrFields) {\n\t\t\tfor(var name in settings.xhrFields) {\n\t\t\t\txhr[name] = settings.xhrFields[name];\n\t\t\t}\n\t\t}\n\n\t\tvar async = 'async' in settings ? settings.async : true;\n\n\t\txhr.open(settings.type.toUpperCase(), settings.url, async, settings.username, settings.password);\n\n\t\tfor(var name in headers) {\n\t\t\tif(headers.hasOwnProperty(name)) {\n\t\t\t\tnativeSetHeader.apply(xhr, headers[name]);\n\t\t\t}\n\t\t}\n\t\tif(settings.timeout > 0) {\n\t\t\tabortTimeout = setTimeout(function() {\n\t\t\t\txhr.onreadystatechange = $.noop;\n\t\t\t\txhr.abort();\n\t\t\t\tajaxError(null, 'timeout', xhr, settings);\n\t\t\t}, settings.timeout);\n\t\t}\n\t\txhr.send(settings.data ? settings.data : null);\n\t\treturn xhr;\n\t};\n\n\t$.param = function(obj, traditional) {\n\t\tvar params = [];\n\t\tparams.add = function(k, v) {\n\t\t\tthis.push(encodeURIComponent(k) + '=' + encodeURIComponent(v));\n\t\t};\n\t\tserialize(params, obj, traditional);\n\t\treturn params.join('&').replace(/%20/g, '+');\n\t};\n\t$.get = function( /* url, data, success, dataType */ ) {\n\t\treturn $.ajax(parseArguments.apply(null, arguments));\n\t};\n\n\t$.post = function( /* url, data, success, dataType */ ) {\n\t\tvar options = parseArguments.apply(null, arguments);\n\t\toptions.type = 'POST';\n\t\treturn $.ajax(options);\n\t};\n\n\t$.getJSON = function( /* url, data, success */ ) {\n\t\tvar options = parseArguments.apply(null, arguments);\n\t\toptions.dataType = 'json';\n\t\treturn $.ajax(options);\n\t};\n\n\t$.fn.load = function(url, data, success) {\n\t\tif(!this.length)\n\t\t\treturn this;\n\t\tvar self = this,\n\t\t\tparts = url.split(/\\s/),\n\t\t\tselector,\n\t\t\toptions = parseArguments(url, data, success),\n\t\t\tcallback = options.success;\n\t\tif(parts.length > 1)\n\t\t\toptions.url = parts[0], selector = parts[1];\n\t\toptions.success = function(response) {\n\t\t\tif(selector) {\n\t\t\t\tvar div = document.createElement('div');\n\t\t\t\tdiv.innerHTML = response.replace(rscript, \"\");\n\t\t\t\tvar selectorDiv = document.createElement('div');\n\t\t\t\tvar childs = div.querySelectorAll(selector);\n\t\t\t\tif(childs && childs.length > 0) {\n\t\t\t\t\tfor(var i = 0, len = childs.length; i < len; i++) {\n\t\t\t\t\t\tselectorDiv.appendChild(childs[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tself[0].innerHTML = selectorDiv.innerHTML;\n\t\t\t} else {\n\t\t\t\tself[0].innerHTML = response;\n\t\t\t}\n\t\t\tcallback && callback.apply(self, arguments);\n\t\t};\n\t\t$.ajax(options);\n\t\treturn this;\n\t};\n\n})(mui, window);\n/**\n * 5+ ajax\n */\n(function($) {\n\tvar originAnchor = document.createElement('a');\n\toriginAnchor.href = window.location.href;\n\t$.plusReady(function() {\n\t\t$.ajaxSettings = $.extend($.ajaxSettings, {\n\t\t\txhr: function(settings) {\n\t\t\t\tif (settings.crossDomain) { //强制使用plus跨域\n\t\t\t\t\treturn new plus.net.XMLHttpRequest();\n\t\t\t\t}\n\t\t\t\t//仅在webview的url为远程文件，且ajax请求的资源不同源下使用plus.net.XMLHttpRequest\n\t\t\t\tif (originAnchor.protocol !== 'file:') {\n\t\t\t\t\tvar urlAnchor = document.createElement('a');\n\t\t\t\t\turlAnchor.href = settings.url;\n\t\t\t\t\turlAnchor.href = urlAnchor.href;\n\t\t\t\t\tsettings.crossDomain = (originAnchor.protocol + '//' + originAnchor.host) !== (urlAnchor.protocol + '//' + urlAnchor.host);\n\t\t\t\t\tif (settings.crossDomain) {\n\t\t\t\t\t\treturn new plus.net.XMLHttpRequest();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ($.os.ios && window.webkit && window.webkit.messageHandlers) { //wkwebview下同样使用5+ xhr\n                    return new plus.net.XMLHttpRequest();\n                }\n\t\t\t\treturn new window.XMLHttpRequest();\n\t\t\t}\n\t\t});\n\t});\n})(mui);\n/**\n * mui layout(offset[,position,width,height...])\n * @param {type} $\n * @param {type} window\n * @param {type} undefined\n * @returns {undefined}\n */\n(function($, window, undefined) {\n\t$.offset = function(element) {\n\t\tvar box = {\n\t\t\ttop : 0,\n\t\t\tleft : 0\n\t\t};\n\t\tif ( typeof element.getBoundingClientRect !== undefined) {\n\t\t\tbox = element.getBoundingClientRect();\n\t\t}\n\t\treturn {\n\t\t\ttop : box.top + window.pageYOffset - element.clientTop,\n\t\t\tleft : box.left + window.pageXOffset - element.clientLeft\n\t\t};\n\t};\n})(mui, window);\n/**\n * mui animation\n */\n(function($, window) {\n\t/**\n\t * scrollTo\n\t */\n\t$.scrollTo = function(scrollTop, duration, callback) {\n\t\tduration = duration || 1000;\n\t\tvar scroll = function(duration) {\n\t\t\tif (duration <= 0) {\n\t\t\t\twindow.scrollTo(0, scrollTop);\n\t\t\t\tcallback && callback();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar distaince = scrollTop - window.scrollY;\n\t\t\tsetTimeout(function() {\n\t\t\t\twindow.scrollTo(0, window.scrollY + distaince / duration * 10);\n\t\t\t\tscroll(duration - 10);\n\t\t\t}, 16.7);\n\t\t};\n\t\tscroll(duration);\n\t};\n\t$.animationFrame = function(cb) {\n\t\tvar args, isQueued, context;\n\t\treturn function() {\n\t\t\targs = arguments;\n\t\t\tcontext = this;\n\t\t\tif (!isQueued) {\n\t\t\t\tisQueued = true;\n\t\t\t\trequestAnimationFrame(function() {\n\t\t\t\t\tcb.apply(context, args);\n\t\t\t\t\tisQueued = false;\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t};\n\n})(mui, window);\n(function($) {\n\tvar initializing = false,\n\t\tfnTest = /xyz/.test(function() {\n\t\t\txyz;\n\t\t}) ? /\\b_super\\b/ : /.*/;\n\n\tvar Class = function() {};\n\tClass.extend = function(prop) {\n\t\tvar _super = this.prototype;\n\t\tinitializing = true;\n\t\tvar prototype = new this();\n\t\tinitializing = false;\n\t\tfor (var name in prop) {\n\t\t\tprototype[name] = typeof prop[name] == \"function\" &&\n\t\t\t\ttypeof _super[name] == \"function\" && fnTest.test(prop[name]) ?\n\t\t\t\t(function(name, fn) {\n\t\t\t\t\treturn function() {\n\t\t\t\t\t\tvar tmp = this._super;\n\n\t\t\t\t\t\tthis._super = _super[name];\n\n\t\t\t\t\t\tvar ret = fn.apply(this, arguments);\n\t\t\t\t\t\tthis._super = tmp;\n\n\t\t\t\t\t\treturn ret;\n\t\t\t\t\t};\n\t\t\t\t})(name, prop[name]) :\n\t\t\t\tprop[name];\n\t\t}\n\t\tfunction Class() {\n\t\t\tif (!initializing && this.init)\n\t\t\t\tthis.init.apply(this, arguments);\n\t\t}\n\t\tClass.prototype = prototype;\n\t\tClass.prototype.constructor = Class;\n\t\tClass.extend = arguments.callee;\n\t\treturn Class;\n\t};\n\t$.Class = Class;\n})(mui);\n(function($, document, undefined) {\n    var CLASS_PULL_TOP_POCKET = 'mui-pull-top-pocket';\n    var CLASS_PULL_BOTTOM_POCKET = 'mui-pull-bottom-pocket';\n    var CLASS_PULL = 'mui-pull';\n    var CLASS_PULL_LOADING = 'mui-pull-loading';\n    var CLASS_PULL_CAPTION = 'mui-pull-caption';\n    var CLASS_PULL_CAPTION_DOWN = 'mui-pull-caption-down';\n    var CLASS_PULL_CAPTION_REFRESH = 'mui-pull-caption-refresh';\n    var CLASS_PULL_CAPTION_NOMORE = 'mui-pull-caption-nomore';\n\n    var CLASS_ICON = 'mui-icon';\n    var CLASS_SPINNER = 'mui-spinner';\n    var CLASS_ICON_PULLDOWN = 'mui-icon-pulldown';\n\n    var CLASS_BLOCK = 'mui-block';\n    var CLASS_HIDDEN = 'mui-hidden';\n    var CLASS_VISIBILITY = 'mui-visibility';\n\n    var CLASS_LOADING_UP = CLASS_PULL_LOADING + ' ' + CLASS_ICON + ' ' + CLASS_ICON_PULLDOWN;\n    var CLASS_LOADING_DOWN = CLASS_PULL_LOADING + ' ' + CLASS_ICON + ' ' + CLASS_ICON_PULLDOWN;\n    var CLASS_LOADING = CLASS_PULL_LOADING + ' ' + CLASS_ICON + ' ' + CLASS_SPINNER;\n\n    var pocketHtml = ['<div class=\"' + CLASS_PULL + '\">', '<div class=\"{icon}\"></div>', '<div class=\"' + CLASS_PULL_CAPTION + '\">{contentrefresh}</div>', '</div>'].join('');\n\n    var PullRefresh = {\n        init: function(element, options) {\n            this._super(element, $.extend(true, {\n                scrollY: true,\n                scrollX: false,\n                indicators: true,\n                deceleration: 0.003,\n                down: {\n                    height: 50,\n                    contentinit: '下拉可以刷新',\n                    contentdown: '下拉可以刷新',\n                    contentover: '释放立即刷新',\n                    contentrefresh: '正在刷新...'\n                },\n                up: {\n                    height: 50,\n                    auto: false,\n                    contentinit: '上拉显示更多',\n                    contentdown: '上拉显示更多',\n                    contentrefresh: '正在加载...',\n                    contentnomore: '没有更多数据了',\n                    duration: 300\n                }\n            }, options));\n        },\n        _init: function() {\n            this._super();\n            this._initPocket();\n        },\n        _initPulldownRefresh: function() {\n            this.pulldown = true;\n            if (this.topPocket) {\n                this.pullPocket = this.topPocket;\n                this.pullPocket.classList.add(CLASS_BLOCK);\n                this.pullPocket.classList.add(CLASS_VISIBILITY);\n                this.pullCaption = this.topCaption;\n                this.pullLoading = this.topLoading;\n            }\n        },\n        _initPullupRefresh: function() {\n            this.pulldown = false;\n            if (this.bottomPocket) {\n                this.pullPocket = this.bottomPocket;\n                this.pullPocket.classList.add(CLASS_BLOCK);\n                this.pullPocket.classList.add(CLASS_VISIBILITY);\n                this.pullCaption = this.bottomCaption;\n                this.pullLoading = this.bottomLoading;\n            }\n        },\n        _initPocket: function() {\n            var options = this.options;\n            if (options.down && options.down.hasOwnProperty('callback')) {\n                this.topPocket = this.scroller.querySelector('.' + CLASS_PULL_TOP_POCKET);\n                if (!this.topPocket) {\n                    this.topPocket = this._createPocket(CLASS_PULL_TOP_POCKET, options.down, CLASS_LOADING_DOWN);\n                    this.wrapper.insertBefore(this.topPocket, this.wrapper.firstChild);\n                }\n                this.topLoading = this.topPocket.querySelector('.' + CLASS_PULL_LOADING);\n                this.topCaption = this.topPocket.querySelector('.' + CLASS_PULL_CAPTION);\n            }\n            if (options.up && options.up.hasOwnProperty('callback')) {\n                this.bottomPocket = this.scroller.querySelector('.' + CLASS_PULL_BOTTOM_POCKET);\n                if (!this.bottomPocket) {\n                    this.bottomPocket = this._createPocket(CLASS_PULL_BOTTOM_POCKET, options.up, CLASS_LOADING);\n                    this.scroller.appendChild(this.bottomPocket);\n                }\n                this.bottomLoading = this.bottomPocket.querySelector('.' + CLASS_PULL_LOADING);\n                this.bottomCaption = this.bottomPocket.querySelector('.' + CLASS_PULL_CAPTION);\n                //TODO only for h5\n                this.wrapper.addEventListener('scrollbottom', this);\n            }\n        },\n        _createPocket: function(clazz, options, iconClass) {\n            var pocket = document.createElement('div');\n            pocket.className = clazz;\n            pocket.innerHTML = pocketHtml.replace('{contentrefresh}', options.contentinit).replace('{icon}', iconClass);\n            return pocket;\n        },\n        _resetPullDownLoading: function() {\n            var loading = this.pullLoading;\n            if (loading) {\n                this.pullCaption.innerHTML = this.options.down.contentdown;\n                loading.style.webkitTransition = \"\";\n                loading.style.webkitTransform = \"\";\n                loading.style.webkitAnimation = \"\";\n                loading.className = CLASS_LOADING_DOWN;\n            }\n        },\n        _setCaptionClass: function(isPulldown, caption, title) {\n            if (!isPulldown) {\n                switch (title) {\n                    case this.options.up.contentdown:\n                        caption.className = CLASS_PULL_CAPTION + ' ' + CLASS_PULL_CAPTION_DOWN;\n                        break;\n                    case this.options.up.contentrefresh:\n                        caption.className = CLASS_PULL_CAPTION + ' ' + CLASS_PULL_CAPTION_REFRESH\n                        break;\n                    case this.options.up.contentnomore:\n                        caption.className = CLASS_PULL_CAPTION + ' ' + CLASS_PULL_CAPTION_NOMORE;\n                        break;\n                }\n            }\n        },\n        _setCaption: function(title, reset) {\n            if (this.loading) {\n                return;\n            }\n            var options = this.options;\n            var pocket = this.pullPocket;\n            var caption = this.pullCaption;\n            var loading = this.pullLoading;\n            var isPulldown = this.pulldown;\n            var self = this;\n            if (pocket) {\n                if (reset) {\n                    setTimeout(function() {\n                        caption.innerHTML = self.lastTitle = title;\n                        if (isPulldown) {\n                            loading.className = CLASS_LOADING_DOWN;\n                        } else {\n                            self._setCaptionClass(false, caption, title);\n                            loading.className = CLASS_LOADING;\n                        }\n                        loading.style.webkitAnimation = \"\";\n                        loading.style.webkitTransition = \"\";\n                        loading.style.webkitTransform = \"\";\n                    }, 100);\n                } else {\n                    if (title !== this.lastTitle) {\n                        caption.innerHTML = title;\n                        if (isPulldown) {\n                            if (title === options.down.contentrefresh) {\n                                loading.className = CLASS_LOADING;\n                                loading.style.webkitAnimation = \"spinner-spin 1s step-end infinite\";\n                            } else if (title === options.down.contentover) {\n                                loading.className = CLASS_LOADING_UP;\n                                loading.style.webkitTransition = \"-webkit-transform 0.3s ease-in\";\n                                loading.style.webkitTransform = \"rotate(180deg)\";\n                            } else if (title === options.down.contentdown) {\n                                loading.className = CLASS_LOADING_DOWN;\n                                loading.style.webkitTransition = \"-webkit-transform 0.3s ease-in\";\n                                loading.style.webkitTransform = \"rotate(0deg)\";\n                            }\n                        } else {\n                            if (title === options.up.contentrefresh) {\n                                loading.className = CLASS_LOADING + ' ' + CLASS_VISIBILITY;\n                            } else {\n                                loading.className = CLASS_LOADING + ' ' + CLASS_HIDDEN;\n                            }\n                            self._setCaptionClass(false, caption, title);\n                        }\n                        this.lastTitle = title;\n                    }\n                }\n\n            }\n        }\n    };\n    $.PullRefresh = PullRefresh;\n})(mui, document);\n(function($, window, document, undefined) {\n\tvar CLASS_SCROLL = 'mui-scroll';\n\tvar CLASS_SCROLLBAR = 'mui-scrollbar';\n\tvar CLASS_INDICATOR = 'mui-scrollbar-indicator';\n\tvar CLASS_SCROLLBAR_VERTICAL = CLASS_SCROLLBAR + '-vertical';\n\tvar CLASS_SCROLLBAR_HORIZONTAL = CLASS_SCROLLBAR + '-horizontal';\n\n\tvar CLASS_ACTIVE = 'mui-active';\n\n\tvar ease = {\n\t\tquadratic: {\n\t\t\tstyle: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n\t\t\tfn: function(k) {\n\t\t\t\treturn k * (2 - k);\n\t\t\t}\n\t\t},\n\t\tcircular: {\n\t\t\tstyle: 'cubic-bezier(0.1, 0.57, 0.1, 1)',\n\t\t\tfn: function(k) {\n\t\t\t\treturn Math.sqrt(1 - (--k * k));\n\t\t\t}\n\t\t},\n\t\toutCirc: {\n\t\t\tstyle: 'cubic-bezier(0.075, 0.82, 0.165, 1)'\n\t\t},\n\t\toutCubic: {\n\t\t\tstyle: 'cubic-bezier(0.165, 0.84, 0.44, 1)'\n\t\t}\n\t}\n\tvar Scroll = $.Class.extend({\n\t\tinit: function(element, options) {\n\t\t\tthis.wrapper = this.element = element;\n\t\t\tthis.scroller = this.wrapper.children[0];\n\t\t\tthis.scrollerStyle = this.scroller && this.scroller.style;\n\t\t\tthis.stopped = false;\n\n\t\t\tthis.options = $.extend(true, {\n\t\t\t\tscrollY: true, //是否竖向滚动\n\t\t\t\tscrollX: false, //是否横向滚动\n\t\t\t\tstartX: 0, //初始化时滚动至x\n\t\t\t\tstartY: 0, //初始化时滚动至y\n\n\t\t\t\tindicators: true, //是否显示滚动条\n\t\t\t\tstopPropagation: false,\n\t\t\t\thardwareAccelerated: true,\n\t\t\t\tfixedBadAndorid: false,\n\t\t\t\tpreventDefaultException: {\n\t\t\t\t\ttagName: /^(INPUT|TEXTAREA|BUTTON|SELECT|VIDEO)$/\n\t\t\t\t},\n\t\t\t\tmomentum: true,\n\n\t\t\t\tsnapX: 0.5, //横向切换距离(以当前容器宽度为基准)\n\t\t\t\tsnap: false, //图片轮播，拖拽式选项卡\n\n\t\t\t\tbounce: true, //是否启用回弹\n\t\t\t\tbounceTime: 500, //回弹动画时间\n\t\t\t\tbounceEasing: ease.outCirc, //回弹动画曲线\n\n\t\t\t\tscrollTime: 500,\n\t\t\t\tscrollEasing: ease.outCubic, //轮播动画曲线\n\n\t\t\t\tdirectionLockThreshold: 5,\n\n\t\t\t\tparallaxElement: false, //视差元素\n\t\t\t\tparallaxRatio: 0.5\n\t\t\t}, options);\n\n\t\t\tthis.x = 0;\n\t\t\tthis.y = 0;\n\t\t\tthis.translateZ = this.options.hardwareAccelerated ? ' translateZ(0)' : '';\n\n\t\t\tthis._init();\n\t\t\tif (this.scroller) {\n\t\t\t\tthis.refresh();\n\t\t\t\t//\t\t\t\tif (this.options.startX !== 0 || this.options.startY !== 0) { //需要判断吗？后续根据实际情况再看看\n\t\t\t\tthis.scrollTo(this.options.startX, this.options.startY);\n\t\t\t\t//\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t_init: function() {\n\t\t\tthis._initParallax();\n\t\t\tthis._initIndicators();\n\t\t\tthis._initEvent();\n\t\t},\n\t\t_initParallax: function() {\n\t\t\tif (this.options.parallaxElement) {\n\t\t\t\tthis.parallaxElement = document.querySelector(this.options.parallaxElement);\n\t\t\t\tthis.parallaxStyle = this.parallaxElement.style;\n\t\t\t\tthis.parallaxHeight = this.parallaxElement.offsetHeight;\n\t\t\t\tthis.parallaxImgStyle = this.parallaxElement.querySelector('img').style;\n\t\t\t}\n\t\t},\n\t\t_initIndicators: function() {\n\t\t\tvar self = this;\n\t\t\tself.indicators = [];\n\t\t\tif (!this.options.indicators) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar indicators = [],\n\t\t\t\tindicator;\n\n\t\t\t// Vertical scrollbar\n\t\t\tif (self.options.scrollY) {\n\t\t\t\tindicator = {\n\t\t\t\t\tel: this._createScrollBar(CLASS_SCROLLBAR_VERTICAL),\n\t\t\t\t\tlistenX: false\n\t\t\t\t};\n\n\t\t\t\tthis.wrapper.appendChild(indicator.el);\n\t\t\t\tindicators.push(indicator);\n\t\t\t}\n\n\t\t\t// Horizontal scrollbar\n\t\t\tif (this.options.scrollX) {\n\t\t\t\tindicator = {\n\t\t\t\t\tel: this._createScrollBar(CLASS_SCROLLBAR_HORIZONTAL),\n\t\t\t\t\tlistenY: false\n\t\t\t\t};\n\n\t\t\t\tthis.wrapper.appendChild(indicator.el);\n\t\t\t\tindicators.push(indicator);\n\t\t\t}\n\n\t\t\tfor (var i = indicators.length; i--;) {\n\t\t\t\tthis.indicators.push(new Indicator(this, indicators[i]));\n\t\t\t}\n\n\t\t},\n\t\t_initSnap: function() {\n\t\t\tthis.currentPage = {};\n\t\t\tthis.pages = [];\n\t\t\tvar snaps = this.snaps;\n\t\t\tvar length = snaps.length;\n\t\t\tvar m = 0;\n\t\t\tvar n = -1;\n\t\t\tvar x = 0;\n\t\t\tvar leftX = 0;\n\t\t\tvar rightX = 0;\n\t\t\tvar snapX = 0;\n\t\t\tfor (var i = 0; i < length; i++) {\n\t\t\t\tvar snap = snaps[i];\n\t\t\t\tvar offsetLeft = snap.offsetLeft;\n\t\t\t\tvar offsetWidth = snap.offsetWidth;\n\t\t\t\tif (i === 0 || offsetLeft <= snaps[i - 1].offsetLeft) {\n\t\t\t\t\tm = 0;\n\t\t\t\t\tn++;\n\t\t\t\t}\n\t\t\t\tif (!this.pages[m]) {\n\t\t\t\t\tthis.pages[m] = [];\n\t\t\t\t}\n\t\t\t\tx = this._getSnapX(offsetLeft);\n\t\t\t\tsnapX = Math.round((offsetWidth) * this.options.snapX);\n\t\t\t\tleftX = x - snapX;\n\t\t\t\trightX = x - offsetWidth + snapX;\n\t\t\t\tthis.pages[m][n] = {\n\t\t\t\t\tx: x,\n\t\t\t\t\tleftX: leftX,\n\t\t\t\t\trightX: rightX,\n\t\t\t\t\tpageX: m,\n\t\t\t\t\telement: snap\n\t\t\t\t}\n\t\t\t\tif (snap.classList.contains(CLASS_ACTIVE)) {\n\t\t\t\t\tthis.currentPage = this.pages[m][0];\n\t\t\t\t}\n\t\t\t\tif (x >= this.maxScrollX) {\n\t\t\t\t\tm++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.options.startX = this.currentPage.x || 0;\n\t\t},\n\t\t_getSnapX: function(offsetLeft) {\n\t\t\treturn Math.max(Math.min(0, -offsetLeft + (this.wrapperWidth / 2)), this.maxScrollX);\n\t\t},\n\t\t_gotoPage: function(index) {\n\t\t\tthis.currentPage = this.pages[Math.min(index, this.pages.length - 1)][0];\n\t\t\tfor (var i = 0, len = this.snaps.length; i < len; i++) {\n\t\t\t\tif (i === index) {\n\t\t\t\t\tthis.snaps[i].classList.add(CLASS_ACTIVE);\n\t\t\t\t} else {\n\t\t\t\t\tthis.snaps[i].classList.remove(CLASS_ACTIVE);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.scrollTo(this.currentPage.x, 0, this.options.scrollTime);\n\t\t},\n\t\t_nearestSnap: function(x) {\n\t\t\tif (!this.pages.length) {\n\t\t\t\treturn {\n\t\t\t\t\tx: 0,\n\t\t\t\t\tpageX: 0\n\t\t\t\t};\n\t\t\t}\n\t\t\tvar i = 0;\n\t\t\tvar length = this.pages.length;\n\t\t\tif (x > 0) {\n\t\t\t\tx = 0;\n\t\t\t} else if (x < this.maxScrollX) {\n\t\t\t\tx = this.maxScrollX;\n\t\t\t}\n\t\t\tfor (; i < length; i++) {\n\t\t\t\tvar nearestX = this.direction === 'left' ? this.pages[i][0].leftX : this.pages[i][0].rightX;\n\t\t\t\tif (x >= nearestX) {\n\t\t\t\t\treturn this.pages[i][0];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tx: 0,\n\t\t\t\tpageX: 0\n\t\t\t};\n\t\t},\n\t\t_initEvent: function(detach) {\n\t\t\tvar action = detach ? 'removeEventListener' : 'addEventListener';\n\t\t\twindow[action]('orientationchange', this);\n\t\t\twindow[action]('resize', this);\n\n\t\t\tthis.scroller[action]('webkitTransitionEnd', this);\n\n\t\t\tthis.wrapper[action]($.EVENT_START, this);\n\t\t\tthis.wrapper[action]($.EVENT_CANCEL, this);\n\t\t\tthis.wrapper[action]($.EVENT_END, this);\n\t\t\tthis.wrapper[action]('drag', this);\n\t\t\tthis.wrapper[action]('dragend', this);\n\t\t\tthis.wrapper[action]('flick', this);\n\t\t\tthis.wrapper[action]('scrollend', this);\n\t\t\tif (this.options.scrollX) {\n\t\t\t\tthis.wrapper[action]('swiperight', this);\n\t\t\t}\n\t\t\tvar segmentedControl = this.wrapper.querySelector('.mui-segmented-control');\n\t\t\tif (segmentedControl) { //靠，这个bug排查了一下午，阻止hash跳转，一旦hash跳转会导致可拖拽选项卡的tab不见\n\t\t\t\tmui(segmentedControl)[detach ? 'off' : 'on']('click', 'a', $.preventDefault);\n\t\t\t}\n\n\t\t\tthis.wrapper[action]('scrollstart', this);\n\t\t\tthis.wrapper[action]('refresh', this);\n\t\t},\n\t\t_handleIndicatorScrollend: function() {\n\t\t\tthis.indicators.map(function(indicator) {\n\t\t\t\tindicator.fade();\n\t\t\t});\n\t\t},\n\t\t_handleIndicatorScrollstart: function() {\n\t\t\tthis.indicators.map(function(indicator) {\n\t\t\t\tindicator.fade(1);\n\t\t\t});\n\t\t},\n\t\t_handleIndicatorRefresh: function() {\n\t\t\tthis.indicators.map(function(indicator) {\n\t\t\t\tindicator.refresh();\n\t\t\t});\n\t\t},\n\t\thandleEvent: function(e) {\n\t\t\tif (this.stopped) {\n\t\t\t\tthis.resetPosition();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tswitch (e.type) {\n\t\t\t\tcase $.EVENT_START:\n\t\t\t\t\tthis._start(e);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'drag':\n\t\t\t\t\tthis.options.stopPropagation && e.stopPropagation();\n\t\t\t\t\tthis._drag(e);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'dragend':\n\t\t\t\tcase 'flick':\n\t\t\t\t\tthis.options.stopPropagation && e.stopPropagation();\n\t\t\t\t\tthis._flick(e);\n\t\t\t\t\tbreak;\n\t\t\t\tcase $.EVENT_CANCEL:\n\t\t\t\tcase $.EVENT_END:\n\t\t\t\t\tthis._end(e);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'webkitTransitionEnd':\n\t\t\t\t\tthis.transitionTimer && this.transitionTimer.cancel();\n\t\t\t\t\tthis._transitionEnd(e);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'scrollstart':\n\t\t\t\t\tthis._handleIndicatorScrollstart(e);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'scrollend':\n\t\t\t\t\tthis._handleIndicatorScrollend(e);\n\t\t\t\t\tthis._scrollend(e);\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'orientationchange':\n\t\t\t\tcase 'resize':\n\t\t\t\t\tthis._resize();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'swiperight':\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'refresh':\n\t\t\t\t\tthis._handleIndicatorRefresh(e);\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\t\t},\n\t\t_start: function(e) {\n\t\t\tthis.moved = this.needReset = false;\n\t\t\tthis._transitionTime();\n\t\t\tif (this.isInTransition) {\n\t\t\t\tthis.needReset = true;\n\t\t\t\tthis.isInTransition = false;\n\t\t\t\tvar pos = $.parseTranslateMatrix($.getStyles(this.scroller, 'webkitTransform'));\n\t\t\t\tthis.setTranslate(Math.round(pos.x), Math.round(pos.y));\n\t\t\t\t//\t\t\t\tthis.resetPosition(); //reset\n\t\t\t\t$.trigger(this.scroller, 'scrollend', this);\n\t\t\t\t//\t\t\t\te.stopPropagation();\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\tthis.reLayout();\n\t\t\t$.trigger(this.scroller, 'beforescrollstart', this);\n\t\t},\n\t\t_getDirectionByAngle: function(angle) {\n\t\t\tif (angle < -80 && angle > -100) {\n\t\t\t\treturn 'up';\n\t\t\t} else if (angle >= 80 && angle < 100) {\n\t\t\t\treturn 'down';\n\t\t\t} else if (angle >= 170 || angle <= -170) {\n\t\t\t\treturn 'left';\n\t\t\t} else if (angle >= -35 && angle <= 10) {\n\t\t\t\treturn 'right';\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\t_drag: function(e) {\n\t\t\t//\t\t\tif (this.needReset) {\n\t\t\t//\t\t\t\te.stopPropagation(); //disable parent drag(nested scroller)\n\t\t\t//\t\t\t\treturn;\n\t\t\t//\t\t\t}\n\t\t\tvar detail = e.detail;\n\t\t\tif (this.options.scrollY || detail.direction === 'up' || detail.direction === 'down') { //如果是竖向滚动或手势方向是上或下\n\t\t\t\t//ios8 hack\n\t\t\t\tif ($.os.ios && parseFloat($.os.version) >= 8) { //多webview时，离开当前webview会导致后续touch事件不触发\n\t\t\t\t\tvar clientY = detail.gesture.touches[0].clientY;\n\t\t\t\t\t//下拉刷新 or 上拉加载\n\t\t\t\t\tif ((clientY + 10) > window.innerHeight || clientY < 10) {\n\t\t\t\t\t\tthis.resetPosition(this.options.bounceTime);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar isPreventDefault = isReturn = false;\n\t\t\tvar direction = this._getDirectionByAngle(detail.angle);\n\t\t\tif (detail.direction === 'left' || detail.direction === 'right') {\n\t\t\t\tif (this.options.scrollX) {\n\t\t\t\t\tisPreventDefault = true;\n\t\t\t\t\tif (!this.moved) { //识别角度(该角度导致轮播不灵敏)\n\t\t\t\t\t\t//\t\t\t\t\t\tif (direction !== 'left' && direction !== 'right') {\n\t\t\t\t\t\t//\t\t\t\t\t\t\tisReturn = true;\n\t\t\t\t\t\t//\t\t\t\t\t\t} else {\n\t\t\t\t\t\t$.gestures.session.lockDirection = true; //锁定方向\n\t\t\t\t\t\t$.gestures.session.startDirection = detail.direction;\n\t\t\t\t\t\t//\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (this.options.scrollY && !this.moved) {\n\t\t\t\t\tisReturn = true;\n\t\t\t\t}\n\t\t\t} else if (detail.direction === 'up' || detail.direction === 'down') {\n\t\t\t\tif (this.options.scrollY) {\n\t\t\t\t\tisPreventDefault = true;\n\t\t\t\t\t//\t\t\t\t\tif (!this.moved) { //识别角度,竖向滚动似乎没必要进行小角度验证\n\t\t\t\t\t//\t\t\t\t\t\tif (direction !== 'up' && direction !== 'down') {\n\t\t\t\t\t//\t\t\t\t\t\t\tisReturn = true;\n\t\t\t\t\t//\t\t\t\t\t\t}\n\t\t\t\t\t//\t\t\t\t\t}\n\t\t\t\t\tif (!this.moved) {\n\t\t\t\t\t\t$.gestures.session.lockDirection = true; //锁定方向\n\t\t\t\t\t\t$.gestures.session.startDirection = detail.direction;\n\t\t\t\t\t}\n\t\t\t\t} else if (this.options.scrollX && !this.moved) {\n\t\t\t\t\tisReturn = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tisReturn = true;\n\t\t\t}\n\t\t\tif (this.moved || isPreventDefault) {\n\t\t\t\te.stopPropagation(); //阻止冒泡(scroll类嵌套)\n\t\t\t\tdetail.gesture && detail.gesture.preventDefault();\n\t\t\t}\n\t\t\tif (isReturn) { //禁止非法方向滚动\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!this.moved) {\n\t\t\t\t$.trigger(this.scroller, 'scrollstart', this);\n\t\t\t} else {\n\t\t\t\te.stopPropagation(); //move期间阻止冒泡(scroll嵌套)\n\t\t\t}\n\t\t\tvar deltaX = 0;\n\t\t\tvar deltaY = 0;\n\t\t\tif (!this.moved) { //start\n\t\t\t\tdeltaX = detail.deltaX;\n\t\t\t\tdeltaY = detail.deltaY;\n\t\t\t} else { //move\n\t\t\t\tdeltaX = detail.deltaX - $.gestures.session.prevTouch.deltaX;\n\t\t\t\tdeltaY = detail.deltaY - $.gestures.session.prevTouch.deltaY;\n\t\t\t}\n\t\t\tvar absDeltaX = Math.abs(detail.deltaX);\n\t\t\tvar absDeltaY = Math.abs(detail.deltaY);\n\t\t\tif (absDeltaX > absDeltaY + this.options.directionLockThreshold) {\n\t\t\t\tdeltaY = 0;\n\t\t\t} else if (absDeltaY >= absDeltaX + this.options.directionLockThreshold) {\n\t\t\t\tdeltaX = 0;\n\t\t\t}\n\n\t\t\tdeltaX = this.hasHorizontalScroll ? deltaX : 0;\n\t\t\tdeltaY = this.hasVerticalScroll ? deltaY : 0;\n\t\t\tvar newX = this.x + deltaX;\n\t\t\tvar newY = this.y + deltaY;\n\t\t\t// Slow down if outside of the boundaries\n\t\t\tif (newX > 0 || newX < this.maxScrollX) {\n\t\t\t\tnewX = this.options.bounce ? this.x + deltaX / 3 : newX > 0 ? 0 : this.maxScrollX;\n\t\t\t}\n\t\t\tif (newY > 0 || newY < this.maxScrollY) {\n\t\t\t\tnewY = this.options.bounce ? this.y + deltaY / 3 : newY > 0 ? 0 : this.maxScrollY;\n\t\t\t}\n\n\t\t\tif (!this.requestAnimationFrame) {\n\t\t\t\tthis._updateTranslate();\n\t\t\t}\n\t\t\tthis.direction = detail.deltaX > 0 ? 'right' : 'left';\n\t\t\tthis.moved = true;\n\t\t\tthis.x = newX;\n\t\t\tthis.y = newY;\n\t\t\t$.trigger(this.scroller, 'scroll', this);\n\t\t},\n\t\t_flick: function(e) {\n\t\t\t//\t\t\tif (!this.moved || this.needReset) {\n\t\t\t//\t\t\t\treturn;\n\t\t\t//\t\t\t}\n\t\t\tif (!this.moved) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\te.stopPropagation();\n\t\t\tvar detail = e.detail;\n\t\t\tthis._clearRequestAnimationFrame();\n\t\t\tif (e.type === 'dragend' && detail.flick) { //dragend\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar newX = Math.round(this.x);\n\t\t\tvar newY = Math.round(this.y);\n\n\t\t\tthis.isInTransition = false;\n\t\t\t// reset if we are outside of the boundaries\n\t\t\tif (this.resetPosition(this.options.bounceTime)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.scrollTo(newX, newY); // ensures that the last position is rounded\n\n\t\t\tif (e.type === 'dragend') { //dragend\n\t\t\t\t$.trigger(this.scroller, 'scrollend', this);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar time = 0;\n\t\t\tvar easing = '';\n\t\t\t// start momentum animation if needed\n\t\t\tif (this.options.momentum && detail.flickTime < 300) {\n\t\t\t\tmomentumX = this.hasHorizontalScroll ? this._momentum(this.x, detail.flickDistanceX, detail.flickTime, this.maxScrollX, this.options.bounce ? this.wrapperWidth : 0, this.options.deceleration) : {\n\t\t\t\t\tdestination: newX,\n\t\t\t\t\tduration: 0\n\t\t\t\t};\n\t\t\t\tmomentumY = this.hasVerticalScroll ? this._momentum(this.y, detail.flickDistanceY, detail.flickTime, this.maxScrollY, this.options.bounce ? this.wrapperHeight : 0, this.options.deceleration) : {\n\t\t\t\t\tdestination: newY,\n\t\t\t\t\tduration: 0\n\t\t\t\t};\n\t\t\t\tnewX = momentumX.destination;\n\t\t\t\tnewY = momentumY.destination;\n\t\t\t\ttime = Math.max(momentumX.duration, momentumY.duration);\n\t\t\t\tthis.isInTransition = true;\n\t\t\t}\n\n\t\t\tif (newX != this.x || newY != this.y) {\n\t\t\t\tif (newX > 0 || newX < this.maxScrollX || newY > 0 || newY < this.maxScrollY) {\n\t\t\t\t\teasing = ease.quadratic;\n\t\t\t\t}\n\t\t\t\tthis.scrollTo(newX, newY, time, easing);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$.trigger(this.scroller, 'scrollend', this);\n\t\t\t//\t\t\te.stopPropagation();\n\t\t},\n\t\t_end: function(e) {\n\t\t\tthis.needReset = false;\n\t\t\tif ((!this.moved && this.needReset) || e.type === $.EVENT_CANCEL) {\n\t\t\t\tthis.resetPosition();\n\t\t\t}\n\t\t},\n\t\t_transitionEnd: function(e) {\n\t\t\tif (e.target != this.scroller || !this.isInTransition) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._transitionTime();\n\t\t\tif (!this.resetPosition(this.options.bounceTime)) {\n\t\t\t\tthis.isInTransition = false;\n\t\t\t\t$.trigger(this.scroller, 'scrollend', this);\n\t\t\t}\n\t\t},\n\t\t_scrollend: function(e) {\n\t\t\tif ((this.y === 0 && this.maxScrollY === 0) || (Math.abs(this.y) > 0 && this.y <= this.maxScrollY)) {\n\t\t\t\t$.trigger(this.scroller, 'scrollbottom', this);\n\t\t\t}\n\t\t},\n\t\t_resize: function() {\n\t\t\tvar that = this;\n\t\t\tclearTimeout(that.resizeTimeout);\n\t\t\tthat.resizeTimeout = setTimeout(function() {\n\t\t\t\tthat.refresh();\n\t\t\t}, that.options.resizePolling);\n\t\t},\n\t\t_transitionTime: function(time) {\n\t\t\ttime = time || 0;\n\t\t\tthis.scrollerStyle['webkitTransitionDuration'] = time + 'ms';\n\t\t\tif (this.parallaxElement && this.options.scrollY) { //目前仅支持竖向视差效果\n\t\t\t\tthis.parallaxStyle['webkitTransitionDuration'] = time + 'ms';\n\t\t\t}\n\t\t\tif (this.options.fixedBadAndorid && !time && $.os.isBadAndroid) {\n\t\t\t\tthis.scrollerStyle['webkitTransitionDuration'] = '0.001s';\n\t\t\t\tif (this.parallaxElement && this.options.scrollY) { //目前仅支持竖向视差效果\n\t\t\t\t\tthis.parallaxStyle['webkitTransitionDuration'] = '0.001s';\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.indicators) {\n\t\t\t\tfor (var i = this.indicators.length; i--;) {\n\t\t\t\t\tthis.indicators[i].transitionTime(time);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (time) { //自定义timer，保证webkitTransitionEnd始终触发\n\t\t\t\tthis.transitionTimer && this.transitionTimer.cancel();\n\t\t\t\tthis.transitionTimer = $.later(function() {\n\t\t\t\t\t$.trigger(this.scroller, 'webkitTransitionEnd');\n\t\t\t\t}, time + 100, this);\n\t\t\t}\n\t\t},\n\t\t_transitionTimingFunction: function(easing) {\n\t\t\tthis.scrollerStyle['webkitTransitionTimingFunction'] = easing;\n\t\t\tif (this.parallaxElement && this.options.scrollY) { //目前仅支持竖向视差效果\n\t\t\t\tthis.parallaxStyle['webkitTransitionDuration'] = easing;\n\t\t\t}\n\t\t\tif (this.indicators) {\n\t\t\t\tfor (var i = this.indicators.length; i--;) {\n\t\t\t\t\tthis.indicators[i].transitionTimingFunction(easing);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t_translate: function(x, y) {\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t},\n\t\t_clearRequestAnimationFrame: function() {\n\t\t\tif (this.requestAnimationFrame) {\n\t\t\t\tcancelAnimationFrame(this.requestAnimationFrame);\n\t\t\t\tthis.requestAnimationFrame = null;\n\t\t\t}\n\t\t},\n\t\t_updateTranslate: function() {\n\t\t\tvar self = this;\n\t\t\tif (self.x !== self.lastX || self.y !== self.lastY) {\n\t\t\t\tself.setTranslate(self.x, self.y);\n\t\t\t}\n\t\t\tself.requestAnimationFrame = requestAnimationFrame(function() {\n\t\t\t\tself._updateTranslate();\n\t\t\t});\n\t\t},\n\t\t_createScrollBar: function(clazz) {\n\t\t\tvar scrollbar = document.createElement('div');\n\t\t\tvar indicator = document.createElement('div');\n\t\t\tscrollbar.className = CLASS_SCROLLBAR + ' ' + clazz;\n\t\t\tindicator.className = CLASS_INDICATOR;\n\t\t\tscrollbar.appendChild(indicator);\n\t\t\tif (clazz === CLASS_SCROLLBAR_VERTICAL) {\n\t\t\t\tthis.scrollbarY = scrollbar;\n\t\t\t\tthis.scrollbarIndicatorY = indicator;\n\t\t\t} else if (clazz === CLASS_SCROLLBAR_HORIZONTAL) {\n\t\t\t\tthis.scrollbarX = scrollbar;\n\t\t\t\tthis.scrollbarIndicatorX = indicator;\n\t\t\t}\n\t\t\tthis.wrapper.appendChild(scrollbar);\n\t\t\treturn scrollbar;\n\t\t},\n\t\t_preventDefaultException: function(el, exceptions) {\n\t\t\tfor (var i in exceptions) {\n\t\t\t\tif (exceptions[i].test(el[i])) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\t_reLayout: function() {\n\t\t\tif (!this.hasHorizontalScroll) {\n\t\t\t\tthis.maxScrollX = 0;\n\t\t\t\tthis.scrollerWidth = this.wrapperWidth;\n\t\t\t}\n\n\t\t\tif (!this.hasVerticalScroll) {\n\t\t\t\tthis.maxScrollY = 0;\n\t\t\t\tthis.scrollerHeight = this.wrapperHeight;\n\t\t\t}\n\n\t\t\tthis.indicators.map(function(indicator) {\n\t\t\t\tindicator.refresh();\n\t\t\t});\n\n\t\t\t//以防slider类嵌套使用\n\t\t\tif (this.options.snap && typeof this.options.snap === 'string') {\n\t\t\t\tvar items = this.scroller.querySelectorAll(this.options.snap);\n\t\t\t\tthis.itemLength = 0;\n\t\t\t\tthis.snaps = [];\n\t\t\t\tfor (var i = 0, len = items.length; i < len; i++) {\n\t\t\t\t\tvar item = items[i];\n\t\t\t\t\tif (item.parentNode === this.scroller) {\n\t\t\t\t\t\tthis.itemLength++;\n\t\t\t\t\t\tthis.snaps.push(item);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._initSnap(); //需要每次都_initSnap么。其实init的时候执行一次，后续resize的时候执行一次就行了吧.先这么做吧，如果影响性能，再调整\n\t\t\t}\n\t\t},\n\t\t_momentum: function(current, distance, time, lowerMargin, wrapperSize, deceleration) {\n\t\t\tvar speed = parseFloat(Math.abs(distance) / time),\n\t\t\t\tdestination,\n\t\t\t\tduration;\n\n\t\t\tdeceleration = deceleration === undefined ? 0.0006 : deceleration;\n\t\t\tdestination = current + (speed * speed) / (2 * deceleration) * (distance < 0 ? -1 : 1);\n\t\t\tduration = speed / deceleration;\n\t\t\tif (destination < lowerMargin) {\n\t\t\t\tdestination = wrapperSize ? lowerMargin - (wrapperSize / 2.5 * (speed / 8)) : lowerMargin;\n\t\t\t\tdistance = Math.abs(destination - current);\n\t\t\t\tduration = distance / speed;\n\t\t\t} else if (destination > 0) {\n\t\t\t\tdestination = wrapperSize ? wrapperSize / 2.5 * (speed / 8) : 0;\n\t\t\t\tdistance = Math.abs(current) + destination;\n\t\t\t\tduration = distance / speed;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tdestination: Math.round(destination),\n\t\t\t\tduration: duration\n\t\t\t};\n\t\t},\n\t\t_getTranslateStr: function(x, y) {\n\t\t\tif (this.options.hardwareAccelerated) {\n\t\t\t\treturn 'translate3d(' + x + 'px,' + y + 'px,0px) ' + this.translateZ;\n\t\t\t}\n\t\t\treturn 'translate(' + x + 'px,' + y + 'px) ';\n\t\t},\n\t\t//API\n\t\tsetStopped: function(stopped) {\n\t\t\tthis.stopped = !!stopped;\n\t\t},\n\t\tsetTranslate: function(x, y) {\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\t\t\tthis.scrollerStyle['webkitTransform'] = this._getTranslateStr(x, y);\n\t\t\tif (this.parallaxElement && this.options.scrollY) { //目前仅支持竖向视差效果\n\t\t\t\tvar parallaxY = y * this.options.parallaxRatio;\n\t\t\t\tvar scale = 1 + parallaxY / ((this.parallaxHeight - parallaxY) / 2);\n\t\t\t\tif (scale > 1) {\n\t\t\t\t\tthis.parallaxImgStyle['opacity'] = 1 - parallaxY / 100 * this.options.parallaxRatio;\n\t\t\t\t\tthis.parallaxStyle['webkitTransform'] = this._getTranslateStr(0, -parallaxY) + ' scale(' + scale + ',' + scale + ')';\n\t\t\t\t} else {\n\t\t\t\t\tthis.parallaxImgStyle['opacity'] = 1;\n\t\t\t\t\tthis.parallaxStyle['webkitTransform'] = this._getTranslateStr(0, -1) + ' scale(1,1)';\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.indicators) {\n\t\t\t\tfor (var i = this.indicators.length; i--;) {\n\t\t\t\t\tthis.indicators[i].updatePosition();\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.lastX = this.x;\n\t\t\tthis.lastY = this.y;\n\t\t\t$.trigger(this.scroller, 'scroll', this);\n\t\t},\n\t\treLayout: function() {\n\t\t\tthis.wrapper.offsetHeight;\n\n\t\t\tvar paddingLeft = parseFloat($.getStyles(this.wrapper, 'padding-left')) || 0;\n\t\t\tvar paddingRight = parseFloat($.getStyles(this.wrapper, 'padding-right')) || 0;\n\t\t\tvar paddingTop = parseFloat($.getStyles(this.wrapper, 'padding-top')) || 0;\n\t\t\tvar paddingBottom = parseFloat($.getStyles(this.wrapper, 'padding-bottom')) || 0;\n\n\t\t\tvar clientWidth = this.wrapper.clientWidth;\n\t\t\tvar clientHeight = this.wrapper.clientHeight;\n\n\t\t\tthis.scrollerWidth = this.scroller.offsetWidth;\n\t\t\tthis.scrollerHeight = this.scroller.offsetHeight;\n\n\t\t\tthis.wrapperWidth = clientWidth - paddingLeft - paddingRight;\n\t\t\tthis.wrapperHeight = clientHeight - paddingTop - paddingBottom;\n\n\t\t\tthis.maxScrollX = Math.min(this.wrapperWidth - this.scrollerWidth, 0);\n\t\t\tthis.maxScrollY = Math.min(this.wrapperHeight - this.scrollerHeight, 0);\n\t\t\tthis.hasHorizontalScroll = this.options.scrollX && this.maxScrollX < 0;\n\t\t\tthis.hasVerticalScroll = this.options.scrollY && this.maxScrollY < 0;\n\t\t\tthis._reLayout();\n\t\t},\n\t\tresetPosition: function(time) {\n\t\t\tvar x = this.x,\n\t\t\t\ty = this.y;\n\n\t\t\ttime = time || 0;\n\t\t\tif (!this.hasHorizontalScroll || this.x > 0) {\n\t\t\t\tx = 0;\n\t\t\t} else if (this.x < this.maxScrollX) {\n\t\t\t\tx = this.maxScrollX;\n\t\t\t}\n\n\t\t\tif (!this.hasVerticalScroll || this.y > 0) {\n\t\t\t\ty = 0;\n\t\t\t} else if (this.y < this.maxScrollY) {\n\t\t\t\ty = this.maxScrollY;\n\t\t\t}\n\n\t\t\tif (x == this.x && y == this.y) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.scrollTo(x, y, time, this.options.scrollEasing);\n\n\t\t\treturn true;\n\t\t},\n\t\t_reInit: function() {\n\t\t\tvar groups = this.wrapper.querySelectorAll('.' + CLASS_SCROLL);\n\t\t\tfor (var i = 0, len = groups.length; i < len; i++) {\n\t\t\t\tif (groups[i].parentNode === this.wrapper) {\n\t\t\t\t\tthis.scroller = groups[i];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.scrollerStyle = this.scroller && this.scroller.style;\n\t\t},\n\t\trefresh: function() {\n\t\t\tthis._reInit();\n\t\t\tthis.reLayout();\n\t\t\t$.trigger(this.scroller, 'refresh', this);\n\t\t\tthis.resetPosition();\n\t\t},\n\t\tscrollTo: function(x, y, time, easing) {\n\t\t\tvar easing = easing || ease.circular;\n\t\t\t//\t\t\tthis.isInTransition = time > 0 && (this.lastX != x || this.lastY != y);\n\t\t\t//暂不严格判断x,y，否则会导致部分版本上不正常触发轮播\n\t\t\tthis.isInTransition = time > 0;\n\t\t\tif (this.isInTransition) {\n\t\t\t\tthis._clearRequestAnimationFrame();\n\t\t\t\tthis._transitionTimingFunction(easing.style);\n\t\t\t\tthis._transitionTime(time);\n\t\t\t\tthis.setTranslate(x, y);\n\t\t\t} else {\n\t\t\t\tthis.setTranslate(x, y);\n\t\t\t}\n\n\t\t},\n\t\tscrollToBottom: function(time, easing) {\n\t\t\ttime = time || this.options.scrollTime;\n\t\t\tthis.scrollTo(0, this.maxScrollY, time, easing);\n\t\t},\n\t\tgotoPage: function(index) {\n\t\t\tthis._gotoPage(index);\n\t\t},\n\t\tdestroy: function() {\n\t\t\tthis._initEvent(true); //detach\n\t\t\tdelete $.data[this.wrapper.getAttribute('data-scroll')];\n\t\t\tthis.wrapper.setAttribute('data-scroll', '');\n\t\t}\n\t});\n\t//Indicator\n\tvar Indicator = function(scroller, options) {\n\t\tthis.wrapper = typeof options.el == 'string' ? document.querySelector(options.el) : options.el;\n\t\tthis.wrapperStyle = this.wrapper.style;\n\t\tthis.indicator = this.wrapper.children[0];\n\t\tthis.indicatorStyle = this.indicator.style;\n\t\tthis.scroller = scroller;\n\n\t\tthis.options = $.extend({\n\t\t\tlistenX: true,\n\t\t\tlistenY: true,\n\t\t\tfade: false,\n\t\t\tspeedRatioX: 0,\n\t\t\tspeedRatioY: 0\n\t\t}, options);\n\n\t\tthis.sizeRatioX = 1;\n\t\tthis.sizeRatioY = 1;\n\t\tthis.maxPosX = 0;\n\t\tthis.maxPosY = 0;\n\n\t\tif (this.options.fade) {\n\t\t\tthis.wrapperStyle['webkitTransform'] = this.scroller.translateZ;\n\t\t\tthis.wrapperStyle['webkitTransitionDuration'] = this.options.fixedBadAndorid && $.os.isBadAndroid ? '0.001s' : '0ms';\n\t\t\tthis.wrapperStyle.opacity = '0';\n\t\t}\n\t}\n\tIndicator.prototype = {\n\t\thandleEvent: function(e) {\n\n\t\t},\n\t\ttransitionTime: function(time) {\n\t\t\ttime = time || 0;\n\t\t\tthis.indicatorStyle['webkitTransitionDuration'] = time + 'ms';\n\t\t\tif (this.scroller.options.fixedBadAndorid && !time && $.os.isBadAndroid) {\n\t\t\t\tthis.indicatorStyle['webkitTransitionDuration'] = '0.001s';\n\t\t\t}\n\t\t},\n\t\ttransitionTimingFunction: function(easing) {\n\t\t\tthis.indicatorStyle['webkitTransitionTimingFunction'] = easing;\n\t\t},\n\t\trefresh: function() {\n\t\t\tthis.transitionTime();\n\n\t\t\tif (this.options.listenX && !this.options.listenY) {\n\t\t\t\tthis.indicatorStyle.display = this.scroller.hasHorizontalScroll ? 'block' : 'none';\n\t\t\t} else if (this.options.listenY && !this.options.listenX) {\n\t\t\t\tthis.indicatorStyle.display = this.scroller.hasVerticalScroll ? 'block' : 'none';\n\t\t\t} else {\n\t\t\t\tthis.indicatorStyle.display = this.scroller.hasHorizontalScroll || this.scroller.hasVerticalScroll ? 'block' : 'none';\n\t\t\t}\n\n\t\t\tthis.wrapper.offsetHeight; // force refresh\n\n\t\t\tif (this.options.listenX) {\n\t\t\t\tthis.wrapperWidth = this.wrapper.clientWidth;\n\t\t\t\tthis.indicatorWidth = Math.max(Math.round(this.wrapperWidth * this.wrapperWidth / (this.scroller.scrollerWidth || this.wrapperWidth || 1)), 8);\n\t\t\t\tthis.indicatorStyle.width = this.indicatorWidth + 'px';\n\n\t\t\t\tthis.maxPosX = this.wrapperWidth - this.indicatorWidth;\n\n\t\t\t\tthis.minBoundaryX = 0;\n\t\t\t\tthis.maxBoundaryX = this.maxPosX;\n\n\t\t\t\tthis.sizeRatioX = this.options.speedRatioX || (this.scroller.maxScrollX && (this.maxPosX / this.scroller.maxScrollX));\n\t\t\t}\n\n\t\t\tif (this.options.listenY) {\n\t\t\t\tthis.wrapperHeight = this.wrapper.clientHeight;\n\t\t\t\tthis.indicatorHeight = Math.max(Math.round(this.wrapperHeight * this.wrapperHeight / (this.scroller.scrollerHeight || this.wrapperHeight || 1)), 8);\n\t\t\t\tthis.indicatorStyle.height = this.indicatorHeight + 'px';\n\n\t\t\t\tthis.maxPosY = this.wrapperHeight - this.indicatorHeight;\n\n\t\t\t\tthis.minBoundaryY = 0;\n\t\t\t\tthis.maxBoundaryY = this.maxPosY;\n\n\t\t\t\tthis.sizeRatioY = this.options.speedRatioY || (this.scroller.maxScrollY && (this.maxPosY / this.scroller.maxScrollY));\n\t\t\t}\n\n\t\t\tthis.updatePosition();\n\t\t},\n\n\t\tupdatePosition: function() {\n\t\t\tvar x = this.options.listenX && Math.round(this.sizeRatioX * this.scroller.x) || 0,\n\t\t\t\ty = this.options.listenY && Math.round(this.sizeRatioY * this.scroller.y) || 0;\n\n\t\t\tif (x < this.minBoundaryX) {\n\t\t\t\tthis.width = Math.max(this.indicatorWidth + x, 8);\n\t\t\t\tthis.indicatorStyle.width = this.width + 'px';\n\t\t\t\tx = this.minBoundaryX;\n\t\t\t} else if (x > this.maxBoundaryX) {\n\t\t\t\tthis.width = Math.max(this.indicatorWidth - (x - this.maxPosX), 8);\n\t\t\t\tthis.indicatorStyle.width = this.width + 'px';\n\t\t\t\tx = this.maxPosX + this.indicatorWidth - this.width;\n\t\t\t} else if (this.width != this.indicatorWidth) {\n\t\t\t\tthis.width = this.indicatorWidth;\n\t\t\t\tthis.indicatorStyle.width = this.width + 'px';\n\t\t\t}\n\n\t\t\tif (y < this.minBoundaryY) {\n\t\t\t\tthis.height = Math.max(this.indicatorHeight + y * 3, 8);\n\t\t\t\tthis.indicatorStyle.height = this.height + 'px';\n\t\t\t\ty = this.minBoundaryY;\n\t\t\t} else if (y > this.maxBoundaryY) {\n\t\t\t\tthis.height = Math.max(this.indicatorHeight - (y - this.maxPosY) * 3, 8);\n\t\t\t\tthis.indicatorStyle.height = this.height + 'px';\n\t\t\t\ty = this.maxPosY + this.indicatorHeight - this.height;\n\t\t\t} else if (this.height != this.indicatorHeight) {\n\t\t\t\tthis.height = this.indicatorHeight;\n\t\t\t\tthis.indicatorStyle.height = this.height + 'px';\n\t\t\t}\n\n\t\t\tthis.x = x;\n\t\t\tthis.y = y;\n\n\t\t\tthis.indicatorStyle['webkitTransform'] = this.scroller._getTranslateStr(x, y);\n\n\t\t},\n\t\tfade: function(val, hold) {\n\t\t\tif (hold && !this.visible) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tclearTimeout(this.fadeTimeout);\n\t\t\tthis.fadeTimeout = null;\n\n\t\t\tvar time = val ? 250 : 500,\n\t\t\t\tdelay = val ? 0 : 300;\n\n\t\t\tval = val ? '1' : '0';\n\n\t\t\tthis.wrapperStyle['webkitTransitionDuration'] = time + 'ms';\n\n\t\t\tthis.fadeTimeout = setTimeout((function(val) {\n\t\t\t\tthis.wrapperStyle.opacity = val;\n\t\t\t\tthis.visible = +val;\n\t\t\t}).bind(this, val), delay);\n\t\t}\n\t};\n\n\t$.Scroll = Scroll;\n\n\t$.fn.scroll = function(options) {\n\t\tvar scrollApis = [];\n\t\tthis.each(function() {\n\t\t\tvar scrollApi = null;\n\t\t\tvar self = this;\n\t\t\tvar id = self.getAttribute('data-scroll');\n\t\t\tif (!id) {\n\t\t\t\tid = ++$.uuid;\n\t\t\t\tvar _options = $.extend({}, options);\n\t\t\t\tif (self.classList.contains('mui-segmented-control')) {\n\t\t\t\t\t_options = $.extend(_options, {\n\t\t\t\t\t\tscrollY: false,\n\t\t\t\t\t\tscrollX: true,\n\t\t\t\t\t\tindicators: false,\n\t\t\t\t\t\tsnap: '.mui-control-item'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t$.data[id] = scrollApi = new Scroll(self, _options);\n\t\t\t\tself.setAttribute('data-scroll', id);\n\t\t\t} else {\n\t\t\t\tscrollApi = $.data[id];\n\t\t\t}\n\t\t\tscrollApis.push(scrollApi);\n\t\t});\n\t\treturn scrollApis.length === 1 ? scrollApis[0] : scrollApis;\n\t};\n})(mui, window, document);\n(function($, window, document, undefined) {\n\n\tvar CLASS_VISIBILITY = 'mui-visibility';\n\tvar CLASS_HIDDEN = 'mui-hidden';\n\n\tvar PullRefresh = $.Scroll.extend($.extend({\n\t\thandleEvent: function(e) {\n\t\t\tthis._super(e);\n\t\t\tif (e.type === 'scrollbottom') {\n\t\t\t\tif (e.target === this.scroller) {\n\t\t\t\t\tthis._scrollbottom();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t_scrollbottom: function() {\n\t\t\tif (!this.pulldown && !this.loading) {\n\t\t\t\tthis.pulldown = false;\n\t\t\t\tthis._initPullupRefresh();\n\t\t\t\tthis.pullupLoading();\n\t\t\t}\n\t\t},\n\t\t_start: function(e) {\n\t\t\t//仅下拉刷新在start阻止默认事件\n\t\t\tif (e.touches && e.touches.length && e.touches[0].clientX > 30) {\n\t\t\t\te.target && !this._preventDefaultException(e.target, this.options.preventDefaultException) && e.preventDefault();\n\t\t\t}\n\t\t\tif (!this.loading) {\n\t\t\t\tthis.pulldown = this.pullPocket = this.pullCaption = this.pullLoading = false\n\t\t\t}\n\t\t\tthis._super(e);\n\t\t},\n\t\t_drag: function(e) {\n\t\t\tthis._super(e);\n\t\t\tif (!this.pulldown && !this.loading && this.topPocket && e.detail.direction === 'down' && this.y >= 0) {\n\t\t\t\tthis._initPulldownRefresh();\n\t\t\t}\n\t\t\tif (this.pulldown) {\n\t\t\t\tthis._setCaption(this.y > this.options.down.height ? this.options.down.contentover : this.options.down.contentdown);\n\t\t\t}\n\t\t},\n\n\t\t_reLayout: function() {\n\t\t\tthis.hasVerticalScroll = true;\n\t\t\tthis._super();\n\t\t},\n\t\t//API\n\t\tresetPosition: function(time) {\n\t\t\tif (this.pulldown) {\n\t\t\t\tif (this.y >= this.options.down.height) {\n\t\t\t\t\tthis.pulldownLoading(undefined, time || 0);\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\t!this.loading && this.topPocket.classList.remove(CLASS_VISIBILITY);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this._super(time);\n\t\t},\n\t\tpulldownLoading: function(y, time) {\n\t\t\ttypeof y === 'undefined' && (y = this.options.down.height); //默认高度\n\t\t\tthis.scrollTo(0, y, time, this.options.bounceEasing);\n\t\t\tif (this.loading) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t//\t\t\tif (!this.pulldown) {\n\t\t\tthis._initPulldownRefresh();\n\t\t\t//\t\t\t}\n\t\t\tthis._setCaption(this.options.down.contentrefresh);\n\t\t\tthis.loading = true;\n\t\t\tthis.indicators.map(function(indicator) {\n\t\t\t\tindicator.fade(0);\n\t\t\t});\n\t\t\tvar callback = this.options.down.callback;\n\t\t\tcallback && callback.call(this);\n\t\t},\n\t\tendPulldownToRefresh: function() {\n\t\t\tvar self = this;\n\t\t\tif (self.topPocket && self.loading && this.pulldown) {\n\t\t\t\tself.scrollTo(0, 0, self.options.bounceTime, self.options.bounceEasing);\n\t\t\t\tself.loading = false;\n\t\t\t\tself._setCaption(self.options.down.contentdown, true);\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tself.loading || self.topPocket.classList.remove(CLASS_VISIBILITY);\n\t\t\t\t}, 350);\n\t\t\t}\n\t\t},\n\t\tpullupLoading: function(callback, x, time) {\n\t\t\tx = x || 0;\n\t\t\tthis.scrollTo(x, this.maxScrollY, time, this.options.bounceEasing);\n\t\t\tif (this.loading) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._initPullupRefresh();\n\t\t\tthis._setCaption(this.options.up.contentrefresh);\n\t\t\tthis.indicators.map(function(indicator) {\n\t\t\t\tindicator.fade(0);\n\t\t\t});\n\t\t\tthis.loading = true;\n\t\t\tcallback = callback || this.options.up.callback;\n\t\t\tcallback && callback.call(this);\n\t\t},\n\t\tendPullupToRefresh: function(finished) {\n\t\t\tvar self = this;\n\t\t\tif (self.bottomPocket) { // && self.loading && !this.pulldown\n\t\t\t\tself.loading = false;\n\t\t\t\tif (finished) {\n\t\t\t\t\tthis.finished = true;\n\t\t\t\t\tself._setCaption(self.options.up.contentnomore);\n\t\t\t\t\t//\t\t\t\t\tself.bottomPocket.classList.remove(CLASS_VISIBILITY);\n\t\t\t\t\t//\t\t\t\t\tself.bottomPocket.classList.add(CLASS_HIDDEN);\n\t\t\t\t\tself.wrapper.removeEventListener('scrollbottom', self);\n\t\t\t\t} else {\n\t\t\t\t\tself._setCaption(self.options.up.contentdown);\n\t\t\t\t\t//\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tself.loading || self.bottomPocket.classList.remove(CLASS_VISIBILITY);\n\t\t\t\t\t//\t\t\t\t\t}, 300);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tdisablePullupToRefresh: function() {\n\t\t\tthis._initPullupRefresh();\n\t\t\tthis.bottomPocket.className = 'mui-pull-bottom-pocket' + ' ' + CLASS_HIDDEN;\n\t\t\tthis.wrapper.removeEventListener('scrollbottom', this);\n\t\t},\n\t\tenablePullupToRefresh: function() {\n\t\t\tthis._initPullupRefresh();\n\t\t\tthis.bottomPocket.classList.remove(CLASS_HIDDEN);\n\t\t\tthis._setCaption(this.options.up.contentdown);\n\t\t\tthis.wrapper.addEventListener('scrollbottom', this);\n\t\t},\n\t\trefresh: function(isReset) {\n\t\t\tif (isReset && this.finished) {\n\t\t\t\tthis.enablePullupToRefresh();\n\t\t\t\tthis.finished = false;\n\t\t\t}\n\t\t\tthis._super();\n\t\t},\n\t}, $.PullRefresh));\n\t$.fn.pullRefresh = function(options) {\n\t\tif (this.length === 1) {\n\t\t\tvar self = this[0];\n\t\t\tvar pullRefreshApi = null;\n\t\t\tvar id = self.getAttribute('data-pullrefresh');\n\t\t\tif (!id && typeof options === 'undefined') {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\toptions = options || {};\n\t\t\tif (!id) {\n\t\t\t\tid = ++$.uuid;\n\t\t\t\t$.data[id] = pullRefreshApi = new PullRefresh(self, options);\n\t\t\t\tself.setAttribute('data-pullrefresh', id);\n\t\t\t} else {\n\t\t\t\tpullRefreshApi = $.data[id];\n\t\t\t}\n\t\t\tif (options.down && options.down.auto) { //如果设置了auto，则自动下拉一次\n\t\t\t\tpullRefreshApi.pulldownLoading(options.down.autoY);\n\t\t\t} else if (options.up && options.up.auto) { //如果设置了auto，则自动上拉一次\n\t\t\t\tpullRefreshApi.pullupLoading();\n\t\t\t}\n\t\t\t//暂不提供这种调用方式吧\n\t\t\t//\t\t\tif (typeof options === 'string') {\n\t\t\t//\t\t\t\tvar methodValue = pullRefreshApi[options].apply(pullRefreshApi, $.slice.call(arguments, 1));\n\t\t\t//\t\t\t\tif (methodValue !== undefined) {\n\t\t\t//\t\t\t\t\treturn methodValue;\n\t\t\t//\t\t\t\t}\n\t\t\t//\t\t\t}\n\t\t\treturn pullRefreshApi;\n\t\t}\n\t};\n})(mui, window, document);\n/**\n * snap 重构\n * @param {Object} $\n * @param {Object} window\n */\n(function($, window) {\n\tvar CLASS_SLIDER = 'mui-slider';\n\tvar CLASS_SLIDER_GROUP = 'mui-slider-group';\n\tvar CLASS_SLIDER_LOOP = 'mui-slider-loop';\n\tvar CLASS_SLIDER_INDICATOR = 'mui-slider-indicator';\n\tvar CLASS_ACTION_PREVIOUS = 'mui-action-previous';\n\tvar CLASS_ACTION_NEXT = 'mui-action-next';\n\tvar CLASS_SLIDER_ITEM = 'mui-slider-item';\n\n\tvar CLASS_ACTIVE = 'mui-active';\n\n\tvar SELECTOR_SLIDER_ITEM = '.' + CLASS_SLIDER_ITEM;\n\tvar SELECTOR_SLIDER_INDICATOR = '.' + CLASS_SLIDER_INDICATOR;\n\tvar SELECTOR_SLIDER_PROGRESS_BAR = '.mui-slider-progress-bar';\n\n\tvar Slider = $.Slider = $.Scroll.extend({\n\t\tinit: function(element, options) {\n\t\t\tthis._super(element, $.extend(true, {\n\t\t\t\tfingers: 1,\n\t\t\t\tinterval: 0, //设置为0，则不定时轮播\n\t\t\t\tscrollY: false,\n\t\t\t\tscrollX: true,\n\t\t\t\tindicators: false,\n\t\t\t\tscrollTime: 1000,\n\t\t\t\tstartX: false,\n\t\t\t\tslideTime: 0, //滑动动画时间\n\t\t\t\tsnap: SELECTOR_SLIDER_ITEM\n\t\t\t}, options));\n\t\t\tif (this.options.startX) {\n\t\t\t\t//\t\t\t\t$.trigger(this.wrapper, 'scrollend', this);\n\t\t\t}\n\t\t},\n\t\t_init: function() {\n\t\t\tthis._reInit();\n\t\t\tif (this.scroller) {\n\t\t\t\tthis.scrollerStyle = this.scroller.style;\n\t\t\t\tthis.progressBar = this.wrapper.querySelector(SELECTOR_SLIDER_PROGRESS_BAR);\n\t\t\t\tif (this.progressBar) {\n\t\t\t\t\tthis.progressBarWidth = this.progressBar.offsetWidth;\n\t\t\t\t\tthis.progressBarStyle = this.progressBar.style;\n\t\t\t\t}\n\t\t\t\t//忘记这个代码是干什么的了？\n\t\t\t\t//\t\t\t\tthis.x = this._getScroll();\n\t\t\t\t//\t\t\t\tif (this.options.startX === false) {\n\t\t\t\t//\t\t\t\t\tthis.options.startX = this.x;\n\t\t\t\t//\t\t\t\t}\n\t\t\t\t//根据active修正startX\n\n\t\t\t\tthis._super();\n\t\t\t\tthis._initTimer();\n\t\t\t}\n\t\t},\n\t\t_triggerSlide: function() {\n\t\t\tvar self = this;\n\t\t\tself.isInTransition = false;\n\t\t\tvar page = self.currentPage;\n\t\t\tself.slideNumber = self._fixedSlideNumber();\n\t\t\tif (self.loop) {\n\t\t\t\tif (self.slideNumber === 0) {\n\t\t\t\t\tself.setTranslate(self.pages[1][0].x, 0);\n\t\t\t\t} else if (self.slideNumber === self.itemLength - 3) {\n\t\t\t\t\tself.setTranslate(self.pages[self.itemLength - 2][0].x, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (self.lastSlideNumber != self.slideNumber) {\n\t\t\t\tself.lastSlideNumber = self.slideNumber;\n\t\t\t\tself.lastPage = self.currentPage;\n\t\t\t\t$.trigger(self.wrapper, 'slide', {\n\t\t\t\t\tslideNumber: self.slideNumber\n\t\t\t\t});\n\t\t\t}\n\t\t\tself._initTimer();\n\t\t},\n\t\t_handleSlide: function(e) {\n\t\t\tvar self = this;\n\t\t\tif (e.target !== self.wrapper) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar detail = e.detail;\n\t\t\tdetail.slideNumber = detail.slideNumber || 0;\n\t\t\tvar temps = self.scroller.querySelectorAll(SELECTOR_SLIDER_ITEM);\n\t\t\tvar items = [];\n\t\t\tfor (var i = 0, len = temps.length; i < len; i++) {\n\t\t\t\tvar item = temps[i];\n\t\t\t\tif (item.parentNode === self.scroller) {\n\t\t\t\t\titems.push(item);\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar _slideNumber = detail.slideNumber;\n\t\t\tif (self.loop) {\n\t\t\t\t_slideNumber += 1;\n\t\t\t}\n\t\t\tif (!self.wrapper.classList.contains('mui-segmented-control')) {\n\t\t\t\tfor (var i = 0, len = items.length; i < len; i++) {\n\t\t\t\t\tvar item = items[i];\n\t\t\t\t\tif (item.parentNode === self.scroller) {\n\t\t\t\t\t\tif (i === _slideNumber) {\n\t\t\t\t\t\t\titem.classList.add(CLASS_ACTIVE);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\titem.classList.remove(CLASS_ACTIVE);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar indicatorWrap = self.wrapper.querySelector('.mui-slider-indicator');\n\t\t\tif (indicatorWrap) {\n\t\t\t\tif (indicatorWrap.getAttribute('data-scroll')) { //scroll\n\t\t\t\t\t$(indicatorWrap).scroll().gotoPage(detail.slideNumber);\n\t\t\t\t}\n\t\t\t\tvar indicators = indicatorWrap.querySelectorAll('.mui-indicator');\n\t\t\t\tif (indicators.length > 0) { //图片轮播\n\t\t\t\t\tfor (var i = 0, len = indicators.length; i < len; i++) {\n\t\t\t\t\t\tindicators[i].classList[i === detail.slideNumber ? 'add' : 'remove'](CLASS_ACTIVE);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvar number = indicatorWrap.querySelector('.mui-number span');\n\t\t\t\t\tif (number) { //图文表格\n\t\t\t\t\t\tnumber.innerText = (detail.slideNumber + 1);\n\t\t\t\t\t} else { //segmented controls\n\t\t\t\t\t\tvar controlItems = indicatorWrap.querySelectorAll('.mui-control-item');\n\t\t\t\t\t\tfor (var i = 0, len = controlItems.length; i < len; i++) {\n\t\t\t\t\t\t\tcontrolItems[i].classList[i === detail.slideNumber ? 'add' : 'remove'](CLASS_ACTIVE);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\te.stopPropagation();\n\t\t},\n\t\t_handleTabShow: function(e) {\n\t\t\tvar self = this;\n\t\t\tself.gotoItem((e.detail.tabNumber || 0), self.options.slideTime);\n\t\t},\n\t\t_handleIndicatorTap: function(event) {\n\t\t\tvar self = this;\n\t\t\tvar target = event.target;\n\t\t\tif (target.classList.contains(CLASS_ACTION_PREVIOUS) || target.classList.contains(CLASS_ACTION_NEXT)) {\n\t\t\t\tself[target.classList.contains(CLASS_ACTION_PREVIOUS) ? 'prevItem' : 'nextItem']();\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t},\n\t\t_initEvent: function(detach) {\n\t\t\tvar self = this;\n\t\t\tself._super(detach);\n\t\t\tvar action = detach ? 'removeEventListener' : 'addEventListener';\n\t\t\tself.wrapper[action]('slide', this);\n\t\t\tself.wrapper[action]($.eventName('shown', 'tab'), this);\n\t\t},\n\t\thandleEvent: function(e) {\n\t\t\tthis._super(e);\n\t\t\tswitch (e.type) {\n\t\t\t\tcase 'slide':\n\t\t\t\t\tthis._handleSlide(e);\n\t\t\t\t\tbreak;\n\t\t\t\tcase $.eventName('shown', 'tab'):\n\t\t\t\t\tif (~this.snaps.indexOf(e.target)) { //避免嵌套监听错误的tab show\n\t\t\t\t\t\tthis._handleTabShow(e);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\t\t_scrollend: function(e) {\n\t\t\tthis._super(e);\n\t\t\tthis._triggerSlide(e);\n\t\t},\n\t\t_drag: function(e) {\n\t\t\tthis._super(e);\n\t\t\tvar direction = e.detail.direction;\n\t\t\tif (direction === 'left' || direction === 'right') {\n\t\t\t\t//拖拽期间取消定时\n\t\t\t\tvar slidershowTimer = this.wrapper.getAttribute('data-slidershowTimer');\n\t\t\t\tslidershowTimer && window.clearTimeout(slidershowTimer);\n\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t},\n\t\t_initTimer: function() {\n\t\t\tvar self = this;\n\t\t\tvar slider = self.wrapper;\n\t\t\tvar interval = self.options.interval;\n\t\t\tvar slidershowTimer = slider.getAttribute('data-slidershowTimer');\n\t\t\tslidershowTimer && window.clearTimeout(slidershowTimer);\n\t\t\tif (interval) {\n\t\t\t\tslidershowTimer = window.setTimeout(function() {\n\t\t\t\t\tif (!slider) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t//仅slider显示状态进行自动轮播\n\t\t\t\t\tif (!!(slider.offsetWidth || slider.offsetHeight)) {\n\t\t\t\t\t\tself.nextItem(true);\n\t\t\t\t\t\t//下一个\n\t\t\t\t\t}\n\t\t\t\t\tself._initTimer();\n\t\t\t\t}, interval);\n\t\t\t\tslider.setAttribute('data-slidershowTimer', slidershowTimer);\n\t\t\t}\n\t\t},\n\n\t\t_fixedSlideNumber: function(page) {\n\t\t\tpage = page || this.currentPage;\n\t\t\tvar slideNumber = page.pageX;\n\t\t\tif (this.loop) {\n\t\t\t\tif (page.pageX === 0) {\n\t\t\t\t\tslideNumber = this.itemLength - 3;\n\t\t\t\t} else if (page.pageX === (this.itemLength - 1)) {\n\t\t\t\t\tslideNumber = 0;\n\t\t\t\t} else {\n\t\t\t\t\tslideNumber = page.pageX - 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn slideNumber;\n\t\t},\n\t\t_reLayout: function() {\n\t\t\tthis.hasHorizontalScroll = true;\n\t\t\tthis.loop = this.scroller.classList.contains(CLASS_SLIDER_LOOP);\n\t\t\tthis._super();\n\t\t},\n\t\t_getScroll: function() {\n\t\t\tvar result = $.parseTranslateMatrix($.getStyles(this.scroller, 'webkitTransform'));\n\t\t\treturn result ? result.x : 0;\n\t\t},\n\t\t_transitionEnd: function(e) {\n\t\t\tif (e.target !== this.scroller || !this.isInTransition) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._transitionTime();\n\t\t\tthis.isInTransition = false;\n\t\t\t$.trigger(this.wrapper, 'scrollend', this);\n\t\t},\n\t\t_flick: function(e) {\n\t\t\tif (!this.moved) { //无moved\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar detail = e.detail;\n\t\t\tvar direction = detail.direction;\n\t\t\tthis._clearRequestAnimationFrame();\n\t\t\tthis.isInTransition = true;\n\t\t\t//\t\t\tif (direction === 'up' || direction === 'down') {\n\t\t\t//\t\t\t\tthis.resetPosition(this.options.bounceTime);\n\t\t\t//\t\t\t\treturn;\n\t\t\t//\t\t\t}\n\t\t\tif (e.type === 'flick') {\n\t\t\t\tif (detail.deltaTime < 200) { //flick，太容易触发，额外校验一下deltaTime\n\t\t\t\t\tthis.x = this._getPage((this.slideNumber + (direction === 'right' ? -1 : 1)), true).x;\n\t\t\t\t}\n\t\t\t\tthis.resetPosition(this.options.bounceTime);\n\t\t\t} else if (e.type === 'dragend' && !detail.flick) {\n\t\t\t\tthis.resetPosition(this.options.bounceTime);\n\t\t\t}\n\t\t\te.stopPropagation();\n\t\t},\n\t\t_initSnap: function() {\n\t\t\tthis.scrollerWidth = this.itemLength * this.scrollerWidth;\n\t\t\tthis.maxScrollX = Math.min(this.wrapperWidth - this.scrollerWidth, 0);\n\t\t\tthis._super();\n\t\t\tif (!this.currentPage.x) {\n\t\t\t\t//当slider处于隐藏状态时，导致snap计算是错误的，临时先这么判断一下，后续要考虑解决所有scroll在隐藏状态下初始化属性不正确的问题\n\t\t\t\tvar currentPage = this.pages[this.loop ? 1 : 0];\n\t\t\t\tcurrentPage = currentPage || this.pages[0];\n\t\t\t\tif (!currentPage) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.currentPage = currentPage[0];\n\t\t\t\tthis.slideNumber = 0;\n\t\t\t\tthis.lastSlideNumber = typeof this.lastSlideNumber === 'undefined' ? 0 : this.lastSlideNumber;\n\t\t\t} else {\n\t\t\t\tthis.slideNumber = this._fixedSlideNumber();\n\t\t\t\tthis.lastSlideNumber = typeof this.lastSlideNumber === 'undefined' ? this.slideNumber : this.lastSlideNumber;\n\t\t\t}\n\t\t\tthis.options.startX = this.currentPage.x || 0;\n\t\t},\n\t\t_getSnapX: function(offsetLeft) {\n\t\t\treturn Math.max(-offsetLeft, this.maxScrollX);\n\t\t},\n\t\t_getPage: function(slideNumber, isFlick) {\n\t\t\tif (this.loop) {\n\t\t\t\tif (slideNumber > (this.itemLength - (isFlick ? 2 : 3))) {\n\t\t\t\t\tslideNumber = 1;\n\t\t\t\t\ttime = 0;\n\t\t\t\t} else if (slideNumber < (isFlick ? -1 : 0)) {\n\t\t\t\t\tslideNumber = this.itemLength - 2;\n\t\t\t\t\ttime = 0;\n\t\t\t\t} else {\n\t\t\t\t\tslideNumber += 1;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (!isFlick) {\n\t\t\t\t\tif (slideNumber > (this.itemLength - 1)) {\n\t\t\t\t\t\tslideNumber = 0;\n\t\t\t\t\t\ttime = 0;\n\t\t\t\t\t} else if (slideNumber < 0) {\n\t\t\t\t\t\tslideNumber = this.itemLength - 1;\n\t\t\t\t\t\ttime = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tslideNumber = Math.min(Math.max(0, slideNumber), this.itemLength - 1);\n\t\t\t}\n\t\t\treturn this.pages[slideNumber][0];\n\t\t},\n\t\t_gotoItem: function(slideNumber, time) {\n\t\t\tthis.currentPage = this._getPage(slideNumber, true); //此处传true。可保证程序切换时，动画与人手操作一致(第一张，最后一张的切换动画)\n\t\t\tthis.scrollTo(this.currentPage.x, 0, time, this.options.scrollEasing);\n\t\t\tif (time === 0) {\n\t\t\t\t$.trigger(this.wrapper, 'scrollend', this);\n\t\t\t}\n\t\t},\n\t\t//API\n\t\tsetTranslate: function(x, y) {\n\t\t\tthis._super(x, y);\n\t\t\tvar progressBar = this.progressBar;\n\t\t\tif (progressBar) {\n\t\t\t\tthis.progressBarStyle.webkitTransform = this._getTranslateStr((-x * (this.progressBarWidth / this.wrapperWidth)), 0);\n\t\t\t}\n\t\t},\n\t\tresetPosition: function(time) {\n\t\t\ttime = time || 0;\n\t\t\tif (this.x > 0) {\n\t\t\t\tthis.x = 0;\n\t\t\t} else if (this.x < this.maxScrollX) {\n\t\t\t\tthis.x = this.maxScrollX;\n\t\t\t}\n\t\t\tthis.currentPage = this._nearestSnap(this.x);\n\t\t\tthis.scrollTo(this.currentPage.x, 0, time, this.options.scrollEasing);\n\t\t\treturn true;\n\t\t},\n\t\tgotoItem: function(slideNumber, time) {\n\t\t\tthis._gotoItem(slideNumber, typeof time === 'undefined' ? this.options.scrollTime : time);\n\t\t},\n\t\tnextItem: function() {\n\t\t\tthis._gotoItem(this.slideNumber + 1, this.options.scrollTime);\n\t\t},\n\t\tprevItem: function() {\n\t\t\tthis._gotoItem(this.slideNumber - 1, this.options.scrollTime);\n\t\t},\n\t\tgetSlideNumber: function() {\n\t\t\treturn this.slideNumber || 0;\n\t\t},\n\t\t_reInit: function() {\n\t\t\tvar groups = this.wrapper.querySelectorAll('.' + CLASS_SLIDER_GROUP);\n\t\t\tfor (var i = 0, len = groups.length; i < len; i++) {\n\t\t\t\tif (groups[i].parentNode === this.wrapper) {\n\t\t\t\t\tthis.scroller = groups[i];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.scrollerStyle = this.scroller && this.scroller.style;\n\t\t\tif (this.progressBar) {\n\t\t\t\tthis.progressBarWidth = this.progressBar.offsetWidth;\n\t\t\t\tthis.progressBarStyle = this.progressBar.style;\n\t\t\t}\n\t\t},\n\t\trefresh: function(options) {\n\t\t\tif (options) {\n\t\t\t\t$.extend(this.options, options);\n\t\t\t\tthis._super();\n\t\t\t\tthis._initTimer();\n\t\t\t} else {\n\t\t\t\tthis._super();\n\t\t\t}\n\t\t},\n\t\tdestroy: function() {\n\t\t\tthis._initEvent(true); //detach\n\t\t\tdelete $.data[this.wrapper.getAttribute('data-slider')];\n\t\t\tthis.wrapper.setAttribute('data-slider', '');\n\t\t}\n\t});\n\t$.fn.slider = function(options) {\n\t\tvar slider = null;\n\t\tthis.each(function() {\n\t\t\tvar sliderElement = this;\n\t\t\tif (!this.classList.contains(CLASS_SLIDER)) {\n\t\t\t\tsliderElement = this.querySelector('.' + CLASS_SLIDER);\n\t\t\t}\n\t\t\tif (sliderElement && sliderElement.querySelector(SELECTOR_SLIDER_ITEM)) {\n\t\t\t\tvar id = sliderElement.getAttribute('data-slider');\n\t\t\t\tif (!id) {\n\t\t\t\t\tid = ++$.uuid;\n\t\t\t\t\t$.data[id] = slider = new Slider(sliderElement, options);\n\t\t\t\t\tsliderElement.setAttribute('data-slider', id);\n\t\t\t\t} else {\n\t\t\t\t\tslider = $.data[id];\n\t\t\t\t\tif (slider && options) {\n\t\t\t\t\t\tslider.refresh(options);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn slider;\n\t};\n\t$.ready(function() {\n\t\t//\t\tsetTimeout(function() {\n\t\t$('.mui-slider').slider();\n\t\t$('.mui-scroll-wrapper.mui-slider-indicator.mui-segmented-control').scroll({\n\t\t\tscrollY: false,\n\t\t\tscrollX: true,\n\t\t\tindicators: false,\n\t\t\tsnap: '.mui-control-item'\n\t\t});\n\t\t//\t\t}, 500); //临时处理slider宽度计算不正确的问题(初步确认是scrollbar导致的)\n\n\t});\n})(mui, window);\n/**\n * pullRefresh 5+\n * @param {type} $\n * @returns {undefined}\n */\n(function($, document) {\n    if (!($.os.plus)) { //仅在5+android支持多webview的使用\n        return;\n    }\n    $.plusReady(function() {\n        if (window.__NWin_Enable__ === false) { //不支持多webview，则不用5+下拉刷新\n            return;\n        }\n        var CLASS_PLUS_PULLREFRESH = 'mui-plus-pullrefresh';\n        var CLASS_VISIBILITY = 'mui-visibility';\n        var CLASS_HIDDEN = 'mui-hidden';\n        var CLASS_BLOCK = 'mui-block';\n\n        var CLASS_PULL_CAPTION = 'mui-pull-caption';\n        var CLASS_PULL_CAPTION_DOWN = 'mui-pull-caption-down';\n        var CLASS_PULL_CAPTION_REFRESH = 'mui-pull-caption-refresh';\n        var CLASS_PULL_CAPTION_NOMORE = 'mui-pull-caption-nomore';\n\n        var PlusPullRefresh = $.Class.extend({\n            init: function(element, options) {\n                this.element = element;\n                this.options = options;\n                this.wrapper = this.scroller = element;\n                this._init();\n                this._initPulldownRefreshEvent();\n            },\n            _init: function() {\n                var self = this;\n                //document.addEventListener('plusscrollbottom', this);\n                window.addEventListener('dragup', self);\n                document.addEventListener(\"plusscrollbottom\", self);\n                self.scrollInterval = window.setInterval(function() {\n                    if (self.isScroll && !self.loading) {\n                        if (window.pageYOffset + window.innerHeight + 10 >= document.documentElement.scrollHeight) {\n                            self.isScroll = false; //放在这里是因为快速滚动的话，有可能检测时，还没到底，所以只要有滚动，没到底之前一直检测高度变化\n                            if (self.bottomPocket) {\n                                self.pullupLoading();\n                            }\n                        }\n                    }\n                }, 100);\n            },\n            _initPulldownRefreshEvent: function() {\n                var self = this;\n                $.plusReady(function() {\n                \t\tif(self.options.down.style == \"circle\"){\n\t                \t\t//单webview、原生转圈\n\t                \t\tself.options.webview = plus.webview.currentWebview();\n\t\t\t\t\t\tself.options.webview.setPullToRefresh({\n\t\t\t\t\t\t\tsupport: true,\n\t\t\t\t\t\t\tcolor:self.options.down.color || '#2BD009',\n\t\t\t\t\t\t\theight: self.options.down.height || '50px',\n\t\t\t\t\t\t\trange: self.options.down.range || '100px',\n\t\t\t\t\t\t\tstyle: 'circle',\n\t\t\t\t\t\t\toffset: self.options.down.offset || '0px'\n\t\t\t\t\t\t}, function() {\n\t\t\t\t\t\t\tself.options.down.callback();\n\t\t\t\t\t\t});\n\t               }else if (self.topPocket && self.options.webviewId) {\n                        var webview = plus.webview.getWebviewById(self.options.webviewId);//子窗口\n                        if (!webview) {\n                            return;\n                        }\n                        self.options.webview = webview;\n                        var downOptions = self.options.down;\n                        var height = downOptions.height;\n                        webview.addEventListener('close', function() {\n                            var attrWebviewId = self.options.webviewId && self.options.webviewId.replace(/\\//g, \"_\"); //替换所有\"/\"\n                            self.element.removeAttribute('data-pullrefresh-plus-' + attrWebviewId);\n                        });\n                        webview.addEventListener(\"dragBounce\", function(e) {\n                            if (!self.pulldown) {\n                                self._initPulldownRefresh();\n                            } else {\n                                self.pullPocket.classList.add(CLASS_BLOCK);\n                            }\n                            switch (e.status) {\n                                case \"beforeChangeOffset\": //下拉可刷新状态\n                                    self._setCaption(downOptions.contentdown);\n                                    break;\n                                case \"afterChangeOffset\": //松开可刷新状态\n                                    self._setCaption(downOptions.contentover);\n                                    break;\n                                case \"dragEndAfterChangeOffset\": //正在刷新状态\n                                    //执行下拉刷新所在webview的回调函数\n                                    webview.evalJS(\"window.mui&&mui.options.pullRefresh.down.callback()\");\n                                    self._setCaption(downOptions.contentrefresh);\n                                    break;\n                                default:\n                                    break;\n                            }\n                        }, false);\n\n                        webview.setBounce({\n                            position: {\n                                top: height * 2 + 'px'\n                            },\n                            changeoffset: {\n                                top: height + 'px'\n                            }\n                        });\n\n\t                }\n                });\n            },\n            handleEvent: function(e) {\n                var self = this;\n                if (self.stopped) {\n                    return;\n                }\n                self.isScroll = false;\n                if (e.type === 'dragup' || e.type === 'plusscrollbottom') {\n                    self.isScroll = true;\n                    setTimeout(function() {\n                        self.isScroll = false;\n                    }, 1000);\n                }\n            }\n        }).extend($.extend({\n            setStopped: function(stopped) { //该方法是子页面调用的\n                this.stopped = !!stopped;\n                //TODO 此处需要设置当前webview的bounce为none,目前5+有BUG\n                var webview = plus.webview.currentWebview();\n                if (this.stopped) {\n                    webview.setStyle({\n                        bounce: 'none'\n                    });\n                    webview.setBounce({\n                        position: {\n                            top: 'none'\n                        }\n                    });\n                } else {\n                    var height = this.options.down.height;\n                    webview.setStyle({\n                        bounce: 'vertical'\n                    });\n                    webview.setBounce({\n                        position: {\n                            top: height * 2 + 'px'\n                        },\n                        changeoffset: {\n                            top: height + 'px'\n                        }\n                    });\n                }\n            },\n            beginPulldown:function() {\n                $.plusReady(function() {\n                \t\tvar _wv = plus.webview.currentWebview();\n                \t\tvar self = this;\n                \t\t//这里延时的目的是为了保证下拉刷新组件初始化完成，后续应该做成有状态的\n                \t\tsetTimeout(function () {\n                \t\t\tif(self.options.down.style == \"circle\"){\n\t                \t\t\t_wv.beginPullToRefresh();\n\t                \t\t}else{\n\t                \t\t\t_wv.setBounce({\n\t\t                        offset: {\n\t\t                            top: this.options.down.height + \"px\"\n\t\t                        }\n\t\t                    });\n\t                \t\t}\n                \t\t},15);\n                }.bind(this));\n            },\n            pulldownLoading: function () {//该方法是子页面调用的，兼容老的历史API\n            \t\tthis.beginPulldown();\n            },\n            _pulldownLoading: function() { //该方法是父页面调用的\n                var self = this;\n                $.plusReady(function() {\n                    var childWebview = plus.webview.getWebviewById(self.options.webviewId);\n                   \tchildWebview && childWebview.setBounce({\n                        offset: {\n                            top: self.options.down.height + \"px\"\n                        }\n                    });\n                });\n            },\n            endPulldown:function(){\n            \t\tvar _wv = this.options.webview;\n                _wv.endPullToRefresh();\n                //双webview的下拉刷新，需要修改父窗口提示信息\n                if(_wv.parent() && this.options.down.style !== \"circle\"){\n\t                \t_wv.parent().evalJS(\"mui&&mui(document.querySelector('.mui-content')).pullRefresh('\" + JSON.stringify({\n\t                    webviewId: _wv.id\n\t                }) + \"')._endPulldownToRefresh()\");\n                }\n            },\n            endPulldownToRefresh: function () {//该方法是子页面调用的，兼容老的历史API\n           \t \tthis.endPulldown();\n            },\n            _endPulldownToRefresh: function() { //该方法是父页面调用的\n                var self = this;\n                if (self.topPocket && self.options.webview) {\n                    //self.options.webview.endPullToRefresh(); //下拉刷新所在webview回弹\n                    self.loading = false;\n                    self._setCaption(self.options.down.contentdown, true);\n                    setTimeout(function() {\n                        self.loading || self.topPocket.classList.remove(CLASS_BLOCK);\n                    }, 350);\n                }\n            },\n            beginPullup:function(callback) {//开始上拉加载\n                var self = this;\n                if (self.isLoading) return;\n                self.isLoading = true;\n                if (self.pulldown !== false) {\n                    self._initPullupRefresh();\n                } else {\n                    this.pullPocket.classList.add(CLASS_BLOCK);\n                }\n                setTimeout(function() {\n                    self.pullLoading.classList.add(CLASS_VISIBILITY);\n                    self.pullLoading.classList.remove(CLASS_HIDDEN);\n                    self.pullCaption.innerHTML = ''; //修正5+里边第一次加载时，文字显示的bug(还会显示出来个“多”,猜测应该是渲染问题导致的)\n                    self.pullCaption.className = CLASS_PULL_CAPTION + ' ' + CLASS_PULL_CAPTION_REFRESH;\n                    self.pullCaption.innerHTML = self.options.up.contentrefresh;\n                    callback = callback || self.options.up.callback;\n                    callback && callback.call(self);\n                }, 300);\n            },\n            pullupLoading:function (callback) {//兼容老的API\n            \t\tthis.beginPullup(callback);\n            },\n            endPullup:function(finished) {//上拉加载结束\n                var self = this;\n                if (self.pullLoading) {\n                    self.pullLoading.classList.remove(CLASS_VISIBILITY);\n                    self.pullLoading.classList.add(CLASS_HIDDEN);\n                    self.isLoading = false;\n                    if (finished) {\n                        self.finished = true;\n                        self.pullCaption.className = CLASS_PULL_CAPTION + ' ' + CLASS_PULL_CAPTION_NOMORE;\n                        self.pullCaption.innerHTML = self.options.up.contentnomore;\n                        //取消5+的plusscrollbottom事件\n                        document.removeEventListener('plusscrollbottom', self);\n                        window.removeEventListener('dragup', self);\n                    } else { //初始化时隐藏，后续不再隐藏\n                        self.pullCaption.className = CLASS_PULL_CAPTION + ' ' + CLASS_PULL_CAPTION_DOWN;\n                        self.pullCaption.innerHTML = self.options.up.contentdown;\n                    }\n                }\n            },\n            endPullupToRefresh: function (finished) {//上拉加载结束，兼容老的API\n            \t\tthis.endPullup(finished);\n            },\n            disablePullupToRefresh: function() {\n                this._initPullupRefresh();\n                this.bottomPocket.className = 'mui-pull-bottom-pocket' + ' ' + CLASS_HIDDEN;\n                window.removeEventListener('dragup', this);\n            },\n            enablePullupToRefresh: function() {\n                this._initPullupRefresh();\n                this.bottomPocket.classList.remove(CLASS_HIDDEN);\n                this.pullCaption.className = CLASS_PULL_CAPTION + ' ' + CLASS_PULL_CAPTION_DOWN;\n                this.pullCaption.innerHTML = this.options.up.contentdown;\n                document.addEventListener(\"plusscrollbottom\", this);\n                window.addEventListener('dragup', this);\n            },\n            scrollTo: function(x, y, time) {\n                $.scrollTo(y, time);\n            },\n            scrollToBottom: function(time) {\n                $.scrollTo(document.documentElement.scrollHeight, time);\n            },\n            refresh: function(isReset) {\n                if (isReset && this.finished) {\n                    this.enablePullupToRefresh();\n                    this.finished = false;\n                }\n            }\n        }, $.PullRefresh));\n\n        //override h5 pullRefresh\n        $.fn.pullRefresh_native = function(options) {\n            var self;\n            if (this.length === 0) {\n                self = document.createElement('div');\n                self.className = 'mui-content';\n                document.body.appendChild(self);\n            } else {\n                self = this[0];\n            }\n            var args = options;\n            //一个父需要支持多个子下拉刷新\n            options = options || {}\n            if (typeof options === 'string') {\n                options = $.parseJSON(options);\n            };\n            !options.webviewId && (options.webviewId = (plus.webview.currentWebview().id || plus.webview.currentWebview().getURL()));\n            var pullRefreshApi = null;\n            var attrWebviewId = options.webviewId && options.webviewId.replace(/\\//g, \"_\"); //替换所有\"/\"\n            var id = self.getAttribute('data-pullrefresh-plus-' + attrWebviewId);\n            if (!id && typeof args === 'undefined') {\n                return false;\n            }\n            if (!id) { //避免重复初始化5+ pullrefresh\n                id = ++$.uuid;\n                self.setAttribute('data-pullrefresh-plus-' + attrWebviewId, id);\n                document.body.classList.add(CLASS_PLUS_PULLREFRESH);\n                $.data[id] = pullRefreshApi = new PlusPullRefresh(self, options);\n            } else {\n                pullRefreshApi = $.data[id];\n            }\n            if (options.down && options.down.auto) { //如果设置了auto，则自动下拉一次\n                //pullRefreshApi._pulldownLoading(); //parent webview\n                pullRefreshApi.beginPulldown();\n            } else if (options.up && options.up.auto) { //如果设置了auto，则自动上拉一次\n                pullRefreshApi.beginPullup();\n            }\n            return pullRefreshApi;\n        };\n    });\n\n})(mui, document);\n/**\n * off-canvas\n * @param {type} $\n * @param {type} window\n * @param {type} document\n * @param {type} action\n * @returns {undefined}\n */\n(function($, window, document, name) {\n\tvar CLASS_OFF_CANVAS_LEFT = 'mui-off-canvas-left';\n\tvar CLASS_OFF_CANVAS_RIGHT = 'mui-off-canvas-right';\n\tvar CLASS_ACTION_BACKDROP = 'mui-off-canvas-backdrop';\n\tvar CLASS_OFF_CANVAS_WRAP = 'mui-off-canvas-wrap';\n\n\tvar CLASS_SLIDE_IN = 'mui-slide-in';\n\tvar CLASS_ACTIVE = 'mui-active';\n\n\n\tvar CLASS_TRANSITIONING = 'mui-transitioning';\n\n\tvar SELECTOR_INNER_WRAP = '.mui-inner-wrap';\n\n\n\tvar OffCanvas = $.Class.extend({\n\t\tinit: function(element, options) {\n\t\t\tthis.wrapper = this.element = element;\n\t\t\tthis.scroller = this.wrapper.querySelector(SELECTOR_INNER_WRAP);\n\t\t\tthis.classList = this.wrapper.classList;\n\t\t\tif (this.scroller) {\n\t\t\t\tthis.options = $.extend(true, {\n\t\t\t\t\tdragThresholdX: 10,\n\t\t\t\t\tscale: 0.8,\n\t\t\t\t\topacity: 0.1,\n\t\t\t\t\tpreventDefaultException: {\n\t\t\t\t\t\ttagName: /^(INPUT|TEXTAREA|BUTTON|SELECT|VIDEO)$/\n\t\t\t\t\t},\n\t\t\t\t}, options);\n\t\t\t\tdocument.body.classList.add('mui-fullscreen'); //fullscreen\n\t\t\t\tthis.refresh();\n\t\t\t\tthis.initEvent();\n\t\t\t}\n\t\t},\n\t\t_preventDefaultException: function(el, exceptions) {\n\t\t\tfor (var i in exceptions) {\n\t\t\t\tif (exceptions[i].test(el[i])) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\trefresh: function(offCanvas) {\n\t\t\t//\t\t\toffCanvas && !offCanvas.classList.contains(CLASS_ACTIVE) && this.classList.remove(CLASS_ACTIVE);\n\t\t\tthis.slideIn = this.classList.contains(CLASS_SLIDE_IN);\n\t\t\tthis.scalable = this.classList.contains('mui-scalable') && !this.slideIn;\n\t\t\tthis.scroller = this.wrapper.querySelector(SELECTOR_INNER_WRAP);\n\t\t\t//\t\t\t!offCanvas && this.scroller.classList.remove(CLASS_TRANSITIONING);\n\t\t\t//\t\t\t!offCanvas && this.scroller.setAttribute('style', '');\n\t\t\tthis.offCanvasLefts = this.wrapper.querySelectorAll('.' + CLASS_OFF_CANVAS_LEFT);\n\t\t\tthis.offCanvasRights = this.wrapper.querySelectorAll('.' + CLASS_OFF_CANVAS_RIGHT);\n\t\t\tif (offCanvas) {\n\t\t\t\tif (offCanvas.classList.contains(CLASS_OFF_CANVAS_LEFT)) {\n\t\t\t\t\tthis.offCanvasLeft = offCanvas;\n\t\t\t\t} else if (offCanvas.classList.contains(CLASS_OFF_CANVAS_RIGHT)) {\n\t\t\t\t\tthis.offCanvasRight = offCanvas;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.offCanvasRight = this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_RIGHT);\n\t\t\t\tthis.offCanvasLeft = this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_LEFT);\n\t\t\t}\n\t\t\tthis.offCanvasRightWidth = this.offCanvasLeftWidth = 0;\n\t\t\tthis.offCanvasLeftSlideIn = this.offCanvasRightSlideIn = false;\n\t\t\tif (this.offCanvasRight) {\n\t\t\t\tthis.offCanvasRightWidth = this.offCanvasRight.offsetWidth;\n\t\t\t\tthis.offCanvasRightSlideIn = this.slideIn && (this.offCanvasRight.parentNode === this.wrapper);\n\t\t\t\t//\t\t\t\tthis.offCanvasRight.classList.remove(CLASS_TRANSITIONING);\n\t\t\t\t//\t\t\t\tthis.offCanvasRight.classList.remove(CLASS_ACTIVE);\n\t\t\t\t//\t\t\t\tthis.offCanvasRight.setAttribute('style', '');\n\t\t\t}\n\t\t\tif (this.offCanvasLeft) {\n\t\t\t\tthis.offCanvasLeftWidth = this.offCanvasLeft.offsetWidth;\n\t\t\t\tthis.offCanvasLeftSlideIn = this.slideIn && (this.offCanvasLeft.parentNode === this.wrapper);\n\t\t\t\t//\t\t\t\tthis.offCanvasLeft.classList.remove(CLASS_TRANSITIONING);\n\t\t\t\t//\t\t\t\tthis.offCanvasLeft.classList.remove(CLASS_ACTIVE);\n\t\t\t\t//\t\t\t\tthis.offCanvasLeft.setAttribute('style', '');\n\t\t\t}\n\t\t\tthis.backdrop = this.scroller.querySelector('.' + CLASS_ACTION_BACKDROP);\n\n\t\t\tthis.options.dragThresholdX = this.options.dragThresholdX || 10;\n\n\t\t\tthis.visible = false;\n\t\t\tthis.startX = null;\n\t\t\tthis.lastX = null;\n\t\t\tthis.offsetX = null;\n\t\t\tthis.lastTranslateX = null;\n\t\t},\n\t\thandleEvent: function(e) {\n\t\t\tswitch (e.type) {\n\t\t\t\tcase $.EVENT_START:\n\t\t\t\t\te.target && !this._preventDefaultException(e.target, this.options.preventDefaultException) && e.preventDefault();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'webkitTransitionEnd': //有个bug需要处理，需要考虑假设没有触发webkitTransitionEnd的情况\n\t\t\t\t\tif (e.target === this.scroller) {\n\t\t\t\t\t\tthis._dispatchEvent();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'drag':\n\t\t\t\t\tvar detail = e.detail;\n\t\t\t\t\tif (!this.startX) {\n\t\t\t\t\t\tthis.startX = detail.center.x;\n\t\t\t\t\t\tthis.lastX = this.startX;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.lastX = detail.center.x;\n\t\t\t\t\t}\n\t\t\t\t\tif (!this.isDragging && Math.abs(this.lastX - this.startX) > this.options.dragThresholdX && (detail.direction === 'left' || (detail.direction === 'right'))) {\n\t\t\t\t\t\tif (this.slideIn) {\n\t\t\t\t\t\t\tthis.scroller = this.wrapper.querySelector(SELECTOR_INNER_WRAP);\n\t\t\t\t\t\t\tif (this.classList.contains(CLASS_ACTIVE)) {\n\t\t\t\t\t\t\t\tif (this.offCanvasRight && this.offCanvasRight.classList.contains(CLASS_ACTIVE)) {\n\t\t\t\t\t\t\t\t\tthis.offCanvas = this.offCanvasRight;\n\t\t\t\t\t\t\t\t\tthis.offCanvasWidth = this.offCanvasRightWidth;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tthis.offCanvas = this.offCanvasLeft;\n\t\t\t\t\t\t\t\t\tthis.offCanvasWidth = this.offCanvasLeftWidth;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (detail.direction === 'left' && this.offCanvasRight) {\n\t\t\t\t\t\t\t\t\tthis.offCanvas = this.offCanvasRight;\n\t\t\t\t\t\t\t\t\tthis.offCanvasWidth = this.offCanvasRightWidth;\n\t\t\t\t\t\t\t\t} else if (detail.direction === 'right' && this.offCanvasLeft) {\n\t\t\t\t\t\t\t\t\tthis.offCanvas = this.offCanvasLeft;\n\t\t\t\t\t\t\t\t\tthis.offCanvasWidth = this.offCanvasLeftWidth;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tthis.scroller = null;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (this.classList.contains(CLASS_ACTIVE)) {\n\t\t\t\t\t\t\t\tif (detail.direction === 'left') {\n\t\t\t\t\t\t\t\t\tthis.offCanvas = this.offCanvasLeft;\n\t\t\t\t\t\t\t\t\tthis.offCanvasWidth = this.offCanvasLeftWidth;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tthis.offCanvas = this.offCanvasRight;\n\t\t\t\t\t\t\t\t\tthis.offCanvasWidth = this.offCanvasRightWidth;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (detail.direction === 'right') {\n\t\t\t\t\t\t\t\t\tthis.offCanvas = this.offCanvasLeft;\n\t\t\t\t\t\t\t\t\tthis.offCanvasWidth = this.offCanvasLeftWidth;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tthis.offCanvas = this.offCanvasRight;\n\t\t\t\t\t\t\t\t\tthis.offCanvasWidth = this.offCanvasRightWidth;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (this.offCanvas && this.scroller) {\n\t\t\t\t\t\t\tthis.startX = this.lastX;\n\t\t\t\t\t\t\tthis.isDragging = true;\n\n\t\t\t\t\t\t\t$.gestures.session.lockDirection = true; //锁定方向\n\t\t\t\t\t\t\t$.gestures.session.startDirection = detail.direction;\n\n\t\t\t\t\t\t\tthis.offCanvas.classList.remove(CLASS_TRANSITIONING);\n\t\t\t\t\t\t\tthis.scroller.classList.remove(CLASS_TRANSITIONING);\n\t\t\t\t\t\t\tthis.offsetX = this.getTranslateX();\n\t\t\t\t\t\t\tthis._initOffCanvasVisible();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (this.isDragging) {\n\t\t\t\t\t\tthis.updateTranslate(this.offsetX + (this.lastX - this.startX));\n\t\t\t\t\t\tdetail.gesture.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'dragend':\n\t\t\t\t\tif (this.isDragging) {\n\t\t\t\t\t\tvar detail = e.detail;\n\t\t\t\t\t\tvar direction = detail.direction;\n\t\t\t\t\t\tthis.isDragging = false;\n\t\t\t\t\t\tthis.offCanvas.classList.add(CLASS_TRANSITIONING);\n\t\t\t\t\t\tthis.scroller.classList.add(CLASS_TRANSITIONING);\n\t\t\t\t\t\tvar ratio = 0;\n\t\t\t\t\t\tvar x = this.getTranslateX();\n\t\t\t\t\t\tif (!this.slideIn) {\n\t\t\t\t\t\t\tif (x >= 0) {\n\t\t\t\t\t\t\t\tratio = (this.offCanvasLeftWidth && (x / this.offCanvasLeftWidth)) || 0;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tratio = (this.offCanvasRightWidth && (x / this.offCanvasRightWidth)) || 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (ratio === 0) {\n\t\t\t\t\t\t\t\tthis.openPercentage(0);\n\t\t\t\t\t\t\t\tthis._dispatchEvent(); //此处不触发webkitTransitionEnd,所以手动dispatch\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (direction === 'right' && ratio >= 0 && (ratio >= 0.5 || detail.swipe)) { //右滑打开\n\t\t\t\t\t\t\t\tthis.openPercentage(100);\n\t\t\t\t\t\t\t} else if (direction === 'right' && ratio < 0 && (ratio > -0.5 || detail.swipe)) { //右滑关闭\n\t\t\t\t\t\t\t\tthis.openPercentage(0);\n\t\t\t\t\t\t\t} else if (direction === 'right' && ratio > 0 && ratio < 0.5) { //右滑还原关闭\n\t\t\t\t\t\t\t\tthis.openPercentage(0);\n\t\t\t\t\t\t\t} else if (direction === 'right' && ratio < 0.5) { //右滑还原打开\n\t\t\t\t\t\t\t\tthis.openPercentage(-100);\n\t\t\t\t\t\t\t} else if (direction === 'left' && ratio <= 0 && (ratio <= -0.5 || detail.swipe)) { //左滑打开\n\t\t\t\t\t\t\t\tthis.openPercentage(-100);\n\t\t\t\t\t\t\t} else if (direction === 'left' && ratio > 0 && (ratio <= 0.5 || detail.swipe)) { //左滑关闭\n\t\t\t\t\t\t\t\tthis.openPercentage(0);\n\t\t\t\t\t\t\t} else if (direction === 'left' && ratio < 0 && ratio >= -0.5) { //左滑还原关闭\n\t\t\t\t\t\t\t\tthis.openPercentage(0);\n\t\t\t\t\t\t\t} else if (direction === 'left' && ratio > 0.5) { //左滑还原打开\n\t\t\t\t\t\t\t\tthis.openPercentage(100);\n\t\t\t\t\t\t\t} else { //默认关闭\n\t\t\t\t\t\t\t\tthis.openPercentage(0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (ratio === 1 || ratio === -1) { //此处不触发webkitTransitionEnd,所以手动dispatch\n\t\t\t\t\t\t\t\tthis._dispatchEvent();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (x >= 0) {\n\t\t\t\t\t\t\t\tratio = (this.offCanvasRightWidth && (x / this.offCanvasRightWidth)) || 0;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tratio = (this.offCanvasLeftWidth && (x / this.offCanvasLeftWidth)) || 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (direction === 'right' && ratio <= 0 && (ratio >= -0.5 || detail.swipe)) { //右滑打开\n\t\t\t\t\t\t\t\tthis.openPercentage(100);\n\t\t\t\t\t\t\t} else if (direction === 'right' && ratio > 0 && (ratio >= 0.5 || detail.swipe)) { //右滑关闭\n\t\t\t\t\t\t\t\tthis.openPercentage(0);\n\t\t\t\t\t\t\t} else if (direction === 'right' && ratio <= -0.5) { //右滑还原关闭\n\t\t\t\t\t\t\t\tthis.openPercentage(0);\n\t\t\t\t\t\t\t} else if (direction === 'right' && ratio > 0 && ratio <= 0.5) { //右滑还原打开\n\t\t\t\t\t\t\t\tthis.openPercentage(-100);\n\t\t\t\t\t\t\t} else if (direction === 'left' && ratio >= 0 && (ratio <= 0.5 || detail.swipe)) { //左滑打开\n\t\t\t\t\t\t\t\tthis.openPercentage(-100);\n\t\t\t\t\t\t\t} else if (direction === 'left' && ratio < 0 && (ratio <= -0.5 || detail.swipe)) { //左滑关闭\n\t\t\t\t\t\t\t\tthis.openPercentage(0);\n\t\t\t\t\t\t\t} else if (direction === 'left' && ratio >= 0.5) { //左滑还原关闭\n\t\t\t\t\t\t\t\tthis.openPercentage(0);\n\t\t\t\t\t\t\t} else if (direction === 'left' && ratio >= -0.5 && ratio < 0) { //左滑还原打开\n\t\t\t\t\t\t\t\tthis.openPercentage(100);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.openPercentage(0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (ratio === 1 || ratio === -1 || ratio === 0) {\n\t\t\t\t\t\t\t\tthis._dispatchEvent();\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\t\t_dispatchEvent: function() {\n\t\t\tif (this.classList.contains(CLASS_ACTIVE)) {\n\t\t\t\t$.trigger(this.wrapper, 'shown', this);\n\t\t\t} else {\n\t\t\t\t$.trigger(this.wrapper, 'hidden', this);\n\t\t\t}\n\t\t},\n\t\t_initOffCanvasVisible: function() {\n\t\t\tif (!this.visible) {\n\t\t\t\tthis.visible = true;\n\t\t\t\tif (this.offCanvasLeft) {\n\t\t\t\t\tthis.offCanvasLeft.style.visibility = 'visible';\n\t\t\t\t}\n\t\t\t\tif (this.offCanvasRight) {\n\t\t\t\t\tthis.offCanvasRight.style.visibility = 'visible';\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tinitEvent: function() {\n\t\t\tvar self = this;\n\t\t\tif (self.backdrop) {\n\t\t\t\tself.backdrop.addEventListener('tap', function(e) {\n\t\t\t\t\tself.close();\n\t\t\t\t\te.detail.gesture.preventDefault();\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (this.classList.contains('mui-draggable')) {\n\t\t\t\tthis.wrapper.addEventListener($.EVENT_START, this); //临时处理\n\t\t\t\tthis.wrapper.addEventListener('drag', this);\n\t\t\t\tthis.wrapper.addEventListener('dragend', this);\n\t\t\t}\n\t\t\tthis.wrapper.addEventListener('webkitTransitionEnd', this);\n\t\t},\n\t\topenPercentage: function(percentage) {\n\t\t\tvar p = percentage / 100;\n\t\t\tif (!this.slideIn) {\n\t\t\t\tif (this.offCanvasLeft && percentage >= 0) {\n\t\t\t\t\tthis.updateTranslate(this.offCanvasLeftWidth * p);\n\t\t\t\t\tthis.offCanvasLeft.classList[p !== 0 ? 'add' : 'remove'](CLASS_ACTIVE);\n\t\t\t\t} else if (this.offCanvasRight && percentage <= 0) {\n\t\t\t\t\tthis.updateTranslate(this.offCanvasRightWidth * p);\n\t\t\t\t\tthis.offCanvasRight.classList[p !== 0 ? 'add' : 'remove'](CLASS_ACTIVE);\n\t\t\t\t}\n\t\t\t\tthis.classList[p !== 0 ? 'add' : 'remove'](CLASS_ACTIVE);\n\t\t\t} else {\n\t\t\t\tif (this.offCanvasLeft && percentage >= 0) {\n\t\t\t\t\tp = p === 0 ? -1 : 0;\n\t\t\t\t\tthis.updateTranslate(this.offCanvasLeftWidth * p);\n\t\t\t\t\tthis.offCanvasLeft.classList[percentage !== 0 ? 'add' : 'remove'](CLASS_ACTIVE);\n\t\t\t\t} else if (this.offCanvasRight && percentage <= 0) {\n\t\t\t\t\tp = p === 0 ? 1 : 0;\n\t\t\t\t\tthis.updateTranslate(this.offCanvasRightWidth * p);\n\t\t\t\t\tthis.offCanvasRight.classList[percentage !== 0 ? 'add' : 'remove'](CLASS_ACTIVE);\n\t\t\t\t}\n\t\t\t\tthis.classList[percentage !== 0 ? 'add' : 'remove'](CLASS_ACTIVE);\n\t\t\t}\n\t\t},\n\t\tupdateTranslate: function(x) {\n\t\t\tif (x !== this.lastTranslateX) {\n\t\t\t\tif (!this.slideIn) {\n\t\t\t\t\tif ((!this.offCanvasLeft && x > 0) || (!this.offCanvasRight && x < 0)) {\n\t\t\t\t\t\tthis.setTranslateX(0);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (this.leftShowing && x > this.offCanvasLeftWidth) {\n\t\t\t\t\t\tthis.setTranslateX(this.offCanvasLeftWidth);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (this.rightShowing && x < -this.offCanvasRightWidth) {\n\t\t\t\t\t\tthis.setTranslateX(-this.offCanvasRightWidth);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis.setTranslateX(x);\n\t\t\t\t\tif (x >= 0) {\n\t\t\t\t\t\tthis.leftShowing = true;\n\t\t\t\t\t\tthis.rightShowing = false;\n\t\t\t\t\t\tif (x > 0) {\n\t\t\t\t\t\t\tif (this.offCanvasLeft) {\n\t\t\t\t\t\t\t\t$.each(this.offCanvasLefts, function(index, offCanvas) {\n\t\t\t\t\t\t\t\t\tif (offCanvas === this.offCanvasLeft) {\n\t\t\t\t\t\t\t\t\t\tthis.offCanvasLeft.style.zIndex = 0;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\toffCanvas.style.zIndex = -1;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}.bind(this));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (this.offCanvasRight) {\n\t\t\t\t\t\t\t\tthis.offCanvasRight.style.zIndex = -1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.rightShowing = true;\n\t\t\t\t\t\tthis.leftShowing = false;\n\t\t\t\t\t\tif (this.offCanvasRight) {\n\t\t\t\t\t\t\t$.each(this.offCanvasRights, function(index, offCanvas) {\n\t\t\t\t\t\t\t\tif (offCanvas === this.offCanvasRight) {\n\t\t\t\t\t\t\t\t\toffCanvas.style.zIndex = 0;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\toffCanvas.style.zIndex = -1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}.bind(this));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (this.offCanvasLeft) {\n\t\t\t\t\t\t\tthis.offCanvasLeft.style.zIndex = -1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (this.offCanvas.classList.contains(CLASS_OFF_CANVAS_RIGHT)) {\n\t\t\t\t\t\tif (x < 0) {\n\t\t\t\t\t\t\tthis.setTranslateX(0);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (x > this.offCanvasRightWidth) {\n\t\t\t\t\t\t\tthis.setTranslateX(this.offCanvasRightWidth);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (x > 0) {\n\t\t\t\t\t\t\tthis.setTranslateX(0);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (x < -this.offCanvasLeftWidth) {\n\t\t\t\t\t\t\tthis.setTranslateX(-this.offCanvasLeftWidth);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.setTranslateX(x);\n\t\t\t\t}\n\t\t\t\tthis.lastTranslateX = x;\n\t\t\t}\n\t\t},\n\t\tsetTranslateX: $.animationFrame(function(x) {\n\t\t\tif (this.scroller) {\n\t\t\t\tif (this.scalable && this.offCanvas.parentNode === this.wrapper) {\n\t\t\t\t\tvar percent = Math.abs(x) / this.offCanvasWidth;\n\t\t\t\t\tvar zoomOutScale = 1 - (1 - this.options.scale) * percent;\n\t\t\t\t\tvar zoomInScale = this.options.scale + (1 - this.options.scale) * percent;\n\t\t\t\t\tvar zoomOutOpacity = 1 - (1 - this.options.opacity) * percent;\n\t\t\t\t\tvar zoomInOpacity = this.options.opacity + (1 - this.options.opacity) * percent;\n\t\t\t\t\tif (this.offCanvas.classList.contains(CLASS_OFF_CANVAS_LEFT)) {\n\t\t\t\t\t\tthis.offCanvas.style.webkitTransformOrigin = '-100%';\n\t\t\t\t\t\tthis.scroller.style.webkitTransformOrigin = 'left';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.offCanvas.style.webkitTransformOrigin = '200%';\n\t\t\t\t\t\tthis.scroller.style.webkitTransformOrigin = 'right';\n\t\t\t\t\t}\n\t\t\t\t\tthis.offCanvas.style.opacity = zoomInOpacity;\n\t\t\t\t\tthis.offCanvas.style.webkitTransform = 'translate3d(0,0,0) scale(' + zoomInScale + ')';\n\t\t\t\t\tthis.scroller.style.webkitTransform = 'translate3d(' + x + 'px,0,0) scale(' + zoomOutScale + ')';\n\t\t\t\t} else {\n\t\t\t\t\tif (this.slideIn) {\n\t\t\t\t\t\tthis.offCanvas.style.webkitTransform = 'translate3d(' + x + 'px,0,0)';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.scroller.style.webkitTransform = 'translate3d(' + x + 'px,0,0)';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}),\n\t\tgetTranslateX: function() {\n\t\t\tif (this.offCanvas) {\n\t\t\t\tvar scroller = this.slideIn ? this.offCanvas : this.scroller;\n\t\t\t\tvar result = $.parseTranslateMatrix($.getStyles(scroller, 'webkitTransform'));\n\t\t\t\treturn (result && result.x) || 0;\n\t\t\t}\n\t\t\treturn 0;\n\t\t},\n\t\tisShown: function(direction) {\n\t\t\tvar shown = false;\n\t\t\tif (!this.slideIn) {\n\t\t\t\tvar x = this.getTranslateX();\n\t\t\t\tif (direction === 'right') {\n\t\t\t\t\tshown = this.classList.contains(CLASS_ACTIVE) && x < 0;\n\t\t\t\t} else if (direction === 'left') {\n\t\t\t\t\tshown = this.classList.contains(CLASS_ACTIVE) && x > 0;\n\t\t\t\t} else {\n\t\t\t\t\tshown = this.classList.contains(CLASS_ACTIVE) && x !== 0;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (direction === 'left') {\n\t\t\t\t\tshown = this.classList.contains(CLASS_ACTIVE) && this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_LEFT + '.' + CLASS_ACTIVE);\n\t\t\t\t} else if (direction === 'right') {\n\t\t\t\t\tshown = this.classList.contains(CLASS_ACTIVE) && this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_RIGHT + '.' + CLASS_ACTIVE);\n\t\t\t\t} else {\n\t\t\t\t\tshown = this.classList.contains(CLASS_ACTIVE) && (this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_LEFT + '.' + CLASS_ACTIVE) || this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_RIGHT + '.' + CLASS_ACTIVE));\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn shown;\n\t\t},\n\t\tclose: function() {\n\t\t\tthis._initOffCanvasVisible();\n\t\t\tthis.offCanvas = this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_RIGHT + '.' + CLASS_ACTIVE) || this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_LEFT + '.' + CLASS_ACTIVE);\n\t\t\tthis.offCanvasWidth = this.offCanvas.offsetWidth;\n\t\t\tif (this.scroller) {\n\t\t\t\tthis.offCanvas.offsetHeight;\n\t\t\t\tthis.offCanvas.classList.add(CLASS_TRANSITIONING);\n\t\t\t\tthis.scroller.classList.add(CLASS_TRANSITIONING);\n\t\t\t\tthis.openPercentage(0);\n\t\t\t}\n\t\t},\n\t\tshow: function(direction) {\n\t\t\tthis._initOffCanvasVisible();\n\t\t\tif (this.isShown(direction)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (!direction) {\n\t\t\t\tdirection = this.wrapper.querySelector('.' + CLASS_OFF_CANVAS_RIGHT) ? 'right' : 'left';\n\t\t\t}\n\t\t\tif (direction === 'right') {\n\t\t\t\tthis.offCanvas = this.offCanvasRight;\n\t\t\t\tthis.offCanvasWidth = this.offCanvasRightWidth;\n\t\t\t} else {\n\t\t\t\tthis.offCanvas = this.offCanvasLeft;\n\t\t\t\tthis.offCanvasWidth = this.offCanvasLeftWidth;\n\t\t\t}\n\t\t\tif (this.scroller) {\n\t\t\t\tthis.offCanvas.offsetHeight;\n\t\t\t\tthis.offCanvas.classList.add(CLASS_TRANSITIONING);\n\t\t\t\tthis.scroller.classList.add(CLASS_TRANSITIONING);\n\t\t\t\tthis.openPercentage(direction === 'left' ? 100 : -100);\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\ttoggle: function(directionOrOffCanvas) {\n\t\t\tvar direction = directionOrOffCanvas;\n\t\t\tif (directionOrOffCanvas && directionOrOffCanvas.classList) {\n\t\t\t\tdirection = directionOrOffCanvas.classList.contains(CLASS_OFF_CANVAS_LEFT) ? 'left' : 'right';\n\t\t\t\tthis.refresh(directionOrOffCanvas);\n\t\t\t}\n\t\t\tif (!this.show(direction)) {\n\t\t\t\tthis.close();\n\t\t\t}\n\t\t}\n\t});\n\n\t//hash to offcanvas\n\tvar findOffCanvasContainer = function(target) {\n\t\tparentNode = target.parentNode;\n\t\tif (parentNode) {\n\t\t\tif (parentNode.classList.contains(CLASS_OFF_CANVAS_WRAP)) {\n\t\t\t\treturn parentNode;\n\t\t\t} else {\n\t\t\t\tparentNode = parentNode.parentNode;\n\t\t\t\tif (parentNode.classList.contains(CLASS_OFF_CANVAS_WRAP)) {\n\t\t\t\t\treturn parentNode;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\tvar handle = function(event, target) {\n\t\tif (target.tagName === 'A' && target.hash) {\n\t\t\tvar offcanvas = document.getElementById(target.hash.replace('#', ''));\n\t\t\tif (offcanvas) {\n\t\t\t\tvar container = findOffCanvasContainer(offcanvas);\n\t\t\t\tif (container) {\n\t\t\t\t\t$.targets._container = container;\n\t\t\t\t\treturn offcanvas;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t};\n\n\t$.registerTarget({\n\t\tname: name,\n\t\tindex: 60,\n\t\thandle: handle,\n\t\ttarget: false,\n\t\tisReset: false,\n\t\tisContinue: true\n\t});\n\n\twindow.addEventListener('tap', function(e) {\n\t\tif (!$.targets.offcanvas) {\n\t\t\treturn;\n\t\t}\n\t\t//TODO 此处类型的代码后续考虑统一优化(target机制)，现在的实现费力不讨好\n\t\tvar target = e.target;\n\t\tfor (; target && target !== document; target = target.parentNode) {\n\t\t\tif (target.tagName === 'A' && target.hash && target.hash === ('#' + $.targets.offcanvas.id)) {\n\t\t\t\te.detail && e.detail.gesture && e.detail.gesture.preventDefault(); //fixed hashchange\n\t\t\t\t$($.targets._container).offCanvas().toggle($.targets.offcanvas);\n\t\t\t\t$.targets.offcanvas = $.targets._container = null;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t});\n\n\t$.fn.offCanvas = function(options) {\n\t\tvar offCanvasApis = [];\n\t\tthis.each(function() {\n\t\t\tvar offCanvasApi = null;\n\t\t\tvar self = this;\n\t\t\t//hack old version\n\t\t\tif (!self.classList.contains(CLASS_OFF_CANVAS_WRAP)) {\n\t\t\t\tself = findOffCanvasContainer(self);\n\t\t\t}\n\t\t\tvar id = self.getAttribute('data-offCanvas');\n\t\t\tif (!id) {\n\t\t\t\tid = ++$.uuid;\n\t\t\t\t$.data[id] = offCanvasApi = new OffCanvas(self, options);\n\t\t\t\tself.setAttribute('data-offCanvas', id);\n\t\t\t} else {\n\t\t\t\toffCanvasApi = $.data[id];\n\t\t\t}\n\t\t\tif (options === 'show' || options === 'close' || options === 'toggle') {\n\t\t\t\toffCanvasApi.toggle();\n\t\t\t}\n\t\t\toffCanvasApis.push(offCanvasApi);\n\t\t});\n\t\treturn offCanvasApis.length === 1 ? offCanvasApis[0] : offCanvasApis;\n\t};\n\t$.ready(function() {\n\t\t$('.mui-off-canvas-wrap').offCanvas();\n\t});\n})(mui, window, document, 'offcanvas');\n/**\n * actions\n * @param {type} $\n * @param {type} name\n * @returns {undefined}\n */\n(function($, name) {\n\tvar CLASS_ACTION = 'mui-action';\n\n\tvar handle = function(event, target) {\n\t\tvar className = target.className || '';\n\t\tif (typeof className !== 'string') { //svg className(SVGAnimatedString)\n\t\t\tclassName = '';\n\t\t}\n\t\tif (className && ~className.indexOf(CLASS_ACTION)) {\n\t\t\tif (target.classList.contains('mui-action-back')) {\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\treturn target;\n\t\t}\n\t\treturn false;\n\t};\n\n\t$.registerTarget({\n\t\tname: name,\n\t\tindex: 50,\n\t\thandle: handle,\n\t\ttarget: false,\n\t\tisContinue: true\n\t});\n\n})(mui, 'action');\n/**\n * Modals\n * @param {type} $\n * @param {type} window\n * @param {type} document\n * @param {type} name\n * @returns {undefined}\n */\n(function($, window, document, name) {\n\tvar CLASS_MODAL = 'mui-modal';\n\n\tvar handle = function(event, target) {\n\t\tif (target.tagName === 'A' && target.hash) {\n\t\t\tvar modal = document.getElementById(target.hash.replace('#', ''));\n\t\t\tif (modal && modal.classList.contains(CLASS_MODAL)) {\n\t\t\t\treturn modal;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t};\n\n\t$.registerTarget({\n\t\tname: name,\n\t\tindex: 50,\n\t\thandle: handle,\n\t\ttarget: false,\n\t\tisReset: false,\n\t\tisContinue: true\n\t});\n\n\twindow.addEventListener('tap', function(event) {\n\t\tif ($.targets.modal) {\n\t\t\tevent.detail.gesture.preventDefault(); //fixed hashchange\n\t\t\t$.targets.modal.classList.toggle('mui-active');\n\t\t}\n\t});\n})(mui, window, document, 'modal');\n/**\n * Popovers\n * @param {type} $\n * @param {type} window\n * @param {type} document\n * @param {type} name\n * @param {type} undefined\n * @returns {undefined}\n */\n(function($, window, document, name) {\n\n\tvar CLASS_POPOVER = 'mui-popover';\n\tvar CLASS_POPOVER_ARROW = 'mui-popover-arrow';\n\tvar CLASS_ACTION_POPOVER = 'mui-popover-action';\n\tvar CLASS_BACKDROP = 'mui-backdrop';\n\tvar CLASS_BAR_POPOVER = 'mui-bar-popover';\n\tvar CLASS_BAR_BACKDROP = 'mui-bar-backdrop';\n\tvar CLASS_ACTION_BACKDROP = 'mui-backdrop-action';\n\tvar CLASS_ACTIVE = 'mui-active';\n\tvar CLASS_BOTTOM = 'mui-bottom';\n\n\n\n\tvar handle = function(event, target) {\n\t\tif (target.tagName === 'A' && target.hash) {\n\t\t\t$.targets._popover = document.getElementById(target.hash.replace('#', ''));\n\t\t\tif ($.targets._popover && $.targets._popover.classList.contains(CLASS_POPOVER)) {\n\t\t\t\treturn target;\n\t\t\t} else {\n\t\t\t\t$.targets._popover = null;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t};\n\n\t$.registerTarget({\n\t\tname: name,\n\t\tindex: 60,\n\t\thandle: handle,\n\t\ttarget: false,\n\t\tisReset: false,\n\t\tisContinue: true\n\t});\n\n\tvar onPopoverShown = function(e) {\n\t\tthis.removeEventListener('webkitTransitionEnd', onPopoverShown);\n\t\tthis.addEventListener($.EVENT_MOVE, $.preventDefault);\n\t\t$.trigger(this, 'shown', this);\n\t}\n\tvar onPopoverHidden = function(e) {\n\t\tsetStyle(this, 'none');\n\t\tthis.removeEventListener('webkitTransitionEnd', onPopoverHidden);\n\t\tthis.removeEventListener($.EVENT_MOVE, $.preventDefault);\n\t\t$.trigger(this, 'hidden', this);\n\t};\n\n\tvar backdrop = (function() {\n\t\tvar element = document.createElement('div');\n\t\telement.classList.add(CLASS_BACKDROP);\n\t\telement.addEventListener($.EVENT_MOVE, $.preventDefault);\n\t\telement.addEventListener('tap', function(e) {\n\t\t\tvar popover = $.targets._popover;\n\t\t\tif (popover) {\n\t\t\t\tpopover.addEventListener('webkitTransitionEnd', onPopoverHidden);\n\t\t\t\tpopover.classList.remove(CLASS_ACTIVE);\n\t\t\t\tremoveBackdrop(popover);\n\t\t\t}\n\t\t});\n\n\t\treturn element;\n\t}());\n\tvar removeBackdropTimer;\n\tvar removeBackdrop = function(popover) {\n\t\tbackdrop.setAttribute('style', 'opacity:0');\n\t\t$.targets.popover = $.targets._popover = null; //reset\n\t\tremoveBackdropTimer = $.later(function() {\n\t\t\tif (!popover.classList.contains(CLASS_ACTIVE) && backdrop.parentNode && backdrop.parentNode === document.body) {\n\t\t\t\tdocument.body.removeChild(backdrop);\n\t\t\t}\n\t\t}, 350);\n\t};\n\twindow.addEventListener('tap', function(e) {\n\t\tif (!$.targets.popover) {\n\t\t\treturn;\n\t\t}\n\t\tvar toggle = false;\n\t\tvar target = e.target;\n\t\tfor (; target && target !== document; target = target.parentNode) {\n\t\t\tif (target === $.targets.popover) {\n\t\t\t\ttoggle = true;\n\t\t\t}\n\t\t}\n\t\tif (toggle) {\n\t\t\te.detail.gesture.preventDefault(); //fixed hashchange\n\t\t\ttogglePopover($.targets._popover, $.targets.popover);\n\t\t}\n\n\t});\n\n\tvar togglePopover = function(popover, anchor, state) {\n\t\tif ((state === 'show' && popover.classList.contains(CLASS_ACTIVE)) || (state === 'hide' && !popover.classList.contains(CLASS_ACTIVE))) {\n\t\t\treturn;\n\t\t}\n\t\tremoveBackdropTimer && removeBackdropTimer.cancel(); //取消remove的timer\n\t\t//remove一遍，以免来回快速切换，导致webkitTransitionEnd不触发，无法remove\n\t\tpopover.removeEventListener('webkitTransitionEnd', onPopoverShown);\n\t\tpopover.removeEventListener('webkitTransitionEnd', onPopoverHidden);\n\t\tbackdrop.classList.remove(CLASS_BAR_BACKDROP);\n\t\tbackdrop.classList.remove(CLASS_ACTION_BACKDROP);\n\t\tvar _popover = document.querySelector('.mui-popover.mui-active');\n\t\tif (_popover) {\n\t\t\t//\t\t\t_popover.setAttribute('style', '');\n\t\t\t_popover.addEventListener('webkitTransitionEnd', onPopoverHidden);\n\t\t\t_popover.classList.remove(CLASS_ACTIVE);\n\t\t\t//\t\t\t_popover.removeEventListener('webkitTransitionEnd', onPopoverHidden);\n\t\t\t//同一个弹出则直接返回，解决同一个popover的toggle\n\t\t\tif (popover === _popover) {\n\t\t\t\tremoveBackdrop(_popover);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tvar isActionSheet = false;\n\t\tif (popover.classList.contains(CLASS_BAR_POPOVER) || popover.classList.contains(CLASS_ACTION_POPOVER)) { //navBar\n\t\t\tif (popover.classList.contains(CLASS_ACTION_POPOVER)) { //action sheet popover\n\t\t\t\tisActionSheet = true;\n\t\t\t\tbackdrop.classList.add(CLASS_ACTION_BACKDROP);\n\t\t\t} else { //bar popover\n\t\t\t\tbackdrop.classList.add(CLASS_BAR_BACKDROP);\n\t\t\t\t//\t\t\t\tif (anchor) {\n\t\t\t\t//\t\t\t\t\tif (anchor.parentNode) {\n\t\t\t\t//\t\t\t\t\t\tvar offsetWidth = anchor.offsetWidth;\n\t\t\t\t//\t\t\t\t\t\tvar offsetLeft = anchor.offsetLeft;\n\t\t\t\t//\t\t\t\t\t\tvar innerWidth = window.innerWidth;\n\t\t\t\t//\t\t\t\t\t\tpopover.style.left = (Math.min(Math.max(offsetLeft, defaultPadding), innerWidth - offsetWidth - defaultPadding)) + \"px\";\n\t\t\t\t//\t\t\t\t\t} else {\n\t\t\t\t//\t\t\t\t\t\t//TODO anchor is position:{left,top,bottom,right}\n\t\t\t\t//\t\t\t\t\t}\n\t\t\t\t//\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tsetStyle(popover, 'block'); //actionsheet transform\n\t\tpopover.offsetHeight;\n\t\tpopover.classList.add(CLASS_ACTIVE);\n\t\tbackdrop.setAttribute('style', '');\n\t\tdocument.body.appendChild(backdrop);\n\t\tcalPosition(popover, anchor, isActionSheet); //position\n\t\tbackdrop.classList.add(CLASS_ACTIVE);\n\t\tpopover.addEventListener('webkitTransitionEnd', onPopoverShown);\n\t};\n\tvar setStyle = function(popover, display, top, left) {\n\t\tvar style = popover.style;\n\t\tif (typeof display !== 'undefined')\n\t\t\tstyle.display = display;\n\t\tif (typeof top !== 'undefined')\n\t\t\tstyle.top = top + 'px';\n\t\tif (typeof left !== 'undefined')\n\t\t\tstyle.left = left + 'px';\n\t};\n\tvar calPosition = function(popover, anchor, isActionSheet) {\n\t\tif (!popover || !anchor) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (isActionSheet) { //actionsheet\n\t\t\tsetStyle(popover, 'block')\n\t\t\treturn;\n\t\t}\n\n\t\tvar wWidth = window.innerWidth;\n\t\tvar wHeight = window.innerHeight;\n\n\t\tvar pWidth = popover.offsetWidth;\n\t\tvar pHeight = popover.offsetHeight;\n\n\t\tvar aWidth = anchor.offsetWidth;\n\t\tvar aHeight = anchor.offsetHeight;\n\t\tvar offset = $.offset(anchor);\n\n\t\tvar arrow = popover.querySelector('.' + CLASS_POPOVER_ARROW);\n\t\tif (!arrow) {\n\t\t\tarrow = document.createElement('div');\n\t\t\tarrow.className = CLASS_POPOVER_ARROW;\n\t\t\tpopover.appendChild(arrow);\n\t\t}\n\t\tvar arrowSize = arrow && arrow.offsetWidth / 2 || 0;\n\n\n\n\t\tvar pTop = 0;\n\t\tvar pLeft = 0;\n\t\tvar diff = 0;\n\t\tvar arrowLeft = 0;\n\t\tvar defaultPadding = popover.classList.contains(CLASS_ACTION_POPOVER) ? 0 : 5;\n\n\t\tvar position = 'top';\n\t\tif ((pHeight + arrowSize) < (offset.top - window.pageYOffset)) { //top\n\t\t\tpTop = offset.top - pHeight - arrowSize;\n\t\t} else if ((pHeight + arrowSize) < (wHeight - (offset.top - window.pageYOffset) - aHeight)) { //bottom\n\t\t\tposition = 'bottom';\n\t\t\tpTop = offset.top + aHeight + arrowSize;\n\t\t} else { //middle\n\t\t\tposition = 'middle';\n\t\t\tpTop = Math.max((wHeight - pHeight) / 2 + window.pageYOffset, 0);\n\t\t\tpLeft = Math.max((wWidth - pWidth) / 2 + window.pageXOffset, 0);\n\t\t}\n\t\tif (position === 'top' || position === 'bottom') {\n\t\t\tpLeft = aWidth / 2 + offset.left - pWidth / 2;\n\t\t\tdiff = pLeft;\n\t\t\tif (pLeft < defaultPadding) pLeft = defaultPadding;\n\t\t\tif (pLeft + pWidth > wWidth) pLeft = wWidth - pWidth - defaultPadding;\n\n\t\t\tif (arrow) {\n\t\t\t\tif (position === 'top') {\n\t\t\t\t\tarrow.classList.add(CLASS_BOTTOM);\n\t\t\t\t} else {\n\t\t\t\t\tarrow.classList.remove(CLASS_BOTTOM);\n\t\t\t\t}\n\t\t\t\tdiff = diff - pLeft;\n\t\t\t\tarrowLeft = (pWidth / 2 - arrowSize / 2 + diff);\n\t\t\t\tarrowLeft = Math.max(Math.min(arrowLeft, pWidth - arrowSize * 2 - 6), 6);\n\t\t\t\tarrow.setAttribute('style', 'left:' + arrowLeft + 'px');\n\t\t\t}\n\t\t} else if (position === 'middle') {\n\t\t\tarrow.setAttribute('style', 'display:none');\n\t\t}\n\t\tsetStyle(popover, 'block', pTop, pLeft);\n\t};\n\n\t$.createMask = function(callback) {\n\t\tvar element = document.createElement('div');\n\t\telement.classList.add(CLASS_BACKDROP);\n\t\telement.addEventListener($.EVENT_MOVE, $.preventDefault);\n\t\telement.addEventListener('tap', function() {\n\t\t\tmask.close();\n\t\t});\n\t\tvar mask = [element];\n\t\tmask._show = false;\n\t\tmask.show = function() {\n\t\t\tmask._show = true;\n\t\t\telement.setAttribute('style', 'opacity:1');\n\t\t\tdocument.body.appendChild(element);\n\t\t\treturn mask;\n\t\t};\n\t\tmask._remove = function() {\n\t\t\tif (mask._show) {\n\t\t\t\tmask._show = false;\n\t\t\t\telement.setAttribute('style', 'opacity:0');\n\t\t\t\t$.later(function() {\n\t\t\t\t\tvar body = document.body;\n\t\t\t\t\telement.parentNode === body && body.removeChild(element);\n\t\t\t\t}, 350);\n\t\t\t}\n\t\t\treturn mask;\n\t\t};\n\t\tmask.close = function() {\n\t\t\tif (callback) {\n\t\t\t\tif (callback() !== false) {\n\t\t\t\t\tmask._remove();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tmask._remove();\n\t\t\t}\n\t\t};\n\t\treturn mask;\n\t};\n\t$.fn.popover = function() {\n\t\tvar args = arguments;\n\t\tthis.each(function() {\n\t\t\t$.targets._popover = this;\n\t\t\tif (args[0] === 'show' || args[0] === 'hide' || args[0] === 'toggle') {\n\t\t\t\ttogglePopover(this, args[1], args[0]);\n\t\t\t}\n\t\t});\n\t};\n\n})(mui, window, document, 'popover');\n/**\n * segmented-controllers\n * @param {type} $\n * @param {type} window\n * @param {type} document\n * @param {type} undefined\n * @returns {undefined}\n */\n(function($, window, document, name, undefined) {\n\n\tvar CLASS_CONTROL_ITEM = 'mui-control-item';\n\tvar CLASS_SEGMENTED_CONTROL = 'mui-segmented-control';\n\tvar CLASS_SEGMENTED_CONTROL_VERTICAL = 'mui-segmented-control-vertical';\n\tvar CLASS_CONTROL_CONTENT = 'mui-control-content';\n\tvar CLASS_TAB_BAR = 'mui-bar-tab';\n\tvar CLASS_TAB_ITEM = 'mui-tab-item';\n\tvar CLASS_SLIDER_ITEM = 'mui-slider-item';\n\n\tvar handle = function(event, target) {\n\t\tif (target.classList && (target.classList.contains(CLASS_CONTROL_ITEM) || target.classList.contains(CLASS_TAB_ITEM))) {\n\t\t\tif (target.parentNode && target.parentNode.classList && target.parentNode.classList.contains(CLASS_SEGMENTED_CONTROL_VERTICAL)) {\n\t\t\t\t//vertical 如果preventDefault会导致无法滚动\n\t\t\t} else {\n\t\t\t\tevent.preventDefault(); //stop hash change\n\t\t\t}\n\t\t\t//\t\t\tif (target.hash) {\n\t\t\treturn target;\n\t\t\t//\t\t\t}\n\t\t}\n\t\treturn false;\n\t};\n\n\t$.registerTarget({\n\t\tname: name,\n\t\tindex: 80,\n\t\thandle: handle,\n\t\ttarget: false\n\t});\n\n\twindow.addEventListener('tap', function(e) {\n\n\t\tvar targetTab = $.targets.tab;\n\t\tif (!targetTab) {\n\t\t\treturn;\n\t\t}\n\t\tvar activeTab;\n\t\tvar activeBodies;\n\t\tvar targetBody;\n\t\tvar className = 'mui-active';\n\t\tvar classSelector = '.' + className;\n\t\tvar segmentedControl = targetTab.parentNode;\n\n\t\tfor (; segmentedControl && segmentedControl !== document; segmentedControl = segmentedControl.parentNode) {\n\t\t\tif (segmentedControl.classList.contains(CLASS_SEGMENTED_CONTROL)) {\n\t\t\t\tactiveTab = segmentedControl.querySelector(classSelector + '.' + CLASS_CONTROL_ITEM);\n\t\t\t\tbreak;\n\t\t\t} else if (segmentedControl.classList.contains(CLASS_TAB_BAR)) {\n\t\t\t\tactiveTab = segmentedControl.querySelector(classSelector + '.' + CLASS_TAB_ITEM);\n\t\t\t}\n\t\t}\n\n\t\tif (activeTab) {\n\t\t\tactiveTab.classList.remove(className);\n\t\t}\n\n\t\tvar isLastActive = targetTab === activeTab;\n\t\tif (targetTab) {\n\t\t\ttargetTab.classList.add(className);\n\t\t}\n\n\t\tif (!targetTab.hash) {\n\t\t\treturn;\n\t\t}\n\t\ttargetBody = document.getElementById(targetTab.hash.replace('#', ''));\n\n\t\tif (!targetBody) {\n\t\t\treturn;\n\t\t}\n\t\tif (!targetBody.classList.contains(CLASS_CONTROL_CONTENT)) { //tab bar popover\n\t\t\ttargetTab.classList[isLastActive ? 'remove' : 'add'](className);\n\t\t\treturn;\n\t\t}\n\t\tif (isLastActive) { //same\n\t\t\treturn;\n\t\t}\n\t\tvar parentNode = targetBody.parentNode;\n\t\tactiveBodies = parentNode.querySelectorAll('.' + CLASS_CONTROL_CONTENT + classSelector);\n\t\tfor (var i = 0; i < activeBodies.length; i++) {\n\t\t\tvar activeBody = activeBodies[i];\n\t\t\tactiveBody.parentNode === parentNode && activeBody.classList.remove(className);\n\t\t}\n\n\t\ttargetBody.classList.add(className);\n\n\t\tvar contents = [];\n\t\tvar _contents = parentNode.querySelectorAll('.' + CLASS_CONTROL_CONTENT);\n\t\tfor (var i = 0; i < _contents.length; i++) { //查找直属子节点\n\t\t\t_contents[i].parentNode === parentNode && (contents.push(_contents[i]));\n\t\t}\n\t\t$.trigger(targetBody, $.eventName('shown', name), {\n\t\t\ttabNumber: Array.prototype.indexOf.call(contents, targetBody)\n\t\t});\n\t\te.detail && e.detail.gesture.preventDefault(); //fixed hashchange\n\t});\n\n})(mui, window, document, 'tab');\n/**\n * Toggles switch\n * @param {type} $\n * @param {type} window\n * @param {type} name\n * @returns {undefined}\n */\n(function($, window, name) {\n\n\tvar CLASS_SWITCH = 'mui-switch';\n\tvar CLASS_SWITCH_HANDLE = 'mui-switch-handle';\n\tvar CLASS_ACTIVE = 'mui-active';\n\tvar CLASS_DRAGGING = 'mui-dragging';\n\n\tvar CLASS_DISABLED = 'mui-disabled';\n\n\tvar SELECTOR_SWITCH_HANDLE = '.' + CLASS_SWITCH_HANDLE;\n\n\tvar handle = function(event, target) {\n\t\tif (target.classList && target.classList.contains(CLASS_SWITCH)) {\n\t\t\treturn target;\n\t\t}\n\t\treturn false;\n\t};\n\n\t$.registerTarget({\n\t\tname: name,\n\t\tindex: 100,\n\t\thandle: handle,\n\t\ttarget: false\n\t});\n\n\n\tvar Toggle = function(element) {\n\t\tthis.element = element;\n\t\tthis.classList = this.element.classList;\n\t\tthis.handle = this.element.querySelector(SELECTOR_SWITCH_HANDLE);\n\t\tthis.init();\n\t\tthis.initEvent();\n\t};\n\tToggle.prototype.init = function() {\n\t\tthis.toggleWidth = this.element.offsetWidth;\n\t\tthis.handleWidth = this.handle.offsetWidth;\n\t\tthis.handleX = this.toggleWidth - this.handleWidth - 3;\n\t};\n\tToggle.prototype.initEvent = function() {\n\t\tthis.element.addEventListener($.EVENT_START, this);\n\t\tthis.element.addEventListener('drag', this);\n\t\tthis.element.addEventListener('swiperight', this);\n\t\tthis.element.addEventListener($.EVENT_END, this);\n\t\tthis.element.addEventListener($.EVENT_CANCEL, this);\n\n\t};\n\tToggle.prototype.handleEvent = function(e) {\n\t\tif (this.classList.contains(CLASS_DISABLED)) {\n\t\t\treturn;\n\t\t}\n\t\tswitch (e.type) {\n\t\t\tcase $.EVENT_START:\n\t\t\t\tthis.start(e);\n\t\t\t\tbreak;\n\t\t\tcase 'drag':\n\t\t\t\tthis.drag(e);\n\t\t\t\tbreak;\n\t\t\tcase 'swiperight':\n\t\t\t\tthis.swiperight();\n\t\t\t\tbreak;\n\t\t\tcase $.EVENT_END:\n\t\t\tcase $.EVENT_CANCEL:\n\t\t\t\tthis.end(e);\n\t\t\t\tbreak;\n\t\t}\n\t};\n\tToggle.prototype.start = function(e) {\n\t\tthis.handle.style.webkitTransitionDuration = this.element.style.webkitTransitionDuration = '.2s';\n\t\tthis.classList.add(CLASS_DRAGGING);\n\t\tif (this.toggleWidth === 0 || this.handleWidth === 0) { //当switch处于隐藏状态时，width为0，需要重新初始化\n\t\t\tthis.init();\n\t\t}\n\t};\n\tToggle.prototype.drag = function(e) {\n\t\tvar detail = e.detail;\n\t\tif (!this.isDragging) {\n\t\t\tif (detail.direction === 'left' || detail.direction === 'right') {\n\t\t\t\tthis.isDragging = true;\n\t\t\t\tthis.lastChanged = undefined;\n\t\t\t\tthis.initialState = this.classList.contains(CLASS_ACTIVE);\n\t\t\t}\n\t\t}\n\t\tif (this.isDragging) {\n\t\t\tthis.setTranslateX(detail.deltaX);\n\t\t\te.stopPropagation();\n\t\t\tdetail.gesture.preventDefault();\n\t\t}\n\t};\n\tToggle.prototype.swiperight = function(e) {\n\t\tif (this.isDragging) {\n\t\t\te.stopPropagation();\n\t\t}\n\t};\n\tToggle.prototype.end = function(e) {\n\t\tthis.classList.remove(CLASS_DRAGGING);\n\t\tif (this.isDragging) {\n\t\t\tthis.isDragging = false;\n\t\t\te.stopPropagation();\n\t\t\t$.trigger(this.element, 'toggle', {\n\t\t\t\tisActive: this.classList.contains(CLASS_ACTIVE)\n\t\t\t});\n\t\t} else {\n\t\t\tthis.toggle();\n\t\t}\n\t};\n\tToggle.prototype.toggle = function(animate) {\n\t\tvar classList = this.classList;\n\t\tif (animate === false) {\n\t\t\tthis.handle.style.webkitTransitionDuration = this.element.style.webkitTransitionDuration = '0s';\n\t\t} else {\n\t\t\tthis.handle.style.webkitTransitionDuration = this.element.style.webkitTransitionDuration = '.2s';\n\t\t}\n\t\tif (classList.contains(CLASS_ACTIVE)) {\n\t\t\tclassList.remove(CLASS_ACTIVE);\n\t\t\tthis.handle.style.webkitTransform = 'translate(0,0)';\n\t\t} else {\n\t\t\tclassList.add(CLASS_ACTIVE);\n\t\t\tthis.handle.style.webkitTransform = 'translate(' + this.handleX + 'px,0)';\n\t\t}\n\t\t$.trigger(this.element, 'toggle', {\n\t\t\tisActive: this.classList.contains(CLASS_ACTIVE)\n\t\t});\n\t};\n\tToggle.prototype.setTranslateX = $.animationFrame(function(x) {\n\t\tif (!this.isDragging) {\n\t\t\treturn;\n\t\t}\n\t\tvar isChanged = false;\n\t\tif ((this.initialState && -x > (this.handleX / 2)) || (!this.initialState && x > (this.handleX / 2))) {\n\t\t\tisChanged = true;\n\t\t}\n\t\tif (this.lastChanged !== isChanged) {\n\t\t\tif (isChanged) {\n\t\t\t\tthis.handle.style.webkitTransform = 'translate(' + (this.initialState ? 0 : this.handleX) + 'px,0)';\n\t\t\t\tthis.classList[this.initialState ? 'remove' : 'add'](CLASS_ACTIVE);\n\t\t\t} else {\n\t\t\t\tthis.handle.style.webkitTransform = 'translate(' + (this.initialState ? this.handleX : 0) + 'px,0)';\n\t\t\t\tthis.classList[this.initialState ? 'add' : 'remove'](CLASS_ACTIVE);\n\t\t\t}\n\t\t\tthis.lastChanged = isChanged;\n\t\t}\n\n\t});\n\n\t$.fn['switch'] = function(options) {\n\t\tvar switchApis = [];\n\t\tthis.each(function() {\n\t\t\tvar switchApi = null;\n\t\t\tvar id = this.getAttribute('data-switch');\n\t\t\tif (!id) {\n\t\t\t\tid = ++$.uuid;\n\t\t\t\t$.data[id] = new Toggle(this);\n\t\t\t\tthis.setAttribute('data-switch', id);\n\t\t\t} else {\n\t\t\t\tswitchApi = $.data[id];\n\t\t\t}\n\t\t\tswitchApis.push(switchApi);\n\t\t});\n\t\treturn switchApis.length > 1 ? switchApis : switchApis[0];\n\t};\n\t$.ready(function() {\n\t\t$('.' + CLASS_SWITCH)['switch']();\n\t});\n})(mui, window, 'toggle');\n/**\n * Tableviews\n * @param {type} $\n * @param {type} window\n * @param {type} document\n * @returns {undefined}\n */\n(function($, window, document) {\n\n\tvar CLASS_ACTIVE = 'mui-active';\n\tvar CLASS_SELECTED = 'mui-selected';\n\tvar CLASS_GRID_VIEW = 'mui-grid-view';\n\tvar CLASS_RADIO_VIEW = 'mui-table-view-radio';\n\tvar CLASS_TABLE_VIEW_CELL = 'mui-table-view-cell';\n\tvar CLASS_COLLAPSE_CONTENT = 'mui-collapse-content';\n\tvar CLASS_DISABLED = 'mui-disabled';\n\tvar CLASS_TOGGLE = 'mui-switch';\n\tvar CLASS_BTN = 'mui-btn';\n\n\tvar CLASS_SLIDER_HANDLE = 'mui-slider-handle';\n\tvar CLASS_SLIDER_LEFT = 'mui-slider-left';\n\tvar CLASS_SLIDER_RIGHT = 'mui-slider-right';\n\tvar CLASS_TRANSITIONING = 'mui-transitioning';\n\n\n\tvar SELECTOR_SLIDER_HANDLE = '.' + CLASS_SLIDER_HANDLE;\n\tvar SELECTOR_SLIDER_LEFT = '.' + CLASS_SLIDER_LEFT;\n\tvar SELECTOR_SLIDER_RIGHT = '.' + CLASS_SLIDER_RIGHT;\n\tvar SELECTOR_SELECTED = '.' + CLASS_SELECTED;\n\tvar SELECTOR_BUTTON = '.' + CLASS_BTN;\n\tvar overFactor = 0.8;\n\tvar cell, a;\n\n\tvar isMoved = isOpened = openedActions = progress = false;\n\tvar sliderHandle = sliderActionLeft = sliderActionRight = buttonsLeft = buttonsRight = sliderDirection = sliderRequestAnimationFrame = false;\n\tvar timer = translateX = lastTranslateX = sliderActionLeftWidth = sliderActionRightWidth = 0;\n\n\n\n\tvar toggleActive = function(isActive) {\n\t\tif (isActive) {\n\t\t\tif (a) {\n\t\t\t\ta.classList.add(CLASS_ACTIVE);\n\t\t\t} else if (cell) {\n\t\t\t\tcell.classList.add(CLASS_ACTIVE);\n\t\t\t}\n\t\t} else {\n\t\t\ttimer && timer.cancel();\n\t\t\tif (a) {\n\t\t\t\ta.classList.remove(CLASS_ACTIVE);\n\t\t\t} else if (cell) {\n\t\t\t\tcell.classList.remove(CLASS_ACTIVE);\n\t\t\t}\n\t\t}\n\t};\n\n\tvar updateTranslate = function() {\n\t\tif (translateX !== lastTranslateX) {\n\t\t\tif (buttonsRight && buttonsRight.length > 0) {\n\t\t\t\tprogress = translateX / sliderActionRightWidth;\n\t\t\t\tif (translateX < -sliderActionRightWidth) {\n\t\t\t\t\ttranslateX = -sliderActionRightWidth - Math.pow(-translateX - sliderActionRightWidth, overFactor);\n\t\t\t\t}\n\t\t\t\tfor (var i = 0, len = buttonsRight.length; i < len; i++) {\n\t\t\t\t\tvar buttonRight = buttonsRight[i];\n\t\t\t\t\tif (typeof buttonRight._buttonOffset === 'undefined') {\n\t\t\t\t\t\tbuttonRight._buttonOffset = buttonRight.offsetLeft;\n\t\t\t\t\t}\n\t\t\t\t\tbuttonOffset = buttonRight._buttonOffset;\n\t\t\t\t\tsetTranslate(buttonRight, (translateX - buttonOffset * (1 + Math.max(progress, -1))));\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (buttonsLeft && buttonsLeft.length > 0) {\n\t\t\t\tprogress = translateX / sliderActionLeftWidth;\n\t\t\t\tif (translateX > sliderActionLeftWidth) {\n\t\t\t\t\ttranslateX = sliderActionLeftWidth + Math.pow(translateX - sliderActionLeftWidth, overFactor);\n\t\t\t\t}\n\t\t\t\tfor (var i = 0, len = buttonsLeft.length; i < len; i++) {\n\t\t\t\t\tvar buttonLeft = buttonsLeft[i];\n\t\t\t\t\tif (typeof buttonLeft._buttonOffset === 'undefined') {\n\t\t\t\t\t\tbuttonLeft._buttonOffset = sliderActionLeftWidth - buttonLeft.offsetLeft - buttonLeft.offsetWidth;\n\t\t\t\t\t}\n\t\t\t\t\tbuttonOffset = buttonLeft._buttonOffset;\n\t\t\t\t\tif (buttonsLeft.length > 1) {\n\t\t\t\t\t\tbuttonLeft.style.zIndex = buttonsLeft.length - i;\n\t\t\t\t\t}\n\t\t\t\t\tsetTranslate(buttonLeft, (translateX + buttonOffset * (1 - Math.min(progress, 1))));\n\t\t\t\t}\n\t\t\t}\n\t\t\tsetTranslate(sliderHandle, translateX);\n\t\t\tlastTranslateX = translateX;\n\t\t}\n\t\tsliderRequestAnimationFrame = requestAnimationFrame(function() {\n\t\t\tupdateTranslate();\n\t\t});\n\t};\n\tvar setTranslate = function(element, x) {\n\t\tif (element) {\n\t\t\telement.style.webkitTransform = 'translate(' + x + 'px,0)';\n\t\t}\n\t};\n\n\twindow.addEventListener($.EVENT_START, function(event) {\n\t\tif (cell) {\n\t\t\ttoggleActive(false);\n\t\t}\n\t\tcell = a = false;\n\t\tisMoved = isOpened = openedActions = false;\n\t\tvar target = event.target;\n\t\tvar isDisabled = false;\n\t\tfor (; target && target !== document; target = target.parentNode) {\n\t\t\tif (target.classList) {\n\t\t\t\tvar classList = target.classList;\n\t\t\t\tif ((target.tagName === 'INPUT' && target.type !== 'radio' && target.type !== 'checkbox') || target.tagName === 'BUTTON' || classList.contains(CLASS_TOGGLE) || classList.contains(CLASS_BTN) || classList.contains(CLASS_DISABLED)) {\n\t\t\t\t\tisDisabled = true;\n\t\t\t\t}\n\t\t\t\tif (classList.contains(CLASS_COLLAPSE_CONTENT)) { //collapse content\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (classList.contains(CLASS_TABLE_VIEW_CELL)) {\n\t\t\t\t\tcell = target;\n\t\t\t\t\t//TODO swipe to delete close\n\t\t\t\t\tvar selected = cell.parentNode.querySelector(SELECTOR_SELECTED);\n\t\t\t\t\tif (!cell.parentNode.classList.contains(CLASS_RADIO_VIEW) && selected && selected !== cell) {\n\t\t\t\t\t\t$.swipeoutClose(selected);\n\t\t\t\t\t\tcell = isDisabled = false;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (!cell.parentNode.classList.contains(CLASS_GRID_VIEW)) {\n\t\t\t\t\t\tvar link = cell.querySelector('a');\n\t\t\t\t\t\tif (link && link.parentNode === cell) { //li>a\n\t\t\t\t\t\t\ta = link;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar handle = cell.querySelector(SELECTOR_SLIDER_HANDLE);\n\t\t\t\t\tif (handle) {\n\t\t\t\t\t\ttoggleEvents(cell);\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t\tif (!isDisabled) {\n\t\t\t\t\t\tif (handle) {\n\t\t\t\t\t\t\tif (timer) {\n\t\t\t\t\t\t\t\ttimer.cancel();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttimer = $.later(function() {\n\t\t\t\t\t\t\t\ttoggleActive(true);\n\t\t\t\t\t\t\t}, 100);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoggleActive(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\twindow.addEventListener($.EVENT_MOVE, function(event) {\n\t\ttoggleActive(false);\n\t});\n\n\tvar handleEvent = {\n\t\thandleEvent: function(event) {\n\t\t\tswitch (event.type) {\n\t\t\t\tcase 'drag':\n\t\t\t\t\tthis.drag(event);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'dragend':\n\t\t\t\t\tthis.dragend(event);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'flick':\n\t\t\t\t\tthis.flick(event);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'swiperight':\n\t\t\t\t\tthis.swiperight(event);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'swipeleft':\n\t\t\t\t\tthis.swipeleft(event);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\t\tdrag: function(event) {\n\t\t\tif (!cell) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!isMoved) { //init\n\t\t\t\tsliderHandle = sliderActionLeft = sliderActionRight = buttonsLeft = buttonsRight = sliderDirection = sliderRequestAnimationFrame = false;\n\t\t\t\tsliderHandle = cell.querySelector(SELECTOR_SLIDER_HANDLE);\n\t\t\t\tif (sliderHandle) {\n\t\t\t\t\tsliderActionLeft = cell.querySelector(SELECTOR_SLIDER_LEFT);\n\t\t\t\t\tsliderActionRight = cell.querySelector(SELECTOR_SLIDER_RIGHT);\n\t\t\t\t\tif (sliderActionLeft) {\n\t\t\t\t\t\tsliderActionLeftWidth = sliderActionLeft.offsetWidth;\n\t\t\t\t\t\tbuttonsLeft = sliderActionLeft.querySelectorAll(SELECTOR_BUTTON);\n\t\t\t\t\t}\n\t\t\t\t\tif (sliderActionRight) {\n\t\t\t\t\t\tsliderActionRightWidth = sliderActionRight.offsetWidth;\n\t\t\t\t\t\tbuttonsRight = sliderActionRight.querySelectorAll(SELECTOR_BUTTON);\n\t\t\t\t\t}\n\t\t\t\t\tcell.classList.remove(CLASS_TRANSITIONING);\n\t\t\t\t\tisOpened = cell.classList.contains(CLASS_SELECTED);\n\t\t\t\t\tif (isOpened) {\n\t\t\t\t\t\topenedActions = cell.querySelector(SELECTOR_SLIDER_LEFT + SELECTOR_SELECTED) ? 'left' : 'right';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar detail = event.detail;\n\t\t\tvar direction = detail.direction;\n\t\t\tvar angle = detail.angle;\n\t\t\tif (direction === 'left' && (angle > 150 || angle < -150)) {\n\t\t\t\tif (buttonsRight || (buttonsLeft && isOpened)) { //存在右侧按钮或存在左侧按钮且是已打开状态\n\t\t\t\t\tisMoved = true;\n\t\t\t\t}\n\t\t\t} else if (direction === 'right' && (angle > -30 && angle < 30)) {\n\t\t\t\tif (buttonsLeft || (buttonsRight && isOpened)) { //存在左侧按钮或存在右侧按钮且是已打开状态\n\t\t\t\t\tisMoved = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (isMoved) {\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tevent.detail.gesture.preventDefault();\n\t\t\t\tvar translate = event.detail.deltaX;\n\t\t\t\tif (isOpened) {\n\t\t\t\t\tif (openedActions === 'right') {\n\t\t\t\t\t\ttranslate = translate - sliderActionRightWidth;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttranslate = translate + sliderActionLeftWidth;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ((translate > 0 && !buttonsLeft) || (translate < 0 && !buttonsRight)) {\n\t\t\t\t\tif (!isOpened) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\ttranslate = 0;\n\t\t\t\t}\n\t\t\t\tif (translate < 0) {\n\t\t\t\t\tsliderDirection = 'toLeft';\n\t\t\t\t} else if (translate > 0) {\n\t\t\t\t\tsliderDirection = 'toRight';\n\t\t\t\t} else {\n\t\t\t\t\tif (!sliderDirection) {\n\t\t\t\t\t\tsliderDirection = 'toLeft';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!sliderRequestAnimationFrame) {\n\t\t\t\t\tupdateTranslate();\n\t\t\t\t}\n\t\t\t\ttranslateX = translate;\n\t\t\t}\n\t\t},\n\t\tflick: function(event) {\n\t\t\tif (isMoved) {\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t},\n\t\tswipeleft: function(event) {\n\t\t\tif (isMoved) {\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t},\n\t\tswiperight: function(event) {\n\t\t\tif (isMoved) {\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t},\n\t\tdragend: function(event) {\n\t\t\tif (!isMoved) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tevent.stopPropagation();\n\t\t\tif (sliderRequestAnimationFrame) {\n\t\t\t\tcancelAnimationFrame(sliderRequestAnimationFrame);\n\t\t\t\tsliderRequestAnimationFrame = null;\n\t\t\t}\n\t\t\tvar detail = event.detail;\n\t\t\tisMoved = false;\n\t\t\tvar action = 'close';\n\t\t\tvar actionsWidth = sliderDirection === 'toLeft' ? sliderActionRightWidth : sliderActionLeftWidth;\n\t\t\tvar isToggle = detail.swipe || (Math.abs(translateX) > actionsWidth / 2);\n\t\t\tif (isToggle) {\n\t\t\t\tif (!isOpened) {\n\t\t\t\t\taction = 'open';\n\t\t\t\t} else if (detail.direction === 'left' && openedActions === 'right') {\n\t\t\t\t\taction = 'open';\n\t\t\t\t} else if (detail.direction === 'right' && openedActions === 'left') {\n\t\t\t\t\taction = 'open';\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tcell.classList.add(CLASS_TRANSITIONING);\n\t\t\tvar buttons;\n\t\t\tif (action === 'open') {\n\t\t\t\tvar newTranslate = sliderDirection === 'toLeft' ? -actionsWidth : actionsWidth;\n\t\t\t\tsetTranslate(sliderHandle, newTranslate);\n\t\t\t\tbuttons = sliderDirection === 'toLeft' ? buttonsRight : buttonsLeft;\n\t\t\t\tif (typeof buttons !== 'undefined') {\n\t\t\t\t\tvar button = null;\n\t\t\t\t\tfor (var i = 0; i < buttons.length; i++) {\n\t\t\t\t\t\tbutton = buttons[i];\n\t\t\t\t\t\tsetTranslate(button, newTranslate);\n\t\t\t\t\t}\n\t\t\t\t\tbutton.parentNode.classList.add(CLASS_SELECTED);\n\t\t\t\t\tcell.classList.add(CLASS_SELECTED);\n\t\t\t\t\tif (!isOpened) {\n\t\t\t\t\t\t$.trigger(cell, sliderDirection === 'toLeft' ? 'slideleft' : 'slideright');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tsetTranslate(sliderHandle, 0);\n\t\t\t\tsliderActionLeft && sliderActionLeft.classList.remove(CLASS_SELECTED);\n\t\t\t\tsliderActionRight && sliderActionRight.classList.remove(CLASS_SELECTED);\n\t\t\t\tcell.classList.remove(CLASS_SELECTED);\n\t\t\t}\n\t\t\tvar buttonOffset;\n\t\t\tif (buttonsLeft && buttonsLeft.length > 0 && buttonsLeft !== buttons) {\n\t\t\t\tfor (var i = 0, len = buttonsLeft.length; i < len; i++) {\n\t\t\t\t\tvar buttonLeft = buttonsLeft[i];\n\t\t\t\t\tbuttonOffset = buttonLeft._buttonOffset;\n\t\t\t\t\tif (typeof buttonOffset === 'undefined') {\n\t\t\t\t\t\tbuttonLeft._buttonOffset = sliderActionLeftWidth - buttonLeft.offsetLeft - buttonLeft.offsetWidth;\n\t\t\t\t\t}\n\t\t\t\t\tsetTranslate(buttonLeft, buttonOffset);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (buttonsRight && buttonsRight.length > 0 && buttonsRight !== buttons) {\n\t\t\t\tfor (var i = 0, len = buttonsRight.length; i < len; i++) {\n\t\t\t\t\tvar buttonRight = buttonsRight[i];\n\t\t\t\t\tbuttonOffset = buttonRight._buttonOffset;\n\t\t\t\t\tif (typeof buttonOffset === 'undefined') {\n\t\t\t\t\t\tbuttonRight._buttonOffset = buttonRight.offsetLeft;\n\t\t\t\t\t}\n\t\t\t\t\tsetTranslate(buttonRight, -buttonOffset);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tfunction toggleEvents(element, isRemove) {\n\t\tvar method = !!isRemove ? 'removeEventListener' : 'addEventListener';\n\t\telement[method]('drag', handleEvent);\n\t\telement[method]('dragend', handleEvent);\n\t\telement[method]('swiperight', handleEvent);\n\t\telement[method]('swipeleft', handleEvent);\n\t\telement[method]('flick', handleEvent);\n\t};\n\t/**\n\t * 打开滑动菜单\n\t * @param {Object} el\n\t * @param {Object} direction\n\t */\n\t$.swipeoutOpen = function(el, direction) {\n\t\tif (!el) return;\n\t\tvar classList = el.classList;\n\t\tif (classList.contains(CLASS_SELECTED)) return;\n\t\tif (!direction) {\n\t\t\tif (el.querySelector(SELECTOR_SLIDER_RIGHT)) {\n\t\t\t\tdirection = 'right';\n\t\t\t} else {\n\t\t\t\tdirection = 'left';\n\t\t\t}\n\t\t}\n\t\tvar swipeoutAction = el.querySelector($.classSelector(\".slider-\" + direction));\n\t\tif (!swipeoutAction) return;\n\t\tswipeoutAction.classList.add(CLASS_SELECTED);\n\t\tclassList.add(CLASS_SELECTED);\n\t\tclassList.remove(CLASS_TRANSITIONING);\n\t\tvar buttons = swipeoutAction.querySelectorAll(SELECTOR_BUTTON);\n\t\tvar swipeoutWidth = swipeoutAction.offsetWidth;\n\t\tvar translate = (direction === 'right') ? -swipeoutWidth : swipeoutWidth;\n\t\tvar length = buttons.length;\n\t\tvar button;\n\t\tfor (var i = 0; i < length; i++) {\n\t\t\tbutton = buttons[i];\n\t\t\tif (direction === 'right') {\n\t\t\t\tsetTranslate(button, -button.offsetLeft);\n\t\t\t} else {\n\t\t\t\tsetTranslate(button, (swipeoutWidth - button.offsetWidth - button.offsetLeft));\n\t\t\t}\n\t\t}\n\t\tclassList.add(CLASS_TRANSITIONING);\n\t\tfor (var i = 0; i < length; i++) {\n\t\t\tsetTranslate(buttons[i], translate);\n\t\t}\n\t\tsetTranslate(el.querySelector(SELECTOR_SLIDER_HANDLE), translate);\n\t};\n\t/**\n\t * 关闭滑动菜单\n\t * @param {Object} el\n\t */\n\t$.swipeoutClose = function(el) {\n\t\tif (!el) return;\n\t\tvar classList = el.classList;\n\t\tif (!classList.contains(CLASS_SELECTED)) return;\n\t\tvar direction = el.querySelector(SELECTOR_SLIDER_RIGHT + SELECTOR_SELECTED) ? 'right' : 'left';\n\t\tvar swipeoutAction = el.querySelector($.classSelector(\".slider-\" + direction));\n\t\tif (!swipeoutAction) return;\n\t\tswipeoutAction.classList.remove(CLASS_SELECTED);\n\t\tclassList.remove(CLASS_SELECTED);\n\t\tclassList.add(CLASS_TRANSITIONING);\n\t\tvar buttons = swipeoutAction.querySelectorAll(SELECTOR_BUTTON);\n\t\tvar swipeoutWidth = swipeoutAction.offsetWidth;\n\t\tvar length = buttons.length;\n\t\tvar button;\n\t\tsetTranslate(el.querySelector(SELECTOR_SLIDER_HANDLE), 0);\n\t\tfor (var i = 0; i < length; i++) {\n\t\t\tbutton = buttons[i];\n\t\t\tif (direction === 'right') {\n\t\t\t\tsetTranslate(button, (-button.offsetLeft));\n\t\t\t} else {\n\t\t\t\tsetTranslate(button, (swipeoutWidth - button.offsetWidth - button.offsetLeft));\n\t\t\t}\n\t\t}\n\t};\n\n\twindow.addEventListener($.EVENT_END, function(event) { //使用touchend来取消高亮，避免一次点击既不触发tap，doubletap，longtap的事件\n\t\tif (!cell) {\n\t\t\treturn;\n\t\t}\n\t\ttoggleActive(false);\n\t\tsliderHandle && toggleEvents(cell, true);\n\t});\n\twindow.addEventListener($.EVENT_CANCEL, function(event) { //使用touchcancel来取消高亮，避免一次点击既不触发tap，doubletap，longtap的事件\n\t\tif (!cell) {\n\t\t\treturn;\n\t\t}\n\t\ttoggleActive(false);\n\t\tsliderHandle && toggleEvents(cell, true);\n\t});\n\tvar radioOrCheckboxClick = function(event) {\n\t\tvar type = event.target && event.target.type || '';\n\t\tif (type === 'radio' || type === 'checkbox') {\n\t\t\treturn;\n\t\t}\n\t\tvar classList = cell.classList;\n\t\tif (classList.contains('mui-radio')) {\n\t\t\tvar input = cell.querySelector('input[type=radio]');\n\t\t\tif (input) {\n\t\t\t\t//\t\t\t\tinput.click();\n\t\t\t\tif (!input.disabled && !input.readOnly) {\n\t\t\t\t\tinput.checked = !input.checked;\n\t\t\t\t\t$.trigger(input, 'change');\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (classList.contains('mui-checkbox')) {\n\t\t\tvar input = cell.querySelector('input[type=checkbox]');\n\t\t\tif (input) {\n\t\t\t\t//\t\t\t\tinput.click();\n\t\t\t\tif (!input.disabled && !input.readOnly) {\n\t\t\t\t\tinput.checked = !input.checked;\n\t\t\t\t\t$.trigger(input, 'change');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\t//fixed hashchange(android)\n\twindow.addEventListener($.EVENT_CLICK, function(e) {\n\t\tif (cell && cell.classList.contains('mui-collapse')) {\n\t\t\te.preventDefault();\n\t\t}\n\t});\n\twindow.addEventListener('doubletap', function(event) {\n\t\tif (cell) {\n\t\t\tradioOrCheckboxClick(event);\n\t\t}\n\t});\n\tvar preventDefaultException = /^(INPUT|TEXTAREA|BUTTON|SELECT)$/;\n\twindow.addEventListener('tap', function(event) {\n\t\tif (!cell) {\n\t\t\treturn;\n\t\t}\n\t\tvar isExpand = false;\n\t\tvar classList = cell.classList;\n\t\tvar ul = cell.parentNode;\n\t\tif (ul && ul.classList.contains(CLASS_RADIO_VIEW)) {\n\t\t\tif (classList.contains(CLASS_SELECTED)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar selected = ul.querySelector('li' + SELECTOR_SELECTED);\n\t\t\tif (selected) {\n\t\t\t\tselected.classList.remove(CLASS_SELECTED);\n\t\t\t}\n\t\t\tclassList.add(CLASS_SELECTED);\n\t\t\t$.trigger(cell, 'selected', {\n\t\t\t\tel: cell\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tif (classList.contains('mui-collapse') && !cell.parentNode.classList.contains('mui-unfold')) {\n\t\t\tif (!preventDefaultException.test(event.target.tagName)) {\n\t\t\t\tevent.detail.gesture.preventDefault();\n\t\t\t}\n\n\t\t\tif (!classList.contains(CLASS_ACTIVE)) { //展开时,需要收缩其他同类\n\t\t\t\tvar collapse = cell.parentNode.querySelector('.mui-collapse.mui-active');\n\t\t\t\tif (collapse) {\n\t\t\t\t\tcollapse.classList.remove(CLASS_ACTIVE);\n\t\t\t\t}\n\t\t\t\tisExpand = true;\n\t\t\t}\n\t\t\tclassList.toggle(CLASS_ACTIVE);\n\t\t\tif (isExpand) {\n\t\t\t\t//触发展开事件\n\t\t\t\t$.trigger(cell, 'expand');\n\n\t\t\t\t//scroll\n\t\t\t\t//暂不滚动\n\t\t\t\t// var offsetTop = $.offset(cell).top;\n\t\t\t\t// var scrollTop = document.body.scrollTop;\n\t\t\t\t// var height = window.innerHeight;\n\t\t\t\t// var offsetHeight = cell.offsetHeight;\n\t\t\t\t// var cellHeight = (offsetTop - scrollTop + offsetHeight);\n\t\t\t\t// if (offsetHeight > height) {\n\t\t\t\t// \t$.scrollTo(offsetTop, 300);\n\t\t\t\t// } else if (cellHeight > height) {\n\t\t\t\t// \t$.scrollTo(cellHeight - height + scrollTop, 300);\n\t\t\t\t// }\n\t\t\t}\n\t\t} else {\n\t\t\tradioOrCheckboxClick(event);\n\t\t}\n\t});\n})(mui, window, document);\n(function($, window) {\n\t/**\n\t * 警告消息框\n\t */\n\t$.alert = function(message, title, btnValue, callback) {\n\t\tif ($.os.plus) {\n\t\t\tif (typeof message === 'undefined') {\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tif (typeof title === 'function') {\n\t\t\t\t\tcallback = title;\n\t\t\t\t\ttitle = null;\n\t\t\t\t\tbtnValue = '确定';\n\t\t\t\t} else if (typeof btnValue === 'function') {\n\t\t\t\t\tcallback = btnValue;\n\t\t\t\t\tbtnValue = null;\n\t\t\t\t}\n\t\t\t\t$.plusReady(function() {\n\t\t\t\t\tplus.nativeUI.alert(message, callback, title, btnValue);\n\t\t\t\t});\n\t\t\t}\n\n\t\t} else {\n\t\t\t//TODO H5版本\n\t\t\twindow.alert(message);\n\t\t}\n\t};\n\n})(mui, window);\n(function($, window) {\n\t/**\n\t * 确认消息框\n\t */\n\t$.confirm = function(message, title, btnArray, callback) {\n\t\tif ($.os.plus) {\n\t\t\tif (typeof message === 'undefined') {\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tif (typeof title === 'function') {\n\t\t\t\t\tcallback = title;\n\t\t\t\t\ttitle = null;\n\t\t\t\t\tbtnArray = null;\n\t\t\t\t} else if (typeof btnArray === 'function') {\n\t\t\t\t\tcallback = btnArray;\n\t\t\t\t\tbtnArray = null;\n\t\t\t\t}\n\t\t\t\t$.plusReady(function() {\n\t\t\t\t\tplus.nativeUI.confirm(message, callback, title, btnArray);\n\t\t\t\t});\n\t\t\t}\n\n\t\t} else {\n\t\t\t//H5版本，0为确认，1为取消\n\t\t\tif (window.confirm(message)) {\n\t\t\t\tcallback({\n\t\t\t\t\tindex: 0\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tcallback({\n\t\t\t\t\tindex: 1\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\n})(mui, window);\n(function($, window) {\n\t/**\n\t * 输入对话框\n\t */\n\t$.prompt = function(text, defaultText, title, btnArray, callback) {\n\t\tif ($.os.plus) {\n\t\t\tif (typeof message === 'undefined') {\n\t\t\t\treturn;\n\t\t\t} else {\n\n\t\t\t\tif (typeof defaultText === 'function') {\n\t\t\t\t\tcallback = defaultText;\n\t\t\t\t\tdefaultText = null;\n\t\t\t\t\ttitle = null;\n\t\t\t\t\tbtnArray = null;\n\t\t\t\t} else if (typeof title === 'function') {\n\t\t\t\t\tcallback = title;\n\t\t\t\t\ttitle = null;\n\t\t\t\t\tbtnArray = null;\n\t\t\t\t} else if (typeof btnArray === 'function') {\n\t\t\t\t\tcallback = btnArray;\n\t\t\t\t\tbtnArray = null;\n\t\t\t\t}\n\t\t\t\t$.plusReady(function() {\n\t\t\t\t\tplus.nativeUI.prompt(text, callback, title, defaultText, btnArray);\n\t\t\t\t});\n\t\t\t}\n\n\t\t} else {\n\t\t\t//H5版本(确认index为0，取消index为1)\n\t\t\tvar result = window.prompt(text);\n\t\t\tif (result) {\n\t\t\t\tcallback({\n\t\t\t\t\tindex: 0,\n\t\t\t\t\tvalue: result\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tcallback({\n\t\t\t\t\tindex: 1,\n\t\t\t\t\tvalue: ''\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\n})(mui, window);\n(function($, window) {\n\tvar CLASS_ACTIVE = 'mui-active';\n\t/**\n\t * 自动消失提示框\n\t */\n\t$.toast = function(message,options) {\n\t\tvar durations = {\n\t\t    'long': 3500,\n\t\t    'short': 2000\n\t\t};\n\n\t\t//计算显示时间\n\t\t options = $.extend({\n\t        duration: 'short'\n\t    }, options || {});\n\n\n\t\tif ($.os.plus && options.type !== 'div') {\n\t\t\t//默认显示在底部；\n\t\t\t$.plusReady(function() {\n\t\t\t\tplus.nativeUI.toast(message, {\n\t\t\t\t\tverticalAlign: 'bottom',\n\t\t\t\t\tduration:options.duration\n\t\t\t\t});\n\t\t\t});\n\t\t} else {\n\t\t\tif (typeof options.duration === 'number') {\n\t\t        duration = options.duration>0 ? options.duration:durations['short'];\n\t\t    } else {\n\t\t        duration = durations[options.duration];\n\t\t    }\n\t\t    if (!duration) {\n\t\t        duration = durations['short'];\n\t\t    }\n\t\t\tvar toast = document.createElement('div');\n\t\t\ttoast.classList.add('mui-toast-container');\n\t\t\ttoast.innerHTML = '<div class=\"' + 'mui-toast-message' + '\">' + message + '</div>';\n\t\t\ttoast.addEventListener('webkitTransitionEnd', function() {\n\t\t\t\tif (!toast.classList.contains(CLASS_ACTIVE)) {\n\t\t\t\t\ttoast.parentNode.removeChild(toast);\n\t\t\t\t\ttoast = null;\n\t\t\t\t}\n\t\t\t});\n\t\t\t//点击则自动消失\n\t\t\ttoast.addEventListener('click', function() {\n\t\t        toast.parentNode.removeChild(toast);\n\t\t        toast = null;\n\t\t    });\n\t\t\tdocument.body.appendChild(toast);\n\t\t\ttoast.offsetHeight;\n\t\t\ttoast.classList.add(CLASS_ACTIVE);\n\t\t\tsetTimeout(function() {\n\t\t\t\ttoast && toast.classList.remove(CLASS_ACTIVE);\n\t\t\t}, duration);\n\n\t\t\treturn {\n\t\t        isVisible: function() {return !!toast;}\n\t\t    }\n\t\t}\n\t};\n\n})(mui, window);\n/**\n * Popup(alert,confirm,prompt)\n * @param {Object} $\n * @param {Object} window\n * @param {Object} document\n */\n(function($, window, document) {\n    var CLASS_POPUP = 'mui-popup';\n    var CLASS_POPUP_BACKDROP = 'mui-popup-backdrop';\n    var CLASS_POPUP_IN = 'mui-popup-in';\n    var CLASS_POPUP_OUT = 'mui-popup-out';\n    var CLASS_POPUP_INNER = 'mui-popup-inner';\n    var CLASS_POPUP_TITLE = 'mui-popup-title';\n    var CLASS_POPUP_TEXT = 'mui-popup-text';\n    var CLASS_POPUP_INPUT = 'mui-popup-input';\n    var CLASS_POPUP_BUTTONS = 'mui-popup-buttons';\n    var CLASS_POPUP_BUTTON = 'mui-popup-button';\n    var CLASS_POPUP_BUTTON_BOLD = 'mui-popup-button-bold';\n    var CLASS_POPUP_BACKDROP = 'mui-popup-backdrop';\n    var CLASS_ACTIVE = 'mui-active';\n\n    var popupStack = [];\n    var backdrop = (function() {\n        var element = document.createElement('div');\n        element.classList.add(CLASS_POPUP_BACKDROP);\n        element.addEventListener($.EVENT_MOVE, $.preventDefault);\n        element.addEventListener('webkitTransitionEnd', function() {\n            if (!this.classList.contains(CLASS_ACTIVE)) {\n                element.parentNode && element.parentNode.removeChild(element);\n            }\n        });\n        return element;\n    }());\n\n    var createInput = function(placeholder) {\n        return '<div class=\"' + CLASS_POPUP_INPUT + '\"><input type=\"text\" autofocus placeholder=\"' + (placeholder || '') + '\"/></div>';\n    };\n    var createInner = function(message, title, extra) {\n        return '<div class=\"' + CLASS_POPUP_INNER + '\"><div class=\"' + CLASS_POPUP_TITLE + '\">' + title + '</div><div class=\"' + CLASS_POPUP_TEXT + '\">' + message.replace(/\\r\\n/g, \"<br/>\").replace(/\\n/g, \"<br/>\") + '</div>' + (extra || '') + '</div>';\n    };\n    var createButtons = function(btnArray) {\n        var length = btnArray.length;\n        var btns = [];\n        for (var i = 0; i < length; i++) {\n            btns.push('<span class=\"' + CLASS_POPUP_BUTTON + (i === length - 1 ? (' ' + CLASS_POPUP_BUTTON_BOLD) : '') + '\">' + btnArray[i] + '</span>');\n        }\n        return '<div class=\"' + CLASS_POPUP_BUTTONS + '\">' + btns.join('') + '</div>';\n    };\n\n    var createPopup = function(html, callback) {\n        var popupElement = document.createElement('div');\n        popupElement.className = CLASS_POPUP;\n        popupElement.innerHTML = html;\n        var removePopupElement = function() {\n            popupElement.parentNode && popupElement.parentNode.removeChild(popupElement);\n            popupElement = null;\n        };\n        popupElement.addEventListener($.EVENT_MOVE, $.preventDefault);\n        popupElement.addEventListener('webkitTransitionEnd', function(e) {\n            if (popupElement && e.target === popupElement && popupElement.classList.contains(CLASS_POPUP_OUT)) {\n                removePopupElement();\n            }\n        });\n        popupElement.style.display = 'block';\n        document.body.appendChild(popupElement);\n        popupElement.offsetHeight;\n        popupElement.classList.add(CLASS_POPUP_IN);\n\n        if (!backdrop.classList.contains(CLASS_ACTIVE)) {\n            backdrop.style.display = 'block';\n            document.body.appendChild(backdrop);\n            backdrop.offsetHeight;\n            backdrop.classList.add(CLASS_ACTIVE);\n        }\n        var btns = $.qsa('.' + CLASS_POPUP_BUTTON, popupElement);\n        var input = popupElement.querySelector('.' + CLASS_POPUP_INPUT + ' input');\n        var popup = {\n            element: popupElement,\n            close: function(index, animate) {\n                if (popupElement) {\n                    var result = callback && callback({\n                        index: index || 0,\n                        value: input && input.value || ''\n                    });\n                    if (result === false) { //返回false则不关闭当前popup\n                        return;\n                    }\n                    if (animate !== false) {\n                        popupElement.classList.remove(CLASS_POPUP_IN);\n                        popupElement.classList.add(CLASS_POPUP_OUT);\n                    } else {\n                        removePopupElement();\n                    }\n                    popupStack.pop();\n                    //如果还有其他popup，则不remove backdrop\n                    if (popupStack.length) {\n                        popupStack[popupStack.length - 1]['show'](animate);\n                    } else {\n                        backdrop.classList.remove(CLASS_ACTIVE);\n                    }\n                }\n            }\n        };\n        var handleEvent = function(e) {\n            popup.close(btns.indexOf(e.target));\n        };\n        $(popupElement).on('tap', '.' + CLASS_POPUP_BUTTON, handleEvent);\n        if (popupStack.length) {\n            popupStack[popupStack.length - 1]['hide']();\n        }\n        popupStack.push({\n            close: popup.close,\n            show: function(animate) {\n                popupElement.style.display = 'block';\n                popupElement.offsetHeight;\n                popupElement.classList.add(CLASS_POPUP_IN);\n            },\n            hide: function() {\n                popupElement.style.display = 'none';\n                popupElement.classList.remove(CLASS_POPUP_IN);\n            }\n        });\n        return popup;\n    };\n    var createAlert = function(message, title, btnValue, callback, type) {\n        if (typeof message === 'undefined') {\n            return;\n        } else {\n            if (typeof title === 'function') {\n                callback = title;\n                type = btnValue;\n                title = null;\n                btnValue = null;\n            } else if (typeof btnValue === 'function') {\n                type = callback;\n                callback = btnValue;\n                btnValue = null;\n            }\n        }\n        if (!$.os.plus || type === 'div') {\n            return createPopup(createInner(message, title || '提示') + createButtons([btnValue || '确定']), callback);\n        }\n        return plus.nativeUI.alert(message, callback, title || '提示', btnValue || '确定');\n    };\n    var createConfirm = function(message, title, btnArray, callback, type) {\n        if (typeof message === 'undefined') {\n            return;\n        } else {\n            if (typeof title === 'function') {\n                callback = title;\n                type = btnArray;\n                title = null;\n                btnArray = null;\n            } else if (typeof btnArray === 'function') {\n                type = callback;\n                callback = btnArray;\n                btnArray = null;\n            }\n        }\n        if (!$.os.plus || type === 'div') {\n            return createPopup(createInner(message, title || '提示') + createButtons(btnArray || ['取消', '确认']), callback);\n        }\n        return plus.nativeUI.confirm(message, callback, title, btnArray || ['取消', '确认']);\n    };\n    var createPrompt = function(message, placeholder, title, btnArray, callback, type) {\n        if (typeof message === 'undefined') {\n            return;\n        } else {\n            if (typeof placeholder === 'function') {\n                callback = placeholder;\n                type = title;\n                placeholder = null;\n                title = null;\n                btnArray = null;\n            } else if (typeof title === 'function') {\n                callback = title;\n                type = btnArray;\n                title = null;\n                btnArray = null;\n            } else if (typeof btnArray === 'function') {\n                type = callback;\n                callback = btnArray;\n                btnArray = null;\n            }\n        }\n        if (!$.os.plus || type === 'div') {\n            return createPopup(createInner(message, title || '提示', createInput(placeholder)) + createButtons(btnArray || ['取消', '确认']), callback);\n        }\n        return plus.nativeUI.prompt(message, callback, title || '提示', placeholder, btnArray || ['取消', '确认']);\n    };\n    var closePopup = function() {\n        if (popupStack.length) {\n            popupStack[popupStack.length - 1]['close']();\n            return true;\n        } else {\n            return false;\n        }\n    };\n    var closePopups = function() {\n        while (popupStack.length) {\n            popupStack[popupStack.length - 1]['close']();\n        }\n    };\n\n    $.closePopup = closePopup;\n    $.closePopups = closePopups;\n    $.alert = createAlert;\n    $.confirm = createConfirm;\n    $.prompt = createPrompt;\n})(mui, window, document);\n(function($, document) {\n\tvar CLASS_PROGRESSBAR = 'mui-progressbar';\n\tvar CLASS_PROGRESSBAR_IN = 'mui-progressbar-in';\n\tvar CLASS_PROGRESSBAR_OUT = 'mui-progressbar-out';\n\tvar CLASS_PROGRESSBAR_INFINITE = 'mui-progressbar-infinite';\n\n\tvar SELECTOR_PROGRESSBAR = '.mui-progressbar';\n\n\tvar _findProgressbar = function(container) {\n\t\tcontainer = $(container || 'body');\n\t\tif (container.length === 0) return;\n\t\tcontainer = container[0];\n\t\tif (container.classList.contains(CLASS_PROGRESSBAR)) {\n\t\t\treturn container;\n\t\t}\n\t\tvar progressbars = container.querySelectorAll(SELECTOR_PROGRESSBAR);\n\t\tif (progressbars) {\n\t\t\tfor (var i = 0, len = progressbars.length; i < len; i++) {\n\t\t\t\tvar progressbar = progressbars[i];\n\t\t\t\tif (progressbar.parentNode === container) {\n\t\t\t\t\treturn progressbar;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\t/**\n\t * 创建并显示进度条\n\t * @param {Object} container  可选，默认body，支持selector,DOM Node,mui wrapper\n\t * @param {Object} progress 可选，undefined表示循环，数字表示具体进度\n\t * @param {Object} color 可选，指定颜色样式(目前暂未提供实际样式，可暂时不暴露此参数)\n\t */\n\tvar showProgressbar = function(container, progress, color) {\n\t\tif (typeof container === 'number') {\n\t\t\tcolor = progress;\n\t\t\tprogress = container;\n\t\t\tcontainer = 'body';\n\t\t}\n\t\tcontainer = $(container || 'body');\n\t\tif (container.length === 0) return;\n\t\tcontainer = container[0];\n\t\tvar progressbar;\n\t\tif (container.classList.contains(CLASS_PROGRESSBAR)) {\n\t\t\tprogressbar = container;\n\t\t} else {\n\t\t\tvar progressbars = container.querySelectorAll(SELECTOR_PROGRESSBAR + ':not(.' + CLASS_PROGRESSBAR_OUT + ')');\n\t\t\tif (progressbars) {\n\t\t\t\tfor (var i = 0, len = progressbars.length; i < len; i++) {\n\t\t\t\t\tvar _progressbar = progressbars[i];\n\t\t\t\t\tif (_progressbar.parentNode === container) {\n\t\t\t\t\t\tprogressbar = _progressbar;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!progressbar) {\n\t\t\t\tprogressbar = document.createElement('span');\n\t\t\t\tprogressbar.className = CLASS_PROGRESSBAR + ' ' + CLASS_PROGRESSBAR_IN + (typeof progress !== 'undefined' ? '' : (' ' + CLASS_PROGRESSBAR_INFINITE)) + (color ? (' ' + CLASS_PROGRESSBAR + '-' + color) : '');\n\t\t\t\tif (typeof progress !== 'undefined') {\n\t\t\t\t\tprogressbar.innerHTML = '<span></span>';\n\t\t\t\t}\n\t\t\t\tcontainer.appendChild(progressbar);\n\t\t\t} else {\n\t\t\t\tprogressbar.classList.add(CLASS_PROGRESSBAR_IN);\n\t\t\t}\n\t\t}\n\t\tif (progress) setProgressbar(container, progress);\n\t\treturn progressbar;\n\t};\n\t/**\n\t * 关闭进度条\n\t * @param {Object} container 可选，默认body，支持selector,DOM Node,mui wrapper\n\t */\n\tvar hideProgressbar = function(container) {\n\t\tvar progressbar = _findProgressbar(container);\n\t\tif (!progressbar) {\n\t\t\treturn;\n\t\t}\n\t\tvar classList = progressbar.classList;\n\t\tif (!classList.contains(CLASS_PROGRESSBAR_IN) || classList.contains(CLASS_PROGRESSBAR_OUT)) {\n\t\t\treturn;\n\t\t}\n\t\tclassList.remove(CLASS_PROGRESSBAR_IN);\n\t\tclassList.add(CLASS_PROGRESSBAR_OUT);\n\t\tprogressbar.addEventListener('webkitAnimationEnd', function() {\n\t\t\tprogressbar.parentNode && progressbar.parentNode.removeChild(progressbar);\n\t\t\tprogressbar = null;\n\t\t});\n\t\treturn;\n\t};\n\t/**\n\t * 设置指定进度条进度\n\t * @param {Object} container  可选，默认body，支持selector,DOM Node,mui wrapper\n\t * @param {Object} progress 可选，默认0 取值范围[0-100]\n\t * @param {Object} speed 进度条动画时间\n\t */\n\tvar setProgressbar = function(container, progress, speed) {\n\t\tif (typeof container === 'number') {\n\t\t\tspeed = progress;\n\t\t\tprogress = container;\n\t\t\tcontainer = false;\n\t\t}\n\t\tvar progressbar = _findProgressbar(container);\n\t\tif (!progressbar || progressbar.classList.contains(CLASS_PROGRESSBAR_INFINITE)) {\n\t\t\treturn;\n\t\t}\n\t\tif (progress) progress = Math.min(Math.max(progress, 0), 100);\n\t\tprogressbar.offsetHeight;\n\t\tvar span = progressbar.querySelector('span');\n\t\tif (span) {\n\t\t\tvar style = span.style;\n\t\t\tstyle.webkitTransform = 'translate3d(' + (-100 + progress) + '%,0,0)';\n\t\t\tif (typeof speed !== 'undefined') {\n\t\t\t\tstyle.webkitTransitionDuration = speed + 'ms';\n\t\t\t} else {\n\t\t\t\tstyle.webkitTransitionDuration = '';\n\t\t\t}\n\t\t}\n\t\treturn progressbar;\n\t};\n\t$.fn.progressbar = function(options) {\n\t\tvar progressbarApis = [];\n\t\toptions = options || {};\n\t\tthis.each(function() {\n\t\t\tvar self = this;\n\t\t\tvar progressbarApi = self.mui_plugin_progressbar;\n\t\t\tif (!progressbarApi) {\n\t\t\t\tself.mui_plugin_progressbar = progressbarApi = {\n\t\t\t\t\toptions: options,\n\t\t\t\t\tsetOptions: function(options) {\n\t\t\t\t\t\tthis.options = options;\n\t\t\t\t\t},\n\t\t\t\t\tshow: function() {\n\t\t\t\t\t\treturn showProgressbar(self, this.options.progress, this.options.color);\n\t\t\t\t\t},\n\t\t\t\t\tsetProgress: function(progress) {\n\t\t\t\t\t\treturn setProgressbar(self, progress);\n\t\t\t\t\t},\n\t\t\t\t\thide: function() {\n\t\t\t\t\t\treturn hideProgressbar(self);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t} else if (options) {\n\t\t\t\tprogressbarApi.setOptions(options);\n\t\t\t}\n\t\t\tprogressbarApis.push(progressbarApi);\n\t\t});\n\t\treturn progressbarApis.length === 1 ? progressbarApis[0] : progressbarApis;\n\t};\n\t//\t$.setProgressbar = setProgressbar;\n\t//\t$.showProgressbar = showProgressbar;\n\t//\t$.hideProgressbar = hideProgressbar;\n})(mui, document);\n/**\n * Input(TODO resize)\n * @param {type} $\n * @param {type} window\n * @param {type} document\n * @returns {undefined}\n */\n(function($, window, document) {\n\tvar CLASS_ICON = 'mui-icon';\n\tvar CLASS_ICON_CLEAR = 'mui-icon-clear';\n\tvar CLASS_ICON_SPEECH = 'mui-icon-speech';\n\tvar CLASS_ICON_SEARCH = 'mui-icon-search';\n\tvar CLASS_ICON_PASSWORD = 'mui-icon-eye';\n\tvar CLASS_INPUT_ROW = 'mui-input-row';\n\tvar CLASS_PLACEHOLDER = 'mui-placeholder';\n\tvar CLASS_TOOLTIP = 'mui-tooltip';\n\tvar CLASS_HIDDEN = 'mui-hidden';\n\tvar CLASS_FOCUSIN = 'mui-focusin';\n\tvar SELECTOR_ICON_CLOSE = '.' + CLASS_ICON_CLEAR;\n\tvar SELECTOR_ICON_SPEECH = '.' + CLASS_ICON_SPEECH;\n\tvar SELECTOR_ICON_PASSWORD = '.' + CLASS_ICON_PASSWORD;\n\tvar SELECTOR_PLACEHOLDER = '.' + CLASS_PLACEHOLDER;\n\tvar SELECTOR_TOOLTIP = '.' + CLASS_TOOLTIP;\n\n\tvar findRow = function(target) {\n\t\tfor (; target && target !== document; target = target.parentNode) {\n\t\t\tif (target.classList && target.classList.contains(CLASS_INPUT_ROW)) {\n\t\t\t\treturn target;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n\tvar Input = function(element, options) {\n\t\tthis.element = element;\n\t\tthis.options = options || {\n\t\t\tactions: 'clear'\n\t\t};\n\t\tif (~this.options.actions.indexOf('slider')) { //slider\n\t\t\tthis.sliderActionClass = CLASS_TOOLTIP + ' ' + CLASS_HIDDEN;\n\t\t\tthis.sliderActionSelector = SELECTOR_TOOLTIP;\n\t\t} else { //clear,speech,search\n\t\t\tif (~this.options.actions.indexOf('clear')) {\n\t\t\t\tthis.clearActionClass = CLASS_ICON + ' ' + CLASS_ICON_CLEAR + ' ' + CLASS_HIDDEN;\n\t\t\t\tthis.clearActionSelector = SELECTOR_ICON_CLOSE;\n\t\t\t}\n\t\t\tif (~this.options.actions.indexOf('speech')) { //only for 5+\n\t\t\t\tthis.speechActionClass = CLASS_ICON + ' ' + CLASS_ICON_SPEECH;\n\t\t\t\tthis.speechActionSelector = SELECTOR_ICON_SPEECH;\n\t\t\t}\n\t\t\tif (~this.options.actions.indexOf('search')) {\n\t\t\t\tthis.searchActionClass = CLASS_PLACEHOLDER;\n\t\t\t\tthis.searchActionSelector = SELECTOR_PLACEHOLDER;\n\t\t\t}\n\t\t\tif (~this.options.actions.indexOf('password')) {\n\t\t\t\tthis.passwordActionClass = CLASS_ICON + ' ' + CLASS_ICON_PASSWORD;\n\t\t\t\tthis.passwordActionSelector = SELECTOR_ICON_PASSWORD;\n\t\t\t}\n\t\t}\n\t\tthis.init();\n\t};\n\tInput.prototype.init = function() {\n\t\tthis.initAction();\n\t\tthis.initElementEvent();\n\t};\n\tInput.prototype.initAction = function() {\n\t\tvar self = this;\n\n\t\tvar row = self.element.parentNode;\n\t\tif (row) {\n\t\t\tif (self.sliderActionClass) {\n\t\t\t\tself.sliderAction = self.createAction(row, self.sliderActionClass, self.sliderActionSelector);\n\t\t\t} else {\n\t\t\t\tif (self.searchActionClass) {\n\t\t\t\t\tself.searchAction = self.createAction(row, self.searchActionClass, self.searchActionSelector);\n\t\t\t\t\tself.searchAction.addEventListener('tap', function(e) {\n\t\t\t\t\t\t$.focus(self.element);\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (self.speechActionClass) {\n\t\t\t\t\tself.speechAction = self.createAction(row, self.speechActionClass, self.speechActionSelector);\n\t\t\t\t\tself.speechAction.addEventListener('click', $.stopPropagation);\n\t\t\t\t\tself.speechAction.addEventListener('tap', function(event) {\n\t\t\t\t\t\tself.speechActionClick(event);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (self.clearActionClass) {\n\t\t\t\t\tself.clearAction = self.createAction(row, self.clearActionClass, self.clearActionSelector);\n\t\t\t\t\tself.clearAction.addEventListener('tap', function(event) {\n\t\t\t\t\t\tself.clearActionClick(event);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (self.passwordActionClass) {\n\t\t\t\t\tself.passwordAction = self.createAction(row, self.passwordActionClass, self.passwordActionSelector);\n\t\t\t\t\tself.passwordAction.addEventListener('tap', function(event) {\n\t\t\t\t\t\tself.passwordActionClick(event);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\tInput.prototype.createAction = function(row, actionClass, actionSelector) {\n\t\tvar action = row.querySelector(actionSelector);\n\t\tif (!action) {\n\t\t\tvar action = document.createElement('span');\n\t\t\taction.className = actionClass;\n\t\t\tif (actionClass === this.searchActionClass) {\n\t\t\t\taction.innerHTML = '<span class=\"' + CLASS_ICON + ' ' + CLASS_ICON_SEARCH + '\"></span><span>' + this.element.getAttribute('placeholder') + '</span>';\n\t\t\t\tthis.element.setAttribute('placeholder', '');\n\t\t\t\tif (this.element.value.trim()) {\n\t\t\t\t\trow.classList.add('mui-active');\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.insertBefore(action, this.element.nextSibling);\n\t\t}\n\t\treturn action;\n\t};\n\tInput.prototype.initElementEvent = function() {\n\t\tvar element = this.element;\n\n\t\tif (this.sliderActionClass) {\n\t\t\tvar tooltip = this.sliderAction;\n\t\t\tvar timer = null;\n\t\t\tvar showTip = function() { //每次重新计算是因为控件可能被隐藏，初始化时计算是不正确的\n\t\t\t\ttooltip.classList.remove(CLASS_HIDDEN);\n\t\t\t\tvar offsetLeft = element.offsetLeft;\n\t\t\t\tvar width = element.offsetWidth - 28;\n\t\t\t\tvar tooltipWidth = tooltip.offsetWidth;\n\t\t\t\tvar distince = Math.abs(element.max - element.min);\n\t\t\t\tvar scaleWidth = (width / distince) * Math.abs(element.value - element.min);\n\t\t\t\ttooltip.style.left = (14 + offsetLeft + scaleWidth - tooltipWidth / 2) + 'px';\n\t\t\t\ttooltip.innerText = element.value;\n\t\t\t\tif (timer) {\n\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t}\n\t\t\t\ttimer = setTimeout(function() {\n\t\t\t\t\ttooltip.classList.add(CLASS_HIDDEN);\n\t\t\t\t}, 1000);\n\t\t\t};\n\t\t\telement.addEventListener('input', showTip);\n\t\t\telement.addEventListener('tap', showTip);\n\t\t\telement.addEventListener($.EVENT_MOVE, function(e) {\n\t\t\t\te.stopPropagation();\n\t\t\t});\n\t\t} else {\n\t\t\tif (this.clearActionClass) {\n\t\t\t\tvar action = this.clearAction;\n\t\t\t\tif (!action) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t$.each(['keyup', 'change', 'input', 'focus', 'cut', 'paste'], function(index, type) {\n\t\t\t\t\t(function(type) {\n\t\t\t\t\t\telement.addEventListener(type, function() {\n\t\t\t\t\t\t\taction.classList[element.value.trim() ? 'remove' : 'add'](CLASS_HIDDEN);\n\t\t\t\t\t\t});\n\t\t\t\t\t})(type);\n\t\t\t\t});\n\t\t\t\telement.addEventListener('blur', function() {\n\t\t\t\t\taction.classList.add(CLASS_HIDDEN);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (this.searchActionClass) {\n\t\t\t\telement.addEventListener('focus', function() {\n\t\t\t\t\telement.parentNode.classList.add('mui-active');\n\t\t\t\t});\n\t\t\t\telement.addEventListener('blur', function() {\n\t\t\t\t\tif (!element.value.trim()) {\n\t\t\t\t\t\telement.parentNode.classList.remove('mui-active');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\tInput.prototype.setPlaceholder = function(text) {\n\t\tif (this.searchActionClass) {\n\t\t\tvar placeholder = this.element.parentNode.querySelector(SELECTOR_PLACEHOLDER);\n\t\t\tplaceholder && (placeholder.getElementsByTagName('span')[1].innerText = text);\n\t\t} else {\n\t\t\tthis.element.setAttribute('placeholder', text);\n\t\t}\n\t};\n\tInput.prototype.passwordActionClick = function(event) {\n\t\tif (this.element.type === 'text') {\n\t\t\tthis.element.type = 'password';\n\t\t} else {\n\t\t\tthis.element.type = 'text';\n\t\t}\n\t\tthis.passwordAction.classList.toggle('mui-active');\n\t\tevent.preventDefault();\n\t};\n\tInput.prototype.clearActionClick = function(event) {\n\t\tvar self = this;\n\t\tself.element.value = '';\n\t\t$.focus(self.element);\n\t\tself.clearAction.classList.add(CLASS_HIDDEN);\n\t\tevent.preventDefault();\n\t};\n\tInput.prototype.speechActionClick = function(event) {\n\t\tif (window.plus) {\n\t\t\tvar self = this;\n\t\t\tvar oldValue = self.element.value;\n\t\t\tself.element.value = '';\n\t\t\tdocument.body.classList.add(CLASS_FOCUSIN);\n\t\t\tplus.speech.startRecognize({\n\t\t\t\tengine: 'iFly'\n\t\t\t}, function(s) {\n\t\t\t\tself.element.value += s;\n\t\t\t\t$.focus(self.element);\n\t\t\t\tplus.speech.stopRecognize();\n\t\t\t\t$.trigger(self.element, 'recognized', {\n\t\t\t\t\tvalue: self.element.value\n\t\t\t\t});\n\t\t\t\tif (oldValue !== self.element.value) {\n\t\t\t\t\t$.trigger(self.element, 'change');\n\t\t\t\t\t$.trigger(self.element, 'input');\n\t\t\t\t}\n\t\t\t\t// document.body.classList.remove(CLASS_FOCUSIN);\n\t\t\t}, function(e) {\n\t\t\t\tdocument.body.classList.remove(CLASS_FOCUSIN);\n\t\t\t});\n\t\t} else {\n\t\t\talert('only for 5+');\n\t\t}\n\t\tevent.preventDefault();\n\t};\n\t$.fn.input = function(options) {\n\t\tvar inputApis = [];\n\t\tthis.each(function() {\n\t\t\tvar inputApi = null;\n\t\t\tvar actions = [];\n\t\t\tvar row = findRow(this.parentNode);\n\t\t\tif (this.type === 'range' && row.classList.contains('mui-input-range')) {\n\t\t\t\tactions.push('slider');\n\t\t\t} else {\n\t\t\t\tvar classList = this.classList;\n\t\t\t\tif (classList.contains('mui-input-clear')) {\n\t\t\t\t\tactions.push('clear');\n\t\t\t\t}\n\t\t\t\tif (!($.os.android && $.os.stream) && classList.contains('mui-input-speech')) {\n\t\t\t\t\tactions.push('speech');\n\t\t\t\t}\n\t\t\t\tif (classList.contains('mui-input-password')) {\n\t\t\t\t\tactions.push('password');\n\t\t\t\t}\n\t\t\t\tif (this.type === 'search' && row.classList.contains('mui-search')) {\n\t\t\t\t\tactions.push('search');\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar id = this.getAttribute('data-input-' + actions[0]);\n\t\t\tif (!id) {\n\t\t\t\tid = ++$.uuid;\n\t\t\t\tinputApi = $.data[id] = new Input(this, {\n\t\t\t\t\tactions: actions.join(',')\n\t\t\t\t});\n\t\t\t\tfor (var i = 0, len = actions.length; i < len; i++) {\n\t\t\t\t\tthis.setAttribute('data-input-' + actions[i], id);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tinputApi = $.data[id];\n\t\t\t}\n\t\t\tinputApis.push(inputApi);\n\t\t});\n\t\treturn inputApis.length === 1 ? inputApis[0] : inputApis;\n\t};\n\t$.ready(function() {\n\t\t$('.mui-input-row input').input();\n\t});\n})(mui, window, document);\n(function($, window) {\n    var CLASS_ACTIVE = 'mui-active';\n    var rgbaRegex = /^rgba\\((\\d{1,3}),\\s*(\\d{1,3}),\\s*(\\d{1,3}),\\s*(\\d*(?:\\.\\d+)?)\\)$/;\n    var getColor = function(colorStr) {\n        var matches = colorStr.match(rgbaRegex);\n        if (matches && matches.length === 5) {\n            return [\n                matches[1],\n                matches[2],\n                matches[3],\n                matches[4]\n            ];\n        }\n        return [];\n    };\n    var Transparent = function(element, options) {\n        this.element = element;\n        this.options = $.extend({\n            top: 0, //距离顶部高度(到达该高度即触发)\n            offset: 150, //滚动透明距离\n            duration: 16, //过渡时间\n            scrollby: window//监听滚动距离容器\n        }, options || {});\n\n        this.scrollByElem = this.options.scrollby || window;\n        if (!this.scrollByElem) {\n            throw new Error(\"监听滚动的元素不存在\");\n        }\n        this.isNativeScroll = false;\n        if (this.scrollByElem === window) {\n            this.isNativeScroll = true;\n        } else if (!~this.scrollByElem.className.indexOf('mui-scroll-wrapper')) {\n            this.isNativeScroll = true;\n        }\n\n        this._style = this.element.style;\n        this._bgColor = this._style.backgroundColor;\n        var color = getColor(mui.getStyles(this.element, 'backgroundColor'));\n        if (color.length) {\n            this._R = color[0];\n            this._G = color[1];\n            this._B = color[2];\n            this._A = parseFloat(color[3]);\n            this.lastOpacity = this._A;\n            this._bufferFn = $.buffer(this.handleScroll, this.options.duration, this);\n            this.initEvent();\n        } else {\n            throw new Error(\"元素背景颜色必须为RGBA\");\n        }\n    };\n\n    Transparent.prototype.initEvent = function() {\n        this.scrollByElem.addEventListener('scroll', this._bufferFn);\n        if (this.isNativeScroll) { //原生scroll\n            this.scrollByElem.addEventListener($.EVENT_MOVE, this._bufferFn);\n        }\n    }\n    Transparent.prototype.handleScroll = function(e) {\n        var y = window.scrollY;\n        if (!this.isNativeScroll && e && e.detail) {\n            y = -e.detail.y;\n        }\n        var opacity = (y - this.options.top) / this.options.offset + this._A;\n        opacity = Math.min(Math.max(this._A, opacity), 1);\n        this._style.backgroundColor = 'rgba(' + this._R + ',' + this._G + ',' + this._B + ',' + opacity + ')';\n        if (opacity > this._A) {\n            this.element.classList.add(CLASS_ACTIVE);\n        } else {\n            this.element.classList.remove(CLASS_ACTIVE);\n        }\n        if (this.lastOpacity !== opacity) {\n            $.trigger(this.element, 'alpha', {\n                alpha: opacity\n            });\n            this.lastOpacity = opacity;\n        }\n    };\n    Transparent.prototype.destory = function() {\n        this.scrollByElem.removeEventListener('scroll', this._bufferFn);\n        this.scrollByElem.removeEventListener($.EVENT_MOVE, this._bufferFn);\n        this.element.style.backgroundColor = this._bgColor;\n        this.element.mui_plugin_transparent = null;\n    };\n    $.fn.transparent = function(options) {\n        options = options || {};\n        var transparentApis = [];\n        this.each(function() {\n            var transparentApi = this.mui_plugin_transparent;\n            if (!transparentApi) {\n                var top = this.getAttribute('data-top');\n                var offset = this.getAttribute('data-offset');\n                var duration = this.getAttribute('data-duration');\n                var scrollby = this.getAttribute('data-scrollby');\n                if (top !== null && typeof options.top === 'undefined') {\n                    options.top = top;\n                }\n                if (offset !== null && typeof options.offset === 'undefined') {\n                    options.offset = offset;\n                }\n                if (duration !== null && typeof options.duration === 'undefined') {\n                    options.duration = duration;\n                }\n                if (scrollby !== null && typeof options.scrollby === 'undefined') {\n                    options.scrollby = document.querySelector(scrollby) || window;\n                }\n                transparentApi = this.mui_plugin_transparent = new Transparent(this, options);\n            }\n            transparentApis.push(transparentApi);\n        });\n        return transparentApis.length === 1 ? transparentApis[0] : transparentApis;\n    };\n    $.ready(function() {\n        $('.mui-bar-transparent').transparent();\n    });\n})(mui, window);\n/**\n * 数字输入框\n * varstion 1.0.1\n * by Houfeng\n * Houfeng@DCloud.io\n */\n\n(function($) {\n\n    var touchSupport = ('ontouchstart' in document);\n    var tapEventName = touchSupport ? 'tap' : 'click';\n    var changeEventName = 'change';\n    var holderClassName = 'mui-numbox';\n    var plusClassSelector = '.mui-btn-numbox-plus,.mui-numbox-btn-plus';\n    var minusClassSelector = '.mui-btn-numbox-minus,.mui-numbox-btn-minus';\n    var inputClassSelector = '.mui-input-numbox,.mui-numbox-input';\n\n    var Numbox = $.Numbox = $.Class.extend({\n        /**\n         * 构造函数\n         **/\n        init: function(holder, options) {\n            var self = this;\n            if (!holder) {\n                throw \"构造 numbox 时缺少容器元素\";\n            }\n            self.holder = holder;\n            options = options || {};\n            options.step = parseInt(options.step || 1);\n            self.options = options;\n            self.input = $.qsa(inputClassSelector, self.holder)[0];\n            self.plus = $.qsa(plusClassSelector, self.holder)[0];\n            self.minus = $.qsa(minusClassSelector, self.holder)[0];\n            self.checkValue();\n            self.initEvent();\n        },\n        /**\n         * 初始化事件绑定\n         **/\n        initEvent: function() {\n            var self = this;\n            self.plus.addEventListener(tapEventName, function(event) {\n                var val = parseInt(self.input.value) + self.options.step;\n                self.input.value = val.toString();\n                $.trigger(self.input, changeEventName, null);\n            });\n            self.minus.addEventListener(tapEventName, function(event) {\n                var val = parseInt(self.input.value) - self.options.step;\n                self.input.value = val.toString();\n                $.trigger(self.input, changeEventName, null);\n            });\n            self.input.addEventListener(changeEventName, function(event) {\n                self.checkValue();\n                var val = parseInt(self.input.value);\n                //触发顶层容器\n                $.trigger(self.holder, changeEventName, {\n                    value: val\n                });\n            });\n        },\n        /**\n         * 获取当前值\n         **/\n        getValue: function() {\n            var self = this;\n            return parseInt(self.input.value);\n        },\n        /**\n         * 验证当前值是法合法\n         **/\n        checkValue: function() {\n            var self = this;\n            var val = self.input.value;\n            if (val == null || val == '' || isNaN(val)) {\n                self.input.value = self.options.min || 0;\n                self.minus.disabled = self.options.min != null;\n            } else {\n                var val = parseInt(val);\n                if (self.options.max != null && !isNaN(self.options.max) && val >= parseInt(self.options.max)) {\n                    val = self.options.max;\n                    self.plus.disabled = true;\n                } else {\n                    self.plus.disabled = false;\n                }\n                if (self.options.min != null && !isNaN(self.options.min) && val <= parseInt(self.options.min)) {\n                    val = self.options.min;\n                    self.minus.disabled = true;\n                } else {\n                    self.minus.disabled = false;\n                }\n                self.input.value = val;\n            }\n        },\n        /**\n         * 更新选项\n         **/\n        setOption: function(name, value) {\n            var self = this;\n            self.options[name] = value;\n        },\n        /**\n         * 动态设置新值\n         **/\n        setValue: function(value) {\n            this.input.value = value;\n            this.checkValue();\n        }\n    });\n\n    $.fn.numbox = function(options) {\n        var instanceArray = [];\n        //遍历选择的元素\n        this.each(function(i, element) {\n            if (element.numbox) {\n                return;\n            }\n            if (options) {\n                element.numbox = new Numbox(element, options);\n            } else {\n                var optionsText = element.getAttribute('data-numbox-options');\n                var options = optionsText ? JSON.parse(optionsText) : {};\n                options.step = element.getAttribute('data-numbox-step') || options.step;\n                options.min = element.getAttribute('data-numbox-min') || options.min;\n                options.max = element.getAttribute('data-numbox-max') || options.max;\n                element.numbox = new Numbox(element, options);\n            }\n        });\n        return this[0] ? this[0].numbox : null;\n    }\n\n    //自动处理 class='mui-locker' 的 dom\n    $.ready(function() {\n        $('.' + holderClassName).numbox();\n    });\n\n}(mui));\n/**\n * Button\n * @param {type} $\n * @param {type} window\n * @param {type} document\n * @returns {undefined}\n */\n(function($, window, document) {\n    var CLASS_ICON = 'mui-icon';\n    var CLASS_DISABLED = 'mui-disabled';\n\n    var STATE_RESET = 'reset';\n    var STATE_LOADING = 'loading';\n\n    var defaultOptions = {\n        loadingText: 'Loading...', //文案\n        loadingIcon: 'mui-spinner' + ' ' + 'mui-spinner-white', //图标，可为空\n        loadingIconPosition: 'left' //图标所处位置，仅支持left|right\n    };\n\n    var Button = function(element, options) {\n        this.element = element;\n        this.options = $.extend({}, defaultOptions, options);\n        if (!this.options.loadingText) {\n            this.options.loadingText = defaultOptions.loadingText;\n        }\n        if (this.options.loadingIcon === null) {\n            this.options.loadingIcon = 'mui-spinner';\n            if ($.getStyles(this.element, 'color') === 'rgb(255, 255, 255)') {\n                this.options.loadingIcon += ' ' + 'mui-spinner-white';\n            }\n        }\n        this.isInput = this.element.tagName === 'INPUT';\n        this.resetHTML = this.isInput ? this.element.value : this.element.innerHTML;\n        this.state = '';\n    };\n    Button.prototype.loading = function() {\n        this.setState(STATE_LOADING);\n    };\n    Button.prototype.reset = function() {\n        this.setState(STATE_RESET);\n    };\n    Button.prototype.setState = function(state) {\n        if (this.state === state) {\n            return false;\n        }\n        this.state = state;\n        if (state === STATE_RESET) {\n            this.element.disabled = false;\n            this.element.classList.remove(CLASS_DISABLED);\n            this.setHtml(this.resetHTML);\n        } else if (state === STATE_LOADING) {\n            this.element.disabled = true;\n            this.element.classList.add(CLASS_DISABLED);\n            var html = this.isInput ? this.options.loadingText : ('<span>' + this.options.loadingText + '</span>');\n            if (this.options.loadingIcon && !this.isInput) {\n                if (this.options.loadingIconPosition === 'right') {\n                    html += '&nbsp;<span class=\"' + this.options.loadingIcon + '\"></span>';\n                } else {\n                    html = '<span class=\"' + this.options.loadingIcon + '\"></span>&nbsp;' + html;\n                }\n            }\n            this.setHtml(html);\n        }\n    };\n    Button.prototype.setHtml = function(html) {\n        if (this.isInput) {\n            this.element.value = html;\n        } else {\n            this.element.innerHTML = html;\n        }\n    }\n    $.fn.button = function(state) {\n        var buttonApis = [];\n        this.each(function() {\n            var buttonApi = this.mui_plugin_button;\n            if (!buttonApi) {\n                var loadingText = this.getAttribute('data-loading-text');\n                var loadingIcon = this.getAttribute('data-loading-icon');\n                var loadingIconPosition = this.getAttribute('data-loading-icon-position');\n                this.mui_plugin_button = buttonApi = new Button(this, {\n                    loadingText: loadingText,\n                    loadingIcon: loadingIcon,\n                    loadingIconPosition: loadingIconPosition\n                });\n            }\n            if (state === STATE_LOADING || state === STATE_RESET) {\n                buttonApi.setState(state);\n            }\n            buttonApis.push(buttonApi);\n        });\n        return buttonApis.length === 1 ? buttonApis[0] : buttonApis;\n    };\n})(mui, window, document);\n// window.mui = mui\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9saWIvbXVpL2pzL211aS5qcz81NTlhIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFlBQVksS0FBSztBQUNqQixZQUFZLEtBQUs7QUFDakIsWUFBWSxLQUFLO0FBQ2pCLGNBQWM7QUFDZDtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLFFBQVEsWUFBWTtBQUNwQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBTztBQUNQO0FBQ0E7O0FBRUE7O0FBRUEsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGtEQUFrRDtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksT0FBTztBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsb0JBQW9CO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2RUFBNkU7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7O0FBR0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFO0FBQ0YsQ0FBQztBQUNEO0FBQ0E7QUFDQSxXQUFXLEtBQUs7QUFDaEIsV0FBVyxLQUFLO0FBQ2hCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGLENBQUM7QUFDRDtBQUNBO0FBQ0EsV0FBVyxLQUFLO0FBQ2hCLFdBQVcsS0FBSztBQUNoQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRixDQUFDO0FBQ0Q7QUFDQTtBQUNBLFdBQVcsS0FBSztBQUNoQixXQUFXLEtBQUs7QUFDaEIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGLENBQUM7QUFDRDtBQUNBO0FBQ0EsV0FBVyxLQUFLO0FBQ2hCLFdBQVcsS0FBSztBQUNoQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNGQUFzRjtBQUN0RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0YsQ0FBQztBQUNEO0FBQ0E7QUFDQSxXQUFXLEtBQUs7QUFDaEIsV0FBVyxLQUFLO0FBQ2hCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRixDQUFDO0FBQ0Q7QUFDQTtBQUNBLFdBQVcsS0FBSztBQUNoQixXQUFXLEtBQUs7QUFDaEIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRixDQUFDO0FBQ0Q7QUFDQTtBQUNBLFdBQVcsS0FBSztBQUNoQixXQUFX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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBQXNEO0FBQ3REO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxJQUFJO0FBQzlDO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLFNBQVM7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxRUFBcUU7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRTtBQUNGLENBQUM7QUFDRDtBQUNBO0FBQ0EsV0FBVyxLQUFLO0FBQ2hCLFdBQVcsS0FBSztBQUNoQixXQUFXLEtBQUs7QUFDaEIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUEsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsd0VBQXdFLEtBQUsscURBQXFELGVBQWU7O0FBRWpKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0Esb0RBQW9ELGVBQWUsa0NBQWtDLEtBQUs7QUFDMUc7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsdUVBQXVFO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxrQ0FBa0MsS0FBSztBQUN2QztBQUNBOztBQUVBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLFlBQVk7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSwyQ0FBMkMsU0FBUztBQUNwRDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLFNBQVMsWUFBWTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBLDBGQUEwRjtBQUMxRjtBQUNBLG9EQUFvRDtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0EsZUFBZTtBQUNmLDhDQUE4QztBQUM5QztBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEM7QUFDOUM7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLElBQUksT0FBTztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDO0FBQzlDO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDZCQUE2Qjs7QUFFN0IsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxzREFBc0Q7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQ7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsS0FBSztBQUM3QztBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxzREFBc0Q7QUFDdEQ7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLEtBQUs7QUFDN0M7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsU0FBUztBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0Q7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLEtBQUs7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSx1Q0FBdUMsU0FBUztBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBOztBQUVBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQSw2QkFBNkI7O0FBRTdCO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLENBQUM7QUFDRDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsOERBQThEO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNB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UTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLHVEQUF1RDtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLCtCQUErQjtBQUN2QztBQUNBLHNFQUFzRTtBQUN0RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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V0FBVyxLQUFLO0FBQ2hCLFdBQVcsS0FBSztBQUNoQixhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7OztBQUdGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBeUQ7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0YsQ0FBQztBQUNEO0FBQ0E7QUFDQSxXQUFXLEtBQUs7QUFDaEIsV0FBVyxLQUFLO0FBQ2hCLFdBQVcsS0FBSztBQUNoQixhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLFNBQVM7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMsU0FBUztBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsK0JBQStCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxREFBcUQ7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkM7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvREFBb0Q7QUFDcEQ7QUFDQTtBQUNBLElBQUk7QUFDSixvREFBb0Q7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixvQkFBb0I7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLFNBQVM7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLFNBQVM7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLE9BQU87QUFDbkIsWUFBWSxPQUFPO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsWUFBWTtBQUM3QjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsWUFBWTtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLE9BQU87QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsWUFBWTtBQUM3QjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsdURBQXVEO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0YsMERBQTBEO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsMkNBQTJDO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEVBQUU7QUFDRixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJO0FBQ0o7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUEsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUEsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQSxDQUFDO0FBQ0Q7QUFD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QUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRDtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLE1BQU07QUFDTixLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSxJQUFJO0FBQ0osR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCx5Q0FBeUMsU0FBUztBQUNsRDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRixDQUFDO0FBQ0Q7QUFDQTtBQUNBLGdDQUFnQyxJQUFJLFNBQVMsSUFBSSxTQUFTLElBQUk7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLGVBQWU7O0FBRXhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGtDQUFrQztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMLENBQUM7QUFDRDtBQUNBO0FBQ0EsV0FBVyxLQUFLO0FBQ2hCLFdBQVcsS0FBSztBQUNoQixXQUFXLEtBQUs7QUFDaEIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUM7QUFDbkMsaUJBQWlCO0FBQ2pCLHdGQUF3RjtBQUN4RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxDQUFDO0FBQ0QiLCJmaWxlIjoiOTY0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICogTXVpIHYzLjcuMCAoaHR0cDovL2Rldi5kY2xvdWQubmV0LmNuL211aSlcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gKi9cbi8qKlxuICogTVVJ5qC45b+DSlNcbiAqIEB0eXBlIF9MNC4kfEZ1bmN0aW9uXG4gKi9cbnZhciBtdWkgPSAoZnVuY3Rpb24oZG9jdW1lbnQsIHVuZGVmaW5lZCkge1xuXHR2YXIgcmVhZHlSRSA9IC9jb21wbGV0ZXxsb2FkZWR8aW50ZXJhY3RpdmUvO1xuXHR2YXIgaWRTZWxlY3RvclJFID0gL14jKFtcXHctXSspJC87XG5cdHZhciBjbGFzc1NlbGVjdG9yUkUgPSAvXlxcLihbXFx3LV0rKSQvO1xuXHR2YXIgdGFnU2VsZWN0b3JSRSA9IC9eW1xcdy1dKyQvO1xuXHR2YXIgdHJhbnNsYXRlUkUgPSAvdHJhbnNsYXRlKD86M2QpP1xcKCguKz8pXFwpLztcblx0dmFyIHRyYW5zbGF0ZU1hdHJpeFJFID0gL21hdHJpeCgzZCk/XFwoKC4rPylcXCkvO1xuXG5cdHZhciAkID0gZnVuY3Rpb24oc2VsZWN0b3IsIGNvbnRleHQpIHtcblx0XHRjb250ZXh0ID0gY29udGV4dCB8fCBkb2N1bWVudDtcblx0XHRpZiAoIXNlbGVjdG9yKVxuXHRcdFx0cmV0dXJuIHdyYXAoKTtcblx0XHRpZiAodHlwZW9mIHNlbGVjdG9yID09PSAnb2JqZWN0Jylcblx0XHRcdGlmICgkLmlzQXJyYXlMaWtlKHNlbGVjdG9yKSkge1xuXHRcdFx0XHRyZXR1cm4gd3JhcCgkLnNsaWNlLmNhbGwoc2VsZWN0b3IpLCBudWxsKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJldHVybiB3cmFwKFtzZWxlY3Rvcl0sIG51bGwpO1xuXHRcdFx0fVxuXHRcdGlmICh0eXBlb2Ygc2VsZWN0b3IgPT09ICdmdW5jdGlvbicpXG5cdFx0XHRyZXR1cm4gJC5yZWFkeShzZWxlY3Rvcik7XG5cdFx0aWYgKHR5cGVvZiBzZWxlY3RvciA9PT0gJ3N0cmluZycpIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdHNlbGVjdG9yID0gc2VsZWN0b3IudHJpbSgpO1xuXHRcdFx0XHRpZiAoaWRTZWxlY3RvclJFLnRlc3Qoc2VsZWN0b3IpKSB7XG5cdFx0XHRcdFx0dmFyIGZvdW5kID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoUmVnRXhwLiQxKTtcblx0XHRcdFx0XHRyZXR1cm4gd3JhcChmb3VuZCA/IFtmb3VuZF0gOiBbXSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHdyYXAoJC5xc2Eoc2VsZWN0b3IsIGNvbnRleHQpLCBzZWxlY3Rvcik7XG5cdFx0XHR9IGNhdGNoIChlKSB7fVxuXHRcdH1cblx0XHRyZXR1cm4gd3JhcCgpO1xuXHR9O1xuXG5cdHZhciB3cmFwID0gZnVuY3Rpb24oZG9tLCBzZWxlY3Rvcikge1xuXHRcdGRvbSA9IGRvbSB8fCBbXTtcblx0XHRPYmplY3Quc2V0UHJvdG90eXBlT2YoZG9tLCAkLmZuKTtcblx0XHRkb20uc2VsZWN0b3IgPSBzZWxlY3RvciB8fCAnJztcblx0XHRyZXR1cm4gZG9tO1xuXHR9O1xuXG5cdCQudXVpZCA9IDA7XG5cblx0JC5kYXRhID0ge307XG5cdC8qKlxuXHQgKiBleHRlbmQoc2ltcGxlKVxuXHQgKiBAcGFyYW0ge3R5cGV9IHRhcmdldFxuXHQgKiBAcGFyYW0ge3R5cGV9IHNvdXJjZVxuXHQgKiBAcGFyYW0ge3R5cGV9IGRlZXBcblx0ICogQHJldHVybnMge3VucmVzb2x2ZWR9XG5cdCAqL1xuXHQkLmV4dGVuZCA9IGZ1bmN0aW9uKCkgeyAvL2Zyb20ganF1ZXJ5MlxuXHRcdHZhciBvcHRpb25zLCBuYW1lLCBzcmMsIGNvcHksIGNvcHlJc0FycmF5LCBjbG9uZSxcblx0XHRcdHRhcmdldCA9IGFyZ3VtZW50c1swXSB8fCB7fSxcblx0XHRcdGkgPSAxLFxuXHRcdFx0bGVuZ3RoID0gYXJndW1lbnRzLmxlbmd0aCxcblx0XHRcdGRlZXAgPSBmYWxzZTtcblxuXHRcdGlmICh0eXBlb2YgdGFyZ2V0ID09PSBcImJvb2xlYW5cIikge1xuXHRcdFx0ZGVlcCA9IHRhcmdldDtcblxuXHRcdFx0dGFyZ2V0ID0gYXJndW1lbnRzW2ldIHx8IHt9O1xuXHRcdFx0aSsrO1xuXHRcdH1cblxuXHRcdGlmICh0eXBlb2YgdGFyZ2V0ICE9PSBcIm9iamVjdFwiICYmICEkLmlzRnVuY3Rpb24odGFyZ2V0KSkge1xuXHRcdFx0dGFyZ2V0ID0ge307XG5cdFx0fVxuXG5cdFx0aWYgKGkgPT09IGxlbmd0aCkge1xuXHRcdFx0dGFyZ2V0ID0gdGhpcztcblx0XHRcdGktLTtcblx0XHR9XG5cblx0XHRmb3IgKDsgaSA8IGxlbmd0aDsgaSsrKSB7XG5cdFx0XHRpZiAoKG9wdGlvbnMgPSBhcmd1bWVudHNbaV0pICE9IG51bGwpIHtcblx0XHRcdFx0Zm9yIChuYW1lIGluIG9wdGlvbnMpIHtcblx0XHRcdFx0XHRzcmMgPSB0YXJnZXRbbmFtZV07XG5cdFx0XHRcdFx0Y29weSA9IG9wdGlvbnNbbmFtZV07XG5cblx0XHRcdFx0XHRpZiAodGFyZ2V0ID09PSBjb3B5KSB7XG5cdFx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoZGVlcCAmJiBjb3B5ICYmICgkLmlzUGxhaW5PYmplY3QoY29weSkgfHwgKGNvcHlJc0FycmF5ID0gJC5pc0FycmF5KGNvcHkpKSkpIHtcblx0XHRcdFx0XHRcdGlmIChjb3B5SXNBcnJheSkge1xuXHRcdFx0XHRcdFx0XHRjb3B5SXNBcnJheSA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0XHRjbG9uZSA9IHNyYyAmJiAkLmlzQXJyYXkoc3JjKSA/IHNyYyA6IFtdO1xuXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRjbG9uZSA9IHNyYyAmJiAkLmlzUGxhaW5PYmplY3Qoc3JjKSA/IHNyYyA6IHt9O1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR0YXJnZXRbbmFtZV0gPSAkLmV4dGVuZChkZWVwLCBjbG9uZSwgY29weSk7XG5cblx0XHRcdFx0XHR9IGVsc2UgaWYgKGNvcHkgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdFx0dGFyZ2V0W25hbWVdID0gY29weTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gdGFyZ2V0O1xuXHR9O1xuXHQvKipcblx0ICogbXVpIG5vb3AoZnVuY3Rpb24pXG5cdCAqL1xuXHQkLm5vb3AgPSBmdW5jdGlvbigpIHt9O1xuXHQvKipcblx0ICogbXVpIHNsaWNlKGFycmF5KVxuXHQgKi9cblx0JC5zbGljZSA9IFtdLnNsaWNlO1xuXHQvKipcblx0ICogbXVpIGZpbHRlcihhcnJheSlcblx0ICovXG5cdCQuZmlsdGVyID0gW10uZmlsdGVyO1xuXG5cdCQudHlwZSA9IGZ1bmN0aW9uKG9iaikge1xuXHRcdHJldHVybiBvYmogPT0gbnVsbCA/IFN0cmluZyhvYmopIDogY2xhc3MydHlwZVt7fS50b1N0cmluZy5jYWxsKG9iaildIHx8IFwib2JqZWN0XCI7XG5cdH07XG5cdC8qKlxuXHQgKiBtdWkgaXNBcnJheVxuXHQgKi9cblx0JC5pc0FycmF5ID0gQXJyYXkuaXNBcnJheSB8fFxuXHRcdGZ1bmN0aW9uKG9iamVjdCkge1xuXHRcdFx0cmV0dXJuIG9iamVjdCBpbnN0YW5jZW9mIEFycmF5O1xuXHRcdH07XG5cdC8qKlxuXHQgKiBtdWkgaXNBcnJheUxpa2Vcblx0ICogQHBhcmFtIHtPYmplY3R9IG9ialxuXHQgKi9cblx0JC5pc0FycmF5TGlrZSA9IGZ1bmN0aW9uKG9iaikge1xuXHRcdHZhciBsZW5ndGggPSAhIW9iaiAmJiBcImxlbmd0aFwiIGluIG9iaiAmJiBvYmoubGVuZ3RoO1xuXHRcdHZhciB0eXBlID0gJC50eXBlKG9iaik7XG5cdFx0aWYgKHR5cGUgPT09IFwiZnVuY3Rpb25cIiB8fCAkLmlzV2luZG93KG9iaikpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdFx0cmV0dXJuIHR5cGUgPT09IFwiYXJyYXlcIiB8fCBsZW5ndGggPT09IDAgfHxcblx0XHRcdHR5cGVvZiBsZW5ndGggPT09IFwibnVtYmVyXCIgJiYgbGVuZ3RoID4gMCAmJiAobGVuZ3RoIC0gMSkgaW4gb2JqO1xuXHR9O1xuXHQvKipcblx0ICogbXVpIGlzV2luZG93KOmcgOiAg+iZkW9iauS4unVuZGVmaW5lZOeahOaDheWGtSlcblx0ICovXG5cdCQuaXNXaW5kb3cgPSBmdW5jdGlvbihvYmopIHtcblx0XHRyZXR1cm4gb2JqICE9IG51bGwgJiYgb2JqID09PSBvYmoud2luZG93O1xuXHR9O1xuXHQvKipcblx0ICogbXVpIGlzT2JqZWN0XG5cdCAqL1xuXHQkLmlzT2JqZWN0ID0gZnVuY3Rpb24ob2JqKSB7XG5cdFx0cmV0dXJuICQudHlwZShvYmopID09PSBcIm9iamVjdFwiO1xuXHR9O1xuXHQvKipcblx0ICogbXVpIGlzUGxhaW5PYmplY3Rcblx0ICovXG5cdCQuaXNQbGFpbk9iamVjdCA9IGZ1bmN0aW9uKG9iaikge1xuXHRcdHJldHVybiAkLmlzT2JqZWN0KG9iaikgJiYgISQuaXNXaW5kb3cob2JqKSAmJiBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqKSA9PT0gT2JqZWN0LnByb3RvdHlwZTtcblx0fTtcblx0LyoqXG5cdCAqIG11aSBpc0VtcHR5T2JqZWN0XG5cdCAqIEBwYXJhbSB7T2JqZWN0fSBvXG5cdCAqL1xuXHQkLmlzRW1wdHlPYmplY3QgPSBmdW5jdGlvbihvKSB7XG5cdFx0Zm9yICh2YXIgcCBpbiBvKSB7XG5cdFx0XHRpZiAocCAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHRydWU7XG5cdH07XG5cdC8qKlxuXHQgKiBtdWkgaXNGdW5jdGlvblxuXHQgKi9cblx0JC5pc0Z1bmN0aW9uID0gZnVuY3Rpb24odmFsdWUpIHtcblx0XHRyZXR1cm4gJC50eXBlKHZhbHVlKSA9PT0gXCJmdW5jdGlvblwiO1xuXHR9O1xuXHQvKipcblx0ICogbXVpIHF1ZXJ5U2VsZWN0b3JBbGxcblx0ICogQHBhcmFtIHt0eXBlfSBzZWxlY3RvclxuXHQgKiBAcGFyYW0ge3R5cGV9IGNvbnRleHRcblx0ICogQHJldHVybnMge0FycmF5fVxuXHQgKi9cblx0JC5xc2EgPSBmdW5jdGlvbihzZWxlY3RvciwgY29udGV4dCkge1xuXHRcdGNvbnRleHQgPSBjb250ZXh0IHx8IGRvY3VtZW50O1xuXHRcdHJldHVybiAkLnNsaWNlLmNhbGwoY2xhc3NTZWxlY3RvclJFLnRlc3Qoc2VsZWN0b3IpID8gY29udGV4dC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFJlZ0V4cC4kMSkgOiB0YWdTZWxlY3RvclJFLnRlc3Qoc2VsZWN0b3IpID8gY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZShzZWxlY3RvcikgOiBjb250ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpKTtcblx0fTtcblx0LyoqXG5cdCAqIHJlYWR5KERPTUNvbnRlbnRMb2FkZWQpXG5cdCAqIEBwYXJhbSB7dHlwZX0gY2FsbGJhY2tcblx0ICogQHJldHVybnMge19MNi4kfVxuXHQgKi9cblx0JC5yZWFkeSA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG5cdFx0aWYgKHJlYWR5UkUudGVzdChkb2N1bWVudC5yZWFkeVN0YXRlKSkge1xuXHRcdFx0Y2FsbGJhY2soJCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0Y2FsbGJhY2soJCk7XG5cdFx0XHR9LCBmYWxzZSk7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzO1xuXHR9O1xuXHQvKipcblx0ICog5bCGIGZuIOe8k+WtmOS4gOauteaXtumXtOWQjiwg5YaN6KKr6LCD55So5omn6KGMXG5cdCAqIOatpOaWueazleS4uuS6humBv+WFjeWcqCBtcyDmrrXml7bpl7TlhoUsIOaJp+ihjCBmbiDlpJrmrKEuIOW4uOeUqOS6jiByZXNpemUgLCBzY3JvbGwgLCBtb3VzZW1vdmUg562J6L+e57ut5oCn5LqL5Lu25LitO1xuXHQgKiDlvZMgbXMg6K6+572u5Li6IC0xLCDooajnpLrnq4vljbPmiafooYwgZm4sIOWNs+WSjOebtOaOpeiwg+eUqCBmbiDkuIDmoLc7XG5cdCAqIOiwg+eUqOi/lOWbnuWHveaVsOeahCBzdG9wIOWBnOatouacgOWQjuS4gOasoeeahCBidWZmZXIg5pWI5p6cXG5cdCAqIEBwYXJhbSB7T2JqZWN0fSBmblxuXHQgKiBAcGFyYW0ge09iamVjdH0gbXNcblx0ICogQHBhcmFtIHtPYmplY3R9IGNvbnRleHRcblx0ICovXG5cdCQuYnVmZmVyID0gZnVuY3Rpb24oZm4sIG1zLCBjb250ZXh0KSB7XG5cdFx0dmFyIHRpbWVyO1xuXHRcdHZhciBsYXN0U3RhcnQgPSAwO1xuXHRcdHZhciBsYXN0RW5kID0gMDtcblx0XHR2YXIgbXMgPSBtcyB8fCAxNTA7XG5cblx0XHRmdW5jdGlvbiBydW4oKSB7XG5cdFx0XHRpZiAodGltZXIpIHtcblx0XHRcdFx0dGltZXIuY2FuY2VsKCk7XG5cdFx0XHRcdHRpbWVyID0gMDtcblx0XHRcdH1cblx0XHRcdGxhc3RTdGFydCA9ICQubm93KCk7XG5cdFx0XHRmbi5hcHBseShjb250ZXh0IHx8IHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHRsYXN0RW5kID0gJC5ub3coKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gJC5leHRlbmQoZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoXG5cdFx0XHRcdCghbGFzdFN0YXJ0KSB8fCAvLyDku47mnKrov5DooYzov4dcblx0XHRcdFx0KGxhc3RFbmQgPj0gbGFzdFN0YXJ0ICYmICQubm93KCkgLSBsYXN0RW5kID4gbXMpIHx8IC8vIOS4iuasoei/kOihjOaIkOWKn+WQjuW3sue7j+i2hei/h21z5q+r56eSXG5cdFx0XHRcdChsYXN0RW5kIDwgbGFzdFN0YXJ0ICYmICQubm93KCkgLSBsYXN0U3RhcnQgPiBtcyAqIDgpIC8vIOS4iuasoei/kOihjOaIluacquWujOaIkO+8jOWQjjgqbXPmr6vnp5Jcblx0XHRcdCkge1xuXHRcdFx0XHRydW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmICh0aW1lcikge1xuXHRcdFx0XHRcdHRpbWVyLmNhbmNlbCgpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHRpbWVyID0gJC5sYXRlcihydW4sIG1zLCBudWxsLCAkLnNsaWNlLmNhbGwoYXJndW1lbnRzKSk7XG5cdFx0XHR9XG5cdFx0fSwge1xuXHRcdFx0c3RvcDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmICh0aW1lcikge1xuXHRcdFx0XHRcdHRpbWVyLmNhbmNlbCgpO1xuXHRcdFx0XHRcdHRpbWVyID0gMDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHR9O1xuXHQvKipcblx0ICogZWFjaFxuXHQgKiBAcGFyYW0ge3R5cGV9IGVsZW1lbnRzXG5cdCAqIEBwYXJhbSB7dHlwZX0gY2FsbGJhY2tcblx0ICogQHJldHVybnMge19MOC4kfVxuXHQgKi9cblx0JC5lYWNoID0gZnVuY3Rpb24oZWxlbWVudHMsIGNhbGxiYWNrLCBoYXNPd25Qcm9wZXJ0eSkge1xuXHRcdGlmICghZWxlbWVudHMpIHtcblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH1cblx0XHRpZiAodHlwZW9mIGVsZW1lbnRzLmxlbmd0aCA9PT0gJ251bWJlcicpIHtcblx0XHRcdFtdLmV2ZXJ5LmNhbGwoZWxlbWVudHMsIGZ1bmN0aW9uKGVsLCBpZHgpIHtcblx0XHRcdFx0cmV0dXJuIGNhbGxiYWNrLmNhbGwoZWwsIGlkeCwgZWwpICE9PSBmYWxzZTtcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRmb3IgKHZhciBrZXkgaW4gZWxlbWVudHMpIHtcblx0XHRcdFx0aWYgKGhhc093blByb3BlcnR5KSB7XG5cdFx0XHRcdFx0aWYgKGVsZW1lbnRzLmhhc093blByb3BlcnR5KGtleSkpIHtcblx0XHRcdFx0XHRcdGlmIChjYWxsYmFjay5jYWxsKGVsZW1lbnRzW2tleV0sIGtleSwgZWxlbWVudHNba2V5XSkgPT09IGZhbHNlKSByZXR1cm4gZWxlbWVudHM7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGlmIChjYWxsYmFjay5jYWxsKGVsZW1lbnRzW2tleV0sIGtleSwgZWxlbWVudHNba2V5XSkgPT09IGZhbHNlKSByZXR1cm4gZWxlbWVudHM7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH07XG5cdCQuZm9jdXMgPSBmdW5jdGlvbihlbGVtZW50KSB7XG5cdFx0aWYgKCQub3MuaW9zKSB7XG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRlbGVtZW50LmZvY3VzKCk7XG5cdFx0XHR9LCAxMCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGVsZW1lbnQuZm9jdXMoKTtcblx0XHR9XG5cdH07XG5cdC8qKlxuXHQgKiB0cmlnZ2VyIGV2ZW50XG5cdCAqIEBwYXJhbSB7dHlwZX0gZWxlbWVudFxuXHQgKiBAcGFyYW0ge3R5cGV9IGV2ZW50VHlwZVxuXHQgKiBAcGFyYW0ge3R5cGV9IGV2ZW50RGF0YVxuXHQgKiBAcmV0dXJucyB7X0w4LiR9XG5cdCAqL1xuXHQkLnRyaWdnZXIgPSBmdW5jdGlvbihlbGVtZW50LCBldmVudFR5cGUsIGV2ZW50RGF0YSkge1xuXHRcdGVsZW1lbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoZXZlbnRUeXBlLCB7XG5cdFx0XHRkZXRhaWw6IGV2ZW50RGF0YSxcblx0XHRcdGJ1YmJsZXM6IHRydWUsXG5cdFx0XHRjYW5jZWxhYmxlOiB0cnVlXG5cdFx0fSkpO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9O1xuXHQvKipcblx0ICogZ2V0U3R5bGVzXG5cdCAqIEBwYXJhbSB7dHlwZX0gZWxlbWVudFxuXHQgKiBAcGFyYW0ge3R5cGV9IHByb3BlcnR5XG5cdCAqIEByZXR1cm5zIHtzdHlsZXN9XG5cdCAqL1xuXHQkLmdldFN0eWxlcyA9IGZ1bmN0aW9uKGVsZW1lbnQsIHByb3BlcnR5KSB7XG5cdFx0dmFyIHN0eWxlcyA9IGVsZW1lbnQub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQsIG51bGwpO1xuXHRcdGlmIChwcm9wZXJ0eSkge1xuXHRcdFx0cmV0dXJuIHN0eWxlcy5nZXRQcm9wZXJ0eVZhbHVlKHByb3BlcnR5KSB8fCBzdHlsZXNbcHJvcGVydHldO1xuXHRcdH1cblx0XHRyZXR1cm4gc3R5bGVzO1xuXHR9O1xuXHQvKipcblx0ICogcGFyc2VUcmFuc2xhdGVcblx0ICogQHBhcmFtIHt0eXBlfSB0cmFuc2xhdGVTdHJpbmdcblx0ICogQHBhcmFtIHt0eXBlfSBwb3NpdGlvblxuXHQgKiBAcmV0dXJucyB7T2JqZWN0fVxuXHQgKi9cblx0JC5wYXJzZVRyYW5zbGF0ZSA9IGZ1bmN0aW9uKHRyYW5zbGF0ZVN0cmluZywgcG9zaXRpb24pIHtcblx0XHR2YXIgcmVzdWx0ID0gdHJhbnNsYXRlU3RyaW5nLm1hdGNoKHRyYW5zbGF0ZVJFIHx8ICcnKTtcblx0XHRpZiAoIXJlc3VsdCB8fCAhcmVzdWx0WzFdKSB7XG5cdFx0XHRyZXN1bHQgPSBbJycsICcwLDAsMCddO1xuXHRcdH1cblx0XHRyZXN1bHQgPSByZXN1bHRbMV0uc3BsaXQoXCIsXCIpO1xuXHRcdHJlc3VsdCA9IHtcblx0XHRcdHg6IHBhcnNlRmxvYXQocmVzdWx0WzBdKSxcblx0XHRcdHk6IHBhcnNlRmxvYXQocmVzdWx0WzFdKSxcblx0XHRcdHo6IHBhcnNlRmxvYXQocmVzdWx0WzJdKVxuXHRcdH07XG5cdFx0aWYgKHBvc2l0aW9uICYmIHJlc3VsdC5oYXNPd25Qcm9wZXJ0eShwb3NpdGlvbikpIHtcblx0XHRcdHJldHVybiByZXN1bHRbcG9zaXRpb25dO1xuXHRcdH1cblx0XHRyZXR1cm4gcmVzdWx0O1xuXHR9O1xuXHQvKipcblx0ICogcGFyc2VUcmFuc2xhdGVNYXRyaXhcblx0ICogQHBhcmFtIHt0eXBlfSB0cmFuc2xhdGVTdHJpbmdcblx0ICogQHBhcmFtIHt0eXBlfSBwb3NpdGlvblxuXHQgKiBAcmV0dXJucyB7T2JqZWN0fVxuXHQgKi9cblx0JC5wYXJzZVRyYW5zbGF0ZU1hdHJpeCA9IGZ1bmN0aW9uKHRyYW5zbGF0ZVN0cmluZywgcG9zaXRpb24pIHtcblx0XHR2YXIgbWF0cml4ID0gdHJhbnNsYXRlU3RyaW5nLm1hdGNoKHRyYW5zbGF0ZU1hdHJpeFJFKTtcblx0XHR2YXIgaXMzRCA9IG1hdHJpeCAmJiBtYXRyaXhbMV07XG5cdFx0aWYgKG1hdHJpeCkge1xuXHRcdFx0bWF0cml4ID0gbWF0cml4WzJdLnNwbGl0KFwiLFwiKTtcblx0XHRcdGlmIChpczNEID09PSBcIjNkXCIpXG5cdFx0XHRcdG1hdHJpeCA9IG1hdHJpeC5zbGljZSgxMiwgMTUpO1xuXHRcdFx0ZWxzZSB7XG5cdFx0XHRcdG1hdHJpeC5wdXNoKDApO1xuXHRcdFx0XHRtYXRyaXggPSBtYXRyaXguc2xpY2UoNCwgNyk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdG1hdHJpeCA9IFswLCAwLCAwXTtcblx0XHR9XG5cdFx0dmFyIHJlc3VsdCA9IHtcblx0XHRcdHg6IHBhcnNlRmxvYXQobWF0cml4WzBdKSxcblx0XHRcdHk6IHBhcnNlRmxvYXQobWF0cml4WzFdKSxcblx0XHRcdHo6IHBhcnNlRmxvYXQobWF0cml4WzJdKVxuXHRcdH07XG5cdFx0aWYgKHBvc2l0aW9uICYmIHJlc3VsdC5oYXNPd25Qcm9wZXJ0eShwb3NpdGlvbikpIHtcblx0XHRcdHJldHVybiByZXN1bHRbcG9zaXRpb25dO1xuXHRcdH1cblx0XHRyZXR1cm4gcmVzdWx0O1xuXHR9O1xuXHQkLmhvb2tzID0ge307XG5cdCQuYWRkQWN0aW9uID0gZnVuY3Rpb24odHlwZSwgaG9vaykge1xuXHRcdHZhciBob29rcyA9ICQuaG9va3NbdHlwZV07XG5cdFx0aWYgKCFob29rcykge1xuXHRcdFx0aG9va3MgPSBbXTtcblx0XHR9XG5cdFx0aG9vay5pbmRleCA9IGhvb2suaW5kZXggfHwgMTAwMDtcblx0XHRob29rcy5wdXNoKGhvb2spO1xuXHRcdGhvb2tzLnNvcnQoZnVuY3Rpb24oYSwgYikge1xuXHRcdFx0cmV0dXJuIGEuaW5kZXggLSBiLmluZGV4O1xuXHRcdH0pO1xuXHRcdCQuaG9va3NbdHlwZV0gPSBob29rcztcblx0XHRyZXR1cm4gJC5ob29rc1t0eXBlXTtcblx0fTtcblx0JC5kb0FjdGlvbiA9IGZ1bmN0aW9uKHR5cGUsIGNhbGxiYWNrKSB7XG5cdFx0aWYgKCQuaXNGdW5jdGlvbihjYWxsYmFjaykpIHsgLy/mjIflrprkuoZjYWxsYmFja1xuXHRcdFx0JC5lYWNoKCQuaG9va3NbdHlwZV0sIGNhbGxiYWNrKTtcblx0XHR9IGVsc2UgeyAvL+acquaMh+WummNhbGxiYWNr77yM55u05o6l5omn6KGMXG5cdFx0XHQkLmVhY2goJC5ob29rc1t0eXBlXSwgZnVuY3Rpb24oaW5kZXgsIGhvb2spIHtcblx0XHRcdFx0cmV0dXJuICFob29rLmhhbmRsZSgpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9O1xuXHQvKipcblx0ICogc2V0VGltZW91dOWwgeijhVxuXHQgKiBAcGFyYW0ge09iamVjdH0gZm5cblx0ICogQHBhcmFtIHtPYmplY3R9IHdoZW5cblx0ICogQHBhcmFtIHtPYmplY3R9IGNvbnRleHRcblx0ICogQHBhcmFtIHtPYmplY3R9IGRhdGFcblx0ICovXG5cdCQubGF0ZXIgPSBmdW5jdGlvbihmbiwgd2hlbiwgY29udGV4dCwgZGF0YSkge1xuXHRcdHdoZW4gPSB3aGVuIHx8IDA7XG5cdFx0dmFyIG0gPSBmbjtcblx0XHR2YXIgZCA9IGRhdGE7XG5cdFx0dmFyIGY7XG5cdFx0dmFyIHI7XG5cblx0XHRpZiAodHlwZW9mIGZuID09PSAnc3RyaW5nJykge1xuXHRcdFx0bSA9IGNvbnRleHRbZm5dO1xuXHRcdH1cblxuXHRcdGYgPSBmdW5jdGlvbigpIHtcblx0XHRcdG0uYXBwbHkoY29udGV4dCwgJC5pc0FycmF5KGQpID8gZCA6IFtkXSk7XG5cdFx0fTtcblxuXHRcdHIgPSBzZXRUaW1lb3V0KGYsIHdoZW4pO1xuXG5cdFx0cmV0dXJuIHtcblx0XHRcdGlkOiByLFxuXHRcdFx0Y2FuY2VsOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0Y2xlYXJUaW1lb3V0KHIpO1xuXHRcdFx0fVxuXHRcdH07XG5cdH07XG5cdCQubm93ID0gRGF0ZS5ub3cgfHwgZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuICtuZXcgRGF0ZSgpO1xuXHR9O1xuXHR2YXIgY2xhc3MydHlwZSA9IHt9O1xuXHQkLmVhY2goWydCb29sZWFuJywgJ051bWJlcicsICdTdHJpbmcnLCAnRnVuY3Rpb24nLCAnQXJyYXknLCAnRGF0ZScsICdSZWdFeHAnLCAnT2JqZWN0JywgJ0Vycm9yJ10sIGZ1bmN0aW9uKGksIG5hbWUpIHtcblx0XHRjbGFzczJ0eXBlW1wiW29iamVjdCBcIiArIG5hbWUgKyBcIl1cIl0gPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG5cdH0pO1xuXHRpZiAod2luZG93LkpTT04pIHtcblx0XHQkLnBhcnNlSlNPTiA9IEpTT04ucGFyc2U7XG5cdH1cblx0LyoqXG5cdCAqICQuZm5cblx0ICovXG5cdCQuZm4gPSB7XG5cdFx0ZWFjaDogZnVuY3Rpb24oY2FsbGJhY2spIHtcblx0XHRcdFtdLmV2ZXJ5LmNhbGwodGhpcywgZnVuY3Rpb24oZWwsIGlkeCkge1xuXHRcdFx0XHRyZXR1cm4gY2FsbGJhY2suY2FsbChlbCwgaWR4LCBlbCkgIT09IGZhbHNlO1xuXHRcdFx0fSk7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9XG5cdH07XG5cblx0LyoqXG5cdCAqIOWFvOWuuSBBTUQg5qih5Z2XXG5cdCAqKi9cblx0aWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuXHRcdGRlZmluZSgnbXVpJywgW10sIGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuICQ7XG5cdFx0fSk7XG5cdH1cblxuXHRyZXR1cm4gJDtcbn0pKGRvY3VtZW50KTtcbi8vd2luZG93Lm11aSA9IG11aTtcbi8vJyQnIGluIHdpbmRvdyB8fCAod2luZG93LiQgPSBtdWkpO1xuLyoqXG4gKiAkLm9zXG4gKiBAcGFyYW0ge3R5cGV9ICRcbiAqIEByZXR1cm5zIHt1bmRlZmluZWR9XG4gKi9cbihmdW5jdGlvbigkLCB3aW5kb3cpIHtcblx0ZnVuY3Rpb24gZGV0ZWN0KHVhKSB7XG5cdFx0dGhpcy5vcyA9IHt9O1xuXHRcdHZhciBmdW5jcyA9IFtcblxuXHRcdFx0ZnVuY3Rpb24oKSB7IC8vd2VjaGF0XG5cdFx0XHRcdHZhciB3ZWNoYXQgPSB1YS5tYXRjaCgvKE1pY3JvTWVzc2VuZ2VyKVxcLyhbXFxkXFwuXSspL2kpO1xuXHRcdFx0XHRpZiAod2VjaGF0KSB7IC8vd2VjaGF0XG5cdFx0XHRcdFx0dGhpcy5vcy53ZWNoYXQgPSB7XG5cdFx0XHRcdFx0XHR2ZXJzaW9uOiB3ZWNoYXRbMl0ucmVwbGFjZSgvXy9nLCAnLicpXG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9LFxuXHRcdFx0ZnVuY3Rpb24oKSB7IC8vYW5kcm9pZFxuXHRcdFx0XHR2YXIgYW5kcm9pZCA9IHVhLm1hdGNoKC8oQW5kcm9pZCk7P1tcXHNcXC9dKyhbXFxkLl0rKT8vKTtcblx0XHRcdFx0aWYgKGFuZHJvaWQpIHtcblx0XHRcdFx0XHR0aGlzLm9zLmFuZHJvaWQgPSB0cnVlO1xuXHRcdFx0XHRcdHRoaXMub3MudmVyc2lvbiA9IGFuZHJvaWRbMl07XG5cblx0XHRcdFx0XHR0aGlzLm9zLmlzQmFkQW5kcm9pZCA9ICEoL0Nocm9tZVxcL1xcZC8udGVzdCh3aW5kb3cubmF2aWdhdG9yLmFwcFZlcnNpb24pKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdGhpcy5vcy5hbmRyb2lkID09PSB0cnVlO1xuXHRcdFx0fSxcblx0XHRcdGZ1bmN0aW9uKCkgeyAvL2lvc1xuXHRcdFx0XHR2YXIgaXBob25lID0gdWEubWF0Y2goLyhpUGhvbmVcXHNPUylcXHMoW1xcZF9dKykvKTtcblx0XHRcdFx0aWYgKGlwaG9uZSkgeyAvL2lwaG9uZVxuXHRcdFx0XHRcdHRoaXMub3MuaW9zID0gdGhpcy5vcy5pcGhvbmUgPSB0cnVlO1xuXHRcdFx0XHRcdHRoaXMub3MudmVyc2lvbiA9IGlwaG9uZVsyXS5yZXBsYWNlKC9fL2csICcuJyk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dmFyIGlwYWQgPSB1YS5tYXRjaCgvKGlQYWQpLipPU1xccyhbXFxkX10rKS8pO1xuXHRcdFx0XHRcdGlmIChpcGFkKSB7IC8vaXBhZFxuXHRcdFx0XHRcdFx0dGhpcy5vcy5pb3MgPSB0aGlzLm9zLmlwYWQgPSB0cnVlO1xuXHRcdFx0XHRcdFx0dGhpcy5vcy52ZXJzaW9uID0gaXBhZFsyXS5yZXBsYWNlKC9fL2csICcuJyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiB0aGlzLm9zLmlvcyA9PT0gdHJ1ZTtcblx0XHRcdH1cblx0XHRdO1xuXHRcdFtdLmV2ZXJ5LmNhbGwoZnVuY3MsIGZ1bmN0aW9uKGZ1bmMpIHtcblx0XHRcdHJldHVybiAhZnVuYy5jYWxsKCQpO1xuXHRcdH0pO1xuXHR9XG5cdGRldGVjdC5jYWxsKCQsIG5hdmlnYXRvci51c2VyQWdlbnQpO1xufSkobXVpLCB3aW5kb3cpO1xuLyoqXG4gKiAkLm9zLnBsdXNcbiAqIEBwYXJhbSB7dHlwZX0gJFxuICogQHJldHVybnMge3VuZGVmaW5lZH1cbiAqL1xuKGZ1bmN0aW9uKCQsIGRvY3VtZW50KSB7XG5cdGZ1bmN0aW9uIGRldGVjdCh1YSkge1xuXHRcdHRoaXMub3MgPSB0aGlzLm9zIHx8IHt9O1xuXHRcdHZhciBwbHVzID0gdWEubWF0Y2goL0h0bWw1UGx1cy9pKTsgLy9UT0RPIDVcXCtCcm93c2VyP1xuXHRcdGlmIChwbHVzKSB7XG5cdFx0XHR0aGlzLm9zLnBsdXMgPSB0cnVlO1xuXHRcdFx0JChmdW5jdGlvbigpIHtcblx0XHRcdFx0ZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCdtdWktcGx1cycpO1xuXHRcdFx0fSk7XG5cdFx0XHRpZiAodWEubWF0Y2goL1N0cmVhbUFwcC9pKSkgeyAvL1RPRE8g5pyA5aW95pyJ5rWB5bqU55So6Ieq5bex55qE5qCH6K+GXG5cdFx0XHRcdHRoaXMub3Muc3RyZWFtID0gdHJ1ZTtcblx0XHRcdFx0JChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ211aS1wbHVzLXN0cmVhbScpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0ZGV0ZWN0LmNhbGwoJCwgbmF2aWdhdG9yLnVzZXJBZ2VudCk7XG59KShtdWksIGRvY3VtZW50KTtcbi8qKlxuICog5LuF5o+Q5L6b566A5Y2V55qEb27vvIxvZmYo5LuF5pSv5oyB5LqL5Lu25aeU5omY77yM5LiN5pSv5oyB5b2T5YmN5YWD57Sg57uR5a6a77yM5b2T5YmN5YWD57Sg57uR5a6a6K+355u05o6l5L2/55SoYWRkRXZlbnRMaXN0ZW5lcixyZW1vdmVFdmVudExpc3RlbmVyKVxuICogQHBhcmFtIHtPYmplY3R9ICRcbiAqL1xuKGZ1bmN0aW9uKCQpIHtcblx0aWYgKCdvbnRvdWNoc3RhcnQnIGluIHdpbmRvdykge1xuXHRcdCQuaXNUb3VjaGFibGUgPSB0cnVlO1xuXHRcdCQuRVZFTlRfU1RBUlQgPSAndG91Y2hzdGFydCc7XG5cdFx0JC5FVkVOVF9NT1ZFID0gJ3RvdWNobW92ZSc7XG5cdFx0JC5FVkVOVF9FTkQgPSAndG91Y2hlbmQnO1xuXHR9IGVsc2Uge1xuXHRcdCQuaXNUb3VjaGFibGUgPSBmYWxzZTtcblx0XHQkLkVWRU5UX1NUQVJUID0gJ21vdXNlZG93bic7XG5cdFx0JC5FVkVOVF9NT1ZFID0gJ21vdXNlbW92ZSc7XG5cdFx0JC5FVkVOVF9FTkQgPSAnbW91c2V1cCc7XG5cdH1cblx0JC5FVkVOVF9DQU5DRUwgPSAndG91Y2hjYW5jZWwnO1xuXHQkLkVWRU5UX0NMSUNLID0gJ2NsaWNrJztcblxuXHR2YXIgX21pZCA9IDE7XG5cdHZhciBkZWxlZ2F0ZXMgPSB7fTtcblx0Ly/pnIDopoF3cmFw55qE5Ye95pWwXG5cdHZhciBldmVudE1ldGhvZHMgPSB7XG5cdFx0cHJldmVudERlZmF1bHQ6ICdpc0RlZmF1bHRQcmV2ZW50ZWQnLFxuXHRcdHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbjogJ2lzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkJyxcblx0XHRzdG9wUHJvcGFnYXRpb246ICdpc1Byb3BhZ2F0aW9uU3RvcHBlZCdcblx0fTtcblx0Ly/pu5jorqR0cnVl6L+U5Zue5Ye95pWwXG5cdHZhciByZXR1cm5UcnVlID0gZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRydWVcblx0fTtcblx0Ly/pu5jorqRmYWxzZei/lOWbnuWHveaVsFxuXHR2YXIgcmV0dXJuRmFsc2UgPSBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gZmFsc2Vcblx0fTtcblx0Ly93cmFw5rWP6KeI5Zmo5LqL5Lu2XG5cdHZhciBjb21wYXRpYmxlID0gZnVuY3Rpb24oZXZlbnQsIHRhcmdldCkge1xuXHRcdGlmICghZXZlbnQuZGV0YWlsKSB7XG5cdFx0XHRldmVudC5kZXRhaWwgPSB7XG5cdFx0XHRcdGN1cnJlbnRUYXJnZXQ6IHRhcmdldFxuXHRcdFx0fTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0ZXZlbnQuZGV0YWlsLmN1cnJlbnRUYXJnZXQgPSB0YXJnZXQ7XG5cdFx0fVxuXHRcdCQuZWFjaChldmVudE1ldGhvZHMsIGZ1bmN0aW9uKG5hbWUsIHByZWRpY2F0ZSkge1xuXHRcdFx0dmFyIHNvdXJjZU1ldGhvZCA9IGV2ZW50W25hbWVdO1xuXHRcdFx0ZXZlbnRbbmFtZV0gPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0dGhpc1twcmVkaWNhdGVdID0gcmV0dXJuVHJ1ZTtcblx0XHRcdFx0cmV0dXJuIHNvdXJjZU1ldGhvZCAmJiBzb3VyY2VNZXRob2QuYXBwbHkoZXZlbnQsIGFyZ3VtZW50cylcblx0XHRcdH1cblx0XHRcdGV2ZW50W3ByZWRpY2F0ZV0gPSByZXR1cm5GYWxzZTtcblx0XHR9LCB0cnVlKTtcblx0XHRyZXR1cm4gZXZlbnQ7XG5cdH07XG5cdC8v566A5Y2V55qEd3JhcOWvueixoV9taWRcblx0dmFyIG1pZCA9IGZ1bmN0aW9uKG9iaikge1xuXHRcdHJldHVybiBvYmogJiYgKG9iai5fbWlkIHx8IChvYmouX21pZCA9IF9taWQrKykpO1xuXHR9O1xuXHQvL+S6i+S7tuWnlOaJmOWvueixoee7keWumueahOS6i+S7tuWbnuiwg+WIl+ihqFxuXHR2YXIgZGVsZWdhdGVGbnMgPSB7fTtcblx0Ly/ov5Tlm57kuovku7blp5TmiZjnmoR3cmFw5LqL5Lu25Zue6LCDXG5cdHZhciBkZWxlZ2F0ZUZuID0gZnVuY3Rpb24oZWxlbWVudCwgZXZlbnQsIHNlbGVjdG9yLCBjYWxsYmFjaykge1xuXHRcdHJldHVybiBmdW5jdGlvbihlKSB7XG5cdFx0XHQvL3NhbWUgZXZlbnRcblx0XHRcdHZhciBjYWxsYmFja09ianMgPSBkZWxlZ2F0ZXNbZWxlbWVudC5fbWlkXVtldmVudF07XG5cdFx0XHR2YXIgaGFuZGxlclF1ZXVlID0gW107XG5cdFx0XHR2YXIgdGFyZ2V0ID0gZS50YXJnZXQ7XG5cdFx0XHR2YXIgc2VsZWN0b3JBbGxzID0ge307XG5cdFx0XHRmb3IgKDsgdGFyZ2V0ICYmIHRhcmdldCAhPT0gZG9jdW1lbnQ7IHRhcmdldCA9IHRhcmdldC5wYXJlbnROb2RlKSB7XG5cdFx0XHRcdGlmICh0YXJnZXQgPT09IGVsZW1lbnQpIHtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoflsnY2xpY2snLCAndGFwJywgJ2RvdWJsZXRhcCcsICdsb25ndGFwJywgJ2hvbGQnXS5pbmRleE9mKGV2ZW50KSAmJiAodGFyZ2V0LmRpc2FibGVkIHx8IHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ211aS1kaXNhYmxlZCcpKSkge1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHZhciBtYXRjaGVzID0ge307XG5cdFx0XHRcdCQuZWFjaChjYWxsYmFja09ianMsIGZ1bmN0aW9uKHNlbGVjdG9yLCBjYWxsYmFja3MpIHsgLy9zYW1lIHNlbGVjdG9yXG5cdFx0XHRcdFx0c2VsZWN0b3JBbGxzW3NlbGVjdG9yXSB8fCAoc2VsZWN0b3JBbGxzW3NlbGVjdG9yXSA9ICQucXNhKHNlbGVjdG9yLCBlbGVtZW50KSk7XG5cdFx0XHRcdFx0aWYgKHNlbGVjdG9yQWxsc1tzZWxlY3Rvcl0gJiYgfihzZWxlY3RvckFsbHNbc2VsZWN0b3JdKS5pbmRleE9mKHRhcmdldCkpIHtcblx0XHRcdFx0XHRcdGlmICghbWF0Y2hlc1tzZWxlY3Rvcl0pIHtcblx0XHRcdFx0XHRcdFx0bWF0Y2hlc1tzZWxlY3Rvcl0gPSBjYWxsYmFja3M7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9LCB0cnVlKTtcblx0XHRcdFx0aWYgKCEkLmlzRW1wdHlPYmplY3QobWF0Y2hlcykpIHtcblx0XHRcdFx0XHRoYW5kbGVyUXVldWUucHVzaCh7XG5cdFx0XHRcdFx0XHRlbGVtZW50OiB0YXJnZXQsXG5cdFx0XHRcdFx0XHRoYW5kbGVyczogbWF0Y2hlc1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRzZWxlY3RvckFsbHMgPSBudWxsO1xuXHRcdFx0ZSA9IGNvbXBhdGlibGUoZSk7IC8vY29tcGF0aWJsZSBldmVudFxuXHRcdFx0JC5lYWNoKGhhbmRsZXJRdWV1ZSwgZnVuY3Rpb24oaW5kZXgsIGhhbmRsZXIpIHtcblx0XHRcdFx0dGFyZ2V0ID0gaGFuZGxlci5lbGVtZW50O1xuXHRcdFx0XHR2YXIgdGFnTmFtZSA9IHRhcmdldC50YWdOYW1lO1xuXHRcdFx0XHRpZiAoZXZlbnQgPT09ICd0YXAnICYmICh0YWdOYW1lICE9PSAnSU5QVVQnICYmIHRhZ05hbWUgIT09ICdURVhUQVJFQScgJiYgdGFnTmFtZSAhPT0gJ1NFTEVDVCcpKSB7XG5cdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdGUuZGV0YWlsICYmIGUuZGV0YWlsLmdlc3R1cmUgJiYgZS5kZXRhaWwuZ2VzdHVyZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdCQuZWFjaChoYW5kbGVyLmhhbmRsZXJzLCBmdW5jdGlvbihpbmRleCwgaGFuZGxlcikge1xuXHRcdFx0XHRcdCQuZWFjaChoYW5kbGVyLCBmdW5jdGlvbihpbmRleCwgY2FsbGJhY2spIHtcblx0XHRcdFx0XHRcdGlmIChjYWxsYmFjay5jYWxsKHRhcmdldCwgZSkgPT09IGZhbHNlKSB7XG5cdFx0XHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9LCB0cnVlKTtcblx0XHRcdFx0fSwgdHJ1ZSlcblx0XHRcdFx0aWYgKGUuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSkge1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fSwgdHJ1ZSk7XG5cdFx0fTtcblx0fTtcblx0dmFyIGZpbmREZWxlZ2F0ZUZuID0gZnVuY3Rpb24oZWxlbWVudCwgZXZlbnQpIHtcblx0XHR2YXIgZGVsZWdhdGVDYWxsYmFja3MgPSBkZWxlZ2F0ZUZuc1ttaWQoZWxlbWVudCldO1xuXHRcdHZhciByZXN1bHQgPSBbXTtcblx0XHRpZiAoZGVsZWdhdGVDYWxsYmFja3MpIHtcblx0XHRcdHJlc3VsdCA9IFtdO1xuXHRcdFx0aWYgKGV2ZW50KSB7XG5cdFx0XHRcdHZhciBmaWx0ZXJGbiA9IGZ1bmN0aW9uKGZuKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZuLnR5cGUgPT09IGV2ZW50O1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBkZWxlZ2F0ZUNhbGxiYWNrcy5maWx0ZXIoZmlsdGVyRm4pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmVzdWx0ID0gZGVsZWdhdGVDYWxsYmFja3M7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiByZXN1bHQ7XG5cdH07XG5cdHZhciBwcmV2ZW50RGVmYXVsdEV4Y2VwdGlvbiA9IC9eKElOUFVUfFRFWFRBUkVBfEJVVFRPTnxTRUxFQ1QpJC87XG5cdC8qKlxuXHQgKiBtdWkgZGVsZWdhdGUgZXZlbnRzXG5cdCAqIEBwYXJhbSB7dHlwZX0gZXZlbnRcblx0ICogQHBhcmFtIHt0eXBlfSBzZWxlY3RvclxuXHQgKiBAcGFyYW0ge3R5cGV9IGNhbGxiYWNrXG5cdCAqIEByZXR1cm5zIHt1bmRlZmluZWR9XG5cdCAqL1xuXHQkLmZuLm9uID0gZnVuY3Rpb24oZXZlbnQsIHNlbGVjdG9yLCBjYWxsYmFjaykgeyAvL+S7heaUr+aMgeeugOWNleeahOS6i+S7tuWnlOaJmCzkuLvopoHmmK90YXDkuovku7bkvb/nlKjvvIznsbvkvLxtb3VzZSxmb2N1c+S5i+exu+aaguS4jeWwgeijheaUr+aMgVxuXHRcdHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgZWxlbWVudCA9IHRoaXM7XG5cdFx0XHRtaWQoZWxlbWVudCk7XG5cdFx0XHRtaWQoY2FsbGJhY2spO1xuXHRcdFx0dmFyIGlzQWRkRXZlbnRMaXN0ZW5lciA9IGZhbHNlO1xuXHRcdFx0dmFyIGRlbGVnYXRlRXZlbnRzID0gZGVsZWdhdGVzW2VsZW1lbnQuX21pZF0gfHwgKGRlbGVnYXRlc1tlbGVtZW50Ll9taWRdID0ge30pO1xuXHRcdFx0dmFyIGRlbGVnYXRlQ2FsbGJhY2tPYmpzID0gZGVsZWdhdGVFdmVudHNbZXZlbnRdIHx8ICgoZGVsZWdhdGVFdmVudHNbZXZlbnRdID0ge30pKTtcblx0XHRcdGlmICgkLmlzRW1wdHlPYmplY3QoZGVsZWdhdGVDYWxsYmFja09ianMpKSB7XG5cdFx0XHRcdGlzQWRkRXZlbnRMaXN0ZW5lciA9IHRydWU7XG5cdFx0XHR9XG5cdFx0XHR2YXIgZGVsZWdhdGVDYWxsYmFja3MgPSBkZWxlZ2F0ZUNhbGxiYWNrT2Jqc1tzZWxlY3Rvcl0gfHwgKGRlbGVnYXRlQ2FsbGJhY2tPYmpzW3NlbGVjdG9yXSA9IFtdKTtcblx0XHRcdGRlbGVnYXRlQ2FsbGJhY2tzLnB1c2goY2FsbGJhY2spO1xuXHRcdFx0aWYgKGlzQWRkRXZlbnRMaXN0ZW5lcikge1xuXHRcdFx0XHR2YXIgZGVsZWdhdGVGbkFycmF5ID0gZGVsZWdhdGVGbnNbbWlkKGVsZW1lbnQpXTtcblx0XHRcdFx0aWYgKCFkZWxlZ2F0ZUZuQXJyYXkpIHtcblx0XHRcdFx0XHRkZWxlZ2F0ZUZuQXJyYXkgPSBbXTtcblx0XHRcdFx0fVxuXHRcdFx0XHR2YXIgZGVsZWdhdGVDYWxsYmFjayA9IGRlbGVnYXRlRm4oZWxlbWVudCwgZXZlbnQsIHNlbGVjdG9yLCBjYWxsYmFjayk7XG5cdFx0XHRcdGRlbGVnYXRlRm5BcnJheS5wdXNoKGRlbGVnYXRlQ2FsbGJhY2spO1xuXHRcdFx0XHRkZWxlZ2F0ZUNhbGxiYWNrLmkgPSBkZWxlZ2F0ZUZuQXJyYXkubGVuZ3RoIC0gMTtcblx0XHRcdFx0ZGVsZWdhdGVDYWxsYmFjay50eXBlID0gZXZlbnQ7XG5cdFx0XHRcdGRlbGVnYXRlRm5zW21pZChlbGVtZW50KV0gPSBkZWxlZ2F0ZUZuQXJyYXk7XG5cdFx0XHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgZGVsZWdhdGVDYWxsYmFjayk7XG5cdFx0XHRcdGlmIChldmVudCA9PT0gJ3RhcCcpIHsgLy9UT0RPIOmcgOimgeaJvuS4quabtOWlveeahOino+WGs+aWueahiFxuXHRcdFx0XHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0XHRpZiAoZS50YXJnZXQpIHtcblx0XHRcdFx0XHRcdFx0dmFyIHRhZ05hbWUgPSBlLnRhcmdldC50YWdOYW1lO1xuXHRcdFx0XHRcdFx0XHRpZiAoIXByZXZlbnREZWZhdWx0RXhjZXB0aW9uLnRlc3QodGFnTmFtZSkpIHtcblx0XHRcdFx0XHRcdFx0XHRpZiAodGFnTmFtZSA9PT0gJ0EnKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgaHJlZiA9IGUudGFyZ2V0LmhyZWY7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoIShocmVmICYmIH5ocmVmLmluZGV4T2YoJ3RlbDonKSkpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblx0fTtcblx0JC5mbi5vZmYgPSBmdW5jdGlvbihldmVudCwgc2VsZWN0b3IsIGNhbGxiYWNrKSB7XG5cdFx0cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdHZhciBfbWlkID0gbWlkKHRoaXMpO1xuXHRcdFx0aWYgKCFldmVudCkgeyAvL211aShzZWxlY3Rvcikub2ZmKCk7XG5cdFx0XHRcdGRlbGVnYXRlc1tfbWlkXSAmJiBkZWxldGUgZGVsZWdhdGVzW19taWRdO1xuXHRcdFx0fSBlbHNlIGlmICghc2VsZWN0b3IpIHsgLy9tdWkoc2VsZWN0b3IpLm9mZihldmVudCk7XG5cdFx0XHRcdGRlbGVnYXRlc1tfbWlkXSAmJiBkZWxldGUgZGVsZWdhdGVzW19taWRdW2V2ZW50XTtcblx0XHRcdH0gZWxzZSBpZiAoIWNhbGxiYWNrKSB7IC8vbXVpKHNlbGVjdG9yKS5vZmYoZXZlbnQsc2VsZWN0b3IpO1xuXHRcdFx0XHRkZWxlZ2F0ZXNbX21pZF0gJiYgZGVsZWdhdGVzW19taWRdW2V2ZW50XSAmJiBkZWxldGUgZGVsZWdhdGVzW19taWRdW2V2ZW50XVtzZWxlY3Rvcl07XG5cdFx0XHR9IGVsc2UgeyAvL211aShzZWxlY3Rvcikub2ZmKGV2ZW50LHNlbGVjdG9yLGNhbGxiYWNrKTtcblx0XHRcdFx0dmFyIGRlbGVnYXRlQ2FsbGJhY2tzID0gZGVsZWdhdGVzW19taWRdICYmIGRlbGVnYXRlc1tfbWlkXVtldmVudF0gJiYgZGVsZWdhdGVzW19taWRdW2V2ZW50XVtzZWxlY3Rvcl07XG5cdFx0XHRcdCQuZWFjaChkZWxlZ2F0ZUNhbGxiYWNrcywgZnVuY3Rpb24oaW5kZXgsIGRlbGVnYXRlQ2FsbGJhY2spIHtcblx0XHRcdFx0XHRpZiAobWlkKGRlbGVnYXRlQ2FsbGJhY2spID09PSBtaWQoY2FsbGJhY2spKSB7XG5cdFx0XHRcdFx0XHRkZWxlZ2F0ZUNhbGxiYWNrcy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSwgdHJ1ZSk7XG5cdFx0XHR9XG5cdFx0XHRpZiAoZGVsZWdhdGVzW19taWRdKSB7XG5cdFx0XHRcdC8v5aaC5p6cb2Zm5o6J5LqG5omA5pyJ5b2T5YmNZWxlbWVudOeahOaMh+WumueahGV2ZW505LqL5Lu277yM5YiZcmVtb3Zl5o6J5b2T5YmNZWxlbWVudOeahGRlbGVnYXRl5Zue6LCDXG5cdFx0XHRcdGlmICgoIWRlbGVnYXRlc1tfbWlkXVtldmVudF0gfHwgJC5pc0VtcHR5T2JqZWN0KGRlbGVnYXRlc1tfbWlkXVtldmVudF0pKSkge1xuXHRcdFx0XHRcdGZpbmREZWxlZ2F0ZUZuKHRoaXMsIGV2ZW50KS5mb3JFYWNoKGZ1bmN0aW9uKGZuKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoZm4udHlwZSwgZm4pO1xuXHRcdFx0XHRcdFx0ZGVsZXRlIGRlbGVnYXRlRm5zW19taWRdW2ZuLmldO1xuXHRcdFx0XHRcdH0uYmluZCh0aGlzKSk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8v5aaC5p6cZGVsZWdhdGVzW19taWRd5bey5LiN5a2Y5Zyo77yM5Yig6Zmk5omA5pyJXG5cdFx0XHRcdGZpbmREZWxlZ2F0ZUZuKHRoaXMpLmZvckVhY2goZnVuY3Rpb24oZm4pIHtcblx0XHRcdFx0XHR0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoZm4udHlwZSwgZm4pO1xuXHRcdFx0XHRcdGRlbGV0ZSBkZWxlZ2F0ZUZuc1tfbWlkXVtmbi5pXTtcblx0XHRcdFx0fS5iaW5kKHRoaXMpKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHR9O1xufSkobXVpKTtcbi8qKlxuICogbXVpIHRhcmdldChhY3Rpb24+cG9wb3Zlcj5tb2RhbD50YWI+dG9nZ2xlKVxuICovXG4oZnVuY3Rpb24oJCwgd2luZG93LCBkb2N1bWVudCkge1xuXHQvKipcblx0ICogdGFyZ2V0c1xuXHQgKi9cblx0JC50YXJnZXRzID0ge307XG5cdC8qKlxuXHQgKiB0YXJnZXQgaGFuZGxlc1xuXHQgKi9cblx0JC50YXJnZXRIYW5kbGVzID0gW107XG5cdC8qKlxuXHQgKiByZWdpc3RlciB0YXJnZXRcblx0ICogQHBhcmFtIHt0eXBlfSB0YXJnZXRcblx0ICogQHJldHVybnMgeyQudGFyZ2V0c31cblx0ICovXG5cdCQucmVnaXN0ZXJUYXJnZXQgPSBmdW5jdGlvbih0YXJnZXQpIHtcblxuXHRcdHRhcmdldC5pbmRleCA9IHRhcmdldC5pbmRleCB8fCAxMDAwO1xuXG5cdFx0JC50YXJnZXRIYW5kbGVzLnB1c2godGFyZ2V0KTtcblxuXHRcdCQudGFyZ2V0SGFuZGxlcy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcblx0XHRcdHJldHVybiBhLmluZGV4IC0gYi5pbmRleDtcblx0XHR9KTtcblxuXHRcdHJldHVybiAkLnRhcmdldEhhbmRsZXM7XG5cdH07XG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCQuRVZFTlRfU1RBUlQsIGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0dmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldDtcblx0XHR2YXIgZm91bmRzID0ge307XG5cdFx0Zm9yICg7IHRhcmdldCAmJiB0YXJnZXQgIT09IGRvY3VtZW50OyB0YXJnZXQgPSB0YXJnZXQucGFyZW50Tm9kZSkge1xuXHRcdFx0dmFyIGlzRm91bmQgPSBmYWxzZTtcblx0XHRcdCQuZWFjaCgkLnRhcmdldEhhbmRsZXMsIGZ1bmN0aW9uKGluZGV4LCB0YXJnZXRIYW5kbGUpIHtcblx0XHRcdFx0dmFyIG5hbWUgPSB0YXJnZXRIYW5kbGUubmFtZTtcblx0XHRcdFx0aWYgKCFpc0ZvdW5kICYmICFmb3VuZHNbbmFtZV0gJiYgdGFyZ2V0SGFuZGxlLmhhc093blByb3BlcnR5KCdoYW5kbGUnKSkge1xuXHRcdFx0XHRcdCQudGFyZ2V0c1tuYW1lXSA9IHRhcmdldEhhbmRsZS5oYW5kbGUoZXZlbnQsIHRhcmdldCk7XG5cdFx0XHRcdFx0aWYgKCQudGFyZ2V0c1tuYW1lXSkge1xuXHRcdFx0XHRcdFx0Zm91bmRzW25hbWVdID0gdHJ1ZTtcblx0XHRcdFx0XHRcdGlmICh0YXJnZXRIYW5kbGUuaXNDb250aW51ZSAhPT0gdHJ1ZSkge1xuXHRcdFx0XHRcdFx0XHRpc0ZvdW5kID0gdHJ1ZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0aWYgKCFmb3VuZHNbbmFtZV0pIHtcblx0XHRcdFx0XHRcdGlmICh0YXJnZXRIYW5kbGUuaXNSZXNldCAhPT0gZmFsc2UpXG5cdFx0XHRcdFx0XHRcdCQudGFyZ2V0c1tuYW1lXSA9IGZhbHNlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRpZiAoaXNGb3VuZCkge1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkgeyAvL+ino+WGs3RvdWNo5LiOY2xpY2vnmoR0YXJnZXTkuI3kuIDoh7TnmoTpl67popgo5q+U5aaC6ZO+5o6l6L6557yY54K55Ye75pe277yMdG91Y2jnmoR0YXJnZXTkuLpodG1s77yM6ICMY2xpY2vnmoR0YXJnZXTkuLpBKVxuXHRcdHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQ7XG5cdFx0dmFyIGlzRm91bmQgPSBmYWxzZTtcblx0XHRmb3IgKDsgdGFyZ2V0ICYmIHRhcmdldCAhPT0gZG9jdW1lbnQ7IHRhcmdldCA9IHRhcmdldC5wYXJlbnROb2RlKSB7XG5cdFx0XHRpZiAodGFyZ2V0LnRhZ05hbWUgPT09ICdBJykge1xuXHRcdFx0XHQkLmVhY2goJC50YXJnZXRIYW5kbGVzLCBmdW5jdGlvbihpbmRleCwgdGFyZ2V0SGFuZGxlKSB7XG5cdFx0XHRcdFx0dmFyIG5hbWUgPSB0YXJnZXRIYW5kbGUubmFtZTtcblx0XHRcdFx0XHRpZiAodGFyZ2V0SGFuZGxlLmhhc093blByb3BlcnR5KCdoYW5kbGUnKSkge1xuXHRcdFx0XHRcdFx0aWYgKHRhcmdldEhhbmRsZS5oYW5kbGUoZXZlbnQsIHRhcmdldCkpIHtcblx0XHRcdFx0XHRcdFx0aXNGb3VuZCA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRpZiAoaXNGb3VuZCkge1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcbn0pKG11aSwgd2luZG93LCBkb2N1bWVudCk7XG4vKipcbiAqIGZpeGVkIHRyaW1cbiAqIEBwYXJhbSB7dHlwZX0gdW5kZWZpbmVkXG4gKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxuICovXG4oZnVuY3Rpb24odW5kZWZpbmVkKSB7XG5cdGlmIChTdHJpbmcucHJvdG90eXBlLnRyaW0gPT09IHVuZGVmaW5lZCkgeyAvLyBmaXggZm9yIGlPUyAzLjJcblx0XHRTdHJpbmcucHJvdG90eXBlLnRyaW0gPSBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB0aGlzLnJlcGxhY2UoL15cXHMrfFxccyskL2csICcnKTtcblx0XHR9O1xuXHR9XG5cdE9iamVjdC5zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbihvYmosIHByb3RvKSB7XG5cdFx0b2JqWydfX3Byb3RvX18nXSA9IHByb3RvO1xuXHRcdHJldHVybiBvYmo7XG5cdH07XG5cbn0pKCk7XG4vKipcbiAqIGZpeGVkIEN1c3RvbUV2ZW50XG4gKi9cbihmdW5jdGlvbigpIHtcblx0aWYgKHR5cGVvZiB3aW5kb3cuQ3VzdG9tRXZlbnQgPT09ICd1bmRlZmluZWQnKSB7XG5cdFx0ZnVuY3Rpb24gQ3VzdG9tRXZlbnQoZXZlbnQsIHBhcmFtcykge1xuXHRcdFx0cGFyYW1zID0gcGFyYW1zIHx8IHtcblx0XHRcdFx0YnViYmxlczogZmFsc2UsXG5cdFx0XHRcdGNhbmNlbGFibGU6IGZhbHNlLFxuXHRcdFx0XHRkZXRhaWw6IHVuZGVmaW5lZFxuXHRcdFx0fTtcblx0XHRcdHZhciBldnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnRXZlbnRzJyk7XG5cdFx0XHR2YXIgYnViYmxlcyA9IHRydWU7XG5cdFx0XHRmb3IgKHZhciBuYW1lIGluIHBhcmFtcykge1xuXHRcdFx0XHQobmFtZSA9PT0gJ2J1YmJsZXMnKSA/IChidWJibGVzID0gISFwYXJhbXNbbmFtZV0pIDogKGV2dFtuYW1lXSA9IHBhcmFtc1tuYW1lXSk7XG5cdFx0XHR9XG5cdFx0XHRldnQuaW5pdEV2ZW50KGV2ZW50LCBidWJibGVzLCB0cnVlKTtcblx0XHRcdHJldHVybiBldnQ7XG5cdFx0fTtcblx0XHRDdXN0b21FdmVudC5wcm90b3R5cGUgPSB3aW5kb3cuRXZlbnQucHJvdG90eXBlO1xuXHRcdHdpbmRvdy5DdXN0b21FdmVudCA9IEN1c3RvbUV2ZW50O1xuXHR9XG59KSgpO1xuLypcblx0QSBzaGltIGZvciBub24gRVM1IHN1cHBvcnRpbmcgYnJvd3NlcnMuXG5cdEFkZHMgZnVuY3Rpb24gYmluZCB0byBGdW5jdGlvbiBwcm90b3R5cGUsIHNvIHRoYXQgeW91IGNhbiBkbyBwYXJ0aWFsIGFwcGxpY2F0aW9uLlxuXHRXb3JrcyBldmVuIHdpdGggdGhlIG5hc3R5IHRoaW5nLCB3aGVyZSB0aGUgZmlyc3Qgd29yZCBpcyB0aGUgb3Bwb3NpdGUgb2YgZXh0cmFuZXQsIHRoZSBzZWNvbmQgb25lIGlzIHRoZSBwcm9mZXNzaW9uIG9mIENvbHVtYnVzLCBhbmQgdGhlIHZlcnNpb24gbnVtYmVyIGlzIDksIGZsaXBwZWQgMTgwIGRlZ3JlZXMuXG4qL1xuXG5GdW5jdGlvbi5wcm90b3R5cGUuYmluZCA9IEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kIHx8IGZ1bmN0aW9uKHRvKSB7XG5cdC8vIE1ha2UgYW4gYXJyYXkgb2Ygb3VyIGFyZ3VtZW50cywgc3RhcnRpbmcgZnJvbSBzZWNvbmQgYXJndW1lbnRcblx0dmFyIHBhcnRpYWwgPSBBcnJheS5wcm90b3R5cGUuc3BsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSxcblx0XHQvLyBXZSdsbCBuZWVkIHRoZSBvcmlnaW5hbCBmdW5jdGlvbi5cblx0XHRmbiA9IHRoaXM7XG5cdHZhciBib3VuZCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0Ly8gSm9pbiB0aGUgYWxyZWFkeSBhcHBsaWVkIGFyZ3VtZW50cyB0byB0aGUgbm93IGNhbGxlZCBvbmVzIChhZnRlciBjb252ZXJ0aW5nIHRvIGFuIGFycmF5IGFnYWluKS5cblx0XHRcdHZhciBhcmdzID0gcGFydGlhbC5jb25jYXQoQXJyYXkucHJvdG90eXBlLnNwbGljZS5jYWxsKGFyZ3VtZW50cywgMCkpO1xuXHRcdFx0Ly8gSWYgbm90IGJlaW5nIGNhbGxlZCBhcyBhIGNvbnN0cnVjdG9yXG5cdFx0XHRpZiAoISh0aGlzIGluc3RhbmNlb2YgYm91bmQpKSB7XG5cdFx0XHRcdC8vIHJldHVybiB0aGUgcmVzdWx0IG9mIHRoZSBmdW5jdGlvbiBjYWxsZWQgYm91bmQgdG8gdGFyZ2V0IGFuZCBwYXJ0aWFsbHkgYXBwbGllZC5cblx0XHRcdFx0cmV0dXJuIGZuLmFwcGx5KHRvLCBhcmdzKTtcblx0XHRcdH1cblx0XHRcdC8vIElmIGJlaW5nIGNhbGxlZCBhcyBhIGNvbnN0cnVjdG9yLCBhcHBseSB0aGUgZnVuY3Rpb24gYm91bmQgdG8gc2VsZi5cblx0XHRcdGZuLmFwcGx5KHRoaXMsIGFyZ3MpO1xuXHRcdH1cblx0XHQvLyBBdHRhY2ggdGhlIHByb3RvdHlwZSBvZiB0aGUgZnVuY3Rpb24gdG8gb3VyIG5ld2x5IGNyZWF0ZWQgZnVuY3Rpb24uXG5cdGJvdW5kLnByb3RvdHlwZSA9IGZuLnByb3RvdHlwZTtcblx0cmV0dXJuIGJvdW5kO1xufTtcbi8qKlxuICogbXVpIGZpeGVkIGNsYXNzTGlzdFxuICogQHBhcmFtIHt0eXBlfSBkb2N1bWVudFxuICogQHJldHVybnMge3VuZGVmaW5lZH1cbiAqL1xuKGZ1bmN0aW9uKGRvY3VtZW50KSB7XG4gICAgaWYgKCEoXCJjbGFzc0xpc3RcIiBpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiB0eXBlb2YgSFRNTEVsZW1lbnQgIT09ICd1bmRlZmluZWQnKSB7XG5cbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEhUTUxFbGVtZW50LnByb3RvdHlwZSwgJ2NsYXNzTGlzdCcsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHVwZGF0ZShmbikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjbGFzc2VzID0gc2VsZi5jbGFzc05hbWUuc3BsaXQoL1xccysvKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBjbGFzc2VzLmluZGV4T2YodmFsdWUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBmbihjbGFzc2VzLCBpbmRleCwgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jbGFzc05hbWUgPSBjbGFzc2VzLmpvaW4oXCIgXCIpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciByZXQgPSB7XG4gICAgICAgICAgICAgICAgICAgIGFkZDogdXBkYXRlKGZ1bmN0aW9uKGNsYXNzZXMsIGluZGV4LCB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgfmluZGV4IHx8IGNsYXNzZXMucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICByZW1vdmU6IHVwZGF0ZShmdW5jdGlvbihjbGFzc2VzLCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgfmluZGV4ICYmIGNsYXNzZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgIHRvZ2dsZTogdXBkYXRlKGZ1bmN0aW9uKGNsYXNzZXMsIGluZGV4LCB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgfmluZGV4ID8gY2xhc3Nlcy5zcGxpY2UoaW5kZXgsIDEpIDogY2xhc3Nlcy5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5zOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICEhfnNlbGYuY2xhc3NOYW1lLnNwbGl0KC9cXHMrLykuaW5kZXhPZih2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGl0ZW06IGZ1bmN0aW9uKGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmNsYXNzTmFtZS5zcGxpdCgvXFxzKy8pW2ldIHx8IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHJldCwgJ2xlbmd0aCcsIHtcbiAgICAgICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmNsYXNzTmFtZS5zcGxpdCgvXFxzKy8pLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufSkoZG9jdW1lbnQpO1xuXG4vKipcbiAqIG11aSBmaXhlZCByZXF1ZXN0QW5pbWF0aW9uRnJhbWVcbiAqIEBwYXJhbSB7dHlwZX0gd2luZG93XG4gKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxuICovXG4oZnVuY3Rpb24od2luZG93KSB7XG5cdGlmICghd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSkge1xuXHRcdHZhciBsYXN0VGltZSA9IDA7XG5cdFx0d2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSA9IHdpbmRvdy53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgZnVuY3Rpb24oY2FsbGJhY2ssIGVsZW1lbnQpIHtcblx0XHRcdHZhciBjdXJyVGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuXHRcdFx0dmFyIHRpbWVUb0NhbGwgPSBNYXRoLm1heCgwLCAxNi43IC0gKGN1cnJUaW1lIC0gbGFzdFRpbWUpKTtcblx0XHRcdHZhciBpZCA9IHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRjYWxsYmFjayhjdXJyVGltZSArIHRpbWVUb0NhbGwpO1xuXHRcdFx0fSwgdGltZVRvQ2FsbCk7XG5cdFx0XHRsYXN0VGltZSA9IGN1cnJUaW1lICsgdGltZVRvQ2FsbDtcblx0XHRcdHJldHVybiBpZDtcblx0XHR9O1xuXHRcdHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSA9IHdpbmRvdy53ZWJraXRDYW5jZWxBbmltYXRpb25GcmFtZSB8fCB3aW5kb3cud2Via2l0Q2FuY2VsUmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IGZ1bmN0aW9uKGlkKSB7XG5cdFx0XHRjbGVhclRpbWVvdXQoaWQpO1xuXHRcdH07XG5cdH07XG59KHdpbmRvdykpO1xuLyoqXG4gKiBmYXN0Y2xpY2sob25seSBmb3IgcmFkaW8sY2hlY2tib3gpXG4gKi9cbihmdW5jdGlvbigkLCB3aW5kb3csIG5hbWUpIHtcblx0aWYgKCEkLm9zLmFuZHJvaWQgJiYgISQub3MuaW9zKSB7IC8v55uu5YmN5LuF6K+G5YirYW5kcm9pZOWSjGlvc1xuXHRcdHJldHVybjtcblx0fVxuXHRpZiAod2luZG93LkZhc3RDbGljaykge1xuXHRcdHJldHVybjtcblx0fVxuXG5cdHZhciBoYW5kbGUgPSBmdW5jdGlvbihldmVudCwgdGFyZ2V0KSB7XG5cdFx0aWYgKHRhcmdldC50YWdOYW1lID09PSAnTEFCRUwnKSB7XG5cdFx0XHRpZiAodGFyZ2V0LnBhcmVudE5vZGUpIHtcblx0XHRcdFx0dGFyZ2V0ID0gdGFyZ2V0LnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignaW5wdXQnKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKHRhcmdldCAmJiAodGFyZ2V0LnR5cGUgPT09ICdyYWRpbycgfHwgdGFyZ2V0LnR5cGUgPT09ICdjaGVja2JveCcpKSB7XG5cdFx0XHRpZiAoIXRhcmdldC5kaXNhYmxlZCkgeyAvL2Rpc2FibGVkXG5cdFx0XHRcdHJldHVybiB0YXJnZXQ7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBmYWxzZTtcblx0fTtcblxuXHQkLnJlZ2lzdGVyVGFyZ2V0KHtcblx0XHRuYW1lOiBuYW1lLFxuXHRcdGluZGV4OiA0MCxcblx0XHRoYW5kbGU6IGhhbmRsZSxcblx0XHR0YXJnZXQ6IGZhbHNlXG5cdH0pO1xuXHR2YXIgZGlzcGF0Y2hFdmVudCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0dmFyIHRhcmdldEVsZW1lbnQgPSAkLnRhcmdldHMuY2xpY2s7XG5cdFx0aWYgKHRhcmdldEVsZW1lbnQpIHtcblx0XHRcdHZhciBjbGlja0V2ZW50LCB0b3VjaDtcblx0XHRcdC8vIE9uIHNvbWUgQW5kcm9pZCBkZXZpY2VzIGFjdGl2ZUVsZW1lbnQgbmVlZHMgdG8gYmUgYmx1cnJlZCBvdGhlcndpc2UgdGhlIHN5bnRoZXRpYyBjbGljayB3aWxsIGhhdmUgbm8gZWZmZWN0XG5cdFx0XHRpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAmJiBkb2N1bWVudC5hY3RpdmVFbGVtZW50ICE9PSB0YXJnZXRFbGVtZW50KSB7XG5cdFx0XHRcdGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuYmx1cigpO1xuXHRcdFx0fVxuXHRcdFx0dG91Y2ggPSBldmVudC5kZXRhaWwuZ2VzdHVyZS5jaGFuZ2VkVG91Y2hlc1swXTtcblx0XHRcdC8vIFN5bnRoZXNpc2UgYSBjbGljayBldmVudCwgd2l0aCBhbiBleHRyYSBhdHRyaWJ1dGUgc28gaXQgY2FuIGJlIHRyYWNrZWRcblx0XHRcdGNsaWNrRXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnTW91c2VFdmVudHMnKTtcblx0XHRcdGNsaWNrRXZlbnQuaW5pdE1vdXNlRXZlbnQoJ2NsaWNrJywgdHJ1ZSwgdHJ1ZSwgd2luZG93LCAxLCB0b3VjaC5zY3JlZW5YLCB0b3VjaC5zY3JlZW5ZLCB0b3VjaC5jbGllbnRYLCB0b3VjaC5jbGllbnRZLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgMCwgbnVsbCk7XG5cdFx0XHRjbGlja0V2ZW50LmZvcndhcmRlZFRvdWNoRXZlbnQgPSB0cnVlO1xuXHRcdFx0dGFyZ2V0RWxlbWVudC5kaXNwYXRjaEV2ZW50KGNsaWNrRXZlbnQpO1xuXHRcdFx0ZXZlbnQuZGV0YWlsICYmIGV2ZW50LmRldGFpbC5nZXN0dXJlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0fVxuXHR9O1xuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndGFwJywgZGlzcGF0Y2hFdmVudCk7XG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdkb3VibGV0YXAnLCBkaXNwYXRjaEV2ZW50KTtcblx0Ly/mjZXojrdcblx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRpZiAoJC50YXJnZXRzLmNsaWNrKSB7XG5cdFx0XHRpZiAoIWV2ZW50LmZvcndhcmRlZFRvdWNoRXZlbnQpIHsgLy9zdG9wIGNsaWNrXG5cdFx0XHRcdGlmIChldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24pIHtcblx0XHRcdFx0XHRldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyBQYXJ0IG9mIHRoZSBoYWNrIGZvciBicm93c2VycyB0aGF0IGRvbid0IHN1cHBvcnQgRXZlbnQjc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uXG5cdFx0XHRcdFx0ZXZlbnQucHJvcGFnYXRpb25TdG9wcGVkID0gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdH1cblx0fSwgdHJ1ZSk7XG5cbn0pKG11aSwgd2luZG93LCAnY2xpY2snKTtcbihmdW5jdGlvbigkLCBkb2N1bWVudCkge1xuXHQkKGZ1bmN0aW9uKCkge1xuXHRcdGlmICghJC5vcy5pb3MpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0dmFyIENMQVNTX0ZPQ1VTSU4gPSAnbXVpLWZvY3VzaW4nO1xuXHRcdHZhciBDTEFTU19CQVJfVEFCID0gJ211aS1iYXItdGFiJztcblx0XHR2YXIgQ0xBU1NfQkFSX0ZPT1RFUiA9ICdtdWktYmFyLWZvb3Rlcic7XG5cdFx0dmFyIENMQVNTX0JBUl9GT09URVJfU0VDT05EQVJZID0gJ211aS1iYXItZm9vdGVyLXNlY29uZGFyeSc7XG5cdFx0dmFyIENMQVNTX0JBUl9GT09URVJfU0VDT05EQVJZX1RBQiA9ICdtdWktYmFyLWZvb3Rlci1zZWNvbmRhcnktdGFiJztcblx0XHQvLyB2YXIgY29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgQ0xBU1NfQ09OVEVOVCk7XG5cdFx0Ly8gaWYgKGNvbnRlbnQpIHtcblx0XHQvLyBcdGRvY3VtZW50LmJvZHkuaW5zZXJ0QmVmb3JlKGNvbnRlbnQsIGRvY3VtZW50LmJvZHkuZmlyc3RFbGVtZW50Q2hpbGQpO1xuXHRcdC8vIH1cblx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdmb2N1c2luJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0aWYgKCQub3MucGx1cykgeyAvL+WcqOeItndlYnZpZXfph4zovrnkuI1maXhcblx0XHRcdFx0aWYgKHdpbmRvdy5wbHVzKSB7XG5cdFx0XHRcdFx0aWYgKHBsdXMud2Vidmlldy5jdXJyZW50V2VidmlldygpLmNoaWxkcmVuKCkubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0dmFyIHRhcmdldCA9IGUudGFyZ2V0O1xuXHRcdFx0Ly9UT0RPIOmcgOiAg+iZkeaJgOaciemUruebmOW8uei1t+eahOaDheWGtVxuXHRcdFx0aWYgKHRhcmdldC50YWdOYW1lICYmICh0YXJnZXQudGFnTmFtZSA9PT0gJ1RFWFRBUkVBJyB8fCAodGFyZ2V0LnRhZ05hbWUgPT09ICdJTlBVVCcgJiYgKHRhcmdldC50eXBlID09PSAndGV4dCcgfHwgdGFyZ2V0LnR5cGUgPT09ICdzZWFyY2gnIHx8IHRhcmdldC50eXBlID09PSAnbnVtYmVyJykpKSkge1xuXHRcdFx0XHRpZiAodGFyZ2V0LmRpc2FibGVkIHx8IHRhcmdldC5yZWFkT25seSkge1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0XHRkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoQ0xBU1NfRk9DVVNJTik7XG5cdFx0XHRcdHZhciBpc0Zvb3RlciA9IGZhbHNlO1xuXHRcdFx0XHRmb3IgKDsgdGFyZ2V0ICYmIHRhcmdldCAhPT0gZG9jdW1lbnQ7IHRhcmdldCA9IHRhcmdldC5wYXJlbnROb2RlKSB7XG5cdFx0XHRcdFx0dmFyIGNsYXNzTGlzdCA9IHRhcmdldC5jbGFzc0xpc3Q7XG5cdFx0XHRcdFx0aWYgKGNsYXNzTGlzdCAmJiBjbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfQkFSX1RBQikgfHwgY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX0JBUl9GT09URVIpIHx8IGNsYXNzTGlzdC5jb250YWlucyhDTEFTU19CQVJfRk9PVEVSX1NFQ09OREFSWSkgfHwgY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX0JBUl9GT09URVJfU0VDT05EQVJZX1RBQikpIHtcblx0XHRcdFx0XHRcdGlzRm9vdGVyID0gdHJ1ZTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoaXNGb290ZXIpIHtcblx0XHRcdFx0XHR2YXIgc2Nyb2xsVG9wID0gZG9jdW1lbnQuYm9keS5zY3JvbGxIZWlnaHQ7XG5cdFx0XHRcdFx0dmFyIHNjcm9sbExlZnQgPSBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQ7XG5cdFx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdHdpbmRvdy5zY3JvbGxUbyhzY3JvbGxMZWZ0LCBzY3JvbGxUb3ApO1xuXHRcdFx0XHRcdH0sIDIwKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3Vzb3V0JywgZnVuY3Rpb24oZSkge1xuXHRcdFx0dmFyIGNsYXNzTGlzdCA9IGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0O1xuXHRcdFx0aWYgKGNsYXNzTGlzdC5jb250YWlucyhDTEFTU19GT0NVU0lOKSkge1xuXHRcdFx0XHRjbGFzc0xpc3QucmVtb3ZlKENMQVNTX0ZPQ1VTSU4pO1xuXHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHdpbmRvdy5zY3JvbGxUbyhkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQsIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wKTtcblx0XHRcdFx0fSwgMjApO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9KTtcbn0pKG11aSwgZG9jdW1lbnQpO1xuLyoqXG4gKiBtdWkgbmFtZXNwYWNlKG9wdGltaXphdGlvbilcbiAqIEBwYXJhbSB7dHlwZX0gJFxuICogQHJldHVybnMge3VuZGVmaW5lZH1cbiAqL1xuKGZ1bmN0aW9uKCQpIHtcblx0JC5uYW1lc3BhY2UgPSAnbXVpJztcblx0JC5jbGFzc05hbWVQcmVmaXggPSAkLm5hbWVzcGFjZSArICctJztcblx0JC5jbGFzc1NlbGVjdG9yUHJlZml4ID0gJy4nICsgJC5jbGFzc05hbWVQcmVmaXg7XG5cdC8qKlxuXHQgKiDov5Tlm57mraPnoa7nmoRjbGFzc05hbWVcblx0ICogQHBhcmFtIHt0eXBlfSBjbGFzc05hbWVcblx0ICogQHJldHVybnMge1N0cmluZ31cblx0ICovXG5cdCQuY2xhc3NOYW1lID0gZnVuY3Rpb24oY2xhc3NOYW1lKSB7XG5cdFx0cmV0dXJuICQuY2xhc3NOYW1lUHJlZml4ICsgY2xhc3NOYW1lO1xuXHR9O1xuXHQvKipcblx0ICog6L+U5Zue5q2j56Gu55qEY2xhc3NTZWxlY3RvclxuXHQgKiBAcGFyYW0ge3R5cGV9IGNsYXNzU2VsZWN0b3Jcblx0ICogQHJldHVybnMge1N0cmluZ31cblx0ICovXG5cdCQuY2xhc3NTZWxlY3RvciA9IGZ1bmN0aW9uKGNsYXNzU2VsZWN0b3IpIHtcblx0XHRyZXR1cm4gY2xhc3NTZWxlY3Rvci5yZXBsYWNlKC9cXC4vZywgJC5jbGFzc1NlbGVjdG9yUHJlZml4KTtcblx0fTtcblx0LyoqXG4gICAgICAgICAqIOi/lOWbnuato+ehrueahGV2ZW50TmFtZVxuICAgICAgICAgKiBAcGFyYW0ge3R5cGV9IGV2ZW50XG4gICAgICAgICAqIEBwYXJhbSB7dHlwZX0gbW9kdWxlXG4gICAgICAgICAqIEByZXR1cm5zIHtTdHJpbmd9XG4gICAgICAgICAqL1xuXHQkLmV2ZW50TmFtZSA9IGZ1bmN0aW9uKGV2ZW50LCBtb2R1bGUpIHtcblx0XHRyZXR1cm4gZXZlbnQgKyAoJC5uYW1lc3BhY2UgPyAoJy4nICsgJC5uYW1lc3BhY2UpIDogJycpICsgKCBtb2R1bGUgPyAoJy4nICsgbW9kdWxlKSA6ICcnKTtcblx0fTtcbn0pKG11aSk7XG5cbi8qKlxuICogbXVpIGdlc3R1cmVzXG4gKiBAcGFyYW0ge3R5cGV9ICRcbiAqIEBwYXJhbSB7dHlwZX0gd2luZG93XG4gKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxuICovXG4oZnVuY3Rpb24oJCwgd2luZG93KSB7XG5cdCQuZ2VzdHVyZXMgPSB7XG5cdFx0c2Vzc2lvbjoge31cblx0fTtcblx0LyoqXG5cdCAqIEdlc3R1cmUgcHJldmVudERlZmF1bHRcblx0ICogQHBhcmFtIHt0eXBlfSBlXG5cdCAqIEByZXR1cm5zIHt1bmRlZmluZWR9XG5cdCAqL1xuXHQkLnByZXZlbnREZWZhdWx0ID0gZnVuY3Rpb24oZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0fTtcblx0LyoqXG5cdCAqIEdlc3R1cmUgc3RvcFByb3BhZ2F0aW9uXG5cdCAqIEBwYXJhbSB7dHlwZX0gZVxuXHQgKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxuXHQgKi9cblx0JC5zdG9wUHJvcGFnYXRpb24gPSBmdW5jdGlvbihlKSB7XG5cdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0fTtcblxuXHQvKipcblx0ICogcmVnaXN0ZXIgZ2VzdHVyZVxuXHQgKiBAcGFyYW0ge3R5cGV9IGdlc3R1cmVcblx0ICogQHJldHVybnMgeyQuZ2VzdHVyZXN9XG5cdCAqL1xuXHQkLmFkZEdlc3R1cmUgPSBmdW5jdGlvbihnZXN0dXJlKSB7XG5cdFx0cmV0dXJuICQuYWRkQWN0aW9uKCdnZXN0dXJlcycsIGdlc3R1cmUpO1xuXG5cdH07XG5cblx0dmFyIHJvdW5kID0gTWF0aC5yb3VuZDtcblx0dmFyIGFicyA9IE1hdGguYWJzO1xuXHR2YXIgc3FydCA9IE1hdGguc3FydDtcblx0dmFyIGF0YW4gPSBNYXRoLmF0YW47XG5cdHZhciBhdGFuMiA9IE1hdGguYXRhbjI7XG5cdC8qKlxuXHQgKiBkaXN0YW5jZVxuXHQgKiBAcGFyYW0ge3R5cGV9IHAxXG5cdCAqIEBwYXJhbSB7dHlwZX0gcDJcblx0ICogQHJldHVybnMge051bWJlcn1cblx0ICovXG5cdHZhciBnZXREaXN0YW5jZSA9IGZ1bmN0aW9uKHAxLCBwMiwgcHJvcHMpIHtcblx0XHRpZiAoIXByb3BzKSB7XG5cdFx0XHRwcm9wcyA9IFsneCcsICd5J107XG5cdFx0fVxuXHRcdHZhciB4ID0gcDJbcHJvcHNbMF1dIC0gcDFbcHJvcHNbMF1dO1xuXHRcdHZhciB5ID0gcDJbcHJvcHNbMV1dIC0gcDFbcHJvcHNbMV1dO1xuXHRcdHJldHVybiBzcXJ0KCh4ICogeCkgKyAoeSAqIHkpKTtcblx0fTtcblx0LyoqXG5cdCAqIHNjYWxlXG5cdCAqIEBwYXJhbSB7T2JqZWN0fSBzdGFydHNcblx0ICogQHBhcmFtIHtPYmplY3R9IG1vdmVzXG5cdCAqL1xuXHR2YXIgZ2V0U2NhbGUgPSBmdW5jdGlvbihzdGFydHMsIG1vdmVzKSB7XG5cdFx0aWYgKHN0YXJ0cy5sZW5ndGggPj0gMiAmJiBtb3Zlcy5sZW5ndGggPj0gMikge1xuXHRcdFx0dmFyIHByb3BzID0gWydwYWdlWCcsICdwYWdlWSddO1xuXHRcdFx0cmV0dXJuIGdldERpc3RhbmNlKG1vdmVzWzFdLCBtb3Zlc1swXSwgcHJvcHMpIC8gZ2V0RGlzdGFuY2Uoc3RhcnRzWzFdLCBzdGFydHNbMF0sIHByb3BzKTtcblx0XHR9XG5cdFx0cmV0dXJuIDE7XG5cdH07XG5cdC8qKlxuXHQgKiBhbmdsZVxuXHQgKiBAcGFyYW0ge3R5cGV9IHAxXG5cdCAqIEBwYXJhbSB7dHlwZX0gcDJcblx0ICogQHJldHVybnMge051bWJlcn1cblx0ICovXG5cdHZhciBnZXRBbmdsZSA9IGZ1bmN0aW9uKHAxLCBwMiwgcHJvcHMpIHtcblx0XHRpZiAoIXByb3BzKSB7XG5cdFx0XHRwcm9wcyA9IFsneCcsICd5J107XG5cdFx0fVxuXHRcdHZhciB4ID0gcDJbcHJvcHNbMF1dIC0gcDFbcHJvcHNbMF1dO1xuXHRcdHZhciB5ID0gcDJbcHJvcHNbMV1dIC0gcDFbcHJvcHNbMV1dO1xuXHRcdHJldHVybiBhdGFuMih5LCB4KSAqIDE4MCAvIE1hdGguUEk7XG5cdH07XG5cdC8qKlxuXHQgKiBkaXJlY3Rpb25cblx0ICogQHBhcmFtIHtPYmplY3R9IHhcblx0ICogQHBhcmFtIHtPYmplY3R9IHlcblx0ICovXG5cdHZhciBnZXREaXJlY3Rpb24gPSBmdW5jdGlvbih4LCB5KSB7XG5cdFx0aWYgKHggPT09IHkpIHtcblx0XHRcdHJldHVybiAnJztcblx0XHR9XG5cdFx0aWYgKGFicyh4KSA+PSBhYnMoeSkpIHtcblx0XHRcdHJldHVybiB4ID4gMCA/ICdsZWZ0JyA6ICdyaWdodCc7XG5cdFx0fVxuXHRcdHJldHVybiB5ID4gMCA/ICd1cCcgOiAnZG93bic7XG5cdH07XG5cdC8qKlxuXHQgKiByb3RhdGlvblxuXHQgKiBAcGFyYW0ge09iamVjdH0gc3RhcnRcblx0ICogQHBhcmFtIHtPYmplY3R9IGVuZFxuXHQgKi9cblx0dmFyIGdldFJvdGF0aW9uID0gZnVuY3Rpb24oc3RhcnQsIGVuZCkge1xuXHRcdHZhciBwcm9wcyA9IFsncGFnZVgnLCAncGFnZVknXTtcblx0XHRyZXR1cm4gZ2V0QW5nbGUoZW5kWzFdLCBlbmRbMF0sIHByb3BzKSAtIGdldEFuZ2xlKHN0YXJ0WzFdLCBzdGFydFswXSwgcHJvcHMpO1xuXHR9O1xuXHQvKipcblx0ICogcHggcGVyIG1zXG5cdCAqIEBwYXJhbSB7T2JqZWN0fSBkZWx0YVRpbWVcblx0ICogQHBhcmFtIHtPYmplY3R9IHhcblx0ICogQHBhcmFtIHtPYmplY3R9IHlcblx0ICovXG5cdHZhciBnZXRWZWxvY2l0eSA9IGZ1bmN0aW9uKGRlbHRhVGltZSwgeCwgeSkge1xuXHRcdHJldHVybiB7XG5cdFx0XHR4OiB4IC8gZGVsdGFUaW1lIHx8IDAsXG5cdFx0XHR5OiB5IC8gZGVsdGFUaW1lIHx8IDBcblx0XHR9O1xuXHR9O1xuXHQvKipcblx0ICogZGV0ZWN0IGdlc3R1cmVzXG5cdCAqIEBwYXJhbSB7dHlwZX0gZXZlbnRcblx0ICogQHBhcmFtIHt0eXBlfSB0b3VjaFxuXHQgKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxuXHQgKi9cblx0dmFyIGRldGVjdCA9IGZ1bmN0aW9uKGV2ZW50LCB0b3VjaCkge1xuXHRcdGlmICgkLmdlc3R1cmVzLnN0b3BlZCkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHQkLmRvQWN0aW9uKCdnZXN0dXJlcycsIGZ1bmN0aW9uKGluZGV4LCBnZXN0dXJlKSB7XG5cdFx0XHRpZiAoISQuZ2VzdHVyZXMuc3RvcGVkKSB7XG5cdFx0XHRcdGlmICgkLm9wdGlvbnMuZ2VzdHVyZUNvbmZpZ1tnZXN0dXJlLm5hbWVdICE9PSBmYWxzZSkge1xuXHRcdFx0XHRcdGdlc3R1cmUuaGFuZGxlKGV2ZW50LCB0b3VjaCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblx0fTtcblx0LyoqXG5cdCAqIOaaguaXtuaXoOeUqFxuXHQgKiBAcGFyYW0ge09iamVjdH0gbm9kZVxuXHQgKiBAcGFyYW0ge09iamVjdH0gcGFyZW50XG5cdCAqL1xuXHR2YXIgaGFzUGFyZW50ID0gZnVuY3Rpb24obm9kZSwgcGFyZW50KSB7XG5cdFx0d2hpbGUgKG5vZGUpIHtcblx0XHRcdGlmIChub2RlID09IHBhcmVudCkge1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblx0XHRcdG5vZGUgPSBub2RlLnBhcmVudE5vZGU7XG5cdFx0fVxuXHRcdHJldHVybiBmYWxzZTtcblx0fTtcblxuXHR2YXIgdW5pcXVlQXJyYXkgPSBmdW5jdGlvbihzcmMsIGtleSwgc29ydCkge1xuXHRcdHZhciByZXN1bHRzID0gW107XG5cdFx0dmFyIHZhbHVlcyA9IFtdO1xuXHRcdHZhciBpID0gMDtcblxuXHRcdHdoaWxlIChpIDwgc3JjLmxlbmd0aCkge1xuXHRcdFx0dmFyIHZhbCA9IGtleSA/IHNyY1tpXVtrZXldIDogc3JjW2ldO1xuXHRcdFx0aWYgKHZhbHVlcy5pbmRleE9mKHZhbCkgPCAwKSB7XG5cdFx0XHRcdHJlc3VsdHMucHVzaChzcmNbaV0pO1xuXHRcdFx0fVxuXHRcdFx0dmFsdWVzW2ldID0gdmFsO1xuXHRcdFx0aSsrO1xuXHRcdH1cblxuXHRcdGlmIChzb3J0KSB7XG5cdFx0XHRpZiAoIWtleSkge1xuXHRcdFx0XHRyZXN1bHRzID0gcmVzdWx0cy5zb3J0KCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXN1bHRzID0gcmVzdWx0cy5zb3J0KGZ1bmN0aW9uIHNvcnRVbmlxdWVBcnJheShhLCBiKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGFba2V5XSA+IGJba2V5XTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHJlc3VsdHM7XG5cdH07XG5cdHZhciBnZXRNdWx0aUNlbnRlciA9IGZ1bmN0aW9uKHRvdWNoZXMpIHtcblx0XHR2YXIgdG91Y2hlc0xlbmd0aCA9IHRvdWNoZXMubGVuZ3RoO1xuXHRcdGlmICh0b3VjaGVzTGVuZ3RoID09PSAxKSB7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHR4OiByb3VuZCh0b3VjaGVzWzBdLnBhZ2VYKSxcblx0XHRcdFx0eTogcm91bmQodG91Y2hlc1swXS5wYWdlWSlcblx0XHRcdH07XG5cdFx0fVxuXG5cdFx0dmFyIHggPSAwO1xuXHRcdHZhciB5ID0gMDtcblx0XHR2YXIgaSA9IDA7XG5cdFx0d2hpbGUgKGkgPCB0b3VjaGVzTGVuZ3RoKSB7XG5cdFx0XHR4ICs9IHRvdWNoZXNbaV0ucGFnZVg7XG5cdFx0XHR5ICs9IHRvdWNoZXNbaV0ucGFnZVk7XG5cdFx0XHRpKys7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHtcblx0XHRcdHg6IHJvdW5kKHggLyB0b3VjaGVzTGVuZ3RoKSxcblx0XHRcdHk6IHJvdW5kKHkgLyB0b3VjaGVzTGVuZ3RoKVxuXHRcdH07XG5cdH07XG5cdHZhciBtdWx0aVRvdWNoID0gZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuICQub3B0aW9ucy5nZXN0dXJlQ29uZmlnLnBpbmNoO1xuXHR9O1xuXHR2YXIgY29weVNpbXBsZVRvdWNoRGF0YSA9IGZ1bmN0aW9uKHRvdWNoKSB7XG5cdFx0dmFyIHRvdWNoZXMgPSBbXTtcblx0XHR2YXIgaSA9IDA7XG5cdFx0d2hpbGUgKGkgPCB0b3VjaC50b3VjaGVzLmxlbmd0aCkge1xuXHRcdFx0dG91Y2hlc1tpXSA9IHtcblx0XHRcdFx0cGFnZVg6IHJvdW5kKHRvdWNoLnRvdWNoZXNbaV0ucGFnZVgpLFxuXHRcdFx0XHRwYWdlWTogcm91bmQodG91Y2gudG91Y2hlc1tpXS5wYWdlWSlcblx0XHRcdH07XG5cdFx0XHRpKys7XG5cdFx0fVxuXHRcdHJldHVybiB7XG5cdFx0XHR0aW1lc3RhbXA6ICQubm93KCksXG5cdFx0XHRnZXN0dXJlOiB0b3VjaC5nZXN0dXJlLFxuXHRcdFx0dG91Y2hlczogdG91Y2hlcyxcblx0XHRcdGNlbnRlcjogZ2V0TXVsdGlDZW50ZXIodG91Y2gudG91Y2hlcyksXG5cdFx0XHRkZWx0YVg6IHRvdWNoLmRlbHRhWCxcblx0XHRcdGRlbHRhWTogdG91Y2guZGVsdGFZXG5cdFx0fTtcblx0fTtcblxuXHR2YXIgY2FsRGVsdGEgPSBmdW5jdGlvbih0b3VjaCkge1xuXHRcdHZhciBzZXNzaW9uID0gJC5nZXN0dXJlcy5zZXNzaW9uO1xuXHRcdHZhciBjZW50ZXIgPSB0b3VjaC5jZW50ZXI7XG5cdFx0dmFyIG9mZnNldCA9IHNlc3Npb24ub2Zmc2V0RGVsdGEgfHwge307XG5cdFx0dmFyIHByZXZEZWx0YSA9IHNlc3Npb24ucHJldkRlbHRhIHx8IHt9O1xuXHRcdHZhciBwcmV2VG91Y2ggPSBzZXNzaW9uLnByZXZUb3VjaCB8fCB7fTtcblxuXHRcdGlmICh0b3VjaC5nZXN0dXJlLnR5cGUgPT09ICQuRVZFTlRfU1RBUlQgfHwgdG91Y2guZ2VzdHVyZS50eXBlID09PSAkLkVWRU5UX0VORCkge1xuXHRcdFx0cHJldkRlbHRhID0gc2Vzc2lvbi5wcmV2RGVsdGEgPSB7XG5cdFx0XHRcdHg6IHByZXZUb3VjaC5kZWx0YVggfHwgMCxcblx0XHRcdFx0eTogcHJldlRvdWNoLmRlbHRhWSB8fCAwXG5cdFx0XHR9O1xuXG5cdFx0XHRvZmZzZXQgPSBzZXNzaW9uLm9mZnNldERlbHRhID0ge1xuXHRcdFx0XHR4OiBjZW50ZXIueCxcblx0XHRcdFx0eTogY2VudGVyLnlcblx0XHRcdH07XG5cdFx0fVxuXHRcdHRvdWNoLmRlbHRhWCA9IHByZXZEZWx0YS54ICsgKGNlbnRlci54IC0gb2Zmc2V0LngpO1xuXHRcdHRvdWNoLmRlbHRhWSA9IHByZXZEZWx0YS55ICsgKGNlbnRlci55IC0gb2Zmc2V0LnkpO1xuXHR9O1xuXHR2YXIgY2FsVG91Y2hEYXRhID0gZnVuY3Rpb24odG91Y2gpIHtcblx0XHR2YXIgc2Vzc2lvbiA9ICQuZ2VzdHVyZXMuc2Vzc2lvbjtcblx0XHR2YXIgdG91Y2hlcyA9IHRvdWNoLnRvdWNoZXM7XG5cdFx0dmFyIHRvdWNoZXNMZW5ndGggPSB0b3VjaGVzLmxlbmd0aDtcblxuXHRcdGlmICghc2Vzc2lvbi5maXJzdFRvdWNoKSB7XG5cdFx0XHRzZXNzaW9uLmZpcnN0VG91Y2ggPSBjb3B5U2ltcGxlVG91Y2hEYXRhKHRvdWNoKTtcblx0XHR9XG5cblx0XHRpZiAobXVsdGlUb3VjaCgpICYmIHRvdWNoZXNMZW5ndGggPiAxICYmICFzZXNzaW9uLmZpcnN0TXVsdGlUb3VjaCkge1xuXHRcdFx0c2Vzc2lvbi5maXJzdE11bHRpVG91Y2ggPSBjb3B5U2ltcGxlVG91Y2hEYXRhKHRvdWNoKTtcblx0XHR9IGVsc2UgaWYgKHRvdWNoZXNMZW5ndGggPT09IDEpIHtcblx0XHRcdHNlc3Npb24uZmlyc3RNdWx0aVRvdWNoID0gZmFsc2U7XG5cdFx0fVxuXG5cdFx0dmFyIGZpcnN0VG91Y2ggPSBzZXNzaW9uLmZpcnN0VG91Y2g7XG5cdFx0dmFyIGZpcnN0TXVsdGlUb3VjaCA9IHNlc3Npb24uZmlyc3RNdWx0aVRvdWNoO1xuXHRcdHZhciBvZmZzZXRDZW50ZXIgPSBmaXJzdE11bHRpVG91Y2ggPyBmaXJzdE11bHRpVG91Y2guY2VudGVyIDogZmlyc3RUb3VjaC5jZW50ZXI7XG5cblx0XHR2YXIgY2VudGVyID0gdG91Y2guY2VudGVyID0gZ2V0TXVsdGlDZW50ZXIodG91Y2hlcyk7XG5cdFx0dG91Y2gudGltZXN0YW1wID0gJC5ub3coKTtcblx0XHR0b3VjaC5kZWx0YVRpbWUgPSB0b3VjaC50aW1lc3RhbXAgLSBmaXJzdFRvdWNoLnRpbWVzdGFtcDtcblxuXHRcdHRvdWNoLmFuZ2xlID0gZ2V0QW5nbGUob2Zmc2V0Q2VudGVyLCBjZW50ZXIpO1xuXHRcdHRvdWNoLmRpc3RhbmNlID0gZ2V0RGlzdGFuY2Uob2Zmc2V0Q2VudGVyLCBjZW50ZXIpO1xuXG5cdFx0Y2FsRGVsdGEodG91Y2gpO1xuXG5cdFx0dG91Y2gub2Zmc2V0RGlyZWN0aW9uID0gZ2V0RGlyZWN0aW9uKHRvdWNoLmRlbHRhWCwgdG91Y2guZGVsdGFZKTtcblxuXHRcdHRvdWNoLnNjYWxlID0gZmlyc3RNdWx0aVRvdWNoID8gZ2V0U2NhbGUoZmlyc3RNdWx0aVRvdWNoLnRvdWNoZXMsIHRvdWNoZXMpIDogMTtcblx0XHR0b3VjaC5yb3RhdGlvbiA9IGZpcnN0TXVsdGlUb3VjaCA/IGdldFJvdGF0aW9uKGZpcnN0TXVsdGlUb3VjaC50b3VjaGVzLCB0b3VjaGVzKSA6IDA7XG5cblx0XHRjYWxJbnRlcnZhbFRvdWNoRGF0YSh0b3VjaCk7XG5cblx0fTtcblx0dmFyIENBTF9JTlRFUlZBTCA9IDI1O1xuXHR2YXIgY2FsSW50ZXJ2YWxUb3VjaERhdGEgPSBmdW5jdGlvbih0b3VjaCkge1xuXHRcdHZhciBzZXNzaW9uID0gJC5nZXN0dXJlcy5zZXNzaW9uO1xuXHRcdHZhciBsYXN0ID0gc2Vzc2lvbi5sYXN0SW50ZXJ2YWwgfHwgdG91Y2g7XG5cdFx0dmFyIGRlbHRhVGltZSA9IHRvdWNoLnRpbWVzdGFtcCAtIGxhc3QudGltZXN0YW1wO1xuXHRcdHZhciB2ZWxvY2l0eTtcblx0XHR2YXIgdmVsb2NpdHlYO1xuXHRcdHZhciB2ZWxvY2l0eVk7XG5cdFx0dmFyIGRpcmVjdGlvbjtcblxuXHRcdGlmICh0b3VjaC5nZXN0dXJlLnR5cGUgIT0gJC5FVkVOVF9DQU5DRUwgJiYgKGRlbHRhVGltZSA+IENBTF9JTlRFUlZBTCB8fCBsYXN0LnZlbG9jaXR5ID09PSB1bmRlZmluZWQpKSB7XG5cdFx0XHR2YXIgZGVsdGFYID0gbGFzdC5kZWx0YVggLSB0b3VjaC5kZWx0YVg7XG5cdFx0XHR2YXIgZGVsdGFZID0gbGFzdC5kZWx0YVkgLSB0b3VjaC5kZWx0YVk7XG5cblx0XHRcdHZhciB2ID0gZ2V0VmVsb2NpdHkoZGVsdGFUaW1lLCBkZWx0YVgsIGRlbHRhWSk7XG5cdFx0XHR2ZWxvY2l0eVggPSB2Lng7XG5cdFx0XHR2ZWxvY2l0eVkgPSB2Lnk7XG5cdFx0XHR2ZWxvY2l0eSA9IChhYnModi54KSA+IGFicyh2LnkpKSA/IHYueCA6IHYueTtcblx0XHRcdGRpcmVjdGlvbiA9IGdldERpcmVjdGlvbihkZWx0YVgsIGRlbHRhWSkgfHwgbGFzdC5kaXJlY3Rpb247XG5cblx0XHRcdHNlc3Npb24ubGFzdEludGVydmFsID0gdG91Y2g7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHZlbG9jaXR5ID0gbGFzdC52ZWxvY2l0eTtcblx0XHRcdHZlbG9jaXR5WCA9IGxhc3QudmVsb2NpdHlYO1xuXHRcdFx0dmVsb2NpdHlZID0gbGFzdC52ZWxvY2l0eVk7XG5cdFx0XHRkaXJlY3Rpb24gPSBsYXN0LmRpcmVjdGlvbjtcblx0XHR9XG5cblx0XHR0b3VjaC52ZWxvY2l0eSA9IHZlbG9jaXR5O1xuXHRcdHRvdWNoLnZlbG9jaXR5WCA9IHZlbG9jaXR5WDtcblx0XHR0b3VjaC52ZWxvY2l0eVkgPSB2ZWxvY2l0eVk7XG5cdFx0dG91Y2guZGlyZWN0aW9uID0gZGlyZWN0aW9uO1xuXHR9O1xuXHR2YXIgdGFyZ2V0SWRzID0ge307XG5cdHZhciBjb252ZXJ0VG91Y2hlcyA9IGZ1bmN0aW9uKHRvdWNoZXMpIHtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHRvdWNoZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdCF0b3VjaGVzWydpZGVudGlmaWVyJ10gJiYgKHRvdWNoZXNbJ2lkZW50aWZpZXInXSA9IDApO1xuXHRcdH1cblx0XHRyZXR1cm4gdG91Y2hlcztcblx0fTtcblx0dmFyIGdldFRvdWNoZXMgPSBmdW5jdGlvbihldmVudCwgdG91Y2gpIHtcblx0XHR2YXIgYWxsVG91Y2hlcyA9IGNvbnZlcnRUb3VjaGVzKCQuc2xpY2UuY2FsbChldmVudC50b3VjaGVzIHx8IFtldmVudF0pKTtcblxuXHRcdHZhciB0eXBlID0gZXZlbnQudHlwZTtcblxuXHRcdHZhciB0YXJnZXRUb3VjaGVzID0gW107XG5cdFx0dmFyIGNoYW5nZWRUYXJnZXRUb3VjaGVzID0gW107XG5cblx0XHQvL+W9k3RvdWNoc3RhcnTmiJZ0b3VjaG1vdmXkuJR0b3VjaGVz6ZW/5bqm5Li6Me+8jOebtOaOpeiOt+W+l2FsbOWSjGNoYW5nZWRcblx0XHRpZiAoKHR5cGUgPT09ICQuRVZFTlRfU1RBUlQgfHwgdHlwZSA9PT0gJC5FVkVOVF9NT1ZFKSAmJiBhbGxUb3VjaGVzLmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0dGFyZ2V0SWRzW2FsbFRvdWNoZXNbMF0uaWRlbnRpZmllcl0gPSB0cnVlO1xuXHRcdFx0dGFyZ2V0VG91Y2hlcyA9IGFsbFRvdWNoZXM7XG5cdFx0XHRjaGFuZ2VkVGFyZ2V0VG91Y2hlcyA9IGFsbFRvdWNoZXM7XG5cdFx0XHR0b3VjaC50YXJnZXQgPSBldmVudC50YXJnZXQ7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHZhciBpID0gMDtcblx0XHRcdHZhciB0YXJnZXRUb3VjaGVzID0gW107XG5cdFx0XHR2YXIgY2hhbmdlZFRhcmdldFRvdWNoZXMgPSBbXTtcblx0XHRcdHZhciBjaGFuZ2VkVG91Y2hlcyA9IGNvbnZlcnRUb3VjaGVzKCQuc2xpY2UuY2FsbChldmVudC5jaGFuZ2VkVG91Y2hlcyB8fCBbZXZlbnRdKSk7XG5cblx0XHRcdHRvdWNoLnRhcmdldCA9IGV2ZW50LnRhcmdldDtcblx0XHRcdHZhciBzZXNzaW9uVGFyZ2V0ID0gJC5nZXN0dXJlcy5zZXNzaW9uLnRhcmdldCB8fCBldmVudC50YXJnZXQ7XG5cdFx0XHR0YXJnZXRUb3VjaGVzID0gYWxsVG91Y2hlcy5maWx0ZXIoZnVuY3Rpb24odG91Y2gpIHtcblx0XHRcdFx0cmV0dXJuIGhhc1BhcmVudCh0b3VjaC50YXJnZXQsIHNlc3Npb25UYXJnZXQpO1xuXHRcdFx0fSk7XG5cblx0XHRcdGlmICh0eXBlID09PSAkLkVWRU5UX1NUQVJUKSB7XG5cdFx0XHRcdGkgPSAwO1xuXHRcdFx0XHR3aGlsZSAoaSA8IHRhcmdldFRvdWNoZXMubGVuZ3RoKSB7XG5cdFx0XHRcdFx0dGFyZ2V0SWRzW3RhcmdldFRvdWNoZXNbaV0uaWRlbnRpZmllcl0gPSB0cnVlO1xuXHRcdFx0XHRcdGkrKztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpID0gMDtcblx0XHRcdHdoaWxlIChpIDwgY2hhbmdlZFRvdWNoZXMubGVuZ3RoKSB7XG5cdFx0XHRcdGlmICh0YXJnZXRJZHNbY2hhbmdlZFRvdWNoZXNbaV0uaWRlbnRpZmllcl0pIHtcblx0XHRcdFx0XHRjaGFuZ2VkVGFyZ2V0VG91Y2hlcy5wdXNoKGNoYW5nZWRUb3VjaGVzW2ldKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAodHlwZSA9PT0gJC5FVkVOVF9FTkQgfHwgdHlwZSA9PT0gJC5FVkVOVF9DQU5DRUwpIHtcblx0XHRcdFx0XHRkZWxldGUgdGFyZ2V0SWRzW2NoYW5nZWRUb3VjaGVzW2ldLmlkZW50aWZpZXJdO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGkrKztcblx0XHRcdH1cblxuXHRcdFx0aWYgKCFjaGFuZ2VkVGFyZ2V0VG91Y2hlcy5sZW5ndGgpIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdH1cblx0XHR0YXJnZXRUb3VjaGVzID0gdW5pcXVlQXJyYXkodGFyZ2V0VG91Y2hlcy5jb25jYXQoY2hhbmdlZFRhcmdldFRvdWNoZXMpLCAnaWRlbnRpZmllcicsIHRydWUpO1xuXHRcdHZhciB0b3VjaGVzTGVuZ3RoID0gdGFyZ2V0VG91Y2hlcy5sZW5ndGg7XG5cdFx0dmFyIGNoYW5nZWRUb3VjaGVzTGVuZ3RoID0gY2hhbmdlZFRhcmdldFRvdWNoZXMubGVuZ3RoO1xuXHRcdGlmICh0eXBlID09PSAkLkVWRU5UX1NUQVJUICYmIHRvdWNoZXNMZW5ndGggLSBjaGFuZ2VkVG91Y2hlc0xlbmd0aCA9PT0gMCkgeyAvL2ZpcnN0XG5cdFx0XHR0b3VjaC5pc0ZpcnN0ID0gdHJ1ZTtcblx0XHRcdCQuZ2VzdHVyZXMudG91Y2ggPSAkLmdlc3R1cmVzLnNlc3Npb24gPSB7XG5cdFx0XHRcdHRhcmdldDogZXZlbnQudGFyZ2V0XG5cdFx0XHR9O1xuXHRcdH1cblx0XHR0b3VjaC5pc0ZpbmFsID0gKCh0eXBlID09PSAkLkVWRU5UX0VORCB8fCB0eXBlID09PSAkLkVWRU5UX0NBTkNFTCkgJiYgKHRvdWNoZXNMZW5ndGggLSBjaGFuZ2VkVG91Y2hlc0xlbmd0aCA9PT0gMCkpO1xuXG5cdFx0dG91Y2gudG91Y2hlcyA9IHRhcmdldFRvdWNoZXM7XG5cdFx0dG91Y2guY2hhbmdlZFRvdWNoZXMgPSBjaGFuZ2VkVGFyZ2V0VG91Y2hlcztcblx0XHRyZXR1cm4gdHJ1ZTtcblxuXHR9O1xuXHR2YXIgaGFuZGxlVG91Y2hFdmVudCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0dmFyIHRvdWNoID0ge1xuXHRcdFx0Z2VzdHVyZTogZXZlbnRcblx0XHR9O1xuXHRcdHZhciB0b3VjaGVzID0gZ2V0VG91Y2hlcyhldmVudCwgdG91Y2gpO1xuXHRcdGlmICghdG91Y2hlcykge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRjYWxUb3VjaERhdGEodG91Y2gpO1xuXHRcdGRldGVjdChldmVudCwgdG91Y2gpO1xuXHRcdCQuZ2VzdHVyZXMuc2Vzc2lvbi5wcmV2VG91Y2ggPSB0b3VjaDtcblx0XHRpZiAoZXZlbnQudHlwZSA9PT0gJC5FVkVOVF9FTkQgJiYgISQuaXNUb3VjaGFibGUpIHtcblx0XHRcdCQuZ2VzdHVyZXMudG91Y2ggPSAkLmdlc3R1cmVzLnNlc3Npb24gPSB7fTtcblx0XHR9XG5cdH07XG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCQuRVZFTlRfU1RBUlQsIGhhbmRsZVRvdWNoRXZlbnQpO1xuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigkLkVWRU5UX01PVkUsIGhhbmRsZVRvdWNoRXZlbnQpO1xuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigkLkVWRU5UX0VORCwgaGFuZGxlVG91Y2hFdmVudCk7XG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCQuRVZFTlRfQ0FOQ0VMLCBoYW5kbGVUb3VjaEV2ZW50KTtcblx0Ly9maXhlZCBoYXNoY2hhbmdlKGFuZHJvaWQpXG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCQuRVZFTlRfQ0xJQ0ssIGZ1bmN0aW9uKGUpIHtcblx0XHQvL1RPRE8g5bqU6K+l5Yik5pat5b2T5YmNdGFyZ2V05piv5LiN5piv5ZyodGFyZ2V0cy5wb3BvdmVy5YaF6YOo77yM6ICM5LiN5piv6Z2e6KaB55u4562JXG5cdFx0aWYgKCgkLm9zLmFuZHJvaWQgfHwgJC5vcy5pb3MpICYmICgoJC50YXJnZXRzLnBvcG92ZXIgJiYgZS50YXJnZXQgPT09ICQudGFyZ2V0cy5wb3BvdmVyKSB8fCAoJC50YXJnZXRzLnRhYikgfHwgJC50YXJnZXRzLm9mZmNhbnZhcyB8fCAkLnRhcmdldHMubW9kYWwpKSB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0fVxuXHR9LCB0cnVlKTtcblxuXG5cdC8v5aKe5Yqg5Y6f55Sf5rua5Yqo6K+G5YirXG5cdCQuaXNTY3JvbGxpbmcgPSBmYWxzZTtcblx0dmFyIHNjcm9sbGluZ1RpbWVvdXQgPSBudWxsO1xuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgZnVuY3Rpb24oKSB7XG5cdFx0JC5pc1Njcm9sbGluZyA9IHRydWU7XG5cdFx0c2Nyb2xsaW5nVGltZW91dCAmJiBjbGVhclRpbWVvdXQoc2Nyb2xsaW5nVGltZW91dCk7XG5cdFx0c2Nyb2xsaW5nVGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHQkLmlzU2Nyb2xsaW5nID0gZmFsc2U7XG5cdFx0fSwgMjUwKTtcblx0fSk7XG59KShtdWksIHdpbmRvdyk7XG4vKipcbiAqIG11aSBnZXN0dXJlIGZsaWNrW2xlZnR8cmlnaHR8dXB8ZG93bl1cbiAqIEBwYXJhbSB7dHlwZX0gJFxuICogQHBhcmFtIHt0eXBlfSBuYW1lXG4gKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxuICovXG4oZnVuY3Rpb24oJCwgbmFtZSkge1xuXHR2YXIgZmxpY2tTdGFydFRpbWUgPSAwO1xuXHR2YXIgaGFuZGxlID0gZnVuY3Rpb24oZXZlbnQsIHRvdWNoKSB7XG5cdFx0dmFyIHNlc3Npb24gPSAkLmdlc3R1cmVzLnNlc3Npb247XG5cdFx0dmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7XG5cdFx0dmFyIG5vdyA9ICQubm93KCk7XG5cdFx0c3dpdGNoIChldmVudC50eXBlKSB7XG5cdFx0XHRjYXNlICQuRVZFTlRfTU9WRTpcblx0XHRcdFx0aWYgKG5vdyAtIGZsaWNrU3RhcnRUaW1lID4gMzAwKSB7XG5cdFx0XHRcdFx0ZmxpY2tTdGFydFRpbWUgPSBub3c7XG5cdFx0XHRcdFx0c2Vzc2lvbi5mbGlja1N0YXJ0ID0gdG91Y2guY2VudGVyO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSAkLkVWRU5UX0VORDpcblx0XHRcdGNhc2UgJC5FVkVOVF9DQU5DRUw6XG5cdFx0XHRcdHRvdWNoLmZsaWNrID0gZmFsc2U7XG5cdFx0XHRcdGlmIChzZXNzaW9uLmZsaWNrU3RhcnQgJiYgb3B0aW9ucy5mbGlja01heFRpbWUgPiAobm93IC0gZmxpY2tTdGFydFRpbWUpICYmIHRvdWNoLmRpc3RhbmNlID4gb3B0aW9ucy5mbGlja01pbkRpc3RpbmNlKSB7XG5cdFx0XHRcdFx0dG91Y2guZmxpY2sgPSB0cnVlO1xuXHRcdFx0XHRcdHRvdWNoLmZsaWNrVGltZSA9IG5vdyAtIGZsaWNrU3RhcnRUaW1lO1xuXHRcdFx0XHRcdHRvdWNoLmZsaWNrRGlzdGFuY2VYID0gdG91Y2guY2VudGVyLnggLSBzZXNzaW9uLmZsaWNrU3RhcnQueDtcblx0XHRcdFx0XHR0b3VjaC5mbGlja0Rpc3RhbmNlWSA9IHRvdWNoLmNlbnRlci55IC0gc2Vzc2lvbi5mbGlja1N0YXJ0Lnk7XG5cdFx0XHRcdFx0JC50cmlnZ2VyKHNlc3Npb24udGFyZ2V0LCBuYW1lLCB0b3VjaCk7XG5cdFx0XHRcdFx0JC50cmlnZ2VyKHNlc3Npb24udGFyZ2V0LCBuYW1lICsgdG91Y2guZGlyZWN0aW9uLCB0b3VjaCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cdFx0fVxuXG5cdH07XG5cdC8qKlxuXHQgKiBtdWkgZ2VzdHVyZSBmbGlja1xuXHQgKi9cblx0JC5hZGRHZXN0dXJlKHtcblx0XHRuYW1lOiBuYW1lLFxuXHRcdGluZGV4OiA1LFxuXHRcdGhhbmRsZTogaGFuZGxlLFxuXHRcdG9wdGlvbnM6IHtcblx0XHRcdGZsaWNrTWF4VGltZTogMjAwLFxuXHRcdFx0ZmxpY2tNaW5EaXN0aW5jZTogMTBcblx0XHR9XG5cdH0pO1xufSkobXVpLCAnZmxpY2snKTtcbi8qKlxuICogbXVpIGdlc3R1cmUgc3dpcGVbbGVmdHxyaWdodHx1cHxkb3duXVxuICogQHBhcmFtIHt0eXBlfSAkXG4gKiBAcGFyYW0ge3R5cGV9IG5hbWVcbiAqIEByZXR1cm5zIHt1bmRlZmluZWR9XG4gKi9cbihmdW5jdGlvbigkLCBuYW1lKSB7XG5cdHZhciBoYW5kbGUgPSBmdW5jdGlvbihldmVudCwgdG91Y2gpIHtcblx0XHR2YXIgc2Vzc2lvbiA9ICQuZ2VzdHVyZXMuc2Vzc2lvbjtcblx0XHRpZiAoZXZlbnQudHlwZSA9PT0gJC5FVkVOVF9FTkQgfHwgZXZlbnQudHlwZSA9PT0gJC5FVkVOVF9DQU5DRUwpIHtcblx0XHRcdHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zO1xuXHRcdFx0dG91Y2guc3dpcGUgPSBmYWxzZTtcblx0XHRcdC8vVE9ETyDlkI7nu63moLnmja52ZWxvY2l0eeiuoeeul1xuXHRcdFx0aWYgKHRvdWNoLmRpcmVjdGlvbiAmJiBvcHRpb25zLnN3aXBlTWF4VGltZSA+IHRvdWNoLmRlbHRhVGltZSAmJiB0b3VjaC5kaXN0YW5jZSA+IG9wdGlvbnMuc3dpcGVNaW5EaXN0aW5jZSkge1xuXHRcdFx0XHR0b3VjaC5zd2lwZSA9IHRydWU7XG5cdFx0XHRcdCQudHJpZ2dlcihzZXNzaW9uLnRhcmdldCwgbmFtZSwgdG91Y2gpO1xuXHRcdFx0XHQkLnRyaWdnZXIoc2Vzc2lvbi50YXJnZXQsIG5hbWUgKyB0b3VjaC5kaXJlY3Rpb24sIHRvdWNoKTtcblx0XHRcdH1cblx0XHR9XG5cdH07XG5cdC8qKlxuXHQgKiBtdWkgZ2VzdHVyZSBzd2lwZVxuXHQgKi9cblx0JC5hZGRHZXN0dXJlKHtcblx0XHRuYW1lOiBuYW1lLFxuXHRcdGluZGV4OiAxMCxcblx0XHRoYW5kbGU6IGhhbmRsZSxcblx0XHRvcHRpb25zOiB7XG5cdFx0XHRzd2lwZU1heFRpbWU6IDMwMCxcblx0XHRcdHN3aXBlTWluRGlzdGluY2U6IDE4XG5cdFx0fVxuXHR9KTtcbn0pKG11aSwgJ3N3aXBlJyk7XG4vKipcbiAqIG11aSBnZXN0dXJlIGRyYWdbc3RhcnR8bGVmdHxyaWdodHx1cHxkb3dufGVuZF1cbiAqIEBwYXJhbSB7dHlwZX0gJFxuICogQHBhcmFtIHt0eXBlfSBuYW1lXG4gKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxuICovXG4oZnVuY3Rpb24oJCwgbmFtZSkge1xuXHR2YXIgaGFuZGxlID0gZnVuY3Rpb24oZXZlbnQsIHRvdWNoKSB7XG5cdFx0dmFyIHNlc3Npb24gPSAkLmdlc3R1cmVzLnNlc3Npb247XG5cdFx0c3dpdGNoIChldmVudC50eXBlKSB7XG5cdFx0XHRjYXNlICQuRVZFTlRfU1RBUlQ6XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSAkLkVWRU5UX01PVkU6XG5cdFx0XHRcdGlmICghdG91Y2guZGlyZWN0aW9uIHx8ICFzZXNzaW9uLnRhcmdldCkge1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0XHQvL+S/ruato2RpcmVjdGlvbizlj6/lnKhzZXNzaW9u5pyf6Ze06Ieq6KGM6ZSB5a6a5ouW5ou95pa55ZCR77yM5pa55L6/5byA5Y+Rc2Nyb2xs57G75LiN5ZCM5pa55ZCR5ouW5ou95o+S5Lu25bWM5aWXXG5cdFx0XHRcdGlmIChzZXNzaW9uLmxvY2tEaXJlY3Rpb24gJiYgc2Vzc2lvbi5zdGFydERpcmVjdGlvbikge1xuXHRcdFx0XHRcdGlmIChzZXNzaW9uLnN0YXJ0RGlyZWN0aW9uICYmIHNlc3Npb24uc3RhcnREaXJlY3Rpb24gIT09IHRvdWNoLmRpcmVjdGlvbikge1xuXHRcdFx0XHRcdFx0aWYgKHNlc3Npb24uc3RhcnREaXJlY3Rpb24gPT09ICd1cCcgfHwgc2Vzc2lvbi5zdGFydERpcmVjdGlvbiA9PT0gJ2Rvd24nKSB7XG5cdFx0XHRcdFx0XHRcdHRvdWNoLmRpcmVjdGlvbiA9IHRvdWNoLmRlbHRhWSA8IDAgPyAndXAnIDogJ2Rvd24nO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0dG91Y2guZGlyZWN0aW9uID0gdG91Y2guZGVsdGFYIDwgMCA/ICdsZWZ0JyA6ICdyaWdodCc7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKCFzZXNzaW9uLmRyYWcpIHtcblx0XHRcdFx0XHRzZXNzaW9uLmRyYWcgPSB0cnVlO1xuXHRcdFx0XHRcdCQudHJpZ2dlcihzZXNzaW9uLnRhcmdldCwgbmFtZSArICdzdGFydCcsIHRvdWNoKTtcblx0XHRcdFx0fVxuXHRcdFx0XHQkLnRyaWdnZXIoc2Vzc2lvbi50YXJnZXQsIG5hbWUsIHRvdWNoKTtcblx0XHRcdFx0JC50cmlnZ2VyKHNlc3Npb24udGFyZ2V0LCBuYW1lICsgdG91Y2guZGlyZWN0aW9uLCB0b3VjaCk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSAkLkVWRU5UX0VORDpcblx0XHRcdGNhc2UgJC5FVkVOVF9DQU5DRUw6XG5cdFx0XHRcdGlmIChzZXNzaW9uLmRyYWcgJiYgdG91Y2guaXNGaW5hbCkge1xuXHRcdFx0XHRcdCQudHJpZ2dlcihzZXNzaW9uLnRhcmdldCwgbmFtZSArICdlbmQnLCB0b3VjaCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9O1xuXHQvKipcblx0ICogbXVpIGdlc3R1cmUgZHJhZ1xuXHQgKi9cblx0JC5hZGRHZXN0dXJlKHtcblx0XHRuYW1lOiBuYW1lLFxuXHRcdGluZGV4OiAyMCxcblx0XHRoYW5kbGU6IGhhbmRsZSxcblx0XHRvcHRpb25zOiB7XG5cdFx0XHRmaW5nZXJzOiAxXG5cdFx0fVxuXHR9KTtcbn0pKG11aSwgJ2RyYWcnKTtcbi8qKlxuICogbXVpIGdlc3R1cmUgdGFwIGFuZCBkb3VibGVUYXBcbiAqIEBwYXJhbSB7dHlwZX0gJFxuICogQHBhcmFtIHt0eXBlfSBuYW1lXG4gKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxuICovXG4oZnVuY3Rpb24oJCwgbmFtZSkge1xuXHR2YXIgbGFzdFRhcmdldDtcblx0dmFyIGxhc3RUYXBUaW1lO1xuXHR2YXIgaGFuZGxlID0gZnVuY3Rpb24oZXZlbnQsIHRvdWNoKSB7XG5cdFx0dmFyIHNlc3Npb24gPSAkLmdlc3R1cmVzLnNlc3Npb247XG5cdFx0dmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7XG5cdFx0c3dpdGNoIChldmVudC50eXBlKSB7XG5cdFx0XHRjYXNlICQuRVZFTlRfRU5EOlxuXHRcdFx0XHRpZiAoIXRvdWNoLmlzRmluYWwpIHtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdFx0dmFyIHRhcmdldCA9IHNlc3Npb24udGFyZ2V0O1xuXHRcdFx0XHRpZiAoIXRhcmdldCB8fCAodGFyZ2V0LmRpc2FibGVkIHx8ICh0YXJnZXQuY2xhc3NMaXN0ICYmIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ211aS1kaXNhYmxlZCcpKSkpIHtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKHRvdWNoLmRpc3RhbmNlIDwgb3B0aW9ucy50YXBNYXhEaXN0YW5jZSAmJiB0b3VjaC5kZWx0YVRpbWUgPCBvcHRpb25zLnRhcE1heFRpbWUpIHtcblx0XHRcdFx0XHRpZiAoJC5vcHRpb25zLmdlc3R1cmVDb25maWcuZG91YmxldGFwICYmIGxhc3RUYXJnZXQgJiYgKGxhc3RUYXJnZXQgPT09IHRhcmdldCkpIHsgLy9zYW1lIHRhcmdldFxuXHRcdFx0XHRcdFx0aWYgKGxhc3RUYXBUaW1lICYmICh0b3VjaC50aW1lc3RhbXAgLSBsYXN0VGFwVGltZSkgPCBvcHRpb25zLnRhcE1heEludGVydmFsKSB7XG5cdFx0XHRcdFx0XHRcdCQudHJpZ2dlcih0YXJnZXQsICdkb3VibGV0YXAnLCB0b3VjaCk7XG5cdFx0XHRcdFx0XHRcdGxhc3RUYXBUaW1lID0gJC5ub3coKTtcblx0XHRcdFx0XHRcdFx0bGFzdFRhcmdldCA9IHRhcmdldDtcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHQkLnRyaWdnZXIodGFyZ2V0LCBuYW1lLCB0b3VjaCk7XG5cdFx0XHRcdFx0bGFzdFRhcFRpbWUgPSAkLm5vdygpO1xuXHRcdFx0XHRcdGxhc3RUYXJnZXQgPSB0YXJnZXQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9O1xuXHQvKipcblx0ICogbXVpIGdlc3R1cmUgdGFwXG5cdCAqL1xuXHQkLmFkZEdlc3R1cmUoe1xuXHRcdG5hbWU6IG5hbWUsXG5cdFx0aW5kZXg6IDMwLFxuXHRcdGhhbmRsZTogaGFuZGxlLFxuXHRcdG9wdGlvbnM6IHtcblx0XHRcdGZpbmdlcnM6IDEsXG5cdFx0XHR0YXBNYXhJbnRlcnZhbDogMzAwLFxuXHRcdFx0dGFwTWF4RGlzdGFuY2U6IDUsXG5cdFx0XHR0YXBNYXhUaW1lOiAyNTBcblx0XHR9XG5cdH0pO1xufSkobXVpLCAndGFwJyk7XG4vKipcbiAqIG11aSBnZXN0dXJlIGxvbmd0YXBcbiAqIEBwYXJhbSB7dHlwZX0gJFxuICogQHBhcmFtIHt0eXBlfSBuYW1lXG4gKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxuICovXG4oZnVuY3Rpb24oJCwgbmFtZSkge1xuXHR2YXIgdGltZXI7XG5cdHZhciBoYW5kbGUgPSBmdW5jdGlvbihldmVudCwgdG91Y2gpIHtcblx0XHR2YXIgc2Vzc2lvbiA9ICQuZ2VzdHVyZXMuc2Vzc2lvbjtcblx0XHR2YXIgb3B0aW9ucyA9IHRoaXMub3B0aW9ucztcblx0XHRzd2l0Y2ggKGV2ZW50LnR5cGUpIHtcblx0XHRcdGNhc2UgJC5FVkVOVF9TVEFSVDpcblx0XHRcdFx0Y2xlYXJUaW1lb3V0KHRpbWVyKTtcblx0XHRcdFx0dGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdCQudHJpZ2dlcihzZXNzaW9uLnRhcmdldCwgbmFtZSwgdG91Y2gpO1xuXHRcdFx0XHR9LCBvcHRpb25zLmhvbGRUaW1lb3V0KTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlICQuRVZFTlRfTU9WRTpcblx0XHRcdFx0aWYgKHRvdWNoLmRpc3RhbmNlID4gb3B0aW9ucy5ob2xkVGhyZXNob2xkKSB7XG5cdFx0XHRcdFx0Y2xlYXJUaW1lb3V0KHRpbWVyKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgJC5FVkVOVF9FTkQ6XG5cdFx0XHRjYXNlICQuRVZFTlRfQ0FOQ0VMOlxuXHRcdFx0XHRjbGVhclRpbWVvdXQodGltZXIpO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cdH07XG5cdC8qKlxuXHQgKiBtdWkgZ2VzdHVyZSBsb25ndGFwXG5cdCAqL1xuXHQkLmFkZEdlc3R1cmUoe1xuXHRcdG5hbWU6IG5hbWUsXG5cdFx0aW5kZXg6IDEwLFxuXHRcdGhhbmRsZTogaGFuZGxlLFxuXHRcdG9wdGlvbnM6IHtcblx0XHRcdGZpbmdlcnM6IDEsXG5cdFx0XHRob2xkVGltZW91dDogNTAwLFxuXHRcdFx0aG9sZFRocmVzaG9sZDogMlxuXHRcdH1cblx0fSk7XG59KShtdWksICdsb25ndGFwJyk7XG4vKipcbiAqIG11aSBnZXN0dXJlIGhvbGRcbiAqIEBwYXJhbSB7dHlwZX0gJFxuICogQHBhcmFtIHt0eXBlfSBuYW1lXG4gKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxuICovXG4oZnVuY3Rpb24oJCwgbmFtZSkge1xuXHR2YXIgdGltZXI7XG5cdHZhciBoYW5kbGUgPSBmdW5jdGlvbihldmVudCwgdG91Y2gpIHtcblx0XHR2YXIgc2Vzc2lvbiA9ICQuZ2VzdHVyZXMuc2Vzc2lvbjtcblx0XHR2YXIgb3B0aW9ucyA9IHRoaXMub3B0aW9ucztcblx0XHRzd2l0Y2ggKGV2ZW50LnR5cGUpIHtcblx0XHRcdGNhc2UgJC5FVkVOVF9TVEFSVDpcblx0XHRcdFx0aWYgKCQub3B0aW9ucy5nZXN0dXJlQ29uZmlnLmhvbGQpIHtcblx0XHRcdFx0XHR0aW1lciAmJiBjbGVhclRpbWVvdXQodGltZXIpO1xuXHRcdFx0XHRcdHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdHRvdWNoLmhvbGQgPSB0cnVlO1xuXHRcdFx0XHRcdFx0JC50cmlnZ2VyKHNlc3Npb24udGFyZ2V0LCBuYW1lLCB0b3VjaCk7XG5cdFx0XHRcdFx0fSwgb3B0aW9ucy5ob2xkVGltZW91dCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlICQuRVZFTlRfTU9WRTpcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlICQuRVZFTlRfRU5EOlxuXHRcdFx0Y2FzZSAkLkVWRU5UX0NBTkNFTDpcblx0XHRcdFx0aWYgKHRpbWVyKSB7XG5cdFx0XHRcdFx0Y2xlYXJUaW1lb3V0KHRpbWVyKSAmJiAodGltZXIgPSBudWxsKTtcblx0XHRcdFx0XHQkLnRyaWdnZXIoc2Vzc2lvbi50YXJnZXQsICdyZWxlYXNlJywgdG91Y2gpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fTtcblx0LyoqXG5cdCAqIG11aSBnZXN0dXJlIGhvbGRcblx0ICovXG5cdCQuYWRkR2VzdHVyZSh7XG5cdFx0bmFtZTogbmFtZSxcblx0XHRpbmRleDogMTAsXG5cdFx0aGFuZGxlOiBoYW5kbGUsXG5cdFx0b3B0aW9uczoge1xuXHRcdFx0ZmluZ2VyczogMSxcblx0XHRcdGhvbGRUaW1lb3V0OiAwXG5cdFx0fVxuXHR9KTtcbn0pKG11aSwgJ2hvbGQnKTtcbi8qKlxuICogbXVpIGdlc3R1cmUgcGluY2hcbiAqIEBwYXJhbSB7dHlwZX0gJFxuICogQHBhcmFtIHt0eXBlfSBuYW1lXG4gKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxuICovXG4oZnVuY3Rpb24oJCwgbmFtZSkge1xuXHR2YXIgaGFuZGxlID0gZnVuY3Rpb24oZXZlbnQsIHRvdWNoKSB7XG5cdFx0dmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7XG5cdFx0dmFyIHNlc3Npb24gPSAkLmdlc3R1cmVzLnNlc3Npb247XG5cdFx0c3dpdGNoIChldmVudC50eXBlKSB7XG5cdFx0XHRjYXNlICQuRVZFTlRfU1RBUlQ6XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSAkLkVWRU5UX01PVkU6XG5cdFx0XHRcdGlmICgkLm9wdGlvbnMuZ2VzdHVyZUNvbmZpZy5waW5jaCkge1xuXHRcdFx0XHRcdGlmICh0b3VjaC50b3VjaGVzLmxlbmd0aCA8IDIpIHtcblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKCFzZXNzaW9uLnBpbmNoKSB7IC8vc3RhcnRcblx0XHRcdFx0XHRcdHNlc3Npb24ucGluY2ggPSB0cnVlO1xuXHRcdFx0XHRcdFx0JC50cmlnZ2VyKHNlc3Npb24udGFyZ2V0LCBuYW1lICsgJ3N0YXJ0JywgdG91Y2gpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHQkLnRyaWdnZXIoc2Vzc2lvbi50YXJnZXQsIG5hbWUsIHRvdWNoKTtcblx0XHRcdFx0XHR2YXIgc2NhbGUgPSB0b3VjaC5zY2FsZTtcblx0XHRcdFx0XHR2YXIgcm90YXRpb24gPSB0b3VjaC5yb3RhdGlvbjtcblx0XHRcdFx0XHR2YXIgbGFzdFNjYWxlID0gdHlwZW9mIHRvdWNoLmxhc3RTY2FsZSA9PT0gJ3VuZGVmaW5lZCcgPyAxIDogdG91Y2gubGFzdFNjYWxlO1xuXHRcdFx0XHRcdHZhciBzY2FsZURpZmYgPSAwLjAwMDAwMDAwMDAwMTsgLy/pmLLmraJzY2FsZeS4jmxhc3RTY2FsZeebuOetie+8jOS4jeinpuWPkeS6i+S7tueahOaDheWGteOAglxuXHRcdFx0XHRcdGlmIChzY2FsZSA+IGxhc3RTY2FsZSkgeyAvL291dFxuXHRcdFx0XHRcdFx0bGFzdFNjYWxlID0gc2NhbGUgLSBzY2FsZURpZmY7XG5cdFx0XHRcdFx0XHQkLnRyaWdnZXIoc2Vzc2lvbi50YXJnZXQsIG5hbWUgKyAnb3V0JywgdG91Y2gpO1xuXHRcdFx0XHRcdH0gLy9pblxuXHRcdFx0XHRcdGVsc2UgaWYgKHNjYWxlIDwgbGFzdFNjYWxlKSB7XG5cdFx0XHRcdFx0XHRsYXN0U2NhbGUgPSBzY2FsZSArIHNjYWxlRGlmZjtcblx0XHRcdFx0XHRcdCQudHJpZ2dlcihzZXNzaW9uLnRhcmdldCwgbmFtZSArICdpbicsIHRvdWNoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKE1hdGguYWJzKHJvdGF0aW9uKSA+IG9wdGlvbnMubWluUm90YXRpb25BbmdsZSkge1xuXHRcdFx0XHRcdFx0JC50cmlnZ2VyKHNlc3Npb24udGFyZ2V0LCAncm90YXRlJywgdG91Y2gpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgJC5FVkVOVF9FTkQ6XG5cdFx0XHRjYXNlICQuRVZFTlRfQ0FOQ0VMOlxuXHRcdFx0XHRpZiAoJC5vcHRpb25zLmdlc3R1cmVDb25maWcucGluY2ggJiYgc2Vzc2lvbi5waW5jaCAmJiB0b3VjaC50b3VjaGVzLmxlbmd0aCA9PT0gMikge1xuXHRcdFx0XHRcdHNlc3Npb24ucGluY2ggPSBmYWxzZTtcblx0XHRcdFx0XHQkLnRyaWdnZXIoc2Vzc2lvbi50YXJnZXQsIG5hbWUgKyAnZW5kJywgdG91Y2gpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fTtcblx0LyoqXG5cdCAqIG11aSBnZXN0dXJlIHBpbmNoXG5cdCAqL1xuXHQkLmFkZEdlc3R1cmUoe1xuXHRcdG5hbWU6IG5hbWUsXG5cdFx0aW5kZXg6IDEwLFxuXHRcdGhhbmRsZTogaGFuZGxlLFxuXHRcdG9wdGlvbnM6IHtcblx0XHRcdG1pblJvdGF0aW9uQW5nbGU6IDBcblx0XHR9XG5cdH0pO1xufSkobXVpLCAncGluY2gnKTtcbi8qKlxuICogbXVpLmluaXRcbiAqIEBwYXJhbSB7dHlwZX0gJFxuICogQHJldHVybnMge3VuZGVmaW5lZH1cbiAqL1xuKGZ1bmN0aW9uKCQpIHtcblx0JC5nbG9iYWwgPSAkLm9wdGlvbnMgPSB7XG5cdFx0Z2VzdHVyZUNvbmZpZzoge1xuXHRcdFx0dGFwOiB0cnVlLFxuXHRcdFx0ZG91YmxldGFwOiBmYWxzZSxcblx0XHRcdGxvbmd0YXA6IGZhbHNlLFxuXHRcdFx0aG9sZDogZmFsc2UsXG5cdFx0XHRmbGljazogdHJ1ZSxcblx0XHRcdHN3aXBlOiB0cnVlLFxuXHRcdFx0ZHJhZzogdHJ1ZSxcblx0XHRcdHBpbmNoOiBmYWxzZVxuXHRcdH1cblx0fTtcblx0LyoqXG5cdCAqXG5cdCAqIEBwYXJhbSB7dHlwZX0gb3B0aW9uc1xuXHQgKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxuXHQgKi9cblx0JC5pbml0R2xvYmFsID0gZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdCQub3B0aW9ucyA9ICQuZXh0ZW5kKHRydWUsICQuZ2xvYmFsLCBvcHRpb25zKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fTtcblx0dmFyIGluaXRzID0ge307XG5cblx0LyoqXG5cdCAqIOWNlemhtemFjee9riDliJ3lp4vljJZcblx0ICogQHBhcmFtIHtvYmplY3R9IG9wdGlvbnNcblx0ICovXG5cdCQuaW5pdCA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHQkLm9wdGlvbnMgPSAkLmV4dGVuZCh0cnVlLCAkLmdsb2JhbCwgb3B0aW9ucyB8fCB7fSk7XG5cdFx0JC5yZWFkeShmdW5jdGlvbigpIHtcblx0XHRcdCQuZG9BY3Rpb24oJ2luaXRzJywgZnVuY3Rpb24oaW5kZXgsIGluaXQpIHtcblx0XHRcdFx0dmFyIGlzSW5pdCA9ICEhKCFpbml0c1tpbml0Lm5hbWVdIHx8IGluaXQucmVwZWF0KTtcblx0XHRcdFx0aWYgKGlzSW5pdCkge1xuXHRcdFx0XHRcdGluaXQuaGFuZGxlLmNhbGwoJCk7XG5cdFx0XHRcdFx0aW5pdHNbaW5pdC5uYW1lXSA9IHRydWU7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0pO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9O1xuXG5cdC8qKlxuXHQgKiDlop7liqDliJ3lp4vljJbmiafooYzmtYHnqItcblx0ICogQHBhcmFtIHtmdW5jdGlvbn0gaW5pdFxuXHQgKi9cblx0JC5hZGRJbml0ID0gZnVuY3Rpb24oaW5pdCkge1xuXHRcdHJldHVybiAkLmFkZEFjdGlvbignaW5pdHMnLCBpbml0KTtcblx0fTtcblx0LyoqXG5cdCAqIOWkhOeQhmh0bWw154mI5pysc3VicGFnZXNcblx0ICovXG5cdCQuYWRkSW5pdCh7XG5cdFx0bmFtZTogJ2lmcmFtZScsXG5cdFx0aW5kZXg6IDEwMCxcblx0XHRoYW5kbGU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIG9wdGlvbnMgPSAkLm9wdGlvbnM7XG5cdFx0XHR2YXIgc3VicGFnZXMgPSBvcHRpb25zLnN1YnBhZ2VzIHx8IFtdO1xuXHRcdFx0aWYgKCEkLm9zLnBsdXMgJiYgc3VicGFnZXMubGVuZ3RoKSB7XG5cdFx0XHRcdC8v5pqC5pe25Y+q5aSE55CG5Y2V5Liqc3VicGFnZeOAguWQjue7reWPr+S7peiAg+iZkeaUr+aMgeWkmuS4qnN1YnBhZ2Vcblx0XHRcdFx0Y3JlYXRlSWZyYW1lKHN1YnBhZ2VzWzBdKTtcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXHR2YXIgY3JlYXRlSWZyYW1lID0gZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdHZhciB3cmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0d3JhcHBlci5jbGFzc05hbWUgPSAnbXVpLWlmcmFtZS13cmFwcGVyJztcblx0XHR2YXIgc3R5bGVzID0gb3B0aW9ucy5zdHlsZXMgfHwge307XG5cdFx0aWYgKHR5cGVvZiBzdHlsZXMudG9wICE9PSAnc3RyaW5nJykge1xuXHRcdFx0c3R5bGVzLnRvcCA9ICcwcHgnO1xuXHRcdH1cblx0XHRpZiAodHlwZW9mIHN0eWxlcy5ib3R0b20gIT09ICdzdHJpbmcnKSB7XG5cdFx0XHRzdHlsZXMuYm90dG9tID0gJzBweCc7XG5cdFx0fVxuXHRcdHdyYXBwZXIuc3R5bGUudG9wID0gc3R5bGVzLnRvcDtcblx0XHR3cmFwcGVyLnN0eWxlLmJvdHRvbSA9IHN0eWxlcy5ib3R0b207XG5cdFx0dmFyIGlmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lmcmFtZScpO1xuXHRcdGlmcmFtZS5zcmMgPSBvcHRpb25zLnVybDtcblx0XHRpZnJhbWUuaWQgPSBvcHRpb25zLmlkIHx8IG9wdGlvbnMudXJsO1xuXHRcdGlmcmFtZS5uYW1lID0gaWZyYW1lLmlkO1xuXHRcdHdyYXBwZXIuYXBwZW5kQ2hpbGQoaWZyYW1lKTtcblx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHdyYXBwZXIpO1xuXHRcdC8v55uu5YmN5LuF5aSE55CG5b6u5L+hXG5cdFx0JC5vcy53ZWNoYXQgJiYgaGFuZGxlU2Nyb2xsKHdyYXBwZXIsIGlmcmFtZSk7XG5cdH07XG5cblx0ZnVuY3Rpb24gaGFuZGxlU2Nyb2xsKHdyYXBwZXIsIGlmcmFtZSkge1xuXHRcdHZhciBrZXkgPSAnTVVJX1NDUk9MTF9QT1NJVElPTl8nICsgZG9jdW1lbnQubG9jYXRpb24uaHJlZiArICdfJyArIGlmcmFtZS5zcmM7XG5cdFx0dmFyIHNjcm9sbFRvcCA9IChwYXJzZUZsb2F0KGxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSkpIHx8IDApO1xuXHRcdGlmIChzY3JvbGxUb3ApIHtcblx0XHRcdChmdW5jdGlvbih5KSB7XG5cdFx0XHRcdGlmcmFtZS5vbmxvYWQgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHR3aW5kb3cuc2Nyb2xsVG8oMCwgeSk7XG5cdFx0XHRcdH07XG5cdFx0XHR9KShzY3JvbGxUb3ApO1xuXHRcdH1cblx0XHRzZXRJbnRlcnZhbChmdW5jdGlvbigpIHtcblx0XHRcdHZhciBfc2Nyb2xsVG9wID0gd2luZG93LnNjcm9sbFk7XG5cdFx0XHRpZiAoc2Nyb2xsVG9wICE9PSBfc2Nyb2xsVG9wKSB7XG5cdFx0XHRcdGxvY2FsU3RvcmFnZS5zZXRJdGVtKGtleSwgX3Njcm9sbFRvcCArICcnKTtcblx0XHRcdFx0c2Nyb2xsVG9wID0gX3Njcm9sbFRvcDtcblx0XHRcdH1cblx0XHR9LCAxMDApO1xuXHR9O1xuXHQkKGZ1bmN0aW9uKCkge1xuXHRcdHZhciBjbGFzc0xpc3QgPSBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdDtcblx0XHR2YXIgb3MgPSBbXTtcblx0XHRpZiAoJC5vcy5pb3MpIHtcblx0XHRcdG9zLnB1c2goe1xuXHRcdFx0XHRvczogJ2lvcycsXG5cdFx0XHRcdHZlcnNpb246ICQub3MudmVyc2lvblxuXHRcdFx0fSk7XG5cdFx0XHRjbGFzc0xpc3QuYWRkKCdtdWktaW9zJyk7XG5cdFx0fSBlbHNlIGlmICgkLm9zLmFuZHJvaWQpIHtcblx0XHRcdG9zLnB1c2goe1xuXHRcdFx0XHRvczogJ2FuZHJvaWQnLFxuXHRcdFx0XHR2ZXJzaW9uOiAkLm9zLnZlcnNpb25cblx0XHRcdH0pO1xuXHRcdFx0Y2xhc3NMaXN0LmFkZCgnbXVpLWFuZHJvaWQnKTtcblx0XHR9XG5cdFx0aWYgKCQub3Mud2VjaGF0KSB7XG5cdFx0XHRvcy5wdXNoKHtcblx0XHRcdFx0b3M6ICd3ZWNoYXQnLFxuXHRcdFx0XHR2ZXJzaW9uOiAkLm9zLndlY2hhdC52ZXJzaW9uXG5cdFx0XHR9KTtcblx0XHRcdGNsYXNzTGlzdC5hZGQoJ211aS13ZWNoYXQnKTtcblx0XHR9XG5cdFx0aWYgKG9zLmxlbmd0aCkge1xuXHRcdFx0JC5lYWNoKG9zLCBmdW5jdGlvbihpbmRleCwgb3NPYmopIHtcblx0XHRcdFx0dmFyIHZlcnNpb24gPSAnJztcblx0XHRcdFx0dmFyIGNsYXNzQXJyYXkgPSBbXTtcblx0XHRcdFx0aWYgKG9zT2JqLnZlcnNpb24pIHtcblx0XHRcdFx0XHQkLmVhY2gob3NPYmoudmVyc2lvbi5zcGxpdCgnLicpLCBmdW5jdGlvbihpLCB2KSB7XG5cdFx0XHRcdFx0XHR2ZXJzaW9uID0gdmVyc2lvbiArICh2ZXJzaW9uID8gJy0nIDogJycpICsgdjtcblx0XHRcdFx0XHRcdGNsYXNzTGlzdC5hZGQoJC5jbGFzc05hbWUob3NPYmoub3MgKyAnLScgKyB2ZXJzaW9uKSk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblx0fSk7XG59KShtdWkpO1xuLyoqXG4gKiBtdWkuaW5pdCA1K1xuICogQHBhcmFtIHt0eXBlfSAkXG4gKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxuICovXG4oZnVuY3Rpb24oJCkge1xuXHR2YXIgZGVmYXVsdE9wdGlvbnMgPSB7XG5cdFx0c3dpcGVCYWNrOiBmYWxzZSxcblx0XHRwcmVsb2FkUGFnZXM6IFtdLCAvLzUrIGxhenlMb2FkIHdlYnZpZXdcblx0XHRwcmVsb2FkTGltaXQ6IDEwLCAvL+mihOWKoOi9veeql+WPo+eahOaVsOmHj+mZkOWItijkuIDml6botoXlh7rvvIzlhYjov5vlhYjlh7opXG5cdFx0a2V5RXZlbnRCaW5kOiB7XG5cdFx0XHRiYWNrYnV0dG9uOiB0cnVlLFxuXHRcdFx0bWVudWJ1dHRvbjogdHJ1ZVxuXHRcdH0sXG5cdFx0dGl0bGVDb25maWc6IHtcblx0XHRcdGhlaWdodDogXCI0NHB4XCIsXG5cdFx0XHRiYWNrZ3JvdW5kQ29sb3I6IFwiI2Y3ZjdmN1wiLCAvL+WvvOiIquagj+iDjOaZr+iJslxuXHRcdFx0Ym90dG9tQm9yZGVyQ29sb3I6IFwiI2NjY2NjY1wiLCAvL+W6lemDqOi+uee6v+minOiJslxuXHRcdFx0dGl0bGU6IHsgLy/moIfpopjphY3nva5cblx0XHRcdFx0dGV4dDogXCJcIiwgLy/moIfpopjmloflrZdcblx0XHRcdFx0cG9zaXRpb246IHtcblx0XHRcdFx0XHR0b3A6IDAsXG5cdFx0XHRcdFx0bGVmdDogMCxcblx0XHRcdFx0XHR3aWR0aDogXCIxMDAlXCIsXG5cdFx0XHRcdFx0aGVpZ2h0OiBcIjEwMCVcIlxuXHRcdFx0XHR9LFxuXHRcdFx0XHRzdHlsZXM6IHtcblx0XHRcdFx0XHRjb2xvcjogXCIjMDAwMDAwXCIsXG5cdFx0XHRcdFx0YWxpZ246IFwiY2VudGVyXCIsXG5cdFx0XHRcdFx0ZmFtaWx5OiBcIidIZWx2ZXRpY2EgTmV1ZScsSGVsdmV0aWNhLHNhbnMtc2VyaWZcIixcblx0XHRcdFx0XHRzaXplOiBcIjE3cHhcIixcblx0XHRcdFx0XHRzdHlsZTogXCJub3JtYWxcIixcblx0XHRcdFx0XHR3ZWlnaHQ6IFwibm9ybWFsXCIsXG5cdFx0XHRcdFx0Zm9udFNyYzogXCJcIlxuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXHRcdFx0YmFjazoge1xuXHRcdFx0XHRpbWFnZToge1xuXHRcdFx0XHRcdGJhc2U2NERhdGE6ICcnLFxuXHRcdFx0XHRcdGltZ1NyYzogJycsXG5cdFx0XHRcdFx0c3ByaXRlOiB7XG5cdFx0XHRcdFx0XHR0b3A6ICcwcHgnLFxuXHRcdFx0XHRcdFx0bGVmdDogJzBweCcsXG5cdFx0XHRcdFx0XHR3aWR0aDogJzEwMCUnLFxuXHRcdFx0XHRcdFx0aGVpZ2h0OiAnMTAwJSdcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdHBvc2l0aW9uOiB7XG5cdFx0XHRcdFx0XHR0b3A6IFwiMTBweFwiLFxuXHRcdFx0XHRcdFx0bGVmdDogXCIxMHB4XCIsXG5cdFx0XHRcdFx0XHR3aWR0aDogXCIyNHB4XCIsXG5cdFx0XHRcdFx0XHRoZWlnaHQ6IFwiMjRweFwiXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9O1xuXG5cdC8v6buY6K6k6aG16Z2i5Yqo55S7XG5cdHZhciBkZWZhdWx0U2hvdyA9IHtcblx0XHRldmVudDpcInRpdGxlVXBkYXRlXCIsXG5cdFx0YXV0b1Nob3c6IHRydWUsXG5cdFx0ZHVyYXRpb246IDMwMCxcblx0XHRhbmlTaG93OiAnc2xpZGUtaW4tcmlnaHQnLFxuXHRcdGV4dHJhczp7fVxuXHR9O1xuXHQvL+iLpeaJp+ihjOS6huaYvuekuuWKqOeUu+WIneWni+WMluaTjeS9nO+8jOWImeimgeimhueblum7mOiupOmFjee9rlxuXHRpZigkLm9wdGlvbnMuc2hvdykge1xuXHRcdGRlZmF1bHRTaG93ID0gJC5leHRlbmQodHJ1ZSwgZGVmYXVsdFNob3csICQub3B0aW9ucy5zaG93KTtcblx0fVxuXG5cdCQuY3VycmVudFdlYnZpZXcgPSBudWxsO1xuXG5cdCQuZXh0ZW5kKHRydWUsICQuZ2xvYmFsLCBkZWZhdWx0T3B0aW9ucyk7XG5cdCQuZXh0ZW5kKHRydWUsICQub3B0aW9ucywgZGVmYXVsdE9wdGlvbnMpO1xuXHQvKipcblx0ICog562J5b6F5Yqo55S76YWN572uXG5cdCAqIEBwYXJhbSB7dHlwZX0gb3B0aW9uc1xuXHQgKiBAcmV0dXJucyB7T2JqZWN0fVxuXHQgKi9cblx0JC53YWl0aW5nT3B0aW9ucyA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRyZXR1cm4gJC5leHRlbmQodHJ1ZSwge30sIHtcblx0XHRcdGF1dG9TaG93OiB0cnVlLFxuXHRcdFx0dGl0bGU6ICcnLFxuXHRcdFx0bW9kYWw6IGZhbHNlXG5cdFx0fSwgb3B0aW9ucyk7XG5cdH07XG5cdC8qKlxuXHQgKiDnqpflj6PmmL7npLrphY3nva5cblx0ICogQHBhcmFtIHt0eXBlfSBvcHRpb25zXG5cdCAqIEByZXR1cm5zIHtPYmplY3R9XG5cdCAqL1xuXHQkLnNob3dPcHRpb25zID0gZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdHJldHVybiAkLmV4dGVuZCh0cnVlLCB7fSwgZGVmYXVsdFNob3csIG9wdGlvbnMpO1xuXHR9O1xuXHQvKipcblx0ICog56qX5Y+j6buY6K6k6YWN572uXG5cdCAqIEBwYXJhbSB7dHlwZX0gb3B0aW9uc1xuXHQgKiBAcmV0dXJucyB7T2JqZWN0fVxuXHQgKi9cblx0JC53aW5kb3dPcHRpb25zID0gZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdHJldHVybiAkLmV4dGVuZCh7XG5cdFx0XHRzY2FsYWJsZTogZmFsc2UsXG5cdFx0XHRib3VuY2U6IFwiXCIgLy92ZXJ0aWNhbFxuXHRcdH0sIG9wdGlvbnMpO1xuXHR9O1xuXHQvKipcblx0ICogcGx1c1JlYWR5XG5cdCAqIEBwYXJhbSB7dHlwZX0gY2FsbGJhY2tcblx0ICogQHJldHVybnMge19MNi4kfVxuXHQgKi9cblx0JC5wbHVzUmVhZHkgPSBmdW5jdGlvbihjYWxsYmFjaykge1xuXHRcdGlmKHdpbmRvdy5wbHVzKSB7XG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyAvL+ino+WGs2NhbGxiYWNr5LiOcGx1c3JlYWR55LqL5Lu255qE5omn6KGM5pe25py66Zeu6aKYKOWFuOWei+ahiOS+izpzaG93V2FpdGluZyxjbG9zZVdhaXRpbmcpXG5cdFx0XHRcdGNhbGxiYWNrKCk7XG5cdFx0XHR9LCAwKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInBsdXNyZWFkeVwiLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0Y2FsbGJhY2soKTtcblx0XHRcdH0sIGZhbHNlKTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH07XG5cdC8qKlxuXHQgKiA1KyBldmVudCg1K+ayoeaPkOS+m+S5i+WJjeaIkeiHquW3seWunueOsClcblx0ICogQHBhcmFtIHt0eXBlfSB3ZWJ2aWV3XG5cdCAqIEBwYXJhbSB7dHlwZX0gZXZlbnRUeXBlXG5cdCAqIEBwYXJhbSB7dHlwZX0gZGF0YVxuXHQgKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxuXHQgKi9cblx0JC5maXJlID0gZnVuY3Rpb24od2VidmlldywgZXZlbnRUeXBlLCBkYXRhKSB7XG5cdFx0aWYod2Vidmlldykge1xuXHRcdFx0aWYodHlwZW9mIGRhdGEgPT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRcdGRhdGEgPSAnJztcblx0XHRcdH0gZWxzZSBpZih0eXBlb2YgZGF0YSA9PT0gJ2Jvb2xlYW4nIHx8IHR5cGVvZiBkYXRhID09PSAnbnVtYmVyJykge1xuXHRcdFx0XHR3ZWJ2aWV3LmV2YWxKUyhcInR5cGVvZiBtdWkhPT0ndW5kZWZpbmVkJyYmbXVpLnJlY2VpdmUoJ1wiICsgZXZlbnRUeXBlICsgXCInLFwiICsgZGF0YSArIFwiKVwiKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fSBlbHNlIGlmKCQuaXNQbGFpbk9iamVjdChkYXRhKSB8fCAkLmlzQXJyYXkoZGF0YSkpIHtcblx0XHRcdFx0ZGF0YSA9IEpTT04uc3RyaW5naWZ5KGRhdGEgfHwge30pLnJlcGxhY2UoL1xcJy9nLCBcIlxcXFx1MDAyN1wiKS5yZXBsYWNlKC9cXFxcL2csIFwiXFxcXHUwMDVjXCIpO1xuXHRcdFx0fVxuXHRcdFx0d2Vidmlldy5ldmFsSlMoXCJ0eXBlb2YgbXVpIT09J3VuZGVmaW5lZCcmJm11aS5yZWNlaXZlKCdcIiArIGV2ZW50VHlwZSArIFwiJywnXCIgKyBkYXRhICsgXCInKVwiKTtcblx0XHR9XG5cdH07XG5cdC8qKlxuXHQgKiA1KyBldmVudCg1K+ayoeaPkOS+m+S5i+WJjeaIkeiHquW3seWunueOsClcblx0ICogQHBhcmFtIHt0eXBlfSBldmVudFR5cGVcblx0ICogQHBhcmFtIHt0eXBlfSBkYXRhXG5cdCAqIEByZXR1cm5zIHt1bmRlZmluZWR9XG5cdCAqL1xuXHQkLnJlY2VpdmUgPSBmdW5jdGlvbihldmVudFR5cGUsIGRhdGEpIHtcblx0XHRpZihldmVudFR5cGUpIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGlmKGRhdGEgJiYgdHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0ZGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7XG5cdFx0XHRcdH1cblx0XHRcdH0gY2F0Y2goZSkge31cblx0XHRcdCQudHJpZ2dlcihkb2N1bWVudCwgZXZlbnRUeXBlLCBkYXRhKTtcblx0XHR9XG5cdH07XG5cdHZhciB0cmlnZ2VyUHJlbG9hZCA9IGZ1bmN0aW9uKHdlYnZpZXcpIHtcblx0XHRpZighd2Vidmlldy5wcmVsb2FkZWQpIHsgLy/kv53or4Hku4Xop6blj5HkuIDmrKFcblx0XHRcdCQuZmlyZSh3ZWJ2aWV3LCAncHJlbG9hZCcpO1xuXHRcdFx0dmFyIGxpc3QgPSB3ZWJ2aWV3LmNoaWxkcmVuKCk7XG5cdFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHQkLmZpcmUobGlzdFtpXSwgJ3ByZWxvYWQnKTtcblx0XHRcdH1cblx0XHRcdHdlYnZpZXcucHJlbG9hZGVkID0gdHJ1ZTtcblx0XHR9XG5cdH07XG5cdHZhciB0cmlnZ2VyID0gZnVuY3Rpb24od2VidmlldywgZXZlbnRUeXBlLCB0aW1lQ2hlY2tlZCkge1xuXHRcdGlmKHRpbWVDaGVja2VkKSB7XG5cdFx0XHRpZighd2Vidmlld1tldmVudFR5cGUgKyAnZWQnXSkge1xuXHRcdFx0XHQkLmZpcmUod2VidmlldywgZXZlbnRUeXBlKTtcblx0XHRcdFx0dmFyIGxpc3QgPSB3ZWJ2aWV3LmNoaWxkcmVuKCk7XG5cdFx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0JC5maXJlKGxpc3RbaV0sIGV2ZW50VHlwZSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0d2Vidmlld1tldmVudFR5cGUgKyAnZWQnXSA9IHRydWU7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdCQuZmlyZSh3ZWJ2aWV3LCBldmVudFR5cGUpO1xuXHRcdFx0dmFyIGxpc3QgPSB3ZWJ2aWV3LmNoaWxkcmVuKCk7XG5cdFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHQkLmZpcmUobGlzdFtpXSwgZXZlbnRUeXBlKTtcblx0XHRcdH1cblx0XHR9XG5cblx0fTtcblx0LyoqXG5cdCAqIOaJk+W8gOaWsOeql+WPo1xuXHQgKiBAcGFyYW0ge3N0cmluZ30gdXJsIOimgeaJk+W8gOeahOmhtemdouWcsOWdgFxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaWQg5oyH5a6a6aG16Z2iSURcblx0ICogQHBhcmFtIHtvYmplY3R9IG9wdGlvbnMg5Y+v6YCJOuWPguaVsCznrYnlvoUs56qX5Y+jLOaYvuekuumFjee9rntwYXJhbXM6e30sd2FpdGluZzp7fSxzdHlsZXM6e30sc2hvdzp7fX1cblx0ICovXG5cdCQub3BlbldpbmRvdyA9IGZ1bmN0aW9uKHVybCwgaWQsIG9wdGlvbnMpIHtcblx0XHRpZih0eXBlb2YgdXJsID09PSAnb2JqZWN0Jykge1xuXHRcdFx0b3B0aW9ucyA9IHVybDtcblx0XHRcdHVybCA9IG9wdGlvbnMudXJsO1xuXHRcdFx0aWQgPSBvcHRpb25zLmlkIHx8IHVybDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYodHlwZW9mIGlkID09PSAnb2JqZWN0Jykge1xuXHRcdFx0XHRvcHRpb25zID0gaWQ7XG5cdFx0XHRcdGlkID0gb3B0aW9ucy5pZCB8fCB1cmw7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZCA9IGlkIHx8IHVybDtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYoISQub3MucGx1cykge1xuXHRcdFx0Ly9UT0RPIOWFiOS4tOaXtui/meS5iOWkhOeQhu+8muaJi+acuuS4iumhtuWxgui3s++8jFBD5LiKcGFyZW506LezXG5cdFx0XHRpZigkLm9zLmlvcyB8fCAkLm9zLmFuZHJvaWQpIHtcblx0XHRcdFx0d2luZG93LnRvcC5sb2NhdGlvbi5ocmVmID0gdXJsO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0d2luZG93LnBhcmVudC5sb2NhdGlvbi5ocmVmID0gdXJsO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRpZighd2luZG93LnBsdXMpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblx0XHR2YXIgcGFyYW1zID0gb3B0aW9ucy5wYXJhbXMgfHwge307XG5cdFx0dmFyIHdlYnZpZXcgPSBudWxsLFxuXHRcdFx0d2Vidmlld0NhY2hlID0gbnVsbCxcblx0XHRcdG5TaG93LCBuV2FpdGluZztcblxuXHRcdGlmKCQud2Vidmlld3NbaWRdKSB7XG5cdFx0XHR3ZWJ2aWV3Q2FjaGUgPSAkLndlYnZpZXdzW2lkXTtcblx0XHRcdC8vd2Vidmlld+ecn+WunuWtmOWcqO+8jOaJjeiDveiOt+WPllxuXHRcdFx0aWYocGx1cy53ZWJ2aWV3LmdldFdlYnZpZXdCeUlkKGlkKSkge1xuXHRcdFx0XHR3ZWJ2aWV3ID0gd2Vidmlld0NhY2hlLndlYnZpZXc7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIGlmKG9wdGlvbnMuY3JlYXRlTmV3ICE9PSB0cnVlKSB7XG5cdFx0XHR3ZWJ2aWV3ID0gcGx1cy53ZWJ2aWV3LmdldFdlYnZpZXdCeUlkKGlkKTtcblx0XHR9XG5cblx0XHRpZih3ZWJ2aWV3KSB7IC8v5bey57yT5a2YXG5cdFx0XHQvL+avj+asoXNob3fpg73pnIDopoHkvKDpgJLliqjnlLvlj4LmlbDvvJtcblx0XHRcdC8v6aKE5Yqg6L2955qE5Yqo55S75Y+C5pWw5LyY5YWI57qn77yab3BlbldpbmRvd+mFjee9rj5wcmVsb2FkUGFnZXPphY3nva4+bXVp6buY6K6k6YWN572u77ybXG5cdFx0XHRuU2hvdyA9IHdlYnZpZXdDYWNoZSA/IHdlYnZpZXdDYWNoZS5zaG93IDogZGVmYXVsdFNob3c7XG5cdFx0XHRuU2hvdyA9IG9wdGlvbnMuc2hvdyA/ICQuZXh0ZW5kKG5TaG93LCBvcHRpb25zLnNob3cpIDogblNob3c7XG5cdFx0XHRuU2hvdy5hdXRvU2hvdyAmJiB3ZWJ2aWV3LnNob3coblNob3cuYW5pU2hvdywgblNob3cuZHVyYXRpb24sIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0cmlnZ2VyUHJlbG9hZCh3ZWJ2aWV3KTtcblx0XHRcdFx0dHJpZ2dlcih3ZWJ2aWV3LCAncGFnZWJlZm9yZXNob3cnLCBmYWxzZSk7XG5cdFx0XHR9KTtcblx0XHRcdGlmKHdlYnZpZXdDYWNoZSkge1xuXHRcdFx0XHR3ZWJ2aWV3Q2FjaGUuYWZ0ZXJTaG93TWV0aG9kTmFtZSAmJiB3ZWJ2aWV3LmV2YWxKUyh3ZWJ2aWV3Q2FjaGUuYWZ0ZXJTaG93TWV0aG9kTmFtZSArICcoXFwnJyArIEpTT04uc3RyaW5naWZ5KHBhcmFtcykgKyAnXFwnKScpO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHdlYnZpZXc7XG5cdFx0fSBlbHNlIHsgLy/mlrDnqpflj6Ncblx0XHRcdGlmKCF1cmwpIHtcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCd3ZWJ2aWV3WycgKyBpZCArICddIGRvZXMgbm90IGV4aXN0Jyk7XG5cdFx0XHR9XG5cblx0XHRcdC8v5pi+56S6d2FpdGluZ1xuXHRcdFx0dmFyIHdhaXRpbmdDb25maWcgPSAkLndhaXRpbmdPcHRpb25zKG9wdGlvbnMud2FpdGluZyk7XG5cdFx0XHRpZih3YWl0aW5nQ29uZmlnLmF1dG9TaG93KSB7XG5cdFx0XHRcdG5XYWl0aW5nID0gcGx1cy5uYXRpdmVVSS5zaG93V2FpdGluZyh3YWl0aW5nQ29uZmlnLnRpdGxlLCB3YWl0aW5nQ29uZmlnLm9wdGlvbnMpO1xuXHRcdFx0fVxuXG5cdFx0XHQvL+WIm+W7uumhtemdolxuXHRcdFx0b3B0aW9ucyA9ICQuZXh0ZW5kKG9wdGlvbnMsIHtcblx0XHRcdFx0aWQ6IGlkLFxuXHRcdFx0XHR1cmw6IHVybFxuXHRcdFx0fSk7XG5cblx0XHRcdHdlYnZpZXcgPSAkLmNyZWF0ZVdpbmRvdyhvcHRpb25zKTtcblxuXHRcdFx0Ly/mmL7npLpcblx0XHRcdG5TaG93ID0gJC5zaG93T3B0aW9ucyhvcHRpb25zLnNob3cpO1xuXHRcdFx0aWYoblNob3cuYXV0b1Nob3cpIHtcblx0XHRcdFx0dmFyIHNob3dXZWJ2aWV3ID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0Ly/lhbPpl63nrYnlvoXmoYZcblx0XHRcdFx0XHRpZihuV2FpdGluZykge1xuXHRcdFx0XHRcdFx0bldhaXRpbmcuY2xvc2UoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Ly/mmL7npLrpobXpnaJcblx0XHRcdFx0XHR3ZWJ2aWV3LnNob3coblNob3cuYW5pU2hvdywgblNob3cuZHVyYXRpb24sIGZ1bmN0aW9uKCkge30sblNob3cuZXh0cmFzKTtcblx0XHRcdFx0XHRvcHRpb25zLmFmdGVyU2hvd01ldGhvZE5hbWUgJiYgd2Vidmlldy5ldmFsSlMob3B0aW9ucy5hZnRlclNob3dNZXRob2ROYW1lICsgJyhcXCcnICsgSlNPTi5zdHJpbmdpZnkocGFyYW1zKSArICdcXCcpJyk7XG5cdFx0XHRcdH07XG5cdFx0XHRcdC8vdGl0bGVVcGRhdGXop6blj5Hml7bmnLrml6nkuo5sb2FkZWTvvIzmm7TmjaLkuLp0aXRsZVVwZGF0ZeWQju+8jOWPr+S7peabtOaXqeeahOaYvuekundlYnZpZXdcblx0XHRcdFx0d2Vidmlldy5hZGRFdmVudExpc3RlbmVyKG5TaG93LmV2ZW50LCBzaG93V2VidmlldywgZmFsc2UpO1xuXHRcdFx0XHQvL2xvYWRlZOS6i+S7tuWPkeeUn+WQju+8jOinpuWPkemihOWKoOi9veWSjHBhZ2ViZWZvcmVzaG935LqL5Lu2XG5cdFx0XHRcdHdlYnZpZXcuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRlZFwiLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHR0cmlnZ2VyUHJlbG9hZCh3ZWJ2aWV3KTtcblx0XHRcdFx0XHR0cmlnZ2VyKHdlYnZpZXcsICdwYWdlYmVmb3Jlc2hvdycsIGZhbHNlKTtcblx0XHRcdFx0fSwgZmFsc2UpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gd2Vidmlldztcblx0fTtcblxuXHQkLm9wZW5XaW5kb3dXaXRoVGl0bGUgPSBmdW5jdGlvbihvcHRpb25zLCB0aXRsZUNvbmZpZykge1xuXHRcdG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXHRcdHZhciB1cmwgPSBvcHRpb25zLnVybDtcblx0XHR2YXIgaWQgPSBvcHRpb25zLmlkIHx8IHVybDtcblxuXHRcdGlmKCEkLm9zLnBsdXMpIHtcblx0XHRcdC8vVE9ETyDlhYjkuLTml7bov5nkuYjlpITnkIbvvJrmiYvmnLrkuIrpobblsYLot7PvvIxQQ+S4inBhcmVudOi3s1xuXHRcdFx0aWYoJC5vcy5pb3MgfHwgJC5vcy5hbmRyb2lkKSB7XG5cdFx0XHRcdHdpbmRvdy50b3AubG9jYXRpb24uaHJlZiA9IHVybDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHdpbmRvdy5wYXJlbnQubG9jYXRpb24uaHJlZiA9IHVybDtcblx0XHRcdH1cblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0aWYoIXdpbmRvdy5wbHVzKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dmFyIHBhcmFtcyA9IG9wdGlvbnMucGFyYW1zIHx8IHt9O1xuXHRcdHZhciB3ZWJ2aWV3ID0gbnVsbCxcblx0XHRcdHdlYnZpZXdDYWNoZSA9IG51bGwsXG5cdFx0XHRuU2hvdywgbldhaXRpbmc7XG5cblx0XHRpZigkLndlYnZpZXdzW2lkXSkge1xuXHRcdFx0d2Vidmlld0NhY2hlID0gJC53ZWJ2aWV3c1tpZF07XG5cdFx0XHQvL3dlYnZpZXfnnJ/lrp7lrZjlnKjvvIzmiY3og73ojrflj5Zcblx0XHRcdGlmKHBsdXMud2Vidmlldy5nZXRXZWJ2aWV3QnlJZChpZCkpIHtcblx0XHRcdFx0d2VidmlldyA9IHdlYnZpZXdDYWNoZS53ZWJ2aWV3O1xuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZihvcHRpb25zLmNyZWF0ZU5ldyAhPT0gdHJ1ZSkge1xuXHRcdFx0d2VidmlldyA9IHBsdXMud2Vidmlldy5nZXRXZWJ2aWV3QnlJZChpZCk7XG5cdFx0fVxuXG5cdFx0aWYod2VidmlldykgeyAvL+W3sue8k+WtmFxuXHRcdFx0Ly/mr4/mrKFzaG936YO96ZyA6KaB5Lyg6YCS5Yqo55S75Y+C5pWw77ybXG5cdFx0XHQvL+mihOWKoOi9veeahOWKqOeUu+WPguaVsOS8mOWFiOe6p++8mm9wZW5XaW5kb3fphY3nva4+cHJlbG9hZFBhZ2Vz6YWN572uPm11aem7mOiupOmFjee9ru+8m1xuXHRcdFx0blNob3cgPSB3ZWJ2aWV3Q2FjaGUgPyB3ZWJ2aWV3Q2FjaGUuc2hvdyA6IGRlZmF1bHRTaG93O1xuXHRcdFx0blNob3cgPSBvcHRpb25zLnNob3cgPyAkLmV4dGVuZChuU2hvdywgb3B0aW9ucy5zaG93KSA6IG5TaG93O1xuXHRcdFx0blNob3cuYXV0b1Nob3cgJiYgd2Vidmlldy5zaG93KG5TaG93LmFuaVNob3csIG5TaG93LmR1cmF0aW9uLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0dHJpZ2dlclByZWxvYWQod2Vidmlldyk7XG5cdFx0XHRcdHRyaWdnZXIod2VidmlldywgJ3BhZ2ViZWZvcmVzaG93JywgZmFsc2UpO1xuXHRcdFx0fSk7XG5cdFx0XHRpZih3ZWJ2aWV3Q2FjaGUpIHtcblx0XHRcdFx0d2Vidmlld0NhY2hlLmFmdGVyU2hvd01ldGhvZE5hbWUgJiYgd2Vidmlldy5ldmFsSlMod2Vidmlld0NhY2hlLmFmdGVyU2hvd01ldGhvZE5hbWUgKyAnKFxcJycgKyBKU09OLnN0cmluZ2lmeShwYXJhbXMpICsgJ1xcJyknKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiB3ZWJ2aWV3O1xuXHRcdH0gZWxzZSB7IC8v5paw56qX5Y+jXG5cdFx0XHRpZighdXJsKSB7XG5cdFx0XHRcdHRocm93IG5ldyBFcnJvcignd2Vidmlld1snICsgaWQgKyAnXSBkb2VzIG5vdCBleGlzdCcpO1xuXHRcdFx0fVxuXG5cdFx0XHQvL+aYvuekundhaXRpbmdcblx0XHRcdHZhciB3YWl0aW5nQ29uZmlnID0gJC53YWl0aW5nT3B0aW9ucyhvcHRpb25zLndhaXRpbmcpO1xuXHRcdFx0aWYod2FpdGluZ0NvbmZpZy5hdXRvU2hvdykge1xuXHRcdFx0XHRuV2FpdGluZyA9IHBsdXMubmF0aXZlVUkuc2hvd1dhaXRpbmcod2FpdGluZ0NvbmZpZy50aXRsZSwgd2FpdGluZ0NvbmZpZy5vcHRpb25zKTtcblx0XHRcdH1cblxuXHRcdFx0Ly/liJvlu7rpobXpnaJcblx0XHRcdG9wdGlvbnMgPSAkLmV4dGVuZChvcHRpb25zLCB7XG5cdFx0XHRcdGlkOiBpZCxcblx0XHRcdFx0dXJsOiB1cmxcblx0XHRcdH0pO1xuXG5cdFx0XHR3ZWJ2aWV3ID0gJC5jcmVhdGVXaW5kb3cob3B0aW9ucyk7XG5cblx0XHRcdGlmKHRpdGxlQ29uZmlnKSB7IC8v5aSE55CG5Y6f55Sf5aS0XG5cdFx0XHRcdCQuZXh0ZW5kKHRydWUsICQub3B0aW9ucy50aXRsZUNvbmZpZywgdGl0bGVDb25maWcpO1xuXHRcdFx0XHR2YXIgdGlkID0gJC5vcHRpb25zLnRpdGxlQ29uZmlnLmlkID8gJC5vcHRpb25zLnRpdGxlQ29uZmlnLmlkIDogaWQgKyBcIl90aXRsZVwiO1xuXHRcdFx0XHR2YXIgdmlldyA9IG5ldyBwbHVzLm5hdGl2ZU9iai5WaWV3KHRpZCwge1xuXHRcdFx0XHRcdHRvcDogMCxcblx0XHRcdFx0XHRoZWlnaHQ6ICQub3B0aW9ucy50aXRsZUNvbmZpZy5oZWlnaHQsXG5cdFx0XHRcdFx0d2lkdGg6IFwiMTAwJVwiLFxuXHRcdFx0XHRcdGRvY2s6IFwidG9wXCIsXG5cdFx0XHRcdFx0cG9zaXRpb246IFwiZG9ja1wiXG5cdFx0XHRcdH0pO1xuXHRcdFx0XHR2aWV3LmRyYXdSZWN0KCQub3B0aW9ucy50aXRsZUNvbmZpZy5iYWNrZ3JvdW5kQ29sb3IpOyAvL+e7mOWItuiDjOaZr+iJslxuXHRcdFx0XHR2YXIgX2IgPSBwYXJzZUludCgkLm9wdGlvbnMudGl0bGVDb25maWcuaGVpZ2h0KSAtIDE7XG5cdFx0XHRcdHZpZXcuZHJhd1JlY3QoJC5vcHRpb25zLnRpdGxlQ29uZmlnLmJvdHRvbUJvcmRlckNvbG9yLCB7XG5cdFx0XHRcdFx0dG9wOiBfYiArIFwicHhcIixcblx0XHRcdFx0XHRsZWZ0OiBcIjBweFwiXG5cdFx0XHRcdH0pOyAvL+e7mOWItuW6lemDqOi+uee6v1xuXG5cdFx0XHRcdC8v57uY5Yi25paH5a2XXG5cdFx0XHRcdGlmKCQub3B0aW9ucy50aXRsZUNvbmZpZy50aXRsZS50ZXh0KXtcblx0XHRcdFx0XHR2YXIgX3RpdGxlID0gJC5vcHRpb25zLnRpdGxlQ29uZmlnLnRpdGxlO1xuXHRcdFx0XHRcdHZpZXcuZHJhd1RleHQoX3RpdGxlLnRleHQsX3RpdGxlLnBvc2l0aW9uICwgX3RpdGxlLnN0eWxlcyk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvL+i/lOWbnuWbvuagh+e7mOWItlxuXHRcdFx0XHR2YXIgX2JhY2sgPSAkLm9wdGlvbnMudGl0bGVDb25maWcuYmFjaztcblx0XHRcdFx0dmFyIGJhY2tDbGljayA9IG51bGw7XG5cdFx0XHRcdC8v5LyY5YWI5a2X5L2TXG5cblx0XHRcdFx0Ly/lhbbmrKHmmK/lm77niYdcblx0XHRcdFx0dmFyIF9iYWNrSW1hZ2UgPSBfYmFjay5pbWFnZTtcblx0XHRcdFx0aWYoX2JhY2tJbWFnZS5iYXNlNjREYXRhIHx8IF9iYWNrSW1hZ2UuaW1nU3JjKSB7XG5cdFx0XHRcdFx0Ly9UT0RPIOatpOWkhOmcgOimgeWkhOeQhueZvuWIhuavlOeahOaDheWGtVxuXHRcdFx0XHRcdGJhY2tDbGljayA9IHtcblx0XHRcdFx0XHRcdGxlZnQ6cGFyc2VJbnQoX2JhY2tJbWFnZS5wb3NpdGlvbi5sZWZ0KSxcblx0XHRcdFx0XHRcdHJpZ2h0OnBhcnNlSW50KF9iYWNrSW1hZ2UucG9zaXRpb24ubGVmdCkgKyBwYXJzZUludChfYmFja0ltYWdlLnBvc2l0aW9uLndpZHRoKVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0dmFyIGJpdG1hcCA9IG5ldyBwbHVzLm5hdGl2ZU9iai5CaXRtYXAoaWQgKyBcIl9iYWNrXCIpO1xuXHRcdFx0XHRcdGlmKF9iYWNrSW1hZ2UuYmFzZTY0RGF0YSkgeyAvL+S8mOWFiGJhc2U2NOe8lueggeWtl+espuS4slxuXHRcdFx0XHRcdFx0Yml0bWFwLmxvYWRCYXNlNjREYXRhKF9iYWNrSW1hZ2UuYmFzZTY0RGF0YSk7XG5cdFx0XHRcdFx0fSBlbHNlIHsgLy/lhbbmrKHliqDovb3lm77niYfmlofku7Zcblx0XHRcdFx0XHRcdGJpdG1hcC5sb2FkKF9iYWNrSW1hZ2UuaW1nU3JjKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dmlldy5kcmF3Qml0bWFwKGJpdG1hcCxfYmFja0ltYWdlLnNwcml0ZSAsIF9iYWNrSW1hZ2UucG9zaXRpb24pO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly/lpITnkIbngrnlh7vkuovku7Zcblx0XHRcdFx0dmlldy5zZXRUb3VjaEV2ZW50UmVjdCh7XG5cdFx0XHRcdFx0dG9wOiBcIjBweFwiLFxuXHRcdFx0XHRcdGxlZnQ6IFwiMHB4XCIsXG5cdFx0XHRcdFx0d2lkdGg6IFwiMTAwJVwiLFxuXHRcdFx0XHRcdGhlaWdodDogXCIxMDAlXCJcblx0XHRcdFx0fSk7XG5cdFx0XHRcdHZpZXcuaW50ZXJjZXB0VG91Y2hFdmVudCh0cnVlKTtcblx0XHRcdFx0dmlldy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdHZhciB4ID0gZS5jbGllbnRYO1xuXG5cdFx0XHRcdFx0Ly/ov5Tlm57mjInpkq7ngrnlh7tcblx0XHRcdFx0XHRpZihiYWNrQ2xpY2smJiB4ID4gYmFja0NsaWNrLmxlZnQgJiYgeCA8IGJhY2tDbGljay5yaWdodCl7XG5cdFx0XHRcdFx0XHRpZiggX2JhY2suY2xpY2sgJiYgJC5pc0Z1bmN0aW9uKF9iYWNrLmNsaWNrKSl7XG5cdFx0XHRcdFx0XHRcdF9iYWNrLmNsaWNrKCk7XG5cdFx0XHRcdFx0XHR9ZWxzZXtcblx0XHRcdFx0XHRcdFx0d2Vidmlldy5ldmFsSlMoXCJ3aW5kb3cubXVpJiZtdWkuYmFjaygpO1wiKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0sIGZhbHNlKTtcblx0XHRcdFx0d2Vidmlldy5hcHBlbmQodmlldyk7XG5cblx0XHRcdH1cblxuXHRcdFx0Ly/mmL7npLpcblx0XHRcdG5TaG93ID0gJC5zaG93T3B0aW9ucyhvcHRpb25zLnNob3cpO1xuXHRcdFx0aWYoblNob3cuYXV0b1Nob3cpIHtcblx0XHRcdFx0Ly90aXRsZVVwZGF0ZeinpuWPkeaXtuacuuaXqeS6jmxvYWRlZO+8jOabtOaNouS4unRpdGxlVXBkYXRl5ZCO77yM5Y+v5Lul5pu05pep55qE5pi+56S6d2Vidmlld1xuXHRcdFx0XHR3ZWJ2aWV3LmFkZEV2ZW50TGlzdGVuZXIoblNob3cuZXZlbnQsIGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHQvL+WFs+mXreetieW+heahhlxuXHRcdFx0XHRcdGlmKG5XYWl0aW5nKSB7XG5cdFx0XHRcdFx0XHRuV2FpdGluZy5jbG9zZSgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHQvL+aYvuekuumhtemdolxuXHRcdFx0XHRcdHdlYnZpZXcuc2hvdyhuU2hvdy5hbmlTaG93LCBuU2hvdy5kdXJhdGlvbiwgZnVuY3Rpb24oKSB7fSxuU2hvdy5leHRyYXMpO1xuXHRcdFx0XHR9LCBmYWxzZSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB3ZWJ2aWV3O1xuXHR9O1xuXG5cdC8qKlxuXHQgKiDmoLnmja7phY3nva7kv6Hmga/liJvlu7rkuIDkuKp3ZWJ2aWV3XG5cdCAqIEBwYXJhbSB7dHlwZX0gb3B0aW9uc1xuXHQgKiBAcGFyYW0ge3R5cGV9IGlzQ3JlYXRlXG5cdCAqIEByZXR1cm5zIHt3ZWJ2aWV3fVxuXHQgKi9cblx0JC5jcmVhdGVXaW5kb3cgPSBmdW5jdGlvbihvcHRpb25zLCBpc0NyZWF0ZSkge1xuXHRcdGlmKCF3aW5kb3cucGx1cykge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHR2YXIgaWQgPSBvcHRpb25zLmlkIHx8IG9wdGlvbnMudXJsO1xuXHRcdHZhciB3ZWJ2aWV3O1xuXHRcdGlmKG9wdGlvbnMucHJlbG9hZCkge1xuXHRcdFx0aWYoJC53ZWJ2aWV3c1tpZF0gJiYgJC53ZWJ2aWV3c1tpZF0ud2Vidmlldy5nZXRVUkwoKSkgeyAvL+W3sue7j2NhY2hlXG5cdFx0XHRcdHdlYnZpZXcgPSAkLndlYnZpZXdzW2lkXS53ZWJ2aWV3O1xuXHRcdFx0fSBlbHNlIHsgLy/mlrDlop7pooTliqDovb3nqpflj6Ncblx0XHRcdFx0Ly/liKTmlq3mmK/lkKbmkLrluKZjcmVhdGVOZXflj4LmlbDvvIzpu5jorqTkuLpmYWxzZVxuXHRcdFx0XHRpZihvcHRpb25zLmNyZWF0ZU5ldyAhPT0gdHJ1ZSkge1xuXHRcdFx0XHRcdHdlYnZpZXcgPSBwbHVzLndlYnZpZXcuZ2V0V2Vidmlld0J5SWQoaWQpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly/kuYvliY3msqHmnInvvIzpgqPlsLHmlrDliJvlu7pcblx0XHRcdFx0aWYoIXdlYnZpZXcpIHtcblx0XHRcdFx0XHR3ZWJ2aWV3ID0gcGx1cy53ZWJ2aWV3LmNyZWF0ZShvcHRpb25zLnVybCwgaWQsICQud2luZG93T3B0aW9ucyhvcHRpb25zLnN0eWxlcyksICQuZXh0ZW5kKHtcblx0XHRcdFx0XHRcdHByZWxvYWQ6IHRydWVcblx0XHRcdFx0XHR9LCBvcHRpb25zLmV4dHJhcykpO1xuXHRcdFx0XHRcdGlmKG9wdGlvbnMuc3VicGFnZXMpIHtcblx0XHRcdFx0XHRcdCQuZWFjaChvcHRpb25zLnN1YnBhZ2VzLCBmdW5jdGlvbihpbmRleCwgc3VicGFnZSkge1xuXHRcdFx0XHRcdFx0XHR2YXIgc3VicGFnZUlkID0gc3VicGFnZS5pZCB8fCBzdWJwYWdlLnVybDtcblx0XHRcdFx0XHRcdFx0aWYoc3VicGFnZUlkKSB7IC8v6L+H5ruk56m65a+56LGhXG5cdFx0XHRcdFx0XHRcdFx0dmFyIHN1YldlYnZpZXcgPSBwbHVzLndlYnZpZXcuZ2V0V2Vidmlld0J5SWQoc3VicGFnZUlkKTtcblx0XHRcdFx0XHRcdFx0XHRpZighc3ViV2VidmlldykgeyAvL+WmguaenOivpXdlYnZpZXfkuI3lrZjlnKjvvIzliJnliJvlu7pcblx0XHRcdFx0XHRcdFx0XHRcdHN1YldlYnZpZXcgPSBwbHVzLndlYnZpZXcuY3JlYXRlKHN1YnBhZ2UudXJsLCBzdWJwYWdlSWQsICQud2luZG93T3B0aW9ucyhzdWJwYWdlLnN0eWxlcyksICQuZXh0ZW5kKHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0cHJlbG9hZDogdHJ1ZVxuXHRcdFx0XHRcdFx0XHRcdFx0fSwgc3VicGFnZS5leHRyYXMpKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0d2Vidmlldy5hcHBlbmQoc3ViV2Vidmlldyk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvL1RPRE8g55CG6K665LiK77yM5a2Qd2Vidmlld+S5n+W6lOivpeiuoeeul+WIsOmihOWKoOi9vemYn+WIl+S4re+8jOS9hui/meagt+Wwsem6u+eDpuS6hu+8jOimgemAgOW/hemhu+mAgOaVtOS9k++8jOWQpuWImeWPr+iDveWHuueOsOmXrumimO+8m1xuXHRcdFx0JC53ZWJ2aWV3c1tpZF0gPSB7XG5cdFx0XHRcdHdlYnZpZXc6IHdlYnZpZXcsIC8v55uu5YmN5LuFcHJlbG9hZOeahOe8k+WtmHdlYnZpZXdcblx0XHRcdFx0cHJlbG9hZDogdHJ1ZSxcblx0XHRcdFx0c2hvdzogJC5zaG93T3B0aW9ucyhvcHRpb25zLnNob3cpLFxuXHRcdFx0XHRhZnRlclNob3dNZXRob2ROYW1lOiBvcHRpb25zLmFmdGVyU2hvd01ldGhvZE5hbWUgLy/lsLHkuI3lupTor6XnlKhldmFsSlPjgILlupTor6XmmK/pgJrov4fkuovku7bmtojmga/pgJrorq9cblx0XHRcdH07XG5cdFx0XHQvL+e0ouW8leivpemihOWKoOi9veeql+WPo1xuXHRcdFx0dmFyIHByZWxvYWRzID0gJC5kYXRhLnByZWxvYWRzO1xuXHRcdFx0dmFyIGluZGV4ID0gcHJlbG9hZHMuaW5kZXhPZihpZCk7XG5cdFx0XHRpZih+aW5kZXgpIHsgLy/liKDpmaTlt7LlrZjlnKjnmoQo5Y+Y55u46LCD5pW05o+S5YWl5L2N572uKVxuXHRcdFx0XHRwcmVsb2Fkcy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0fVxuXHRcdFx0cHJlbG9hZHMucHVzaChpZCk7XG5cdFx0XHRpZihwcmVsb2Fkcy5sZW5ndGggPiAkLm9wdGlvbnMucHJlbG9hZExpbWl0KSB7XG5cdFx0XHRcdC8v5YWI6L+b5YWI5Ye6XG5cdFx0XHRcdHZhciBmaXJzdCA9ICQuZGF0YS5wcmVsb2Fkcy5zaGlmdCgpO1xuXHRcdFx0XHR2YXIgd2Vidmlld0NhY2hlID0gJC53ZWJ2aWV3c1tmaXJzdF07XG5cdFx0XHRcdGlmKHdlYnZpZXdDYWNoZSAmJiB3ZWJ2aWV3Q2FjaGUud2Vidmlldykge1xuXHRcdFx0XHRcdC8v6ZyA6KaB5bCG6Ieq5bex5omT5byA55qE5omA5pyJ6aG16Z2i77yM5YWo6YOoY2xvc2XvvJtcblx0XHRcdFx0XHQvL+WFs+mXreivpemihOWKoOi9vXdlYnZpZXdcblx0XHRcdFx0XHQkLmNsb3NlQWxsKHdlYnZpZXdDYWNoZS53ZWJ2aWV3KTtcblx0XHRcdFx0fVxuXHRcdFx0XHQvL+WIoOmZpOe8k+WtmFxuXHRcdFx0XHRkZWxldGUgJC53ZWJ2aWV3c1tmaXJzdF07XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdGlmKGlzQ3JlYXRlICE9PSBmYWxzZSkgeyAvL+ebtOaOpeWIm+W7uumdnumihOWKoOi9veeql+WPo1xuXHRcdFx0XHR3ZWJ2aWV3ID0gcGx1cy53ZWJ2aWV3LmNyZWF0ZShvcHRpb25zLnVybCwgaWQsICQud2luZG93T3B0aW9ucyhvcHRpb25zLnN0eWxlcyksIG9wdGlvbnMuZXh0cmFzKTtcblx0XHRcdFx0aWYob3B0aW9ucy5zdWJwYWdlcykge1xuXHRcdFx0XHRcdCQuZWFjaChvcHRpb25zLnN1YnBhZ2VzLCBmdW5jdGlvbihpbmRleCwgc3VicGFnZSkge1xuXHRcdFx0XHRcdFx0dmFyIHN1YnBhZ2VJZCA9IHN1YnBhZ2UuaWQgfHwgc3VicGFnZS51cmw7XG5cdFx0XHRcdFx0XHR2YXIgc3ViV2VidmlldyA9IHBsdXMud2Vidmlldy5nZXRXZWJ2aWV3QnlJZChzdWJwYWdlSWQpO1xuXHRcdFx0XHRcdFx0aWYoIXN1YldlYnZpZXcpIHtcblx0XHRcdFx0XHRcdFx0c3ViV2VidmlldyA9IHBsdXMud2Vidmlldy5jcmVhdGUoc3VicGFnZS51cmwsIHN1YnBhZ2VJZCwgJC53aW5kb3dPcHRpb25zKHN1YnBhZ2Uuc3R5bGVzKSwgc3VicGFnZS5leHRyYXMpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0d2Vidmlldy5hcHBlbmQoc3ViV2Vidmlldyk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHdlYnZpZXc7XG5cdH07XG5cblx0LyoqXG5cdCAqIOmihOWKoOi9vVxuXHQgKi9cblx0JC5wcmVsb2FkID0gZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdC8v6LCD55So6aKE5Yqg6L295Ye95pWw77yM5LiN566h5piv5ZCm5Lyg6YCScHJlbG9hZOWPguaVsO+8jOW8uuWItuWPmOS4unRydWVcblx0XHRpZighb3B0aW9ucy5wcmVsb2FkKSB7XG5cdFx0XHRvcHRpb25zLnByZWxvYWQgPSB0cnVlO1xuXHRcdH1cblx0XHRyZXR1cm4gJC5jcmVhdGVXaW5kb3cob3B0aW9ucyk7XG5cdH07XG5cblx0LyoqXG5cdCAq5YWz6Zet5b2T5YmNd2Vidmlld+aJk+W8gOeahOaJgOaciXdlYnZpZXfvvJtcblx0ICovXG5cdCQuY2xvc2VPcGVuZWQgPSBmdW5jdGlvbih3ZWJ2aWV3KSB7XG5cdFx0dmFyIG9wZW5lZCA9IHdlYnZpZXcub3BlbmVkKCk7XG5cdFx0aWYob3BlbmVkKSB7XG5cdFx0XHRmb3IodmFyIGkgPSAwLCBsZW4gPSBvcGVuZWQubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0XHRcdFx0dmFyIG9wZW5lZFdlYnZpZXcgPSBvcGVuZWRbaV07XG5cdFx0XHRcdHZhciBvcGVuX29wZW4gPSBvcGVuZWRXZWJ2aWV3Lm9wZW5lZCgpO1xuXHRcdFx0XHRpZihvcGVuX29wZW4gJiYgb3Blbl9vcGVuLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHQvL+WFs+mXreaJk+W8gOeahHdlYnZpZXdcblx0XHRcdFx0XHQkLmNsb3NlT3BlbmVkKG9wZW5lZFdlYnZpZXcpO1xuXHRcdFx0XHRcdC8v5YWz6Zet6Ieq5bexXG5cdFx0XHRcdFx0b3BlbmVkV2Vidmlldy5jbG9zZShcIm5vbmVcIik7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly/lpoLmnpznm7TmjqXlranlrZDoioLngrnvvIzlsLHkuI3nlKjlhbPpl63kuobvvIzlm6DkuLrniLblhbPpl63nmoTml7blgJnvvIzkvJroh6rliqjlhbPpl63lrZDvvJtcblx0XHRcdFx0XHRpZihvcGVuZWRXZWJ2aWV3LnBhcmVudCgpICE9PSB3ZWJ2aWV3KSB7XG5cdFx0XHRcdFx0XHRvcGVuZWRXZWJ2aWV3LmNsb3NlKCdub25lJyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9O1xuXHQkLmNsb3NlQWxsID0gZnVuY3Rpb24od2VidmlldywgYW5pU2hvdykge1xuXHRcdCQuY2xvc2VPcGVuZWQod2Vidmlldyk7XG5cdFx0aWYoYW5pU2hvdykge1xuXHRcdFx0d2Vidmlldy5jbG9zZShhbmlTaG93KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0d2Vidmlldy5jbG9zZSgpO1xuXHRcdH1cblx0fTtcblxuXHQvKipcblx0ICog5om56YeP5Yib5bu6d2Vidmlld1xuXHQgKiBAcGFyYW0ge3R5cGV9IG9wdGlvbnNcblx0ICogQHJldHVybnMge3VuZGVmaW5lZH1cblx0ICovXG5cdCQuY3JlYXRlV2luZG93cyA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHQkLmVhY2gob3B0aW9ucywgZnVuY3Rpb24oaW5kZXgsIG9wdGlvbikge1xuXHRcdFx0Ly/liJ3lp4vljJbpooTliqDovb3nqpflj6Mo5Yib5bu6KeWSjOmdnumihOWKoOi9veeql+WPoyjku4XphY3nva7vvIzkuI3liJvlu7opXG5cdFx0XHQkLmNyZWF0ZVdpbmRvdyhvcHRpb24sIGZhbHNlKTtcblx0XHR9KTtcblx0fTtcblx0LyoqXG5cdCAqIOWIm+W7uuW9k+WJjemhtemdoueahOWtkHdlYnZpZXdcblx0ICogQHBhcmFtIHt0eXBlfSBvcHRpb25zXG5cdCAqIEByZXR1cm5zIHt3ZWJ2aWV3fVxuXHQgKi9cblx0JC5hcHBlbmRXZWJ2aWV3ID0gZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdGlmKCF3aW5kb3cucGx1cykge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHR2YXIgaWQgPSBvcHRpb25zLmlkIHx8IG9wdGlvbnMudXJsO1xuXHRcdHZhciB3ZWJ2aWV3O1xuXHRcdGlmKCEkLndlYnZpZXdzW2lkXSkgeyAvL+S/neivgeaJp+ihjOS4gOmBjVxuXHRcdFx0Ly9UT0RPIOi/memHjOS5n+aciemakOaCo++8jOavlOWmguafkOS4qndlYnZpZXfkuI3mmK/kvZzkuLpzdWJwYWdl5Yib5bu655qE77yM6ICM5piv5L2c5Li6dGFyZ2V0IHdlYnZpZXfnmoTor53vvJtcblx0XHRcdGlmKCFwbHVzLndlYnZpZXcuZ2V0V2Vidmlld0J5SWQoaWQpKSB7XG5cdFx0XHRcdHdlYnZpZXcgPSBwbHVzLndlYnZpZXcuY3JlYXRlKG9wdGlvbnMudXJsLCBpZCwgb3B0aW9ucy5zdHlsZXMsIG9wdGlvbnMuZXh0cmFzKTtcblx0XHRcdH1cblx0XHRcdC8v5LmL5YmN55qE5a6e546w5pa55qGI77ya5a2Q56qX5Y+jbG9hZGVk5LmL5ZCO5YaNYXBwZW5k5Yiw54i256qX5Y+j5Lit77ybXG5cdFx0XHQvL+mXrumimO+8mumDqOWIhuWtkOeql+WPo2xvYWRlZOS6i+S7tuWPkeeUn+i+g+aZmu+8jOatpOaXtuaJp+ihjOeItueql+WPo+eahGNoaWxkcmVu5pa55rOV5Lya6L+U5Zue56m677yM5a+86Ie054i25a2Q6YCa6K6v5aSx6LSl77ybXG5cdFx0XHQvLyAgICAg5q+U5aaC54i26aG16Z2i5omn6KGM5a6McHJlbG9hZOS6i+S7tuWQju+8jOmcgOinpuWPkeWtkOmhtemdoueahHByZWxvYWTkuovku7bvvIzmraTml7bmnKphcHBlbmTnmoTor53vvIzlsLHml6Dms5Xop6blj5HvvJtcblx0XHRcdC8v5L+u5pS55pa55byP77ya5LiN5YaN55uR5o6nbG9hZGVk5LqL5Lu277yM55u05o6lYXBwZW5kXG5cdFx0XHQvL2J5IGNoYkAyMDE1MDUyMVxuXHRcdFx0Ly8gd2Vidmlldy5hZGRFdmVudExpc3RlbmVyKCdsb2FkZWQnLCBmdW5jdGlvbigpIHtcblx0XHRcdHBsdXMud2Vidmlldy5jdXJyZW50V2VidmlldygpLmFwcGVuZCh3ZWJ2aWV3KTtcblx0XHRcdC8vIH0pO1xuXHRcdFx0JC53ZWJ2aWV3c1tpZF0gPSBvcHRpb25zO1xuXG5cdFx0fVxuXHRcdHJldHVybiB3ZWJ2aWV3O1xuXHR9O1xuXG5cdC8v5YWo5bGAd2Vidmlld3Ncblx0JC53ZWJ2aWV3cyA9IHt9O1xuXHQvL+mihOWKoOi9veeql+WPo+e0ouW8lVxuXHQkLmRhdGEucHJlbG9hZHMgPSBbXTtcblx0Ly8kLmN1cnJlbnRXZWJ2aWV3XG5cdCQucGx1c1JlYWR5KGZ1bmN0aW9uKCkge1xuXHRcdCQuY3VycmVudFdlYnZpZXcgPSBwbHVzLndlYnZpZXcuY3VycmVudFdlYnZpZXcoKTtcblx0fSk7XG5cdCQuYWRkSW5pdCh7XG5cdFx0bmFtZTogJzUrJyxcblx0XHRpbmRleDogMTAwLFxuXHRcdGhhbmRsZTogZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgb3B0aW9ucyA9ICQub3B0aW9ucztcblx0XHRcdHZhciBzdWJwYWdlcyA9IG9wdGlvbnMuc3VicGFnZXMgfHwgW107XG5cdFx0XHRpZigkLm9zLnBsdXMpIHtcblx0XHRcdFx0JC5wbHVzUmVhZHkoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0Ly9UT0RPICDov5nph4zpnIDopoHliKTmlq3kuIDkuIvvvIzmnIDlpb3nrYnlrZDnqpflj6PliqDovb3lrozmr5XlkI7vvIzlho3osIPnlKjkuLvnqpflj6PnmoRzaG935pa55rOV77ybXG5cdFx0XHRcdFx0Ly/miJbogIXvvJrlnKhvcGVud2luZG935pa55rOV5Lit77yM55uR5ZCs5a6e546w77ybXG5cdFx0XHRcdFx0JC5lYWNoKHN1YnBhZ2VzLCBmdW5jdGlvbihpbmRleCwgc3VicGFnZSkge1xuXHRcdFx0XHRcdFx0JC5hcHBlbmRXZWJ2aWV3KHN1YnBhZ2UpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdC8v5Yik5pat5piv5ZCm6aaW6aG1XG5cdFx0XHRcdFx0aWYocGx1cy53ZWJ2aWV3LmN1cnJlbnRXZWJ2aWV3KCkgPT09IHBsdXMud2Vidmlldy5nZXRXZWJ2aWV3QnlJZChwbHVzLnJ1bnRpbWUuYXBwaWQpKSB7XG5cdFx0XHRcdFx0XHQvL+mmlumhtemcgOimgeiHquW3sea/gOa0u+mihOWKoOi9ve+8m1xuXHRcdFx0XHRcdFx0Ly90aW1lb3V05Zug5Li65a2Q6aG16Z2ibG9hZGVk5LmL5ZCO5omNYXBwZW5k55qE77yM6Ziy5q2i5a2Q6aG16Z2i5bCa5pyqYXBwZW5k44CB5LuO6ICM5a+86Ie05YW2cHJlbG9hZOacquinpuWPkeeahOmXrumimO+8m1xuXHRcdFx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0dHJpZ2dlclByZWxvYWQocGx1cy53ZWJ2aWV3LmN1cnJlbnRXZWJ2aWV3KCkpO1xuXHRcdFx0XHRcdFx0fSwgMzAwKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Ly/orr7nva5pb3Ppobbpg6jnirbmgIHmoI/popzoibLvvJtcblx0XHRcdFx0XHRpZigkLm9zLmlvcyAmJiAkLm9wdGlvbnMuc3RhdHVzQmFyQmFja2dyb3VuZCkge1xuXHRcdFx0XHRcdFx0cGx1cy5uYXZpZ2F0b3Iuc2V0U3RhdHVzQmFyQmFja2dyb3VuZCgkLm9wdGlvbnMuc3RhdHVzQmFyQmFja2dyb3VuZCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmKCQub3MuYW5kcm9pZCAmJiBwYXJzZUZsb2F0KCQub3MudmVyc2lvbikgPCA0LjQpIHtcblx0XHRcdFx0XHRcdC8v6Kej5YazQW5kcm9pZOW5s+WPsDQuNOeJiOacrOS7peS4i++8jHJlc3VtZeWQju+8jOeItueql+S9k+agh+mimOW7tui/n+a4suafk+eahOmXrumimO+8m1xuXHRcdFx0XHRcdFx0aWYocGx1cy53ZWJ2aWV3LmN1cnJlbnRXZWJ2aWV3KCkucGFyZW50KCkgPT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwicmVzdW1lXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdHZhciBib2R5ID0gZG9jdW1lbnQuYm9keTtcblx0XHRcdFx0XHRcdFx0XHRib2R5LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRcdFx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGJvZHkuc3R5bGUuZGlzcGxheSA9ICcnO1xuXHRcdFx0XHRcdFx0XHRcdH0sIDEwKTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8v5bey5pSv5oyBaWZyYW1l5bWM5YWlXG5cdFx0XHRcdC8vXHRcdFx0XHRpZiAoc3VicGFnZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHQvL1x0XHRcdFx0XHR2YXIgZXJyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0XHRcdC8vXHRcdFx0XHRcdGVyci5jbGFzc05hbWUgPSAnbXVpLWVycm9yJztcblx0XHRcdFx0Ly9cdFx0XHRcdFx0Ly/mloflrZfmj4/ov7Bcblx0XHRcdFx0Ly9cdFx0XHRcdFx0dmFyIHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG5cdFx0XHRcdC8vXHRcdFx0XHRcdHNwYW4uaW5uZXJIVE1MID0gJ+WcqOivpea1j+iniOWZqOS4i++8jOS4jeaUr+aMgeWIm+W7uuWtkOmhtemdou+8jOWFt+S9k+WPguiAgyc7XG5cdFx0XHRcdC8vXHRcdFx0XHRcdGVyci5hcHBlbmRDaGlsZChzcGFuKTtcblx0XHRcdFx0Ly9cdFx0XHRcdFx0dmFyIGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG5cdFx0XHRcdC8vXHRcdFx0XHRcdGEuaW5uZXJIVE1MID0gJ1wibXVp5qGG5p626YCC55So5Zy65pmvXCInO1xuXHRcdFx0XHQvL1x0XHRcdFx0XHRhLmhyZWYgPSAnaHR0cDovL2Fzay5kY2xvdWQubmV0LmNuL2FydGljbGUvMTEzJztcblx0XHRcdFx0Ly9cdFx0XHRcdFx0ZXJyLmFwcGVuZENoaWxkKGEpO1xuXHRcdFx0XHQvL1x0XHRcdFx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVycik7XG5cdFx0XHRcdC8vXHRcdFx0XHRcdGNvbnNvbGUubG9nKCflnKjor6XmtY/op4jlmajkuIvvvIzkuI3mlK/mjIHliJvlu7rlrZDpobXpnaInKTtcblx0XHRcdFx0Ly9cdFx0XHRcdH1cblxuXHRcdFx0fVxuXG5cdFx0fVxuXHR9KTtcblx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3ByZWxvYWQnLCBmdW5jdGlvbigpIHtcblx0XHQvL+WkhOeQhumihOWKoOi9vemDqOWIhlxuXHRcdHZhciB3ZWJ2aWV3cyA9ICQub3B0aW9ucy5wcmVsb2FkUGFnZXMgfHwgW107XG5cdFx0JC5wbHVzUmVhZHkoZnVuY3Rpb24oKSB7XG5cdFx0XHQkLmVhY2god2Vidmlld3MsIGZ1bmN0aW9uKGluZGV4LCB3ZWJ2aWV3KSB7XG5cdFx0XHRcdCQuY3JlYXRlV2luZG93KCQuZXh0ZW5kKHdlYnZpZXcsIHtcblx0XHRcdFx0XHRwcmVsb2FkOiB0cnVlXG5cdFx0XHRcdH0pKTtcblx0XHRcdH0pO1xuXG5cdFx0fSk7XG5cdH0pO1xuXHQkLnN1cHBvcnRTdGF0dXNiYXJPZmZzZXQgPSBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gJC5vcy5wbHVzICYmICQub3MuaW9zICYmIHBhcnNlRmxvYXQoJC5vcy52ZXJzaW9uKSA+PSA3O1xuXHR9O1xuXHQkLnJlYWR5KGZ1bmN0aW9uKCkge1xuXHRcdC8v5qCH6K+G5b2T5YmN546v5aKD5pSv5oyBc3RhdHVzYmFyXG5cdFx0aWYoJC5zdXBwb3J0U3RhdHVzYmFyT2Zmc2V0KCkpIHtcblx0XHRcdGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgnbXVpLXN0YXR1c2JhcicpO1xuXHRcdH1cblx0fSk7XG59KShtdWkpO1xuXG4vKipcbiAqIG11aSBiYWNrXG4gKiBAcGFyYW0ge3R5cGV9ICRcbiAqIEBwYXJhbSB7dHlwZX0gd2luZG93XG4gKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxuICovXG4oZnVuY3Rpb24oJCwgd2luZG93KSB7XG5cdC8qKlxuXHQgKiByZWdpc3RlciBiYWNrXG5cdCAqIEBwYXJhbSB7dHlwZX0gYmFja1xuXHQgKiBAcmV0dXJucyB7JC5nZXN0dXJlc31cblx0ICovXG5cdCQuYWRkQmFjayA9IGZ1bmN0aW9uKGJhY2spIHtcblx0XHRyZXR1cm4gJC5hZGRBY3Rpb24oJ2JhY2tzJywgYmFjayk7XG5cdH07XG5cdC8qKlxuXHQgKiBkZWZhdWx0XG5cdCAqL1xuXHQkLmFkZEJhY2soe1xuXHRcdG5hbWU6ICdicm93c2VyJyxcblx0XHRpbmRleDogMTAwLFxuXHRcdGhhbmRsZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAod2luZG93Lmhpc3RvcnkubGVuZ3RoID4gMSkge1xuXHRcdFx0XHR3aW5kb3cuaGlzdG9yeS5iYWNrKCk7XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0fSk7XG5cdC8qKlxuXHQgKiDlkI7pgIBcblx0ICovXG5cdCQuYmFjayA9IGZ1bmN0aW9uKCkge1xuXHRcdGlmICh0eXBlb2YgJC5vcHRpb25zLmJlZm9yZWJhY2sgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdGlmICgkLm9wdGlvbnMuYmVmb3JlYmFjaygpID09PSBmYWxzZSkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0fVxuXHRcdCQuZG9BY3Rpb24oJ2JhY2tzJyk7XG5cdH07XG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd0YXAnLCBmdW5jdGlvbihlKSB7XG5cdFx0dmFyIGFjdGlvbiA9ICQudGFyZ2V0cy5hY3Rpb247XG5cdFx0aWYgKGFjdGlvbiAmJiBhY3Rpb24uY2xhc3NMaXN0LmNvbnRhaW5zKCdtdWktYWN0aW9uLWJhY2snKSkge1xuXHRcdFx0JC5iYWNrKCk7XG5cdFx0XHQkLnRhcmdldHMuYWN0aW9uID0gZmFsc2U7XG5cdFx0fVxuXHR9KTtcblx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3N3aXBlcmlnaHQnLCBmdW5jdGlvbihlKSB7XG5cdFx0dmFyIGRldGFpbCA9IGUuZGV0YWlsO1xuXHRcdGlmICgkLm9wdGlvbnMuc3dpcGVCYWNrID09PSB0cnVlICYmIE1hdGguYWJzKGRldGFpbC5hbmdsZSkgPCAzKSB7XG5cdFx0XHQkLmJhY2soKTtcblx0XHR9XG5cdH0pO1xuXG59KShtdWksIHdpbmRvdyk7XG4vKipcbiAqIG11aSBiYWNrIDUrXG4gKiBAcGFyYW0ge3R5cGV9ICRcbiAqIEBwYXJhbSB7dHlwZX0gd2luZG93XG4gKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxuICovXG4oZnVuY3Rpb24oJCwgd2luZG93KSB7XG5cdGlmICgkLm9zLnBsdXMgJiYgJC5vcy5hbmRyb2lkKSB7XG5cdFx0JC5hZGRCYWNrKHtcblx0XHRcdG5hbWU6ICdtdWknLFxuXHRcdFx0aW5kZXg6IDUsXG5cdFx0XHRoYW5kbGU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQvL+WQjue7remHjeaWsOiuvuiuoeatpOWkhO+8jOWwhmJhY2vmlL7liLDlkITkuKrnqbrpl7TlhoXpg6jlrp7njrBcblx0XHRcdFx0Ly9wb3BvdmVyXG5cdFx0XHRcdGlmICgkLnRhcmdldHMuX3BvcG92ZXIgJiYgJC50YXJnZXRzLl9wb3BvdmVyLmNsYXNzTGlzdC5jb250YWlucygnbXVpLWFjdGl2ZScpKSB7XG5cdFx0XHRcdFx0JCgkLnRhcmdldHMuX3BvcG92ZXIpLnBvcG92ZXIoJ2hpZGUnKTtcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0XHQvL29mZmNhbnZhc1xuXHRcdFx0XHR2YXIgb2ZmQ2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm11aS1vZmYtY2FudmFzLXdyYXAubXVpLWFjdGl2ZScpO1xuXHRcdFx0XHRpZiAob2ZmQ2FudmFzKSB7XG5cdFx0XHRcdFx0JChvZmZDYW52YXMpLm9mZkNhbnZhcygnY2xvc2UnKTtcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0XHR2YXIgcHJldmlld0ltYWdlID0gJC5pc0Z1bmN0aW9uKCQuZ2V0UHJldmlld0ltYWdlKSAmJiAkLmdldFByZXZpZXdJbWFnZSgpO1xuXHRcdFx0XHRpZiAocHJldmlld0ltYWdlICYmIHByZXZpZXdJbWFnZS5pc1Nob3duKCkpIHtcblx0XHRcdFx0XHRwcmV2aWV3SW1hZ2UuY2xvc2UoKTtcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0XHQvL3BvcHVwXG5cdFx0XHRcdHJldHVybiAkLmNsb3NlUG9wdXAoKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHQvL+mmluasoeaMieS4i2JhY2vmjInplK7nmoTml7bpl7Rcblx0JC5fX2JhY2tfX2ZpcnN0ID0gbnVsbDtcblx0LyoqXG5cdCAqIDUrIGJhY2tcblx0ICovXG5cdCQuYWRkQmFjayh7XG5cdFx0bmFtZTogJzUrJyxcblx0XHRpbmRleDogMTAsXG5cdFx0aGFuZGxlOiBmdW5jdGlvbigpIHtcblx0XHRcdGlmICghd2luZG93LnBsdXMpIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdFx0dmFyIHdvYmogPSBwbHVzLndlYnZpZXcuY3VycmVudFdlYnZpZXcoKTtcblx0XHRcdHZhciBwYXJlbnQgPSB3b2JqLnBhcmVudCgpO1xuXHRcdFx0aWYgKHBhcmVudCkge1xuXHRcdFx0XHRwYXJlbnQuZXZhbEpTKCdtdWkmJm11aS5iYWNrKCk7Jyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR3b2JqLmNhbkJhY2soZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdC8vYnkgY2hiIOaaguaXtuazqOmHiu+8jOWcqOeisOWIsOexu+S8vHBvcG92ZXLkuYvnsbvnmoTplJrngrnnmoTml7blgJnvvIzpnIDlpJrmrKHngrnlh7vmiY3og73ov5Tlm57vvJtcblx0XHRcdFx0XHRpZiAoZS5jYW5CYWNrKSB7IC8vd2VidmlldyBoaXN0b3J5IGJhY2tcblx0XHRcdFx0XHRcdHdpbmRvdy5oaXN0b3J5LmJhY2soKTtcblx0XHRcdFx0XHR9IGVsc2UgeyAvL3dlYnZpZXcgY2xvc2Ugb3IgaGlkZVxuXHRcdFx0XHRcdFx0Ly9maXhlZCBieSBmeHkg5q2k5aSE5LiN5bqU6K+l55Sob3BlbmVy5Yik5pat77yM5Zug5Li655So5oi35pyJ5Y+v6IO96Ieq5bexY2xvc2XmjonlvZPliY3nqpflj6PnmoRvcGVuZXLjgILov5nmoLfnmoTor53jgIJvcGVuZXLlsLHkuLrnqbrkuobvvIzlr7zoh7TkuI3og73miafooYxjbG9zZVxuXHRcdFx0XHRcdFx0aWYgKHdvYmouaWQgPT09IHBsdXMucnVudGltZS5hcHBpZCkgeyAvL+mmlumhtVxuXHRcdFx0XHRcdFx0XHQvL+mmlumhteS4jeWtmOWcqG9wZW5lcueahOaDheWGteS4i++8jOWQjumAgOWunumZheS4iuW6lOivpeaYr+mAgOWHuuW6lOeUqO+8m1xuXHRcdFx0XHRcdFx0XHQvL+mmluasoeaMiemUru+8jOaPkOekuuKAmOWGjeaMieS4gOasoemAgOWHuuW6lOeUqOKAmVxuXHRcdFx0XHRcdFx0XHRpZiAoISQuX19iYWNrX19maXJzdCkge1xuXHRcdFx0XHRcdFx0XHRcdCQuX19iYWNrX19maXJzdCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuXHRcdFx0XHRcdFx0XHRcdG11aS50b2FzdCgn5YaN5oyJ5LiA5qyh6YCA5Ye65bqU55SoJyk7XG5cdFx0XHRcdFx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHRcdCQuX19iYWNrX19maXJzdCA9IG51bGw7XG5cdFx0XHRcdFx0XHRcdFx0fSwgMjAwMCk7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC0gJC5fX2JhY2tfX2ZpcnN0IDwgMjAwMCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0cGx1cy5ydW50aW1lLnF1aXQoKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gZWxzZSB7IC8v5YW25LuW6aG16Z2i77yMXG5cdFx0XHRcdFx0XHRcdGlmICh3b2JqLnByZWxvYWQpIHtcblx0XHRcdFx0XHRcdFx0XHR3b2JqLmhpZGUoXCJhdXRvXCIpO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdC8v5YWz6Zet6aG16Z2i5pe277yM6ZyA6KaB5bCG5YW25omT5byA55qE5omA5pyJ5a2Q6aG16Z2i5YWo6YOo5YWz6Zet77ybXG5cdFx0XHRcdFx0XHRcdFx0JC5jbG9zZUFsbCh3b2JqKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdH0pO1xuXG5cblx0JC5tZW51ID0gZnVuY3Rpb24oKSB7XG5cdFx0dmFyIG1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubXVpLWFjdGlvbi1tZW51Jyk7XG5cdFx0aWYgKG1lbnUpIHtcblx0XHRcdCQudHJpZ2dlcihtZW51LCAkLkVWRU5UX1NUQVJUKTsgLy/kuLTml7blpITnkIZtZW515pegdG91Y2hzdGFydOeahOivne+8jOaJvuS4jeWIsOW9k+WJjXRhcmdldHPnmoTpl67pophcblx0XHRcdCQudHJpZ2dlcihtZW51LCAndGFwJyk7XG5cdFx0fSBlbHNlIHsgLy/miafooYzniLbnqpflj6PnmoRtZW51XG5cdFx0XHRpZiAod2luZG93LnBsdXMpIHtcblx0XHRcdFx0dmFyIHdvYmogPSAkLmN1cnJlbnRXZWJ2aWV3O1xuXHRcdFx0XHR2YXIgcGFyZW50ID0gd29iai5wYXJlbnQoKTtcblx0XHRcdFx0aWYgKHBhcmVudCkgeyAvL+WPiOW+l2V2YWxKU1xuXHRcdFx0XHRcdHBhcmVudC5ldmFsSlMoJ211aSYmbXVpLm1lbnUoKTsnKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fTtcblx0dmFyIF9fYmFjayA9IGZ1bmN0aW9uKCkge1xuXHRcdCQuYmFjaygpO1xuXHR9O1xuXHR2YXIgX19tZW51ID0gZnVuY3Rpb24oKSB7XG5cdFx0JC5tZW51KCk7XG5cdH07XG5cdC8v6buY6K6k55uR5ZCsXG5cdCQucGx1c1JlYWR5KGZ1bmN0aW9uKCkge1xuXHRcdGlmICgkLm9wdGlvbnMua2V5RXZlbnRCaW5kLmJhY2tidXR0b24pIHtcblx0XHRcdHBsdXMua2V5LmFkZEV2ZW50TGlzdGVuZXIoJ2JhY2tidXR0b24nLCBfX2JhY2ssIGZhbHNlKTtcblx0XHR9XG5cdFx0aWYgKCQub3B0aW9ucy5rZXlFdmVudEJpbmQubWVudWJ1dHRvbikge1xuXHRcdFx0cGx1cy5rZXkuYWRkRXZlbnRMaXN0ZW5lcignbWVudWJ1dHRvbicsIF9fbWVudSwgZmFsc2UpO1xuXHRcdH1cblx0fSk7XG5cdC8v5aSE55CG5oyJ6ZSu55uR5ZCs5LqL5Lu2XG5cdCQuYWRkSW5pdCh7XG5cdFx0bmFtZTogJ2tleUV2ZW50QmluZCcsXG5cdFx0aW5kZXg6IDEwMDAsXG5cdFx0aGFuZGxlOiBmdW5jdGlvbigpIHtcblx0XHRcdCQucGx1c1JlYWR5KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQvL+WmguaenOS4jeS4unRydWXvvIzliJnnp7vpmaTpu5jorqTnm5HlkKxcblx0XHRcdFx0aWYgKCEkLm9wdGlvbnMua2V5RXZlbnRCaW5kLmJhY2tidXR0b24pIHtcblx0XHRcdFx0XHRwbHVzLmtleS5yZW1vdmVFdmVudExpc3RlbmVyKCdiYWNrYnV0dG9uJywgX19iYWNrKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoISQub3B0aW9ucy5rZXlFdmVudEJpbmQubWVudWJ1dHRvbikge1xuXHRcdFx0XHRcdHBsdXMua2V5LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21lbnVidXR0b24nLCBfX21lbnUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9XG5cdH0pO1xufSkobXVpLCB3aW5kb3cpO1xuLyoqXG4gKiBtdWkuaW5pdCBwdWxsZG93blJlZnJlc2hcbiAqIEBwYXJhbSB7dHlwZX0gJFxuICogQHJldHVybnMge3VuZGVmaW5lZH1cbiAqL1xuKGZ1bmN0aW9uKCQpIHtcblx0JC5hZGRJbml0KHtcblx0XHRuYW1lOiAncHVsbHJlZnJlc2gnLFxuXHRcdGluZGV4OiAxMDAwLFxuXHRcdGhhbmRsZTogZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgb3B0aW9ucyA9ICQub3B0aW9ucztcblx0XHRcdHZhciBwdWxsUmVmcmVzaE9wdGlvbnMgPSBvcHRpb25zLnB1bGxSZWZyZXNoIHx8IHt9O1xuXHRcdFx0dmFyIGhhc1B1bGxkb3duID0gcHVsbFJlZnJlc2hPcHRpb25zLmRvd24gJiYgcHVsbFJlZnJlc2hPcHRpb25zLmRvd24uaGFzT3duUHJvcGVydHkoJ2NhbGxiYWNrJyk7XG5cdFx0XHR2YXIgaGFzUHVsbHVwID0gcHVsbFJlZnJlc2hPcHRpb25zLnVwICYmIHB1bGxSZWZyZXNoT3B0aW9ucy51cC5oYXNPd25Qcm9wZXJ0eSgnY2FsbGJhY2snKTtcblx0XHRcdGlmKGhhc1B1bGxkb3duIHx8IGhhc1B1bGx1cCkge1xuXHRcdFx0XHR2YXIgY29udGFpbmVyID0gcHVsbFJlZnJlc2hPcHRpb25zLmNvbnRhaW5lcjtcblx0XHRcdFx0aWYoY29udGFpbmVyKSB7XG5cdFx0XHRcdFx0dmFyICRjb250YWluZXIgPSAkKGNvbnRhaW5lcik7XG5cdFx0XHRcdFx0aWYoJGNvbnRhaW5lci5sZW5ndGggPT09IDEpIHtcblx0XHRcdFx0XHRcdGlmKCQub3MucGx1cykgeyAvLzUr546v5aKDXG5cdFx0XHRcdFx0XHRcdGlmKGhhc1B1bGxkb3duICYmIHB1bGxSZWZyZXNoT3B0aW9ucy5kb3duLnN0eWxlID09IFwiY2lyY2xlXCIpIHsgLy/ljp/nlJ/ovazlnIhcblx0XHRcdFx0XHRcdFx0XHQkLnBsdXNSZWFkeShmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHRcdC8v6L+Z6YeM5pS55YaZJC5mbi5wdWxsUmVmcmVzaFxuXHRcdFx0XHRcdFx0XHRcdFx0JC5mbi5wdWxsUmVmcmVzaCA9ICQuZm4ucHVsbFJlZnJlc2hfbmF0aXZlO1xuXHRcdFx0XHRcdFx0XHRcdFx0Ly92YXIgd2VidmlldyA9IHBsdXMud2Vidmlldy5jdXJyZW50V2VidmlldygpO1xuXHRcdFx0XHRcdFx0XHRcdFx0Ly9kb3duT3B0aW9ucy5kb3duLmNhbGxiYWNrID0gJ19DQUxMQkFDSyc7XG5cdFx0XHRcdFx0XHRcdFx0XHQkY29udGFpbmVyLnB1bGxSZWZyZXNoKHB1bGxSZWZyZXNoT3B0aW9ucyk7XG5cdFx0XHRcdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmKCQub3MuYW5kcm9pZCkgeyAvL+mdnuWOn+eUn+i9rOWciO+8jOS9huaYr0FuZHJvaWTnjq/looNcblx0XHRcdFx0XHRcdFx0XHQkLnBsdXNSZWFkeShmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHRcdC8v6L+Z6YeM5pS55YaZJC5mbi5wdWxsUmVmcmVzaFxuXHRcdFx0XHRcdFx0XHRcdFx0JC5mbi5wdWxsUmVmcmVzaCA9ICQuZm4ucHVsbFJlZnJlc2hfbmF0aXZlXG5cdFx0XHRcdFx0XHRcdFx0XHRpZih3aW5kb3cuX19OV2luX0VuYWJsZV9fID09PSBmYWxzZSkgeyAvL+S4jeaUr+aMgeWkmndlYnZpZXdcblx0XHRcdFx0XHRcdFx0XHRcdFx0JGNvbnRhaW5lci5wdWxsUmVmcmVzaChwdWxsUmVmcmVzaE9wdGlvbnMpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoaGFzUHVsbHVwKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly/lvZPliY3pobXpnaLliJ3lp4vljJZwdWxsdXBcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgdXBPcHRpb25zID0ge307XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dXBPcHRpb25zLnVwID0gcHVsbFJlZnJlc2hPcHRpb25zLnVwO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHVwT3B0aW9ucy53ZWJ2aWV3SWQgPSB3ZWJ2aWV3LmlkIHx8IHdlYnZpZXcuZ2V0VVJMKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0JGNvbnRhaW5lci5wdWxsUmVmcmVzaCh1cE9wdGlvbnMpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmKGhhc1B1bGxkb3duKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIHBhcmVudCA9IHdlYnZpZXcucGFyZW50KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIGlkID0gd2Vidmlldy5pZCB8fCB3ZWJ2aWV3LmdldFVSTCgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmKHBhcmVudCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIWhhc1B1bGx1cCkgeyAvL+WmguaenOayoeacieS4iuaLieWKoOi9ve+8jOmcgOimgeaJi+WKqOWIneWni+WMluS4gOS4qum7mOiupOeahHB1bGxSZWZyZXNo77yM5Lul5L6/5b2T5YmN6aG16Z2i5a655Zmo5Y+v5Lul6LCD55SoZW5kUHVsbGRvd25Ub1JlZnJlc2jnrYnmlrnms5Vcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0JGNvbnRhaW5lci5wdWxsUmVmcmVzaCh7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0d2Vidmlld0lkOiBpZFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBkb3duT3B0aW9ucyA9IHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0d2Vidmlld0lkOiBpZC8v5a2Q6aG16Z2iaWRcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRkb3duT3B0aW9ucy5kb3duID0gJC5leHRlbmQoe30sIHB1bGxSZWZyZXNoT3B0aW9ucy5kb3duKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGRvd25PcHRpb25zLmRvd24uY2FsbGJhY2sgPSAnX0NBTExCQUNLJztcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8v54i26aG16Z2i5Yid5aeL5YyWcHVsbGRvd25cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHBhcmVudC5ldmFsSlMoXCJtdWkmJm11aShkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubXVpLWNvbnRlbnQnKSkucHVsbFJlZnJlc2goJ1wiICsgSlNPTi5zdHJpbmdpZnkoZG93bk9wdGlvbnMpICsgXCInKVwiKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHsgLy/pnZ7ljp/nlJ/ovazlnIjvvIxpT1Pnjq/looNcblx0XHRcdFx0XHRcdFx0XHQkY29udGFpbmVyLnB1bGxSZWZyZXNoKHB1bGxSZWZyZXNoT3B0aW9ucyk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdCRjb250YWluZXIucHVsbFJlZnJlc2gocHVsbFJlZnJlc2hPcHRpb25zKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH0pO1xufSkobXVpKTtcbi8qKlxuICogbXVpIGFqYXhcbiAqIEBwYXJhbSB7dHlwZX0gJFxuICogQHJldHVybnMge3VuZGVmaW5lZH1cbiAqL1xuKGZ1bmN0aW9uKCQsIHdpbmRvdywgdW5kZWZpbmVkKSB7XG5cblx0dmFyIGpzb25UeXBlID0gJ2FwcGxpY2F0aW9uL2pzb24nO1xuXHR2YXIgaHRtbFR5cGUgPSAndGV4dC9odG1sJztcblx0dmFyIHJzY3JpcHQgPSAvPHNjcmlwdFxcYltePF0qKD86KD8hPFxcL3NjcmlwdD4pPFtePF0qKSo8XFwvc2NyaXB0Pi9naTtcblx0dmFyIHNjcmlwdFR5cGVSRSA9IC9eKD86dGV4dHxhcHBsaWNhdGlvbilcXC9qYXZhc2NyaXB0L2k7XG5cdHZhciB4bWxUeXBlUkUgPSAvXig/OnRleHR8YXBwbGljYXRpb24pXFwveG1sL2k7XG5cdHZhciBibGFua1JFID0gL15cXHMqJC87XG5cblx0JC5hamF4U2V0dGluZ3MgPSB7XG5cdFx0dHlwZTogJ0dFVCcsXG5cdFx0YmVmb3JlU2VuZDogJC5ub29wLFxuXHRcdHN1Y2Nlc3M6ICQubm9vcCxcblx0XHRlcnJvcjogJC5ub29wLFxuXHRcdGNvbXBsZXRlOiAkLm5vb3AsXG5cdFx0Y29udGV4dDogbnVsbCxcblx0XHR4aHI6IGZ1bmN0aW9uKHByb3RvY29sKSB7XG5cdFx0XHRyZXR1cm4gbmV3IHdpbmRvdy5YTUxIdHRwUmVxdWVzdCgpO1xuXHRcdH0sXG5cdFx0YWNjZXB0czoge1xuXHRcdFx0c2NyaXB0OiAndGV4dC9qYXZhc2NyaXB0LCBhcHBsaWNhdGlvbi9qYXZhc2NyaXB0LCBhcHBsaWNhdGlvbi94LWphdmFzY3JpcHQnLFxuXHRcdFx0anNvbjoganNvblR5cGUsXG5cdFx0XHR4bWw6ICdhcHBsaWNhdGlvbi94bWwsIHRleHQveG1sJyxcblx0XHRcdGh0bWw6IGh0bWxUeXBlLFxuXHRcdFx0dGV4dDogJ3RleHQvcGxhaW4nXG5cdFx0fSxcblx0XHR0aW1lb3V0OiAwLFxuXHRcdHByb2Nlc3NEYXRhOiB0cnVlLFxuXHRcdGNhY2hlOiB0cnVlXG5cdH07XG5cdHZhciBhamF4QmVmb3JlU2VuZCA9IGZ1bmN0aW9uKHhociwgc2V0dGluZ3MpIHtcblx0XHR2YXIgY29udGV4dCA9IHNldHRpbmdzLmNvbnRleHRcblx0XHRpZihzZXR0aW5ncy5iZWZvcmVTZW5kLmNhbGwoY29udGV4dCwgeGhyLCBzZXR0aW5ncykgPT09IGZhbHNlKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHR9O1xuXHR2YXIgYWpheFN1Y2Nlc3MgPSBmdW5jdGlvbihkYXRhLCB4aHIsIHNldHRpbmdzKSB7XG5cdFx0c2V0dGluZ3Muc3VjY2Vzcy5jYWxsKHNldHRpbmdzLmNvbnRleHQsIGRhdGEsICdzdWNjZXNzJywgeGhyKTtcblx0XHRhamF4Q29tcGxldGUoJ3N1Y2Nlc3MnLCB4aHIsIHNldHRpbmdzKTtcblx0fTtcblx0Ly8gdHlwZTogXCJ0aW1lb3V0XCIsIFwiZXJyb3JcIiwgXCJhYm9ydFwiLCBcInBhcnNlcmVycm9yXCJcblx0dmFyIGFqYXhFcnJvciA9IGZ1bmN0aW9uKGVycm9yLCB0eXBlLCB4aHIsIHNldHRpbmdzKSB7XG5cdFx0c2V0dGluZ3MuZXJyb3IuY2FsbChzZXR0aW5ncy5jb250ZXh0LCB4aHIsIHR5cGUsIGVycm9yKTtcblx0XHRhamF4Q29tcGxldGUodHlwZSwgeGhyLCBzZXR0aW5ncyk7XG5cdH07XG5cdC8vIHN0YXR1czogXCJzdWNjZXNzXCIsIFwibm90bW9kaWZpZWRcIiwgXCJlcnJvclwiLCBcInRpbWVvdXRcIiwgXCJhYm9ydFwiLCBcInBhcnNlcmVycm9yXCJcblx0dmFyIGFqYXhDb21wbGV0ZSA9IGZ1bmN0aW9uKHN0YXR1cywgeGhyLCBzZXR0aW5ncykge1xuXHRcdHNldHRpbmdzLmNvbXBsZXRlLmNhbGwoc2V0dGluZ3MuY29udGV4dCwgeGhyLCBzdGF0dXMpO1xuXHR9O1xuXG5cdHZhciBzZXJpYWxpemUgPSBmdW5jdGlvbihwYXJhbXMsIG9iaiwgdHJhZGl0aW9uYWwsIHNjb3BlKSB7XG5cdFx0dmFyIHR5cGUsIGFycmF5ID0gJC5pc0FycmF5KG9iaiksXG5cdFx0XHRoYXNoID0gJC5pc1BsYWluT2JqZWN0KG9iaik7XG5cdFx0JC5lYWNoKG9iaiwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xuXHRcdFx0dHlwZSA9ICQudHlwZSh2YWx1ZSk7XG5cdFx0XHRpZihzY29wZSkge1xuXHRcdFx0XHRrZXkgPSB0cmFkaXRpb25hbCA/IHNjb3BlIDpcblx0XHRcdFx0XHRzY29wZSArICdbJyArIChoYXNoIHx8IHR5cGUgPT09ICdvYmplY3QnIHx8IHR5cGUgPT09ICdhcnJheScgPyBrZXkgOiAnJykgKyAnXSc7XG5cdFx0XHR9XG5cdFx0XHQvLyBoYW5kbGUgZGF0YSBpbiBzZXJpYWxpemVBcnJheSgpIGZvcm1hdFxuXHRcdFx0aWYoIXNjb3BlICYmIGFycmF5KSB7XG5cdFx0XHRcdHBhcmFtcy5hZGQodmFsdWUubmFtZSwgdmFsdWUudmFsdWUpO1xuXHRcdFx0fVxuXHRcdFx0Ly8gcmVjdXJzZSBpbnRvIG5lc3RlZCBvYmplY3RzXG5cdFx0XHRlbHNlIGlmKHR5cGUgPT09IFwiYXJyYXlcIiB8fCAoIXRyYWRpdGlvbmFsICYmIHR5cGUgPT09IFwib2JqZWN0XCIpKSB7XG5cdFx0XHRcdHNlcmlhbGl6ZShwYXJhbXMsIHZhbHVlLCB0cmFkaXRpb25hbCwga2V5KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHBhcmFtcy5hZGQoa2V5LCB2YWx1ZSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH07XG5cdHZhciBzZXJpYWxpemVEYXRhID0gZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdGlmKG9wdGlvbnMucHJvY2Vzc0RhdGEgJiYgb3B0aW9ucy5kYXRhICYmIHR5cGVvZiBvcHRpb25zLmRhdGEgIT09IFwic3RyaW5nXCIpIHtcblx0XHRcdHZhciBjb250ZW50VHlwZSA9IG9wdGlvbnMuY29udGVudFR5cGU7XG5cdFx0XHRpZighY29udGVudFR5cGUgJiYgb3B0aW9ucy5oZWFkZXJzKSB7XG5cdFx0XHRcdGNvbnRlbnRUeXBlID0gb3B0aW9ucy5oZWFkZXJzWydDb250ZW50LVR5cGUnXTtcblx0XHRcdH1cblx0XHRcdGlmKGNvbnRlbnRUeXBlICYmIH5jb250ZW50VHlwZS5pbmRleE9mKGpzb25UeXBlKSkgeyAvL2FwcGxpY2F0aW9uL2pzb25cblx0XHRcdFx0b3B0aW9ucy5kYXRhID0gSlNPTi5zdHJpbmdpZnkob3B0aW9ucy5kYXRhKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG9wdGlvbnMuZGF0YSA9ICQucGFyYW0ob3B0aW9ucy5kYXRhLCBvcHRpb25zLnRyYWRpdGlvbmFsKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYob3B0aW9ucy5kYXRhICYmICghb3B0aW9ucy50eXBlIHx8IG9wdGlvbnMudHlwZS50b1VwcGVyQ2FzZSgpID09PSAnR0VUJykpIHtcblx0XHRcdG9wdGlvbnMudXJsID0gYXBwZW5kUXVlcnkob3B0aW9ucy51cmwsIG9wdGlvbnMuZGF0YSk7XG5cdFx0XHRvcHRpb25zLmRhdGEgPSB1bmRlZmluZWQ7XG5cdFx0fVxuXHR9O1xuXHR2YXIgYXBwZW5kUXVlcnkgPSBmdW5jdGlvbih1cmwsIHF1ZXJ5KSB7XG5cdFx0aWYocXVlcnkgPT09ICcnKSB7XG5cdFx0XHRyZXR1cm4gdXJsO1xuXHRcdH1cblx0XHRyZXR1cm4odXJsICsgJyYnICsgcXVlcnkpLnJlcGxhY2UoL1smP117MSwyfS8sICc/Jyk7XG5cdH07XG5cdHZhciBtaW1lVG9EYXRhVHlwZSA9IGZ1bmN0aW9uKG1pbWUpIHtcblx0XHRpZihtaW1lKSB7XG5cdFx0XHRtaW1lID0gbWltZS5zcGxpdCgnOycsIDIpWzBdO1xuXHRcdH1cblx0XHRyZXR1cm4gbWltZSAmJiAobWltZSA9PT0gaHRtbFR5cGUgPyAnaHRtbCcgOlxuXHRcdFx0bWltZSA9PT0ganNvblR5cGUgPyAnanNvbicgOlxuXHRcdFx0c2NyaXB0VHlwZVJFLnRlc3QobWltZSkgPyAnc2NyaXB0JyA6XG5cdFx0XHR4bWxUeXBlUkUudGVzdChtaW1lKSAmJiAneG1sJykgfHwgJ3RleHQnO1xuXHR9O1xuXHR2YXIgcGFyc2VBcmd1bWVudHMgPSBmdW5jdGlvbih1cmwsIGRhdGEsIHN1Y2Nlc3MsIGRhdGFUeXBlKSB7XG5cdFx0aWYoJC5pc0Z1bmN0aW9uKGRhdGEpKSB7XG5cdFx0XHRkYXRhVHlwZSA9IHN1Y2Nlc3MsIHN1Y2Nlc3MgPSBkYXRhLCBkYXRhID0gdW5kZWZpbmVkO1xuXHRcdH1cblx0XHRpZighJC5pc0Z1bmN0aW9uKHN1Y2Nlc3MpKSB7XG5cdFx0XHRkYXRhVHlwZSA9IHN1Y2Nlc3MsIHN1Y2Nlc3MgPSB1bmRlZmluZWQ7XG5cdFx0fVxuXHRcdHJldHVybiB7XG5cdFx0XHR1cmw6IHVybCxcblx0XHRcdGRhdGE6IGRhdGEsXG5cdFx0XHRzdWNjZXNzOiBzdWNjZXNzLFxuXHRcdFx0ZGF0YVR5cGU6IGRhdGFUeXBlXG5cdFx0fTtcblx0fTtcblx0JC5hamF4ID0gZnVuY3Rpb24odXJsLCBvcHRpb25zKSB7XG5cdFx0aWYodHlwZW9mIHVybCA9PT0gXCJvYmplY3RcIikge1xuXHRcdFx0b3B0aW9ucyA9IHVybDtcblx0XHRcdHVybCA9IHVuZGVmaW5lZDtcblx0XHR9XG5cdFx0dmFyIHNldHRpbmdzID0gb3B0aW9ucyB8fCB7fTtcblx0XHRzZXR0aW5ncy51cmwgPSB1cmwgfHwgc2V0dGluZ3MudXJsO1xuXHRcdGZvcih2YXIga2V5IGluICQuYWpheFNldHRpbmdzKSB7XG5cdFx0XHRpZihzZXR0aW5nc1trZXldID09PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0c2V0dGluZ3Nba2V5XSA9ICQuYWpheFNldHRpbmdzW2tleV07XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHNlcmlhbGl6ZURhdGEoc2V0dGluZ3MpO1xuXHRcdHZhciBkYXRhVHlwZSA9IHNldHRpbmdzLmRhdGFUeXBlO1xuXG5cdFx0aWYoc2V0dGluZ3MuY2FjaGUgPT09IGZhbHNlIHx8ICgoIW9wdGlvbnMgfHwgb3B0aW9ucy5jYWNoZSAhPT0gdHJ1ZSkgJiYgKCdzY3JpcHQnID09PSBkYXRhVHlwZSkpKSB7XG5cdFx0XHRzZXR0aW5ncy51cmwgPSBhcHBlbmRRdWVyeShzZXR0aW5ncy51cmwsICdfPScgKyAkLm5vdygpKTtcblx0XHR9XG5cdFx0dmFyIG1pbWUgPSBzZXR0aW5ncy5hY2NlcHRzW2RhdGFUeXBlICYmIGRhdGFUeXBlLnRvTG93ZXJDYXNlKCldO1xuXHRcdHZhciBoZWFkZXJzID0ge307XG5cdFx0dmFyIHNldEhlYWRlciA9IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG5cdFx0XHRoZWFkZXJzW25hbWUudG9Mb3dlckNhc2UoKV0gPSBbbmFtZSwgdmFsdWVdO1xuXHRcdH07XG5cdFx0dmFyIHByb3RvY29sID0gL14oW1xcdy1dKzopXFwvXFwvLy50ZXN0KHNldHRpbmdzLnVybCkgPyBSZWdFeHAuJDEgOiB3aW5kb3cubG9jYXRpb24ucHJvdG9jb2w7XG5cdFx0dmFyIHhociA9IHNldHRpbmdzLnhocihzZXR0aW5ncyk7XG5cdFx0dmFyIG5hdGl2ZVNldEhlYWRlciA9IHhoci5zZXRSZXF1ZXN0SGVhZGVyO1xuXHRcdHZhciBhYm9ydFRpbWVvdXQ7XG5cblx0XHRzZXRIZWFkZXIoJ1gtUmVxdWVzdGVkLVdpdGgnLCAnWE1MSHR0cFJlcXVlc3QnKTtcblx0XHRzZXRIZWFkZXIoJ0FjY2VwdCcsIG1pbWUgfHwgJyovKicpO1xuXHRcdGlmKCEhKG1pbWUgPSBzZXR0aW5ncy5taW1lVHlwZSB8fCBtaW1lKSkge1xuXHRcdFx0aWYobWltZS5pbmRleE9mKCcsJykgPiAtMSkge1xuXHRcdFx0XHRtaW1lID0gbWltZS5zcGxpdCgnLCcsIDIpWzBdO1xuXHRcdFx0fVxuXHRcdFx0eGhyLm92ZXJyaWRlTWltZVR5cGUgJiYgeGhyLm92ZXJyaWRlTWltZVR5cGUobWltZSk7XG5cdFx0fVxuXHRcdGlmKHNldHRpbmdzLmNvbnRlbnRUeXBlIHx8IChzZXR0aW5ncy5jb250ZW50VHlwZSAhPT0gZmFsc2UgJiYgc2V0dGluZ3MuZGF0YSAmJiBzZXR0aW5ncy50eXBlLnRvVXBwZXJDYXNlKCkgIT09ICdHRVQnKSkge1xuXHRcdFx0c2V0SGVhZGVyKCdDb250ZW50LVR5cGUnLCBzZXR0aW5ncy5jb250ZW50VHlwZSB8fCAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyk7XG5cdFx0fVxuXHRcdGlmKHNldHRpbmdzLmhlYWRlcnMpIHtcblx0XHRcdGZvcih2YXIgbmFtZSBpbiBzZXR0aW5ncy5oZWFkZXJzKVxuXHRcdFx0XHRzZXRIZWFkZXIobmFtZSwgc2V0dGluZ3MuaGVhZGVyc1tuYW1lXSk7XG5cdFx0fVxuXHRcdHhoci5zZXRSZXF1ZXN0SGVhZGVyID0gc2V0SGVhZGVyO1xuXG5cdFx0eGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYoeGhyLnJlYWR5U3RhdGUgPT09IDQpIHtcblx0XHRcdFx0eGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9ICQubm9vcDtcblx0XHRcdFx0Y2xlYXJUaW1lb3V0KGFib3J0VGltZW91dCk7XG5cdFx0XHRcdHZhciByZXN1bHQsIGVycm9yID0gZmFsc2U7XG5cdFx0XHRcdHZhciBpc0xvY2FsID0gcHJvdG9jb2wgPT09ICdmaWxlOic7XG5cdFx0XHRcdGlmKCh4aHIuc3RhdHVzID49IDIwMCAmJiB4aHIuc3RhdHVzIDwgMzAwKSB8fCB4aHIuc3RhdHVzID09PSAzMDQgfHwgKHhoci5zdGF0dXMgPT09IDAgJiYgaXNMb2NhbCAmJiB4aHIucmVzcG9uc2VUZXh0KSkge1xuXHRcdFx0XHRcdGRhdGFUeXBlID0gZGF0YVR5cGUgfHwgbWltZVRvRGF0YVR5cGUoc2V0dGluZ3MubWltZVR5cGUgfHwgeGhyLmdldFJlc3BvbnNlSGVhZGVyKCdjb250ZW50LXR5cGUnKSk7XG5cdFx0XHRcdFx0cmVzdWx0ID0geGhyLnJlc3BvbnNlVGV4dDtcblx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0Ly8gaHR0cDovL3BlcmZlY3Rpb25raWxscy5jb20vZ2xvYmFsLWV2YWwtd2hhdC1hcmUtdGhlLW9wdGlvbnMvXG5cdFx0XHRcdFx0XHRpZihkYXRhVHlwZSA9PT0gJ3NjcmlwdCcpIHtcblx0XHRcdFx0XHRcdFx0KDEsIGV2YWwpKHJlc3VsdCk7XG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYoZGF0YVR5cGUgPT09ICd4bWwnKSB7XG5cdFx0XHRcdFx0XHRcdHJlc3VsdCA9IHhoci5yZXNwb25zZVhNTDtcblx0XHRcdFx0XHRcdH0gZWxzZSBpZihkYXRhVHlwZSA9PT0gJ2pzb24nKSB7XG5cdFx0XHRcdFx0XHRcdHJlc3VsdCA9IGJsYW5rUkUudGVzdChyZXN1bHQpID8gbnVsbCA6ICQucGFyc2VKU09OKHJlc3VsdCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBjYXRjaChlKSB7XG5cdFx0XHRcdFx0XHRlcnJvciA9IGU7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYoZXJyb3IpIHtcblx0XHRcdFx0XHRcdGFqYXhFcnJvcihlcnJvciwgJ3BhcnNlcmVycm9yJywgeGhyLCBzZXR0aW5ncyk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGFqYXhTdWNjZXNzKHJlc3VsdCwgeGhyLCBzZXR0aW5ncyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHZhciBzdGF0dXMgPSB4aHIuc3RhdHVzID8gJ2Vycm9yJyA6ICdhYm9ydCc7XG5cdFx0XHRcdFx0dmFyIHN0YXR1c1RleHQgPSB4aHIuc3RhdHVzVGV4dCB8fCBudWxsO1xuXHRcdFx0XHRcdGlmKGlzTG9jYWwpIHtcblx0XHRcdFx0XHRcdHN0YXR1cyA9ICdlcnJvcic7XG5cdFx0XHRcdFx0XHRzdGF0dXNUZXh0ID0gJzQwNCc7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGFqYXhFcnJvcihzdGF0dXNUZXh0LCBzdGF0dXMsIHhociwgc2V0dGluZ3MpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fTtcblx0XHRpZihhamF4QmVmb3JlU2VuZCh4aHIsIHNldHRpbmdzKSA9PT0gZmFsc2UpIHtcblx0XHRcdHhoci5hYm9ydCgpO1xuXHRcdFx0YWpheEVycm9yKG51bGwsICdhYm9ydCcsIHhociwgc2V0dGluZ3MpO1xuXHRcdFx0cmV0dXJuIHhocjtcblx0XHR9XG5cblx0XHRpZihzZXR0aW5ncy54aHJGaWVsZHMpIHtcblx0XHRcdGZvcih2YXIgbmFtZSBpbiBzZXR0aW5ncy54aHJGaWVsZHMpIHtcblx0XHRcdFx0eGhyW25hbWVdID0gc2V0dGluZ3MueGhyRmllbGRzW25hbWVdO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHZhciBhc3luYyA9ICdhc3luYycgaW4gc2V0dGluZ3MgPyBzZXR0aW5ncy5hc3luYyA6IHRydWU7XG5cblx0XHR4aHIub3BlbihzZXR0aW5ncy50eXBlLnRvVXBwZXJDYXNlKCksIHNldHRpbmdzLnVybCwgYXN5bmMsIHNldHRpbmdzLnVzZXJuYW1lLCBzZXR0aW5ncy5wYXNzd29yZCk7XG5cblx0XHRmb3IodmFyIG5hbWUgaW4gaGVhZGVycykge1xuXHRcdFx0aWYoaGVhZGVycy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuXHRcdFx0XHRuYXRpdmVTZXRIZWFkZXIuYXBwbHkoeGhyLCBoZWFkZXJzW25hbWVdKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYoc2V0dGluZ3MudGltZW91dCA+IDApIHtcblx0XHRcdGFib3J0VGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSAkLm5vb3A7XG5cdFx0XHRcdHhoci5hYm9ydCgpO1xuXHRcdFx0XHRhamF4RXJyb3IobnVsbCwgJ3RpbWVvdXQnLCB4aHIsIHNldHRpbmdzKTtcblx0XHRcdH0sIHNldHRpbmdzLnRpbWVvdXQpO1xuXHRcdH1cblx0XHR4aHIuc2VuZChzZXR0aW5ncy5kYXRhID8gc2V0dGluZ3MuZGF0YSA6IG51bGwpO1xuXHRcdHJldHVybiB4aHI7XG5cdH07XG5cblx0JC5wYXJhbSA9IGZ1bmN0aW9uKG9iaiwgdHJhZGl0aW9uYWwpIHtcblx0XHR2YXIgcGFyYW1zID0gW107XG5cdFx0cGFyYW1zLmFkZCA9IGZ1bmN0aW9uKGssIHYpIHtcblx0XHRcdHRoaXMucHVzaChlbmNvZGVVUklDb21wb25lbnQoaykgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQodikpO1xuXHRcdH07XG5cdFx0c2VyaWFsaXplKHBhcmFtcywgb2JqLCB0cmFkaXRpb25hbCk7XG5cdFx0cmV0dXJuIHBhcmFtcy5qb2luKCcmJykucmVwbGFjZSgvJTIwL2csICcrJyk7XG5cdH07XG5cdCQuZ2V0ID0gZnVuY3Rpb24oIC8qIHVybCwgZGF0YSwgc3VjY2VzcywgZGF0YVR5cGUgKi8gKSB7XG5cdFx0cmV0dXJuICQuYWpheChwYXJzZUFyZ3VtZW50cy5hcHBseShudWxsLCBhcmd1bWVudHMpKTtcblx0fTtcblxuXHQkLnBvc3QgPSBmdW5jdGlvbiggLyogdXJsLCBkYXRhLCBzdWNjZXNzLCBkYXRhVHlwZSAqLyApIHtcblx0XHR2YXIgb3B0aW9ucyA9IHBhcnNlQXJndW1lbnRzLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG5cdFx0b3B0aW9ucy50eXBlID0gJ1BPU1QnO1xuXHRcdHJldHVybiAkLmFqYXgob3B0aW9ucyk7XG5cdH07XG5cblx0JC5nZXRKU09OID0gZnVuY3Rpb24oIC8qIHVybCwgZGF0YSwgc3VjY2VzcyAqLyApIHtcblx0XHR2YXIgb3B0aW9ucyA9IHBhcnNlQXJndW1lbnRzLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG5cdFx0b3B0aW9ucy5kYXRhVHlwZSA9ICdqc29uJztcblx0XHRyZXR1cm4gJC5hamF4KG9wdGlvbnMpO1xuXHR9O1xuXG5cdCQuZm4ubG9hZCA9IGZ1bmN0aW9uKHVybCwgZGF0YSwgc3VjY2Vzcykge1xuXHRcdGlmKCF0aGlzLmxlbmd0aClcblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdHZhciBzZWxmID0gdGhpcyxcblx0XHRcdHBhcnRzID0gdXJsLnNwbGl0KC9cXHMvKSxcblx0XHRcdHNlbGVjdG9yLFxuXHRcdFx0b3B0aW9ucyA9IHBhcnNlQXJndW1lbnRzKHVybCwgZGF0YSwgc3VjY2VzcyksXG5cdFx0XHRjYWxsYmFjayA9IG9wdGlvbnMuc3VjY2Vzcztcblx0XHRpZihwYXJ0cy5sZW5ndGggPiAxKVxuXHRcdFx0b3B0aW9ucy51cmwgPSBwYXJ0c1swXSwgc2VsZWN0b3IgPSBwYXJ0c1sxXTtcblx0XHRvcHRpb25zLnN1Y2Nlc3MgPSBmdW5jdGlvbihyZXNwb25zZSkge1xuXHRcdFx0aWYoc2VsZWN0b3IpIHtcblx0XHRcdFx0dmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdFx0XHRkaXYuaW5uZXJIVE1MID0gcmVzcG9uc2UucmVwbGFjZShyc2NyaXB0LCBcIlwiKTtcblx0XHRcdFx0dmFyIHNlbGVjdG9yRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0XHRcdHZhciBjaGlsZHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChzZWxlY3Rvcik7XG5cdFx0XHRcdGlmKGNoaWxkcyAmJiBjaGlsZHMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdGZvcih2YXIgaSA9IDAsIGxlbiA9IGNoaWxkcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHRcdFx0XHRcdFx0c2VsZWN0b3JEaXYuYXBwZW5kQ2hpbGQoY2hpbGRzW2ldKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0c2VsZlswXS5pbm5lckhUTUwgPSBzZWxlY3RvckRpdi5pbm5lckhUTUw7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRzZWxmWzBdLmlubmVySFRNTCA9IHJlc3BvbnNlO1xuXHRcdFx0fVxuXHRcdFx0Y2FsbGJhY2sgJiYgY2FsbGJhY2suYXBwbHkoc2VsZiwgYXJndW1lbnRzKTtcblx0XHR9O1xuXHRcdCQuYWpheChvcHRpb25zKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fTtcblxufSkobXVpLCB3aW5kb3cpO1xuLyoqXG4gKiA1KyBhamF4XG4gKi9cbihmdW5jdGlvbigkKSB7XG5cdHZhciBvcmlnaW5BbmNob3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG5cdG9yaWdpbkFuY2hvci5ocmVmID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XG5cdCQucGx1c1JlYWR5KGZ1bmN0aW9uKCkge1xuXHRcdCQuYWpheFNldHRpbmdzID0gJC5leHRlbmQoJC5hamF4U2V0dGluZ3MsIHtcblx0XHRcdHhocjogZnVuY3Rpb24oc2V0dGluZ3MpIHtcblx0XHRcdFx0aWYgKHNldHRpbmdzLmNyb3NzRG9tYWluKSB7IC8v5by65Yi25L2/55SocGx1c+i3qOWfn1xuXHRcdFx0XHRcdHJldHVybiBuZXcgcGx1cy5uZXQuWE1MSHR0cFJlcXVlc3QoKTtcblx0XHRcdFx0fVxuXHRcdFx0XHQvL+S7heWcqHdlYnZpZXfnmoR1cmzkuLrov5znqIvmlofku7bvvIzkuJRhamF46K+35rGC55qE6LWE5rqQ5LiN5ZCM5rqQ5LiL5L2/55SocGx1cy5uZXQuWE1MSHR0cFJlcXVlc3Rcblx0XHRcdFx0aWYgKG9yaWdpbkFuY2hvci5wcm90b2NvbCAhPT0gJ2ZpbGU6Jykge1xuXHRcdFx0XHRcdHZhciB1cmxBbmNob3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG5cdFx0XHRcdFx0dXJsQW5jaG9yLmhyZWYgPSBzZXR0aW5ncy51cmw7XG5cdFx0XHRcdFx0dXJsQW5jaG9yLmhyZWYgPSB1cmxBbmNob3IuaHJlZjtcblx0XHRcdFx0XHRzZXR0aW5ncy5jcm9zc0RvbWFpbiA9IChvcmlnaW5BbmNob3IucHJvdG9jb2wgKyAnLy8nICsgb3JpZ2luQW5jaG9yLmhvc3QpICE9PSAodXJsQW5jaG9yLnByb3RvY29sICsgJy8vJyArIHVybEFuY2hvci5ob3N0KTtcblx0XHRcdFx0XHRpZiAoc2V0dGluZ3MuY3Jvc3NEb21haW4pIHtcblx0XHRcdFx0XHRcdHJldHVybiBuZXcgcGx1cy5uZXQuWE1MSHR0cFJlcXVlc3QoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKCQub3MuaW9zICYmIHdpbmRvdy53ZWJraXQgJiYgd2luZG93LndlYmtpdC5tZXNzYWdlSGFuZGxlcnMpIHsgLy93a3dlYnZpZXfkuIvlkIzmoLfkvb/nlKg1KyB4aHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBwbHVzLm5ldC5YTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICAgICAgICAgIH1cblx0XHRcdFx0cmV0dXJuIG5ldyB3aW5kb3cuWE1MSHR0cFJlcXVlc3QoKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fSk7XG59KShtdWkpO1xuLyoqXG4gKiBtdWkgbGF5b3V0KG9mZnNldFsscG9zaXRpb24sd2lkdGgsaGVpZ2h0Li4uXSlcbiAqIEBwYXJhbSB7dHlwZX0gJFxuICogQHBhcmFtIHt0eXBlfSB3aW5kb3dcbiAqIEBwYXJhbSB7dHlwZX0gdW5kZWZpbmVkXG4gKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxuICovXG4oZnVuY3Rpb24oJCwgd2luZG93LCB1bmRlZmluZWQpIHtcblx0JC5vZmZzZXQgPSBmdW5jdGlvbihlbGVtZW50KSB7XG5cdFx0dmFyIGJveCA9IHtcblx0XHRcdHRvcCA6IDAsXG5cdFx0XHRsZWZ0IDogMFxuXHRcdH07XG5cdFx0aWYgKCB0eXBlb2YgZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0Ym94ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XHR9XG5cdFx0cmV0dXJuIHtcblx0XHRcdHRvcCA6IGJveC50b3AgKyB3aW5kb3cucGFnZVlPZmZzZXQgLSBlbGVtZW50LmNsaWVudFRvcCxcblx0XHRcdGxlZnQgOiBib3gubGVmdCArIHdpbmRvdy5wYWdlWE9mZnNldCAtIGVsZW1lbnQuY2xpZW50TGVmdFxuXHRcdH07XG5cdH07XG59KShtdWksIHdpbmRvdyk7XG4vKipcbiAqIG11aSBhbmltYXRpb25cbiAqL1xuKGZ1bmN0aW9uKCQsIHdpbmRvdykge1xuXHQvKipcblx0ICogc2Nyb2xsVG9cblx0ICovXG5cdCQuc2Nyb2xsVG8gPSBmdW5jdGlvbihzY3JvbGxUb3AsIGR1cmF0aW9uLCBjYWxsYmFjaykge1xuXHRcdGR1cmF0aW9uID0gZHVyYXRpb24gfHwgMTAwMDtcblx0XHR2YXIgc2Nyb2xsID0gZnVuY3Rpb24oZHVyYXRpb24pIHtcblx0XHRcdGlmIChkdXJhdGlvbiA8PSAwKSB7XG5cdFx0XHRcdHdpbmRvdy5zY3JvbGxUbygwLCBzY3JvbGxUb3ApO1xuXHRcdFx0XHRjYWxsYmFjayAmJiBjYWxsYmFjaygpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHR2YXIgZGlzdGFpbmNlID0gc2Nyb2xsVG9wIC0gd2luZG93LnNjcm9sbFk7XG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR3aW5kb3cuc2Nyb2xsVG8oMCwgd2luZG93LnNjcm9sbFkgKyBkaXN0YWluY2UgLyBkdXJhdGlvbiAqIDEwKTtcblx0XHRcdFx0c2Nyb2xsKGR1cmF0aW9uIC0gMTApO1xuXHRcdFx0fSwgMTYuNyk7XG5cdFx0fTtcblx0XHRzY3JvbGwoZHVyYXRpb24pO1xuXHR9O1xuXHQkLmFuaW1hdGlvbkZyYW1lID0gZnVuY3Rpb24oY2IpIHtcblx0XHR2YXIgYXJncywgaXNRdWV1ZWQsIGNvbnRleHQ7XG5cdFx0cmV0dXJuIGZ1bmN0aW9uKCkge1xuXHRcdFx0YXJncyA9IGFyZ3VtZW50cztcblx0XHRcdGNvbnRleHQgPSB0aGlzO1xuXHRcdFx0aWYgKCFpc1F1ZXVlZCkge1xuXHRcdFx0XHRpc1F1ZXVlZCA9IHRydWU7XG5cdFx0XHRcdHJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRjYi5hcHBseShjb250ZXh0LCBhcmdzKTtcblx0XHRcdFx0XHRpc1F1ZXVlZCA9IGZhbHNlO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9O1xuXHR9O1xuXG59KShtdWksIHdpbmRvdyk7XG4oZnVuY3Rpb24oJCkge1xuXHR2YXIgaW5pdGlhbGl6aW5nID0gZmFsc2UsXG5cdFx0Zm5UZXN0ID0gL3h5ei8udGVzdChmdW5jdGlvbigpIHtcblx0XHRcdHh5ejtcblx0XHR9KSA/IC9cXGJfc3VwZXJcXGIvIDogLy4qLztcblxuXHR2YXIgQ2xhc3MgPSBmdW5jdGlvbigpIHt9O1xuXHRDbGFzcy5leHRlbmQgPSBmdW5jdGlvbihwcm9wKSB7XG5cdFx0dmFyIF9zdXBlciA9IHRoaXMucHJvdG90eXBlO1xuXHRcdGluaXRpYWxpemluZyA9IHRydWU7XG5cdFx0dmFyIHByb3RvdHlwZSA9IG5ldyB0aGlzKCk7XG5cdFx0aW5pdGlhbGl6aW5nID0gZmFsc2U7XG5cdFx0Zm9yICh2YXIgbmFtZSBpbiBwcm9wKSB7XG5cdFx0XHRwcm90b3R5cGVbbmFtZV0gPSB0eXBlb2YgcHJvcFtuYW1lXSA9PSBcImZ1bmN0aW9uXCIgJiZcblx0XHRcdFx0dHlwZW9mIF9zdXBlcltuYW1lXSA9PSBcImZ1bmN0aW9uXCIgJiYgZm5UZXN0LnRlc3QocHJvcFtuYW1lXSkgP1xuXHRcdFx0XHQoZnVuY3Rpb24obmFtZSwgZm4pIHtcblx0XHRcdFx0XHRyZXR1cm4gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHR2YXIgdG1wID0gdGhpcy5fc3VwZXI7XG5cblx0XHRcdFx0XHRcdHRoaXMuX3N1cGVyID0gX3N1cGVyW25hbWVdO1xuXG5cdFx0XHRcdFx0XHR2YXIgcmV0ID0gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdFx0XHRcdHRoaXMuX3N1cGVyID0gdG1wO1xuXG5cdFx0XHRcdFx0XHRyZXR1cm4gcmV0O1xuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH0pKG5hbWUsIHByb3BbbmFtZV0pIDpcblx0XHRcdFx0cHJvcFtuYW1lXTtcblx0XHR9XG5cdFx0ZnVuY3Rpb24gQ2xhc3MoKSB7XG5cdFx0XHRpZiAoIWluaXRpYWxpemluZyAmJiB0aGlzLmluaXQpXG5cdFx0XHRcdHRoaXMuaW5pdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdH1cblx0XHRDbGFzcy5wcm90b3R5cGUgPSBwcm90b3R5cGU7XG5cdFx0Q2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQ2xhc3M7XG5cdFx0Q2xhc3MuZXh0ZW5kID0gYXJndW1lbnRzLmNhbGxlZTtcblx0XHRyZXR1cm4gQ2xhc3M7XG5cdH07XG5cdCQuQ2xhc3MgPSBDbGFzcztcbn0pKG11aSk7XG4oZnVuY3Rpb24oJCwgZG9jdW1lbnQsIHVuZGVmaW5lZCkge1xuICAgIHZhciBDTEFTU19QVUxMX1RPUF9QT0NLRVQgPSAnbXVpLXB1bGwtdG9wLXBvY2tldCc7XG4gICAgdmFyIENMQVNTX1BVTExfQk9UVE9NX1BPQ0tFVCA9ICdtdWktcHVsbC1ib3R0b20tcG9ja2V0JztcbiAgICB2YXIgQ0xBU1NfUFVMTCA9ICdtdWktcHVsbCc7XG4gICAgdmFyIENMQVNTX1BVTExfTE9BRElORyA9ICdtdWktcHVsbC1sb2FkaW5nJztcbiAgICB2YXIgQ0xBU1NfUFVMTF9DQVBUSU9OID0gJ211aS1wdWxsLWNhcHRpb24nO1xuICAgIHZhciBDTEFTU19QVUxMX0NBUFRJT05fRE9XTiA9ICdtdWktcHVsbC1jYXB0aW9uLWRvd24nO1xuICAgIHZhciBDTEFTU19QVUxMX0NBUFRJT05fUkVGUkVTSCA9ICdtdWktcHVsbC1jYXB0aW9uLXJlZnJlc2gnO1xuICAgIHZhciBDTEFTU19QVUxMX0NBUFRJT05fTk9NT1JFID0gJ211aS1wdWxsLWNhcHRpb24tbm9tb3JlJztcblxuICAgIHZhciBDTEFTU19JQ09OID0gJ211aS1pY29uJztcbiAgICB2YXIgQ0xBU1NfU1BJTk5FUiA9ICdtdWktc3Bpbm5lcic7XG4gICAgdmFyIENMQVNTX0lDT05fUFVMTERPV04gPSAnbXVpLWljb24tcHVsbGRvd24nO1xuXG4gICAgdmFyIENMQVNTX0JMT0NLID0gJ211aS1ibG9jayc7XG4gICAgdmFyIENMQVNTX0hJRERFTiA9ICdtdWktaGlkZGVuJztcbiAgICB2YXIgQ0xBU1NfVklTSUJJTElUWSA9ICdtdWktdmlzaWJpbGl0eSc7XG5cbiAgICB2YXIgQ0xBU1NfTE9BRElOR19VUCA9IENMQVNTX1BVTExfTE9BRElORyArICcgJyArIENMQVNTX0lDT04gKyAnICcgKyBDTEFTU19JQ09OX1BVTExET1dOO1xuICAgIHZhciBDTEFTU19MT0FESU5HX0RPV04gPSBDTEFTU19QVUxMX0xPQURJTkcgKyAnICcgKyBDTEFTU19JQ09OICsgJyAnICsgQ0xBU1NfSUNPTl9QVUxMRE9XTjtcbiAgICB2YXIgQ0xBU1NfTE9BRElORyA9IENMQVNTX1BVTExfTE9BRElORyArICcgJyArIENMQVNTX0lDT04gKyAnICcgKyBDTEFTU19TUElOTkVSO1xuXG4gICAgdmFyIHBvY2tldEh0bWwgPSBbJzxkaXYgY2xhc3M9XCInICsgQ0xBU1NfUFVMTCArICdcIj4nLCAnPGRpdiBjbGFzcz1cIntpY29ufVwiPjwvZGl2PicsICc8ZGl2IGNsYXNzPVwiJyArIENMQVNTX1BVTExfQ0FQVElPTiArICdcIj57Y29udGVudHJlZnJlc2h9PC9kaXY+JywgJzwvZGl2PiddLmpvaW4oJycpO1xuXG4gICAgdmFyIFB1bGxSZWZyZXNoID0ge1xuICAgICAgICBpbml0OiBmdW5jdGlvbihlbGVtZW50LCBvcHRpb25zKSB7XG4gICAgICAgICAgICB0aGlzLl9zdXBlcihlbGVtZW50LCAkLmV4dGVuZCh0cnVlLCB7XG4gICAgICAgICAgICAgICAgc2Nyb2xsWTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBzY3JvbGxYOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBpbmRpY2F0b3JzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGRlY2VsZXJhdGlvbjogMC4wMDMsXG4gICAgICAgICAgICAgICAgZG93bjoge1xuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDUwLFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50aW5pdDogJ+S4i+aLieWPr+S7peWIt+aWsCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnRkb3duOiAn5LiL5ouJ5Y+v5Lul5Yi35pawJyxcbiAgICAgICAgICAgICAgICAgICAgY29udGVudG92ZXI6ICfph4rmlL7nq4vljbPliLfmlrAnLFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50cmVmcmVzaDogJ+ato+WcqOWIt+aWsC4uLidcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHVwOiB7XG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogNTAsXG4gICAgICAgICAgICAgICAgICAgIGF1dG86IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50aW5pdDogJ+S4iuaLieaYvuekuuabtOWkmicsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnRkb3duOiAn5LiK5ouJ5pi+56S65pu05aSaJyxcbiAgICAgICAgICAgICAgICAgICAgY29udGVudHJlZnJlc2g6ICfmraPlnKjliqDovb0uLi4nLFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50bm9tb3JlOiAn5rKh5pyJ5pu05aSa5pWw5o2u5LqGJyxcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDMwMFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIG9wdGlvbnMpKTtcbiAgICAgICAgfSxcbiAgICAgICAgX2luaXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5fc3VwZXIoKTtcbiAgICAgICAgICAgIHRoaXMuX2luaXRQb2NrZXQoKTtcbiAgICAgICAgfSxcbiAgICAgICAgX2luaXRQdWxsZG93blJlZnJlc2g6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5wdWxsZG93biA9IHRydWU7XG4gICAgICAgICAgICBpZiAodGhpcy50b3BQb2NrZXQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnB1bGxQb2NrZXQgPSB0aGlzLnRvcFBvY2tldDtcbiAgICAgICAgICAgICAgICB0aGlzLnB1bGxQb2NrZXQuY2xhc3NMaXN0LmFkZChDTEFTU19CTE9DSyk7XG4gICAgICAgICAgICAgICAgdGhpcy5wdWxsUG9ja2V0LmNsYXNzTGlzdC5hZGQoQ0xBU1NfVklTSUJJTElUWSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wdWxsQ2FwdGlvbiA9IHRoaXMudG9wQ2FwdGlvbjtcbiAgICAgICAgICAgICAgICB0aGlzLnB1bGxMb2FkaW5nID0gdGhpcy50b3BMb2FkaW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBfaW5pdFB1bGx1cFJlZnJlc2g6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5wdWxsZG93biA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKHRoaXMuYm90dG9tUG9ja2V0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wdWxsUG9ja2V0ID0gdGhpcy5ib3R0b21Qb2NrZXQ7XG4gICAgICAgICAgICAgICAgdGhpcy5wdWxsUG9ja2V0LmNsYXNzTGlzdC5hZGQoQ0xBU1NfQkxPQ0spO1xuICAgICAgICAgICAgICAgIHRoaXMucHVsbFBvY2tldC5jbGFzc0xpc3QuYWRkKENMQVNTX1ZJU0lCSUxJVFkpO1xuICAgICAgICAgICAgICAgIHRoaXMucHVsbENhcHRpb24gPSB0aGlzLmJvdHRvbUNhcHRpb247XG4gICAgICAgICAgICAgICAgdGhpcy5wdWxsTG9hZGluZyA9IHRoaXMuYm90dG9tTG9hZGluZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgX2luaXRQb2NrZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5kb3duICYmIG9wdGlvbnMuZG93bi5oYXNPd25Qcm9wZXJ0eSgnY2FsbGJhY2snKSkge1xuICAgICAgICAgICAgICAgIHRoaXMudG9wUG9ja2V0ID0gdGhpcy5zY3JvbGxlci5xdWVyeVNlbGVjdG9yKCcuJyArIENMQVNTX1BVTExfVE9QX1BPQ0tFVCk7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnRvcFBvY2tldCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRvcFBvY2tldCA9IHRoaXMuX2NyZWF0ZVBvY2tldChDTEFTU19QVUxMX1RPUF9QT0NLRVQsIG9wdGlvbnMuZG93biwgQ0xBU1NfTE9BRElOR19ET1dOKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyLmluc2VydEJlZm9yZSh0aGlzLnRvcFBvY2tldCwgdGhpcy53cmFwcGVyLmZpcnN0Q2hpbGQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnRvcExvYWRpbmcgPSB0aGlzLnRvcFBvY2tldC5xdWVyeVNlbGVjdG9yKCcuJyArIENMQVNTX1BVTExfTE9BRElORyk7XG4gICAgICAgICAgICAgICAgdGhpcy50b3BDYXB0aW9uID0gdGhpcy50b3BQb2NrZXQucXVlcnlTZWxlY3RvcignLicgKyBDTEFTU19QVUxMX0NBUFRJT04pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wdGlvbnMudXAgJiYgb3B0aW9ucy51cC5oYXNPd25Qcm9wZXJ0eSgnY2FsbGJhY2snKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuYm90dG9tUG9ja2V0ID0gdGhpcy5zY3JvbGxlci5xdWVyeVNlbGVjdG9yKCcuJyArIENMQVNTX1BVTExfQk9UVE9NX1BPQ0tFVCk7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmJvdHRvbVBvY2tldCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmJvdHRvbVBvY2tldCA9IHRoaXMuX2NyZWF0ZVBvY2tldChDTEFTU19QVUxMX0JPVFRPTV9QT0NLRVQsIG9wdGlvbnMudXAsIENMQVNTX0xPQURJTkcpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbGVyLmFwcGVuZENoaWxkKHRoaXMuYm90dG9tUG9ja2V0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5ib3R0b21Mb2FkaW5nID0gdGhpcy5ib3R0b21Qb2NrZXQucXVlcnlTZWxlY3RvcignLicgKyBDTEFTU19QVUxMX0xPQURJTkcpO1xuICAgICAgICAgICAgICAgIHRoaXMuYm90dG9tQ2FwdGlvbiA9IHRoaXMuYm90dG9tUG9ja2V0LnF1ZXJ5U2VsZWN0b3IoJy4nICsgQ0xBU1NfUFVMTF9DQVBUSU9OKTtcbiAgICAgICAgICAgICAgICAvL1RPRE8gb25seSBmb3IgaDVcbiAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsYm90dG9tJywgdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIF9jcmVhdGVQb2NrZXQ6IGZ1bmN0aW9uKGNsYXp6LCBvcHRpb25zLCBpY29uQ2xhc3MpIHtcbiAgICAgICAgICAgIHZhciBwb2NrZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIHBvY2tldC5jbGFzc05hbWUgPSBjbGF6ejtcbiAgICAgICAgICAgIHBvY2tldC5pbm5lckhUTUwgPSBwb2NrZXRIdG1sLnJlcGxhY2UoJ3tjb250ZW50cmVmcmVzaH0nLCBvcHRpb25zLmNvbnRlbnRpbml0KS5yZXBsYWNlKCd7aWNvbn0nLCBpY29uQ2xhc3MpO1xuICAgICAgICAgICAgcmV0dXJuIHBvY2tldDtcbiAgICAgICAgfSxcbiAgICAgICAgX3Jlc2V0UHVsbERvd25Mb2FkaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBsb2FkaW5nID0gdGhpcy5wdWxsTG9hZGluZztcbiAgICAgICAgICAgIGlmIChsb2FkaW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wdWxsQ2FwdGlvbi5pbm5lckhUTUwgPSB0aGlzLm9wdGlvbnMuZG93bi5jb250ZW50ZG93bjtcbiAgICAgICAgICAgICAgICBsb2FkaW5nLnN0eWxlLndlYmtpdFRyYW5zaXRpb24gPSBcIlwiO1xuICAgICAgICAgICAgICAgIGxvYWRpbmcuc3R5bGUud2Via2l0VHJhbnNmb3JtID0gXCJcIjtcbiAgICAgICAgICAgICAgICBsb2FkaW5nLnN0eWxlLndlYmtpdEFuaW1hdGlvbiA9IFwiXCI7XG4gICAgICAgICAgICAgICAgbG9hZGluZy5jbGFzc05hbWUgPSBDTEFTU19MT0FESU5HX0RPV047XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIF9zZXRDYXB0aW9uQ2xhc3M6IGZ1bmN0aW9uKGlzUHVsbGRvd24sIGNhcHRpb24sIHRpdGxlKSB7XG4gICAgICAgICAgICBpZiAoIWlzUHVsbGRvd24pIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHRpdGxlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgdGhpcy5vcHRpb25zLnVwLmNvbnRlbnRkb3duOlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FwdGlvbi5jbGFzc05hbWUgPSBDTEFTU19QVUxMX0NBUFRJT04gKyAnICcgKyBDTEFTU19QVUxMX0NBUFRJT05fRE9XTjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIHRoaXMub3B0aW9ucy51cC5jb250ZW50cmVmcmVzaDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhcHRpb24uY2xhc3NOYW1lID0gQ0xBU1NfUFVMTF9DQVBUSU9OICsgJyAnICsgQ0xBU1NfUFVMTF9DQVBUSU9OX1JFRlJFU0hcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIHRoaXMub3B0aW9ucy51cC5jb250ZW50bm9tb3JlOlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FwdGlvbi5jbGFzc05hbWUgPSBDTEFTU19QVUxMX0NBUFRJT04gKyAnICcgKyBDTEFTU19QVUxMX0NBUFRJT05fTk9NT1JFO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBfc2V0Q2FwdGlvbjogZnVuY3Rpb24odGl0bGUsIHJlc2V0KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5sb2FkaW5nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7XG4gICAgICAgICAgICB2YXIgcG9ja2V0ID0gdGhpcy5wdWxsUG9ja2V0O1xuICAgICAgICAgICAgdmFyIGNhcHRpb24gPSB0aGlzLnB1bGxDYXB0aW9uO1xuICAgICAgICAgICAgdmFyIGxvYWRpbmcgPSB0aGlzLnB1bGxMb2FkaW5nO1xuICAgICAgICAgICAgdmFyIGlzUHVsbGRvd24gPSB0aGlzLnB1bGxkb3duO1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgaWYgKHBvY2tldCkge1xuICAgICAgICAgICAgICAgIGlmIChyZXNldCkge1xuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FwdGlvbi5pbm5lckhUTUwgPSBzZWxmLmxhc3RUaXRsZSA9IHRpdGxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzUHVsbGRvd24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkaW5nLmNsYXNzTmFtZSA9IENMQVNTX0xPQURJTkdfRE9XTjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fc2V0Q2FwdGlvbkNsYXNzKGZhbHNlLCBjYXB0aW9uLCB0aXRsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGluZy5jbGFzc05hbWUgPSBDTEFTU19MT0FESU5HO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGluZy5zdHlsZS53ZWJraXRBbmltYXRpb24gPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGluZy5zdHlsZS53ZWJraXRUcmFuc2l0aW9uID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRpbmcuc3R5bGUud2Via2l0VHJhbnNmb3JtID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGl0bGUgIT09IHRoaXMubGFzdFRpdGxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXB0aW9uLmlubmVySFRNTCA9IHRpdGxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzUHVsbGRvd24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGl0bGUgPT09IG9wdGlvbnMuZG93bi5jb250ZW50cmVmcmVzaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkaW5nLmNsYXNzTmFtZSA9IENMQVNTX0xPQURJTkc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRpbmcuc3R5bGUud2Via2l0QW5pbWF0aW9uID0gXCJzcGlubmVyLXNwaW4gMXMgc3RlcC1lbmQgaW5maW5pdGVcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRpdGxlID09PSBvcHRpb25zLmRvd24uY29udGVudG92ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGluZy5jbGFzc05hbWUgPSBDTEFTU19MT0FESU5HX1VQO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkaW5nLnN0eWxlLndlYmtpdFRyYW5zaXRpb24gPSBcIi13ZWJraXQtdHJhbnNmb3JtIDAuM3MgZWFzZS1pblwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkaW5nLnN0eWxlLndlYmtpdFRyYW5zZm9ybSA9IFwicm90YXRlKDE4MGRlZylcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRpdGxlID09PSBvcHRpb25zLmRvd24uY29udGVudGRvd24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZGluZy5jbGFzc05hbWUgPSBDTEFTU19MT0FESU5HX0RPV047XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRpbmcuc3R5bGUud2Via2l0VHJhbnNpdGlvbiA9IFwiLXdlYmtpdC10cmFuc2Zvcm0gMC4zcyBlYXNlLWluXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRpbmcuc3R5bGUud2Via2l0VHJhbnNmb3JtID0gXCJyb3RhdGUoMGRlZylcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aXRsZSA9PT0gb3B0aW9ucy51cC5jb250ZW50cmVmcmVzaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkaW5nLmNsYXNzTmFtZSA9IENMQVNTX0xPQURJTkcgKyAnICcgKyBDTEFTU19WSVNJQklMSVRZO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRpbmcuY2xhc3NOYW1lID0gQ0xBU1NfTE9BRElORyArICcgJyArIENMQVNTX0hJRERFTjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fc2V0Q2FwdGlvbkNsYXNzKGZhbHNlLCBjYXB0aW9uLCB0aXRsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxhc3RUaXRsZSA9IHRpdGxlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgICQuUHVsbFJlZnJlc2ggPSBQdWxsUmVmcmVzaDtcbn0pKG11aSwgZG9jdW1lbnQpO1xuKGZ1bmN0aW9uKCQsIHdpbmRvdywgZG9jdW1lbnQsIHVuZGVmaW5lZCkge1xuXHR2YXIgQ0xBU1NfU0NST0xMID0gJ211aS1zY3JvbGwnO1xuXHR2YXIgQ0xBU1NfU0NST0xMQkFSID0gJ211aS1zY3JvbGxiYXInO1xuXHR2YXIgQ0xBU1NfSU5ESUNBVE9SID0gJ211aS1zY3JvbGxiYXItaW5kaWNhdG9yJztcblx0dmFyIENMQVNTX1NDUk9MTEJBUl9WRVJUSUNBTCA9IENMQVNTX1NDUk9MTEJBUiArICctdmVydGljYWwnO1xuXHR2YXIgQ0xBU1NfU0NST0xMQkFSX0hPUklaT05UQUwgPSBDTEFTU19TQ1JPTExCQVIgKyAnLWhvcml6b250YWwnO1xuXG5cdHZhciBDTEFTU19BQ1RJVkUgPSAnbXVpLWFjdGl2ZSc7XG5cblx0dmFyIGVhc2UgPSB7XG5cdFx0cXVhZHJhdGljOiB7XG5cdFx0XHRzdHlsZTogJ2N1YmljLWJlemllcigwLjI1LCAwLjQ2LCAwLjQ1LCAwLjk0KScsXG5cdFx0XHRmbjogZnVuY3Rpb24oaykge1xuXHRcdFx0XHRyZXR1cm4gayAqICgyIC0gayk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRjaXJjdWxhcjoge1xuXHRcdFx0c3R5bGU6ICdjdWJpYy1iZXppZXIoMC4xLCAwLjU3LCAwLjEsIDEpJyxcblx0XHRcdGZuOiBmdW5jdGlvbihrKSB7XG5cdFx0XHRcdHJldHVybiBNYXRoLnNxcnQoMSAtICgtLWsgKiBrKSk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRvdXRDaXJjOiB7XG5cdFx0XHRzdHlsZTogJ2N1YmljLWJlemllcigwLjA3NSwgMC44MiwgMC4xNjUsIDEpJ1xuXHRcdH0sXG5cdFx0b3V0Q3ViaWM6IHtcblx0XHRcdHN0eWxlOiAnY3ViaWMtYmV6aWVyKDAuMTY1LCAwLjg0LCAwLjQ0LCAxKSdcblx0XHR9XG5cdH1cblx0dmFyIFNjcm9sbCA9ICQuQ2xhc3MuZXh0ZW5kKHtcblx0XHRpbml0OiBmdW5jdGlvbihlbGVtZW50LCBvcHRpb25zKSB7XG5cdFx0XHR0aGlzLndyYXBwZXIgPSB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuXHRcdFx0dGhpcy5zY3JvbGxlciA9IHRoaXMud3JhcHBlci5jaGlsZHJlblswXTtcblx0XHRcdHRoaXMuc2Nyb2xsZXJTdHlsZSA9IHRoaXMuc2Nyb2xsZXIgJiYgdGhpcy5zY3JvbGxlci5zdHlsZTtcblx0XHRcdHRoaXMuc3RvcHBlZCA9IGZhbHNlO1xuXG5cdFx0XHR0aGlzLm9wdGlvbnMgPSAkLmV4dGVuZCh0cnVlLCB7XG5cdFx0XHRcdHNjcm9sbFk6IHRydWUsIC8v5piv5ZCm56uW5ZCR5rua5YqoXG5cdFx0XHRcdHNjcm9sbFg6IGZhbHNlLCAvL+aYr+WQpuaoquWQkea7muWKqFxuXHRcdFx0XHRzdGFydFg6IDAsIC8v5Yid5aeL5YyW5pe25rua5Yqo6IezeFxuXHRcdFx0XHRzdGFydFk6IDAsIC8v5Yid5aeL5YyW5pe25rua5Yqo6IezeVxuXG5cdFx0XHRcdGluZGljYXRvcnM6IHRydWUsIC8v5piv5ZCm5pi+56S65rua5Yqo5p2hXG5cdFx0XHRcdHN0b3BQcm9wYWdhdGlvbjogZmFsc2UsXG5cdFx0XHRcdGhhcmR3YXJlQWNjZWxlcmF0ZWQ6IHRydWUsXG5cdFx0XHRcdGZpeGVkQmFkQW5kb3JpZDogZmFsc2UsXG5cdFx0XHRcdHByZXZlbnREZWZhdWx0RXhjZXB0aW9uOiB7XG5cdFx0XHRcdFx0dGFnTmFtZTogL14oSU5QVVR8VEVYVEFSRUF8QlVUVE9OfFNFTEVDVHxWSURFTykkL1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRtb21lbnR1bTogdHJ1ZSxcblxuXHRcdFx0XHRzbmFwWDogMC41LCAvL+aoquWQkeWIh+aNoui3neemuyjku6XlvZPliY3lrrnlmajlrr3luqbkuLrln7rlh4YpXG5cdFx0XHRcdHNuYXA6IGZhbHNlLCAvL+WbvueJh+i9ruaSre+8jOaLluaLveW8j+mAiemhueWNoVxuXG5cdFx0XHRcdGJvdW5jZTogdHJ1ZSwgLy/mmK/lkKblkK/nlKjlm57lvLlcblx0XHRcdFx0Ym91bmNlVGltZTogNTAwLCAvL+WbnuW8ueWKqOeUu+aXtumXtFxuXHRcdFx0XHRib3VuY2VFYXNpbmc6IGVhc2Uub3V0Q2lyYywgLy/lm57lvLnliqjnlLvmm7Lnur9cblxuXHRcdFx0XHRzY3JvbGxUaW1lOiA1MDAsXG5cdFx0XHRcdHNjcm9sbEVhc2luZzogZWFzZS5vdXRDdWJpYywgLy/ova7mkq3liqjnlLvmm7Lnur9cblxuXHRcdFx0XHRkaXJlY3Rpb25Mb2NrVGhyZXNob2xkOiA1LFxuXG5cdFx0XHRcdHBhcmFsbGF4RWxlbWVudDogZmFsc2UsIC8v6KeG5beu5YWD57SgXG5cdFx0XHRcdHBhcmFsbGF4UmF0aW86IDAuNVxuXHRcdFx0fSwgb3B0aW9ucyk7XG5cblx0XHRcdHRoaXMueCA9IDA7XG5cdFx0XHR0aGlzLnkgPSAwO1xuXHRcdFx0dGhpcy50cmFuc2xhdGVaID0gdGhpcy5vcHRpb25zLmhhcmR3YXJlQWNjZWxlcmF0ZWQgPyAnIHRyYW5zbGF0ZVooMCknIDogJyc7XG5cblx0XHRcdHRoaXMuX2luaXQoKTtcblx0XHRcdGlmICh0aGlzLnNjcm9sbGVyKSB7XG5cdFx0XHRcdHRoaXMucmVmcmVzaCgpO1xuXHRcdFx0XHQvL1x0XHRcdFx0aWYgKHRoaXMub3B0aW9ucy5zdGFydFggIT09IDAgfHwgdGhpcy5vcHRpb25zLnN0YXJ0WSAhPT0gMCkgeyAvL+mcgOimgeWIpOaWreWQl++8n+WQjue7reagueaNruWunumZheaDheWGteWGjeeci+eci1xuXHRcdFx0XHR0aGlzLnNjcm9sbFRvKHRoaXMub3B0aW9ucy5zdGFydFgsIHRoaXMub3B0aW9ucy5zdGFydFkpO1xuXHRcdFx0XHQvL1x0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0sXG5cdFx0X2luaXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5faW5pdFBhcmFsbGF4KCk7XG5cdFx0XHR0aGlzLl9pbml0SW5kaWNhdG9ycygpO1xuXHRcdFx0dGhpcy5faW5pdEV2ZW50KCk7XG5cdFx0fSxcblx0XHRfaW5pdFBhcmFsbGF4OiBmdW5jdGlvbigpIHtcblx0XHRcdGlmICh0aGlzLm9wdGlvbnMucGFyYWxsYXhFbGVtZW50KSB7XG5cdFx0XHRcdHRoaXMucGFyYWxsYXhFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLm9wdGlvbnMucGFyYWxsYXhFbGVtZW50KTtcblx0XHRcdFx0dGhpcy5wYXJhbGxheFN0eWxlID0gdGhpcy5wYXJhbGxheEVsZW1lbnQuc3R5bGU7XG5cdFx0XHRcdHRoaXMucGFyYWxsYXhIZWlnaHQgPSB0aGlzLnBhcmFsbGF4RWxlbWVudC5vZmZzZXRIZWlnaHQ7XG5cdFx0XHRcdHRoaXMucGFyYWxsYXhJbWdTdHlsZSA9IHRoaXMucGFyYWxsYXhFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2ltZycpLnN0eWxlO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0X2luaXRJbmRpY2F0b3JzOiBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdHNlbGYuaW5kaWNhdG9ycyA9IFtdO1xuXHRcdFx0aWYgKCF0aGlzLm9wdGlvbnMuaW5kaWNhdG9ycykge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHR2YXIgaW5kaWNhdG9ycyA9IFtdLFxuXHRcdFx0XHRpbmRpY2F0b3I7XG5cblx0XHRcdC8vIFZlcnRpY2FsIHNjcm9sbGJhclxuXHRcdFx0aWYgKHNlbGYub3B0aW9ucy5zY3JvbGxZKSB7XG5cdFx0XHRcdGluZGljYXRvciA9IHtcblx0XHRcdFx0XHRlbDogdGhpcy5fY3JlYXRlU2Nyb2xsQmFyKENMQVNTX1NDUk9MTEJBUl9WRVJUSUNBTCksXG5cdFx0XHRcdFx0bGlzdGVuWDogZmFsc2Vcblx0XHRcdFx0fTtcblxuXHRcdFx0XHR0aGlzLndyYXBwZXIuYXBwZW5kQ2hpbGQoaW5kaWNhdG9yLmVsKTtcblx0XHRcdFx0aW5kaWNhdG9ycy5wdXNoKGluZGljYXRvcik7XG5cdFx0XHR9XG5cblx0XHRcdC8vIEhvcml6b250YWwgc2Nyb2xsYmFyXG5cdFx0XHRpZiAodGhpcy5vcHRpb25zLnNjcm9sbFgpIHtcblx0XHRcdFx0aW5kaWNhdG9yID0ge1xuXHRcdFx0XHRcdGVsOiB0aGlzLl9jcmVhdGVTY3JvbGxCYXIoQ0xBU1NfU0NST0xMQkFSX0hPUklaT05UQUwpLFxuXHRcdFx0XHRcdGxpc3Rlblk6IGZhbHNlXG5cdFx0XHRcdH07XG5cblx0XHRcdFx0dGhpcy53cmFwcGVyLmFwcGVuZENoaWxkKGluZGljYXRvci5lbCk7XG5cdFx0XHRcdGluZGljYXRvcnMucHVzaChpbmRpY2F0b3IpO1xuXHRcdFx0fVxuXG5cdFx0XHRmb3IgKHZhciBpID0gaW5kaWNhdG9ycy5sZW5ndGg7IGktLTspIHtcblx0XHRcdFx0dGhpcy5pbmRpY2F0b3JzLnB1c2gobmV3IEluZGljYXRvcih0aGlzLCBpbmRpY2F0b3JzW2ldKSk7XG5cdFx0XHR9XG5cblx0XHR9LFxuXHRcdF9pbml0U25hcDogZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLmN1cnJlbnRQYWdlID0ge307XG5cdFx0XHR0aGlzLnBhZ2VzID0gW107XG5cdFx0XHR2YXIgc25hcHMgPSB0aGlzLnNuYXBzO1xuXHRcdFx0dmFyIGxlbmd0aCA9IHNuYXBzLmxlbmd0aDtcblx0XHRcdHZhciBtID0gMDtcblx0XHRcdHZhciBuID0gLTE7XG5cdFx0XHR2YXIgeCA9IDA7XG5cdFx0XHR2YXIgbGVmdFggPSAwO1xuXHRcdFx0dmFyIHJpZ2h0WCA9IDA7XG5cdFx0XHR2YXIgc25hcFggPSAwO1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuXHRcdFx0XHR2YXIgc25hcCA9IHNuYXBzW2ldO1xuXHRcdFx0XHR2YXIgb2Zmc2V0TGVmdCA9IHNuYXAub2Zmc2V0TGVmdDtcblx0XHRcdFx0dmFyIG9mZnNldFdpZHRoID0gc25hcC5vZmZzZXRXaWR0aDtcblx0XHRcdFx0aWYgKGkgPT09IDAgfHwgb2Zmc2V0TGVmdCA8PSBzbmFwc1tpIC0gMV0ub2Zmc2V0TGVmdCkge1xuXHRcdFx0XHRcdG0gPSAwO1xuXHRcdFx0XHRcdG4rKztcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoIXRoaXMucGFnZXNbbV0pIHtcblx0XHRcdFx0XHR0aGlzLnBhZ2VzW21dID0gW107XG5cdFx0XHRcdH1cblx0XHRcdFx0eCA9IHRoaXMuX2dldFNuYXBYKG9mZnNldExlZnQpO1xuXHRcdFx0XHRzbmFwWCA9IE1hdGgucm91bmQoKG9mZnNldFdpZHRoKSAqIHRoaXMub3B0aW9ucy5zbmFwWCk7XG5cdFx0XHRcdGxlZnRYID0geCAtIHNuYXBYO1xuXHRcdFx0XHRyaWdodFggPSB4IC0gb2Zmc2V0V2lkdGggKyBzbmFwWDtcblx0XHRcdFx0dGhpcy5wYWdlc1ttXVtuXSA9IHtcblx0XHRcdFx0XHR4OiB4LFxuXHRcdFx0XHRcdGxlZnRYOiBsZWZ0WCxcblx0XHRcdFx0XHRyaWdodFg6IHJpZ2h0WCxcblx0XHRcdFx0XHRwYWdlWDogbSxcblx0XHRcdFx0XHRlbGVtZW50OiBzbmFwXG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKHNuYXAuY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX0FDVElWRSkpIHtcblx0XHRcdFx0XHR0aGlzLmN1cnJlbnRQYWdlID0gdGhpcy5wYWdlc1ttXVswXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoeCA+PSB0aGlzLm1heFNjcm9sbFgpIHtcblx0XHRcdFx0XHRtKys7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHRoaXMub3B0aW9ucy5zdGFydFggPSB0aGlzLmN1cnJlbnRQYWdlLnggfHwgMDtcblx0XHR9LFxuXHRcdF9nZXRTbmFwWDogZnVuY3Rpb24ob2Zmc2V0TGVmdCkge1xuXHRcdFx0cmV0dXJuIE1hdGgubWF4KE1hdGgubWluKDAsIC1vZmZzZXRMZWZ0ICsgKHRoaXMud3JhcHBlcldpZHRoIC8gMikpLCB0aGlzLm1heFNjcm9sbFgpO1xuXHRcdH0sXG5cdFx0X2dvdG9QYWdlOiBmdW5jdGlvbihpbmRleCkge1xuXHRcdFx0dGhpcy5jdXJyZW50UGFnZSA9IHRoaXMucGFnZXNbTWF0aC5taW4oaW5kZXgsIHRoaXMucGFnZXMubGVuZ3RoIC0gMSldWzBdO1xuXHRcdFx0Zm9yICh2YXIgaSA9IDAsIGxlbiA9IHRoaXMuc25hcHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0XHRcdFx0aWYgKGkgPT09IGluZGV4KSB7XG5cdFx0XHRcdFx0dGhpcy5zbmFwc1tpXS5jbGFzc0xpc3QuYWRkKENMQVNTX0FDVElWRSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dGhpcy5zbmFwc1tpXS5jbGFzc0xpc3QucmVtb3ZlKENMQVNTX0FDVElWRSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHRoaXMuc2Nyb2xsVG8odGhpcy5jdXJyZW50UGFnZS54LCAwLCB0aGlzLm9wdGlvbnMuc2Nyb2xsVGltZSk7XG5cdFx0fSxcblx0XHRfbmVhcmVzdFNuYXA6IGZ1bmN0aW9uKHgpIHtcblx0XHRcdGlmICghdGhpcy5wYWdlcy5sZW5ndGgpIHtcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHR4OiAwLFxuXHRcdFx0XHRcdHBhZ2VYOiAwXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cdFx0XHR2YXIgaSA9IDA7XG5cdFx0XHR2YXIgbGVuZ3RoID0gdGhpcy5wYWdlcy5sZW5ndGg7XG5cdFx0XHRpZiAoeCA+IDApIHtcblx0XHRcdFx0eCA9IDA7XG5cdFx0XHR9IGVsc2UgaWYgKHggPCB0aGlzLm1heFNjcm9sbFgpIHtcblx0XHRcdFx0eCA9IHRoaXMubWF4U2Nyb2xsWDtcblx0XHRcdH1cblx0XHRcdGZvciAoOyBpIDwgbGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dmFyIG5lYXJlc3RYID0gdGhpcy5kaXJlY3Rpb24gPT09ICdsZWZ0JyA/IHRoaXMucGFnZXNbaV1bMF0ubGVmdFggOiB0aGlzLnBhZ2VzW2ldWzBdLnJpZ2h0WDtcblx0XHRcdFx0aWYgKHggPj0gbmVhcmVzdFgpIHtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy5wYWdlc1tpXVswXTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0eDogMCxcblx0XHRcdFx0cGFnZVg6IDBcblx0XHRcdH07XG5cdFx0fSxcblx0XHRfaW5pdEV2ZW50OiBmdW5jdGlvbihkZXRhY2gpIHtcblx0XHRcdHZhciBhY3Rpb24gPSBkZXRhY2ggPyAncmVtb3ZlRXZlbnRMaXN0ZW5lcicgOiAnYWRkRXZlbnRMaXN0ZW5lcic7XG5cdFx0XHR3aW5kb3dbYWN0aW9uXSgnb3JpZW50YXRpb25jaGFuZ2UnLCB0aGlzKTtcblx0XHRcdHdpbmRvd1thY3Rpb25dKCdyZXNpemUnLCB0aGlzKTtcblxuXHRcdFx0dGhpcy5zY3JvbGxlclthY3Rpb25dKCd3ZWJraXRUcmFuc2l0aW9uRW5kJywgdGhpcyk7XG5cblx0XHRcdHRoaXMud3JhcHBlclthY3Rpb25dKCQuRVZFTlRfU1RBUlQsIHRoaXMpO1xuXHRcdFx0dGhpcy53cmFwcGVyW2FjdGlvbl0oJC5FVkVOVF9DQU5DRUwsIHRoaXMpO1xuXHRcdFx0dGhpcy53cmFwcGVyW2FjdGlvbl0oJC5FVkVOVF9FTkQsIHRoaXMpO1xuXHRcdFx0dGhpcy53cmFwcGVyW2FjdGlvbl0oJ2RyYWcnLCB0aGlzKTtcblx0XHRcdHRoaXMud3JhcHBlclthY3Rpb25dKCdkcmFnZW5kJywgdGhpcyk7XG5cdFx0XHR0aGlzLndyYXBwZXJbYWN0aW9uXSgnZmxpY2snLCB0aGlzKTtcblx0XHRcdHRoaXMud3JhcHBlclthY3Rpb25dKCdzY3JvbGxlbmQnLCB0aGlzKTtcblx0XHRcdGlmICh0aGlzLm9wdGlvbnMuc2Nyb2xsWCkge1xuXHRcdFx0XHR0aGlzLndyYXBwZXJbYWN0aW9uXSgnc3dpcGVyaWdodCcsIHRoaXMpO1xuXHRcdFx0fVxuXHRcdFx0dmFyIHNlZ21lbnRlZENvbnRyb2wgPSB0aGlzLndyYXBwZXIucXVlcnlTZWxlY3RvcignLm11aS1zZWdtZW50ZWQtY29udHJvbCcpO1xuXHRcdFx0aWYgKHNlZ21lbnRlZENvbnRyb2wpIHsgLy/pnaDvvIzov5nkuKpidWfmjpLmn6XkuobkuIDkuIvljYjvvIzpmLvmraJoYXNo6Lez6L2s77yM5LiA5pemaGFzaOi3s+i9rOS8muWvvOiHtOWPr+aLluaLvemAiemhueWNoeeahHRhYuS4jeingVxuXHRcdFx0XHRtdWkoc2VnbWVudGVkQ29udHJvbClbZGV0YWNoID8gJ29mZicgOiAnb24nXSgnY2xpY2snLCAnYScsICQucHJldmVudERlZmF1bHQpO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLndyYXBwZXJbYWN0aW9uXSgnc2Nyb2xsc3RhcnQnLCB0aGlzKTtcblx0XHRcdHRoaXMud3JhcHBlclthY3Rpb25dKCdyZWZyZXNoJywgdGhpcyk7XG5cdFx0fSxcblx0XHRfaGFuZGxlSW5kaWNhdG9yU2Nyb2xsZW5kOiBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMuaW5kaWNhdG9ycy5tYXAoZnVuY3Rpb24oaW5kaWNhdG9yKSB7XG5cdFx0XHRcdGluZGljYXRvci5mYWRlKCk7XG5cdFx0XHR9KTtcblx0XHR9LFxuXHRcdF9oYW5kbGVJbmRpY2F0b3JTY3JvbGxzdGFydDogZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLmluZGljYXRvcnMubWFwKGZ1bmN0aW9uKGluZGljYXRvcikge1xuXHRcdFx0XHRpbmRpY2F0b3IuZmFkZSgxKTtcblx0XHRcdH0pO1xuXHRcdH0sXG5cdFx0X2hhbmRsZUluZGljYXRvclJlZnJlc2g6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5pbmRpY2F0b3JzLm1hcChmdW5jdGlvbihpbmRpY2F0b3IpIHtcblx0XHRcdFx0aW5kaWNhdG9yLnJlZnJlc2goKTtcblx0XHRcdH0pO1xuXHRcdH0sXG5cdFx0aGFuZGxlRXZlbnQ6IGZ1bmN0aW9uKGUpIHtcblx0XHRcdGlmICh0aGlzLnN0b3BwZWQpIHtcblx0XHRcdFx0dGhpcy5yZXNldFBvc2l0aW9uKCk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0c3dpdGNoIChlLnR5cGUpIHtcblx0XHRcdFx0Y2FzZSAkLkVWRU5UX1NUQVJUOlxuXHRcdFx0XHRcdHRoaXMuX3N0YXJ0KGUpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdkcmFnJzpcblx0XHRcdFx0XHR0aGlzLm9wdGlvbnMuc3RvcFByb3BhZ2F0aW9uICYmIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0dGhpcy5fZHJhZyhlKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZHJhZ2VuZCc6XG5cdFx0XHRcdGNhc2UgJ2ZsaWNrJzpcblx0XHRcdFx0XHR0aGlzLm9wdGlvbnMuc3RvcFByb3BhZ2F0aW9uICYmIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0dGhpcy5fZmxpY2soZSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJC5FVkVOVF9DQU5DRUw6XG5cdFx0XHRcdGNhc2UgJC5FVkVOVF9FTkQ6XG5cdFx0XHRcdFx0dGhpcy5fZW5kKGUpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICd3ZWJraXRUcmFuc2l0aW9uRW5kJzpcblx0XHRcdFx0XHR0aGlzLnRyYW5zaXRpb25UaW1lciAmJiB0aGlzLnRyYW5zaXRpb25UaW1lci5jYW5jZWwoKTtcblx0XHRcdFx0XHR0aGlzLl90cmFuc2l0aW9uRW5kKGUpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdzY3JvbGxzdGFydCc6XG5cdFx0XHRcdFx0dGhpcy5faGFuZGxlSW5kaWNhdG9yU2Nyb2xsc3RhcnQoZSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ3Njcm9sbGVuZCc6XG5cdFx0XHRcdFx0dGhpcy5faGFuZGxlSW5kaWNhdG9yU2Nyb2xsZW5kKGUpO1xuXHRcdFx0XHRcdHRoaXMuX3Njcm9sbGVuZChlKTtcblx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdvcmllbnRhdGlvbmNoYW5nZSc6XG5cdFx0XHRcdGNhc2UgJ3Jlc2l6ZSc6XG5cdFx0XHRcdFx0dGhpcy5fcmVzaXplKCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ3N3aXBlcmlnaHQnOlxuXHRcdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ3JlZnJlc2gnOlxuXHRcdFx0XHRcdHRoaXMuX2hhbmRsZUluZGljYXRvclJlZnJlc2goZSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdH1cblx0XHR9LFxuXHRcdF9zdGFydDogZnVuY3Rpb24oZSkge1xuXHRcdFx0dGhpcy5tb3ZlZCA9IHRoaXMubmVlZFJlc2V0ID0gZmFsc2U7XG5cdFx0XHR0aGlzLl90cmFuc2l0aW9uVGltZSgpO1xuXHRcdFx0aWYgKHRoaXMuaXNJblRyYW5zaXRpb24pIHtcblx0XHRcdFx0dGhpcy5uZWVkUmVzZXQgPSB0cnVlO1xuXHRcdFx0XHR0aGlzLmlzSW5UcmFuc2l0aW9uID0gZmFsc2U7XG5cdFx0XHRcdHZhciBwb3MgPSAkLnBhcnNlVHJhbnNsYXRlTWF0cml4KCQuZ2V0U3R5bGVzKHRoaXMuc2Nyb2xsZXIsICd3ZWJraXRUcmFuc2Zvcm0nKSk7XG5cdFx0XHRcdHRoaXMuc2V0VHJhbnNsYXRlKE1hdGgucm91bmQocG9zLngpLCBNYXRoLnJvdW5kKHBvcy55KSk7XG5cdFx0XHRcdC8vXHRcdFx0XHR0aGlzLnJlc2V0UG9zaXRpb24oKTsgLy9yZXNldFxuXHRcdFx0XHQkLnRyaWdnZXIodGhpcy5zY3JvbGxlciwgJ3Njcm9sbGVuZCcsIHRoaXMpO1xuXHRcdFx0XHQvL1x0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5yZUxheW91dCgpO1xuXHRcdFx0JC50cmlnZ2VyKHRoaXMuc2Nyb2xsZXIsICdiZWZvcmVzY3JvbGxzdGFydCcsIHRoaXMpO1xuXHRcdH0sXG5cdFx0X2dldERpcmVjdGlvbkJ5QW5nbGU6IGZ1bmN0aW9uKGFuZ2xlKSB7XG5cdFx0XHRpZiAoYW5nbGUgPCAtODAgJiYgYW5nbGUgPiAtMTAwKSB7XG5cdFx0XHRcdHJldHVybiAndXAnO1xuXHRcdFx0fSBlbHNlIGlmIChhbmdsZSA+PSA4MCAmJiBhbmdsZSA8IDEwMCkge1xuXHRcdFx0XHRyZXR1cm4gJ2Rvd24nO1xuXHRcdFx0fSBlbHNlIGlmIChhbmdsZSA+PSAxNzAgfHwgYW5nbGUgPD0gLTE3MCkge1xuXHRcdFx0XHRyZXR1cm4gJ2xlZnQnO1xuXHRcdFx0fSBlbHNlIGlmIChhbmdsZSA+PSAtMzUgJiYgYW5nbGUgPD0gMTApIHtcblx0XHRcdFx0cmV0dXJuICdyaWdodCc7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9LFxuXHRcdF9kcmFnOiBmdW5jdGlvbihlKSB7XG5cdFx0XHQvL1x0XHRcdGlmICh0aGlzLm5lZWRSZXNldCkge1xuXHRcdFx0Ly9cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7IC8vZGlzYWJsZSBwYXJlbnQgZHJhZyhuZXN0ZWQgc2Nyb2xsZXIpXG5cdFx0XHQvL1x0XHRcdFx0cmV0dXJuO1xuXHRcdFx0Ly9cdFx0XHR9XG5cdFx0XHR2YXIgZGV0YWlsID0gZS5kZXRhaWw7XG5cdFx0XHRpZiAodGhpcy5vcHRpb25zLnNjcm9sbFkgfHwgZGV0YWlsLmRpcmVjdGlvbiA9PT0gJ3VwJyB8fCBkZXRhaWwuZGlyZWN0aW9uID09PSAnZG93bicpIHsgLy/lpoLmnpzmmK/nq5blkJHmu5rliqjmiJbmiYvlir/mlrnlkJHmmK/kuIrmiJbkuItcblx0XHRcdFx0Ly9pb3M4IGhhY2tcblx0XHRcdFx0aWYgKCQub3MuaW9zICYmIHBhcnNlRmxvYXQoJC5vcy52ZXJzaW9uKSA+PSA4KSB7IC8v5aSad2Vidmlld+aXtu+8jOemu+W8gOW9k+WJjXdlYnZpZXfkvJrlr7zoh7TlkI7nu610b3VjaOS6i+S7tuS4jeinpuWPkVxuXHRcdFx0XHRcdHZhciBjbGllbnRZID0gZGV0YWlsLmdlc3R1cmUudG91Y2hlc1swXS5jbGllbnRZO1xuXHRcdFx0XHRcdC8v5LiL5ouJ5Yi35pawIG9yIOS4iuaLieWKoOi9vVxuXHRcdFx0XHRcdGlmICgoY2xpZW50WSArIDEwKSA+IHdpbmRvdy5pbm5lckhlaWdodCB8fCBjbGllbnRZIDwgMTApIHtcblx0XHRcdFx0XHRcdHRoaXMucmVzZXRQb3NpdGlvbih0aGlzLm9wdGlvbnMuYm91bmNlVGltZSk7XG5cdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHR2YXIgaXNQcmV2ZW50RGVmYXVsdCA9IGlzUmV0dXJuID0gZmFsc2U7XG5cdFx0XHR2YXIgZGlyZWN0aW9uID0gdGhpcy5fZ2V0RGlyZWN0aW9uQnlBbmdsZShkZXRhaWwuYW5nbGUpO1xuXHRcdFx0aWYgKGRldGFpbC5kaXJlY3Rpb24gPT09ICdsZWZ0JyB8fCBkZXRhaWwuZGlyZWN0aW9uID09PSAncmlnaHQnKSB7XG5cdFx0XHRcdGlmICh0aGlzLm9wdGlvbnMuc2Nyb2xsWCkge1xuXHRcdFx0XHRcdGlzUHJldmVudERlZmF1bHQgPSB0cnVlO1xuXHRcdFx0XHRcdGlmICghdGhpcy5tb3ZlZCkgeyAvL+ivhuWIq+inkuW6pijor6Xop5Lluqblr7zoh7Tova7mkq3kuI3ngbXmlY8pXG5cdFx0XHRcdFx0XHQvL1x0XHRcdFx0XHRcdGlmIChkaXJlY3Rpb24gIT09ICdsZWZ0JyAmJiBkaXJlY3Rpb24gIT09ICdyaWdodCcpIHtcblx0XHRcdFx0XHRcdC8vXHRcdFx0XHRcdFx0XHRpc1JldHVybiA9IHRydWU7XG5cdFx0XHRcdFx0XHQvL1x0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHQkLmdlc3R1cmVzLnNlc3Npb24ubG9ja0RpcmVjdGlvbiA9IHRydWU7IC8v6ZSB5a6a5pa55ZCRXG5cdFx0XHRcdFx0XHQkLmdlc3R1cmVzLnNlc3Npb24uc3RhcnREaXJlY3Rpb24gPSBkZXRhaWwuZGlyZWN0aW9uO1xuXHRcdFx0XHRcdFx0Ly9cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2UgaWYgKHRoaXMub3B0aW9ucy5zY3JvbGxZICYmICF0aGlzLm1vdmVkKSB7XG5cdFx0XHRcdFx0aXNSZXR1cm4gPSB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKGRldGFpbC5kaXJlY3Rpb24gPT09ICd1cCcgfHwgZGV0YWlsLmRpcmVjdGlvbiA9PT0gJ2Rvd24nKSB7XG5cdFx0XHRcdGlmICh0aGlzLm9wdGlvbnMuc2Nyb2xsWSkge1xuXHRcdFx0XHRcdGlzUHJldmVudERlZmF1bHQgPSB0cnVlO1xuXHRcdFx0XHRcdC8vXHRcdFx0XHRcdGlmICghdGhpcy5tb3ZlZCkgeyAvL+ivhuWIq+inkuW6piznq5blkJHmu5rliqjkvLzkuY7msqHlv4XopoHov5vooYzlsI/op5Lluqbpqozor4Fcblx0XHRcdFx0XHQvL1x0XHRcdFx0XHRcdGlmIChkaXJlY3Rpb24gIT09ICd1cCcgJiYgZGlyZWN0aW9uICE9PSAnZG93bicpIHtcblx0XHRcdFx0XHQvL1x0XHRcdFx0XHRcdFx0aXNSZXR1cm4gPSB0cnVlO1xuXHRcdFx0XHRcdC8vXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdC8vXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAoIXRoaXMubW92ZWQpIHtcblx0XHRcdFx0XHRcdCQuZ2VzdHVyZXMuc2Vzc2lvbi5sb2NrRGlyZWN0aW9uID0gdHJ1ZTsgLy/plIHlrprmlrnlkJFcblx0XHRcdFx0XHRcdCQuZ2VzdHVyZXMuc2Vzc2lvbi5zdGFydERpcmVjdGlvbiA9IGRldGFpbC5kaXJlY3Rpb247XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2UgaWYgKHRoaXMub3B0aW9ucy5zY3JvbGxYICYmICF0aGlzLm1vdmVkKSB7XG5cdFx0XHRcdFx0aXNSZXR1cm4gPSB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpc1JldHVybiA9IHRydWU7XG5cdFx0XHR9XG5cdFx0XHRpZiAodGhpcy5tb3ZlZCB8fCBpc1ByZXZlbnREZWZhdWx0KSB7XG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7IC8v6Zi75q2i5YaS5rOhKHNjcm9sbOexu+W1jOWllylcblx0XHRcdFx0ZGV0YWlsLmdlc3R1cmUgJiYgZGV0YWlsLmdlc3R1cmUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdH1cblx0XHRcdGlmIChpc1JldHVybikgeyAvL+emgeatoumdnuazleaWueWQkea7muWKqFxuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHRpZiAoIXRoaXMubW92ZWQpIHtcblx0XHRcdFx0JC50cmlnZ2VyKHRoaXMuc2Nyb2xsZXIsICdzY3JvbGxzdGFydCcsIHRoaXMpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTsgLy9tb3Zl5pyf6Ze06Zi75q2i5YaS5rOhKHNjcm9sbOW1jOWllylcblx0XHRcdH1cblx0XHRcdHZhciBkZWx0YVggPSAwO1xuXHRcdFx0dmFyIGRlbHRhWSA9IDA7XG5cdFx0XHRpZiAoIXRoaXMubW92ZWQpIHsgLy9zdGFydFxuXHRcdFx0XHRkZWx0YVggPSBkZXRhaWwuZGVsdGFYO1xuXHRcdFx0XHRkZWx0YVkgPSBkZXRhaWwuZGVsdGFZO1xuXHRcdFx0fSBlbHNlIHsgLy9tb3ZlXG5cdFx0XHRcdGRlbHRhWCA9IGRldGFpbC5kZWx0YVggLSAkLmdlc3R1cmVzLnNlc3Npb24ucHJldlRvdWNoLmRlbHRhWDtcblx0XHRcdFx0ZGVsdGFZID0gZGV0YWlsLmRlbHRhWSAtICQuZ2VzdHVyZXMuc2Vzc2lvbi5wcmV2VG91Y2guZGVsdGFZO1xuXHRcdFx0fVxuXHRcdFx0dmFyIGFic0RlbHRhWCA9IE1hdGguYWJzKGRldGFpbC5kZWx0YVgpO1xuXHRcdFx0dmFyIGFic0RlbHRhWSA9IE1hdGguYWJzKGRldGFpbC5kZWx0YVkpO1xuXHRcdFx0aWYgKGFic0RlbHRhWCA+IGFic0RlbHRhWSArIHRoaXMub3B0aW9ucy5kaXJlY3Rpb25Mb2NrVGhyZXNob2xkKSB7XG5cdFx0XHRcdGRlbHRhWSA9IDA7XG5cdFx0XHR9IGVsc2UgaWYgKGFic0RlbHRhWSA+PSBhYnNEZWx0YVggKyB0aGlzLm9wdGlvbnMuZGlyZWN0aW9uTG9ja1RocmVzaG9sZCkge1xuXHRcdFx0XHRkZWx0YVggPSAwO1xuXHRcdFx0fVxuXG5cdFx0XHRkZWx0YVggPSB0aGlzLmhhc0hvcml6b250YWxTY3JvbGwgPyBkZWx0YVggOiAwO1xuXHRcdFx0ZGVsdGFZID0gdGhpcy5oYXNWZXJ0aWNhbFNjcm9sbCA/IGRlbHRhWSA6IDA7XG5cdFx0XHR2YXIgbmV3WCA9IHRoaXMueCArIGRlbHRhWDtcblx0XHRcdHZhciBuZXdZID0gdGhpcy55ICsgZGVsdGFZO1xuXHRcdFx0Ly8gU2xvdyBkb3duIGlmIG91dHNpZGUgb2YgdGhlIGJvdW5kYXJpZXNcblx0XHRcdGlmIChuZXdYID4gMCB8fCBuZXdYIDwgdGhpcy5tYXhTY3JvbGxYKSB7XG5cdFx0XHRcdG5ld1ggPSB0aGlzLm9wdGlvbnMuYm91bmNlID8gdGhpcy54ICsgZGVsdGFYIC8gMyA6IG5ld1ggPiAwID8gMCA6IHRoaXMubWF4U2Nyb2xsWDtcblx0XHRcdH1cblx0XHRcdGlmIChuZXdZID4gMCB8fCBuZXdZIDwgdGhpcy5tYXhTY3JvbGxZKSB7XG5cdFx0XHRcdG5ld1kgPSB0aGlzLm9wdGlvbnMuYm91bmNlID8gdGhpcy55ICsgZGVsdGFZIC8gMyA6IG5ld1kgPiAwID8gMCA6IHRoaXMubWF4U2Nyb2xsWTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCF0aGlzLnJlcXVlc3RBbmltYXRpb25GcmFtZSkge1xuXHRcdFx0XHR0aGlzLl91cGRhdGVUcmFuc2xhdGUoKTtcblx0XHRcdH1cblx0XHRcdHRoaXMuZGlyZWN0aW9uID0gZGV0YWlsLmRlbHRhWCA+IDAgPyAncmlnaHQnIDogJ2xlZnQnO1xuXHRcdFx0dGhpcy5tb3ZlZCA9IHRydWU7XG5cdFx0XHR0aGlzLnggPSBuZXdYO1xuXHRcdFx0dGhpcy55ID0gbmV3WTtcblx0XHRcdCQudHJpZ2dlcih0aGlzLnNjcm9sbGVyLCAnc2Nyb2xsJywgdGhpcyk7XG5cdFx0fSxcblx0XHRfZmxpY2s6IGZ1bmN0aW9uKGUpIHtcblx0XHRcdC8vXHRcdFx0aWYgKCF0aGlzLm1vdmVkIHx8IHRoaXMubmVlZFJlc2V0KSB7XG5cdFx0XHQvL1x0XHRcdFx0cmV0dXJuO1xuXHRcdFx0Ly9cdFx0XHR9XG5cdFx0XHRpZiAoIXRoaXMubW92ZWQpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdHZhciBkZXRhaWwgPSBlLmRldGFpbDtcblx0XHRcdHRoaXMuX2NsZWFyUmVxdWVzdEFuaW1hdGlvbkZyYW1lKCk7XG5cdFx0XHRpZiAoZS50eXBlID09PSAnZHJhZ2VuZCcgJiYgZGV0YWlsLmZsaWNrKSB7IC8vZHJhZ2VuZFxuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdHZhciBuZXdYID0gTWF0aC5yb3VuZCh0aGlzLngpO1xuXHRcdFx0dmFyIG5ld1kgPSBNYXRoLnJvdW5kKHRoaXMueSk7XG5cblx0XHRcdHRoaXMuaXNJblRyYW5zaXRpb24gPSBmYWxzZTtcblx0XHRcdC8vIHJlc2V0IGlmIHdlIGFyZSBvdXRzaWRlIG9mIHRoZSBib3VuZGFyaWVzXG5cdFx0XHRpZiAodGhpcy5yZXNldFBvc2l0aW9uKHRoaXMub3B0aW9ucy5ib3VuY2VUaW1lKSkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuc2Nyb2xsVG8obmV3WCwgbmV3WSk7IC8vIGVuc3VyZXMgdGhhdCB0aGUgbGFzdCBwb3NpdGlvbiBpcyByb3VuZGVkXG5cblx0XHRcdGlmIChlLnR5cGUgPT09ICdkcmFnZW5kJykgeyAvL2RyYWdlbmRcblx0XHRcdFx0JC50cmlnZ2VyKHRoaXMuc2Nyb2xsZXIsICdzY3JvbGxlbmQnLCB0aGlzKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0dmFyIHRpbWUgPSAwO1xuXHRcdFx0dmFyIGVhc2luZyA9ICcnO1xuXHRcdFx0Ly8gc3RhcnQgbW9tZW50dW0gYW5pbWF0aW9uIGlmIG5lZWRlZFxuXHRcdFx0aWYgKHRoaXMub3B0aW9ucy5tb21lbnR1bSAmJiBkZXRhaWwuZmxpY2tUaW1lIDwgMzAwKSB7XG5cdFx0XHRcdG1vbWVudHVtWCA9IHRoaXMuaGFzSG9yaXpvbnRhbFNjcm9sbCA/IHRoaXMuX21vbWVudHVtKHRoaXMueCwgZGV0YWlsLmZsaWNrRGlzdGFuY2VYLCBkZXRhaWwuZmxpY2tUaW1lLCB0aGlzLm1heFNjcm9sbFgsIHRoaXMub3B0aW9ucy5ib3VuY2UgPyB0aGlzLndyYXBwZXJXaWR0aCA6IDAsIHRoaXMub3B0aW9ucy5kZWNlbGVyYXRpb24pIDoge1xuXHRcdFx0XHRcdGRlc3RpbmF0aW9uOiBuZXdYLFxuXHRcdFx0XHRcdGR1cmF0aW9uOiAwXG5cdFx0XHRcdH07XG5cdFx0XHRcdG1vbWVudHVtWSA9IHRoaXMuaGFzVmVydGljYWxTY3JvbGwgPyB0aGlzLl9tb21lbnR1bSh0aGlzLnksIGRldGFpbC5mbGlja0Rpc3RhbmNlWSwgZGV0YWlsLmZsaWNrVGltZSwgdGhpcy5tYXhTY3JvbGxZLCB0aGlzLm9wdGlvbnMuYm91bmNlID8gdGhpcy53cmFwcGVySGVpZ2h0IDogMCwgdGhpcy5vcHRpb25zLmRlY2VsZXJhdGlvbikgOiB7XG5cdFx0XHRcdFx0ZGVzdGluYXRpb246IG5ld1ksXG5cdFx0XHRcdFx0ZHVyYXRpb246IDBcblx0XHRcdFx0fTtcblx0XHRcdFx0bmV3WCA9IG1vbWVudHVtWC5kZXN0aW5hdGlvbjtcblx0XHRcdFx0bmV3WSA9IG1vbWVudHVtWS5kZXN0aW5hdGlvbjtcblx0XHRcdFx0dGltZSA9IE1hdGgubWF4KG1vbWVudHVtWC5kdXJhdGlvbiwgbW9tZW50dW1ZLmR1cmF0aW9uKTtcblx0XHRcdFx0dGhpcy5pc0luVHJhbnNpdGlvbiA9IHRydWU7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChuZXdYICE9IHRoaXMueCB8fCBuZXdZICE9IHRoaXMueSkge1xuXHRcdFx0XHRpZiAobmV3WCA+IDAgfHwgbmV3WCA8IHRoaXMubWF4U2Nyb2xsWCB8fCBuZXdZID4gMCB8fCBuZXdZIDwgdGhpcy5tYXhTY3JvbGxZKSB7XG5cdFx0XHRcdFx0ZWFzaW5nID0gZWFzZS5xdWFkcmF0aWM7XG5cdFx0XHRcdH1cblx0XHRcdFx0dGhpcy5zY3JvbGxUbyhuZXdYLCBuZXdZLCB0aW1lLCBlYXNpbmcpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdCQudHJpZ2dlcih0aGlzLnNjcm9sbGVyLCAnc2Nyb2xsZW5kJywgdGhpcyk7XG5cdFx0XHQvL1x0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0fSxcblx0XHRfZW5kOiBmdW5jdGlvbihlKSB7XG5cdFx0XHR0aGlzLm5lZWRSZXNldCA9IGZhbHNlO1xuXHRcdFx0aWYgKCghdGhpcy5tb3ZlZCAmJiB0aGlzLm5lZWRSZXNldCkgfHwgZS50eXBlID09PSAkLkVWRU5UX0NBTkNFTCkge1xuXHRcdFx0XHR0aGlzLnJlc2V0UG9zaXRpb24oKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdF90cmFuc2l0aW9uRW5kOiBmdW5jdGlvbihlKSB7XG5cdFx0XHRpZiAoZS50YXJnZXQgIT0gdGhpcy5zY3JvbGxlciB8fCAhdGhpcy5pc0luVHJhbnNpdGlvbikge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHR0aGlzLl90cmFuc2l0aW9uVGltZSgpO1xuXHRcdFx0aWYgKCF0aGlzLnJlc2V0UG9zaXRpb24odGhpcy5vcHRpb25zLmJvdW5jZVRpbWUpKSB7XG5cdFx0XHRcdHRoaXMuaXNJblRyYW5zaXRpb24gPSBmYWxzZTtcblx0XHRcdFx0JC50cmlnZ2VyKHRoaXMuc2Nyb2xsZXIsICdzY3JvbGxlbmQnLCB0aGlzKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdF9zY3JvbGxlbmQ6IGZ1bmN0aW9uKGUpIHtcblx0XHRcdGlmICgodGhpcy55ID09PSAwICYmIHRoaXMubWF4U2Nyb2xsWSA9PT0gMCkgfHwgKE1hdGguYWJzKHRoaXMueSkgPiAwICYmIHRoaXMueSA8PSB0aGlzLm1heFNjcm9sbFkpKSB7XG5cdFx0XHRcdCQudHJpZ2dlcih0aGlzLnNjcm9sbGVyLCAnc2Nyb2xsYm90dG9tJywgdGhpcyk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRfcmVzaXplOiBmdW5jdGlvbigpIHtcblx0XHRcdHZhciB0aGF0ID0gdGhpcztcblx0XHRcdGNsZWFyVGltZW91dCh0aGF0LnJlc2l6ZVRpbWVvdXQpO1xuXHRcdFx0dGhhdC5yZXNpemVUaW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0dGhhdC5yZWZyZXNoKCk7XG5cdFx0XHR9LCB0aGF0Lm9wdGlvbnMucmVzaXplUG9sbGluZyk7XG5cdFx0fSxcblx0XHRfdHJhbnNpdGlvblRpbWU6IGZ1bmN0aW9uKHRpbWUpIHtcblx0XHRcdHRpbWUgPSB0aW1lIHx8IDA7XG5cdFx0XHR0aGlzLnNjcm9sbGVyU3R5bGVbJ3dlYmtpdFRyYW5zaXRpb25EdXJhdGlvbiddID0gdGltZSArICdtcyc7XG5cdFx0XHRpZiAodGhpcy5wYXJhbGxheEVsZW1lbnQgJiYgdGhpcy5vcHRpb25zLnNjcm9sbFkpIHsgLy/nm67liY3ku4XmlK/mjIHnq5blkJHop4blt67mlYjmnpxcblx0XHRcdFx0dGhpcy5wYXJhbGxheFN0eWxlWyd3ZWJraXRUcmFuc2l0aW9uRHVyYXRpb24nXSA9IHRpbWUgKyAnbXMnO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHRoaXMub3B0aW9ucy5maXhlZEJhZEFuZG9yaWQgJiYgIXRpbWUgJiYgJC5vcy5pc0JhZEFuZHJvaWQpIHtcblx0XHRcdFx0dGhpcy5zY3JvbGxlclN0eWxlWyd3ZWJraXRUcmFuc2l0aW9uRHVyYXRpb24nXSA9ICcwLjAwMXMnO1xuXHRcdFx0XHRpZiAodGhpcy5wYXJhbGxheEVsZW1lbnQgJiYgdGhpcy5vcHRpb25zLnNjcm9sbFkpIHsgLy/nm67liY3ku4XmlK/mjIHnq5blkJHop4blt67mlYjmnpxcblx0XHRcdFx0XHR0aGlzLnBhcmFsbGF4U3R5bGVbJ3dlYmtpdFRyYW5zaXRpb25EdXJhdGlvbiddID0gJzAuMDAxcyc7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGlmICh0aGlzLmluZGljYXRvcnMpIHtcblx0XHRcdFx0Zm9yICh2YXIgaSA9IHRoaXMuaW5kaWNhdG9ycy5sZW5ndGg7IGktLTspIHtcblx0XHRcdFx0XHR0aGlzLmluZGljYXRvcnNbaV0udHJhbnNpdGlvblRpbWUodGltZSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGlmICh0aW1lKSB7IC8v6Ieq5a6a5LmJdGltZXLvvIzkv53or4F3ZWJraXRUcmFuc2l0aW9uRW5k5aeL57uI6Kem5Y+RXG5cdFx0XHRcdHRoaXMudHJhbnNpdGlvblRpbWVyICYmIHRoaXMudHJhbnNpdGlvblRpbWVyLmNhbmNlbCgpO1xuXHRcdFx0XHR0aGlzLnRyYW5zaXRpb25UaW1lciA9ICQubGF0ZXIoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0JC50cmlnZ2VyKHRoaXMuc2Nyb2xsZXIsICd3ZWJraXRUcmFuc2l0aW9uRW5kJyk7XG5cdFx0XHRcdH0sIHRpbWUgKyAxMDAsIHRoaXMpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0X3RyYW5zaXRpb25UaW1pbmdGdW5jdGlvbjogZnVuY3Rpb24oZWFzaW5nKSB7XG5cdFx0XHR0aGlzLnNjcm9sbGVyU3R5bGVbJ3dlYmtpdFRyYW5zaXRpb25UaW1pbmdGdW5jdGlvbiddID0gZWFzaW5nO1xuXHRcdFx0aWYgKHRoaXMucGFyYWxsYXhFbGVtZW50ICYmIHRoaXMub3B0aW9ucy5zY3JvbGxZKSB7IC8v55uu5YmN5LuF5pSv5oyB56uW5ZCR6KeG5beu5pWI5p6cXG5cdFx0XHRcdHRoaXMucGFyYWxsYXhTdHlsZVsnd2Via2l0VHJhbnNpdGlvbkR1cmF0aW9uJ10gPSBlYXNpbmc7XG5cdFx0XHR9XG5cdFx0XHRpZiAodGhpcy5pbmRpY2F0b3JzKSB7XG5cdFx0XHRcdGZvciAodmFyIGkgPSB0aGlzLmluZGljYXRvcnMubGVuZ3RoOyBpLS07KSB7XG5cdFx0XHRcdFx0dGhpcy5pbmRpY2F0b3JzW2ldLnRyYW5zaXRpb25UaW1pbmdGdW5jdGlvbihlYXNpbmcpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRfdHJhbnNsYXRlOiBmdW5jdGlvbih4LCB5KSB7XG5cdFx0XHR0aGlzLnggPSB4O1xuXHRcdFx0dGhpcy55ID0geTtcblx0XHR9LFxuXHRcdF9jbGVhclJlcXVlc3RBbmltYXRpb25GcmFtZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAodGhpcy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUpIHtcblx0XHRcdFx0Y2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUpO1xuXHRcdFx0XHR0aGlzLnJlcXVlc3RBbmltYXRpb25GcmFtZSA9IG51bGw7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRfdXBkYXRlVHJhbnNsYXRlOiBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdGlmIChzZWxmLnggIT09IHNlbGYubGFzdFggfHwgc2VsZi55ICE9PSBzZWxmLmxhc3RZKSB7XG5cdFx0XHRcdHNlbGYuc2V0VHJhbnNsYXRlKHNlbGYueCwgc2VsZi55KTtcblx0XHRcdH1cblx0XHRcdHNlbGYucmVxdWVzdEFuaW1hdGlvbkZyYW1lID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRzZWxmLl91cGRhdGVUcmFuc2xhdGUoKTtcblx0XHRcdH0pO1xuXHRcdH0sXG5cdFx0X2NyZWF0ZVNjcm9sbEJhcjogZnVuY3Rpb24oY2xhenopIHtcblx0XHRcdHZhciBzY3JvbGxiYXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHRcdHZhciBpbmRpY2F0b3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHRcdHNjcm9sbGJhci5jbGFzc05hbWUgPSBDTEFTU19TQ1JPTExCQVIgKyAnICcgKyBjbGF6ejtcblx0XHRcdGluZGljYXRvci5jbGFzc05hbWUgPSBDTEFTU19JTkRJQ0FUT1I7XG5cdFx0XHRzY3JvbGxiYXIuYXBwZW5kQ2hpbGQoaW5kaWNhdG9yKTtcblx0XHRcdGlmIChjbGF6eiA9PT0gQ0xBU1NfU0NST0xMQkFSX1ZFUlRJQ0FMKSB7XG5cdFx0XHRcdHRoaXMuc2Nyb2xsYmFyWSA9IHNjcm9sbGJhcjtcblx0XHRcdFx0dGhpcy5zY3JvbGxiYXJJbmRpY2F0b3JZID0gaW5kaWNhdG9yO1xuXHRcdFx0fSBlbHNlIGlmIChjbGF6eiA9PT0gQ0xBU1NfU0NST0xMQkFSX0hPUklaT05UQUwpIHtcblx0XHRcdFx0dGhpcy5zY3JvbGxiYXJYID0gc2Nyb2xsYmFyO1xuXHRcdFx0XHR0aGlzLnNjcm9sbGJhckluZGljYXRvclggPSBpbmRpY2F0b3I7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLndyYXBwZXIuYXBwZW5kQ2hpbGQoc2Nyb2xsYmFyKTtcblx0XHRcdHJldHVybiBzY3JvbGxiYXI7XG5cdFx0fSxcblx0XHRfcHJldmVudERlZmF1bHRFeGNlcHRpb246IGZ1bmN0aW9uKGVsLCBleGNlcHRpb25zKSB7XG5cdFx0XHRmb3IgKHZhciBpIGluIGV4Y2VwdGlvbnMpIHtcblx0XHRcdFx0aWYgKGV4Y2VwdGlvbnNbaV0udGVzdChlbFtpXSkpIHtcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH0sXG5cdFx0X3JlTGF5b3V0OiBmdW5jdGlvbigpIHtcblx0XHRcdGlmICghdGhpcy5oYXNIb3Jpem9udGFsU2Nyb2xsKSB7XG5cdFx0XHRcdHRoaXMubWF4U2Nyb2xsWCA9IDA7XG5cdFx0XHRcdHRoaXMuc2Nyb2xsZXJXaWR0aCA9IHRoaXMud3JhcHBlcldpZHRoO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIXRoaXMuaGFzVmVydGljYWxTY3JvbGwpIHtcblx0XHRcdFx0dGhpcy5tYXhTY3JvbGxZID0gMDtcblx0XHRcdFx0dGhpcy5zY3JvbGxlckhlaWdodCA9IHRoaXMud3JhcHBlckhlaWdodDtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5pbmRpY2F0b3JzLm1hcChmdW5jdGlvbihpbmRpY2F0b3IpIHtcblx0XHRcdFx0aW5kaWNhdG9yLnJlZnJlc2goKTtcblx0XHRcdH0pO1xuXG5cdFx0XHQvL+S7pemYsnNsaWRlcuexu+W1jOWll+S9v+eUqFxuXHRcdFx0aWYgKHRoaXMub3B0aW9ucy5zbmFwICYmIHR5cGVvZiB0aGlzLm9wdGlvbnMuc25hcCA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0dmFyIGl0ZW1zID0gdGhpcy5zY3JvbGxlci5xdWVyeVNlbGVjdG9yQWxsKHRoaXMub3B0aW9ucy5zbmFwKTtcblx0XHRcdFx0dGhpcy5pdGVtTGVuZ3RoID0gMDtcblx0XHRcdFx0dGhpcy5zbmFwcyA9IFtdO1xuXHRcdFx0XHRmb3IgKHZhciBpID0gMCwgbGVuID0gaXRlbXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0XHRcdFx0XHR2YXIgaXRlbSA9IGl0ZW1zW2ldO1xuXHRcdFx0XHRcdGlmIChpdGVtLnBhcmVudE5vZGUgPT09IHRoaXMuc2Nyb2xsZXIpIHtcblx0XHRcdFx0XHRcdHRoaXMuaXRlbUxlbmd0aCsrO1xuXHRcdFx0XHRcdFx0dGhpcy5zbmFwcy5wdXNoKGl0ZW0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHR0aGlzLl9pbml0U25hcCgpOyAvL+mcgOimgeavj+asoemDvV9pbml0U25hcOS5iOOAguWFtuWunmluaXTnmoTml7blgJnmiafooYzkuIDmrKHvvIzlkI7nu61yZXNpemXnmoTml7blgJnmiafooYzkuIDmrKHlsLHooYzkuoblkKcu5YWI6L+Z5LmI5YGa5ZCn77yM5aaC5p6c5b2x5ZON5oCn6IO977yM5YaN6LCD5pW0XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRfbW9tZW50dW06IGZ1bmN0aW9uKGN1cnJlbnQsIGRpc3RhbmNlLCB0aW1lLCBsb3dlck1hcmdpbiwgd3JhcHBlclNpemUsIGRlY2VsZXJhdGlvbikge1xuXHRcdFx0dmFyIHNwZWVkID0gcGFyc2VGbG9hdChNYXRoLmFicyhkaXN0YW5jZSkgLyB0aW1lKSxcblx0XHRcdFx0ZGVzdGluYXRpb24sXG5cdFx0XHRcdGR1cmF0aW9uO1xuXG5cdFx0XHRkZWNlbGVyYXRpb24gPSBkZWNlbGVyYXRpb24gPT09IHVuZGVmaW5lZCA/IDAuMDAwNiA6IGRlY2VsZXJhdGlvbjtcblx0XHRcdGRlc3RpbmF0aW9uID0gY3VycmVudCArIChzcGVlZCAqIHNwZWVkKSAvICgyICogZGVjZWxlcmF0aW9uKSAqIChkaXN0YW5jZSA8IDAgPyAtMSA6IDEpO1xuXHRcdFx0ZHVyYXRpb24gPSBzcGVlZCAvIGRlY2VsZXJhdGlvbjtcblx0XHRcdGlmIChkZXN0aW5hdGlvbiA8IGxvd2VyTWFyZ2luKSB7XG5cdFx0XHRcdGRlc3RpbmF0aW9uID0gd3JhcHBlclNpemUgPyBsb3dlck1hcmdpbiAtICh3cmFwcGVyU2l6ZSAvIDIuNSAqIChzcGVlZCAvIDgpKSA6IGxvd2VyTWFyZ2luO1xuXHRcdFx0XHRkaXN0YW5jZSA9IE1hdGguYWJzKGRlc3RpbmF0aW9uIC0gY3VycmVudCk7XG5cdFx0XHRcdGR1cmF0aW9uID0gZGlzdGFuY2UgLyBzcGVlZDtcblx0XHRcdH0gZWxzZSBpZiAoZGVzdGluYXRpb24gPiAwKSB7XG5cdFx0XHRcdGRlc3RpbmF0aW9uID0gd3JhcHBlclNpemUgPyB3cmFwcGVyU2l6ZSAvIDIuNSAqIChzcGVlZCAvIDgpIDogMDtcblx0XHRcdFx0ZGlzdGFuY2UgPSBNYXRoLmFicyhjdXJyZW50KSArIGRlc3RpbmF0aW9uO1xuXHRcdFx0XHRkdXJhdGlvbiA9IGRpc3RhbmNlIC8gc3BlZWQ7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdGRlc3RpbmF0aW9uOiBNYXRoLnJvdW5kKGRlc3RpbmF0aW9uKSxcblx0XHRcdFx0ZHVyYXRpb246IGR1cmF0aW9uXG5cdFx0XHR9O1xuXHRcdH0sXG5cdFx0X2dldFRyYW5zbGF0ZVN0cjogZnVuY3Rpb24oeCwgeSkge1xuXHRcdFx0aWYgKHRoaXMub3B0aW9ucy5oYXJkd2FyZUFjY2VsZXJhdGVkKSB7XG5cdFx0XHRcdHJldHVybiAndHJhbnNsYXRlM2QoJyArIHggKyAncHgsJyArIHkgKyAncHgsMHB4KSAnICsgdGhpcy50cmFuc2xhdGVaO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuICd0cmFuc2xhdGUoJyArIHggKyAncHgsJyArIHkgKyAncHgpICc7XG5cdFx0fSxcblx0XHQvL0FQSVxuXHRcdHNldFN0b3BwZWQ6IGZ1bmN0aW9uKHN0b3BwZWQpIHtcblx0XHRcdHRoaXMuc3RvcHBlZCA9ICEhc3RvcHBlZDtcblx0XHR9LFxuXHRcdHNldFRyYW5zbGF0ZTogZnVuY3Rpb24oeCwgeSkge1xuXHRcdFx0dGhpcy54ID0geDtcblx0XHRcdHRoaXMueSA9IHk7XG5cdFx0XHR0aGlzLnNjcm9sbGVyU3R5bGVbJ3dlYmtpdFRyYW5zZm9ybSddID0gdGhpcy5fZ2V0VHJhbnNsYXRlU3RyKHgsIHkpO1xuXHRcdFx0aWYgKHRoaXMucGFyYWxsYXhFbGVtZW50ICYmIHRoaXMub3B0aW9ucy5zY3JvbGxZKSB7IC8v55uu5YmN5LuF5pSv5oyB56uW5ZCR6KeG5beu5pWI5p6cXG5cdFx0XHRcdHZhciBwYXJhbGxheFkgPSB5ICogdGhpcy5vcHRpb25zLnBhcmFsbGF4UmF0aW87XG5cdFx0XHRcdHZhciBzY2FsZSA9IDEgKyBwYXJhbGxheFkgLyAoKHRoaXMucGFyYWxsYXhIZWlnaHQgLSBwYXJhbGxheFkpIC8gMik7XG5cdFx0XHRcdGlmIChzY2FsZSA+IDEpIHtcblx0XHRcdFx0XHR0aGlzLnBhcmFsbGF4SW1nU3R5bGVbJ29wYWNpdHknXSA9IDEgLSBwYXJhbGxheFkgLyAxMDAgKiB0aGlzLm9wdGlvbnMucGFyYWxsYXhSYXRpbztcblx0XHRcdFx0XHR0aGlzLnBhcmFsbGF4U3R5bGVbJ3dlYmtpdFRyYW5zZm9ybSddID0gdGhpcy5fZ2V0VHJhbnNsYXRlU3RyKDAsIC1wYXJhbGxheFkpICsgJyBzY2FsZSgnICsgc2NhbGUgKyAnLCcgKyBzY2FsZSArICcpJztcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR0aGlzLnBhcmFsbGF4SW1nU3R5bGVbJ29wYWNpdHknXSA9IDE7XG5cdFx0XHRcdFx0dGhpcy5wYXJhbGxheFN0eWxlWyd3ZWJraXRUcmFuc2Zvcm0nXSA9IHRoaXMuX2dldFRyYW5zbGF0ZVN0cigwLCAtMSkgKyAnIHNjYWxlKDEsMSknO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRpZiAodGhpcy5pbmRpY2F0b3JzKSB7XG5cdFx0XHRcdGZvciAodmFyIGkgPSB0aGlzLmluZGljYXRvcnMubGVuZ3RoOyBpLS07KSB7XG5cdFx0XHRcdFx0dGhpcy5pbmRpY2F0b3JzW2ldLnVwZGF0ZVBvc2l0aW9uKCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHRoaXMubGFzdFggPSB0aGlzLng7XG5cdFx0XHR0aGlzLmxhc3RZID0gdGhpcy55O1xuXHRcdFx0JC50cmlnZ2VyKHRoaXMuc2Nyb2xsZXIsICdzY3JvbGwnLCB0aGlzKTtcblx0XHR9LFxuXHRcdHJlTGF5b3V0OiBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMud3JhcHBlci5vZmZzZXRIZWlnaHQ7XG5cblx0XHRcdHZhciBwYWRkaW5nTGVmdCA9IHBhcnNlRmxvYXQoJC5nZXRTdHlsZXModGhpcy53cmFwcGVyLCAncGFkZGluZy1sZWZ0JykpIHx8IDA7XG5cdFx0XHR2YXIgcGFkZGluZ1JpZ2h0ID0gcGFyc2VGbG9hdCgkLmdldFN0eWxlcyh0aGlzLndyYXBwZXIsICdwYWRkaW5nLXJpZ2h0JykpIHx8IDA7XG5cdFx0XHR2YXIgcGFkZGluZ1RvcCA9IHBhcnNlRmxvYXQoJC5nZXRTdHlsZXModGhpcy53cmFwcGVyLCAncGFkZGluZy10b3AnKSkgfHwgMDtcblx0XHRcdHZhciBwYWRkaW5nQm90dG9tID0gcGFyc2VGbG9hdCgkLmdldFN0eWxlcyh0aGlzLndyYXBwZXIsICdwYWRkaW5nLWJvdHRvbScpKSB8fCAwO1xuXG5cdFx0XHR2YXIgY2xpZW50V2lkdGggPSB0aGlzLndyYXBwZXIuY2xpZW50V2lkdGg7XG5cdFx0XHR2YXIgY2xpZW50SGVpZ2h0ID0gdGhpcy53cmFwcGVyLmNsaWVudEhlaWdodDtcblxuXHRcdFx0dGhpcy5zY3JvbGxlcldpZHRoID0gdGhpcy5zY3JvbGxlci5vZmZzZXRXaWR0aDtcblx0XHRcdHRoaXMuc2Nyb2xsZXJIZWlnaHQgPSB0aGlzLnNjcm9sbGVyLm9mZnNldEhlaWdodDtcblxuXHRcdFx0dGhpcy53cmFwcGVyV2lkdGggPSBjbGllbnRXaWR0aCAtIHBhZGRpbmdMZWZ0IC0gcGFkZGluZ1JpZ2h0O1xuXHRcdFx0dGhpcy53cmFwcGVySGVpZ2h0ID0gY2xpZW50SGVpZ2h0IC0gcGFkZGluZ1RvcCAtIHBhZGRpbmdCb3R0b207XG5cblx0XHRcdHRoaXMubWF4U2Nyb2xsWCA9IE1hdGgubWluKHRoaXMud3JhcHBlcldpZHRoIC0gdGhpcy5zY3JvbGxlcldpZHRoLCAwKTtcblx0XHRcdHRoaXMubWF4U2Nyb2xsWSA9IE1hdGgubWluKHRoaXMud3JhcHBlckhlaWdodCAtIHRoaXMuc2Nyb2xsZXJIZWlnaHQsIDApO1xuXHRcdFx0dGhpcy5oYXNIb3Jpem9udGFsU2Nyb2xsID0gdGhpcy5vcHRpb25zLnNjcm9sbFggJiYgdGhpcy5tYXhTY3JvbGxYIDwgMDtcblx0XHRcdHRoaXMuaGFzVmVydGljYWxTY3JvbGwgPSB0aGlzLm9wdGlvbnMuc2Nyb2xsWSAmJiB0aGlzLm1heFNjcm9sbFkgPCAwO1xuXHRcdFx0dGhpcy5fcmVMYXlvdXQoKTtcblx0XHR9LFxuXHRcdHJlc2V0UG9zaXRpb246IGZ1bmN0aW9uKHRpbWUpIHtcblx0XHRcdHZhciB4ID0gdGhpcy54LFxuXHRcdFx0XHR5ID0gdGhpcy55O1xuXG5cdFx0XHR0aW1lID0gdGltZSB8fCAwO1xuXHRcdFx0aWYgKCF0aGlzLmhhc0hvcml6b250YWxTY3JvbGwgfHwgdGhpcy54ID4gMCkge1xuXHRcdFx0XHR4ID0gMDtcblx0XHRcdH0gZWxzZSBpZiAodGhpcy54IDwgdGhpcy5tYXhTY3JvbGxYKSB7XG5cdFx0XHRcdHggPSB0aGlzLm1heFNjcm9sbFg7XG5cdFx0XHR9XG5cblx0XHRcdGlmICghdGhpcy5oYXNWZXJ0aWNhbFNjcm9sbCB8fCB0aGlzLnkgPiAwKSB7XG5cdFx0XHRcdHkgPSAwO1xuXHRcdFx0fSBlbHNlIGlmICh0aGlzLnkgPCB0aGlzLm1heFNjcm9sbFkpIHtcblx0XHRcdFx0eSA9IHRoaXMubWF4U2Nyb2xsWTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHggPT0gdGhpcy54ICYmIHkgPT0gdGhpcy55KSB7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblx0XHRcdHRoaXMuc2Nyb2xsVG8oeCwgeSwgdGltZSwgdGhpcy5vcHRpb25zLnNjcm9sbEVhc2luZyk7XG5cblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH0sXG5cdFx0X3JlSW5pdDogZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgZ3JvdXBzID0gdGhpcy53cmFwcGVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy4nICsgQ0xBU1NfU0NST0xMKTtcblx0XHRcdGZvciAodmFyIGkgPSAwLCBsZW4gPSBncm91cHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0XHRcdFx0aWYgKGdyb3Vwc1tpXS5wYXJlbnROb2RlID09PSB0aGlzLndyYXBwZXIpIHtcblx0XHRcdFx0XHR0aGlzLnNjcm9sbGVyID0gZ3JvdXBzW2ldO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHR0aGlzLnNjcm9sbGVyU3R5bGUgPSB0aGlzLnNjcm9sbGVyICYmIHRoaXMuc2Nyb2xsZXIuc3R5bGU7XG5cdFx0fSxcblx0XHRyZWZyZXNoOiBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMuX3JlSW5pdCgpO1xuXHRcdFx0dGhpcy5yZUxheW91dCgpO1xuXHRcdFx0JC50cmlnZ2VyKHRoaXMuc2Nyb2xsZXIsICdyZWZyZXNoJywgdGhpcyk7XG5cdFx0XHR0aGlzLnJlc2V0UG9zaXRpb24oKTtcblx0XHR9LFxuXHRcdHNjcm9sbFRvOiBmdW5jdGlvbih4LCB5LCB0aW1lLCBlYXNpbmcpIHtcblx0XHRcdHZhciBlYXNpbmcgPSBlYXNpbmcgfHwgZWFzZS5jaXJjdWxhcjtcblx0XHRcdC8vXHRcdFx0dGhpcy5pc0luVHJhbnNpdGlvbiA9IHRpbWUgPiAwICYmICh0aGlzLmxhc3RYICE9IHggfHwgdGhpcy5sYXN0WSAhPSB5KTtcblx0XHRcdC8v5pqC5LiN5Lil5qC85Yik5pateCx577yM5ZCm5YiZ5Lya5a+86Ie06YOo5YiG54mI5pys5LiK5LiN5q2j5bi46Kem5Y+R6L2u5pKtXG5cdFx0XHR0aGlzLmlzSW5UcmFuc2l0aW9uID0gdGltZSA+IDA7XG5cdFx0XHRpZiAodGhpcy5pc0luVHJhbnNpdGlvbikge1xuXHRcdFx0XHR0aGlzLl9jbGVhclJlcXVlc3RBbmltYXRpb25GcmFtZSgpO1xuXHRcdFx0XHR0aGlzLl90cmFuc2l0aW9uVGltaW5nRnVuY3Rpb24oZWFzaW5nLnN0eWxlKTtcblx0XHRcdFx0dGhpcy5fdHJhbnNpdGlvblRpbWUodGltZSk7XG5cdFx0XHRcdHRoaXMuc2V0VHJhbnNsYXRlKHgsIHkpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5zZXRUcmFuc2xhdGUoeCwgeSk7XG5cdFx0XHR9XG5cblx0XHR9LFxuXHRcdHNjcm9sbFRvQm90dG9tOiBmdW5jdGlvbih0aW1lLCBlYXNpbmcpIHtcblx0XHRcdHRpbWUgPSB0aW1lIHx8IHRoaXMub3B0aW9ucy5zY3JvbGxUaW1lO1xuXHRcdFx0dGhpcy5zY3JvbGxUbygwLCB0aGlzLm1heFNjcm9sbFksIHRpbWUsIGVhc2luZyk7XG5cdFx0fSxcblx0XHRnb3RvUGFnZTogZnVuY3Rpb24oaW5kZXgpIHtcblx0XHRcdHRoaXMuX2dvdG9QYWdlKGluZGV4KTtcblx0XHR9LFxuXHRcdGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5faW5pdEV2ZW50KHRydWUpOyAvL2RldGFjaFxuXHRcdFx0ZGVsZXRlICQuZGF0YVt0aGlzLndyYXBwZXIuZ2V0QXR0cmlidXRlKCdkYXRhLXNjcm9sbCcpXTtcblx0XHRcdHRoaXMud3JhcHBlci5zZXRBdHRyaWJ1dGUoJ2RhdGEtc2Nyb2xsJywgJycpO1xuXHRcdH1cblx0fSk7XG5cdC8vSW5kaWNhdG9yXG5cdHZhciBJbmRpY2F0b3IgPSBmdW5jdGlvbihzY3JvbGxlciwgb3B0aW9ucykge1xuXHRcdHRoaXMud3JhcHBlciA9IHR5cGVvZiBvcHRpb25zLmVsID09ICdzdHJpbmcnID8gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihvcHRpb25zLmVsKSA6IG9wdGlvbnMuZWw7XG5cdFx0dGhpcy53cmFwcGVyU3R5bGUgPSB0aGlzLndyYXBwZXIuc3R5bGU7XG5cdFx0dGhpcy5pbmRpY2F0b3IgPSB0aGlzLndyYXBwZXIuY2hpbGRyZW5bMF07XG5cdFx0dGhpcy5pbmRpY2F0b3JTdHlsZSA9IHRoaXMuaW5kaWNhdG9yLnN0eWxlO1xuXHRcdHRoaXMuc2Nyb2xsZXIgPSBzY3JvbGxlcjtcblxuXHRcdHRoaXMub3B0aW9ucyA9ICQuZXh0ZW5kKHtcblx0XHRcdGxpc3Rlblg6IHRydWUsXG5cdFx0XHRsaXN0ZW5ZOiB0cnVlLFxuXHRcdFx0ZmFkZTogZmFsc2UsXG5cdFx0XHRzcGVlZFJhdGlvWDogMCxcblx0XHRcdHNwZWVkUmF0aW9ZOiAwXG5cdFx0fSwgb3B0aW9ucyk7XG5cblx0XHR0aGlzLnNpemVSYXRpb1ggPSAxO1xuXHRcdHRoaXMuc2l6ZVJhdGlvWSA9IDE7XG5cdFx0dGhpcy5tYXhQb3NYID0gMDtcblx0XHR0aGlzLm1heFBvc1kgPSAwO1xuXG5cdFx0aWYgKHRoaXMub3B0aW9ucy5mYWRlKSB7XG5cdFx0XHR0aGlzLndyYXBwZXJTdHlsZVsnd2Via2l0VHJhbnNmb3JtJ10gPSB0aGlzLnNjcm9sbGVyLnRyYW5zbGF0ZVo7XG5cdFx0XHR0aGlzLndyYXBwZXJTdHlsZVsnd2Via2l0VHJhbnNpdGlvbkR1cmF0aW9uJ10gPSB0aGlzLm9wdGlvbnMuZml4ZWRCYWRBbmRvcmlkICYmICQub3MuaXNCYWRBbmRyb2lkID8gJzAuMDAxcycgOiAnMG1zJztcblx0XHRcdHRoaXMud3JhcHBlclN0eWxlLm9wYWNpdHkgPSAnMCc7XG5cdFx0fVxuXHR9XG5cdEluZGljYXRvci5wcm90b3R5cGUgPSB7XG5cdFx0aGFuZGxlRXZlbnQ6IGZ1bmN0aW9uKGUpIHtcblxuXHRcdH0sXG5cdFx0dHJhbnNpdGlvblRpbWU6IGZ1bmN0aW9uKHRpbWUpIHtcblx0XHRcdHRpbWUgPSB0aW1lIHx8IDA7XG5cdFx0XHR0aGlzLmluZGljYXRvclN0eWxlWyd3ZWJraXRUcmFuc2l0aW9uRHVyYXRpb24nXSA9IHRpbWUgKyAnbXMnO1xuXHRcdFx0aWYgKHRoaXMuc2Nyb2xsZXIub3B0aW9ucy5maXhlZEJhZEFuZG9yaWQgJiYgIXRpbWUgJiYgJC5vcy5pc0JhZEFuZHJvaWQpIHtcblx0XHRcdFx0dGhpcy5pbmRpY2F0b3JTdHlsZVsnd2Via2l0VHJhbnNpdGlvbkR1cmF0aW9uJ10gPSAnMC4wMDFzJztcblx0XHRcdH1cblx0XHR9LFxuXHRcdHRyYW5zaXRpb25UaW1pbmdGdW5jdGlvbjogZnVuY3Rpb24oZWFzaW5nKSB7XG5cdFx0XHR0aGlzLmluZGljYXRvclN0eWxlWyd3ZWJraXRUcmFuc2l0aW9uVGltaW5nRnVuY3Rpb24nXSA9IGVhc2luZztcblx0XHR9LFxuXHRcdHJlZnJlc2g6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy50cmFuc2l0aW9uVGltZSgpO1xuXG5cdFx0XHRpZiAodGhpcy5vcHRpb25zLmxpc3RlblggJiYgIXRoaXMub3B0aW9ucy5saXN0ZW5ZKSB7XG5cdFx0XHRcdHRoaXMuaW5kaWNhdG9yU3R5bGUuZGlzcGxheSA9IHRoaXMuc2Nyb2xsZXIuaGFzSG9yaXpvbnRhbFNjcm9sbCA/ICdibG9jaycgOiAnbm9uZSc7XG5cdFx0XHR9IGVsc2UgaWYgKHRoaXMub3B0aW9ucy5saXN0ZW5ZICYmICF0aGlzLm9wdGlvbnMubGlzdGVuWCkge1xuXHRcdFx0XHR0aGlzLmluZGljYXRvclN0eWxlLmRpc3BsYXkgPSB0aGlzLnNjcm9sbGVyLmhhc1ZlcnRpY2FsU2Nyb2xsID8gJ2Jsb2NrJyA6ICdub25lJztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuaW5kaWNhdG9yU3R5bGUuZGlzcGxheSA9IHRoaXMuc2Nyb2xsZXIuaGFzSG9yaXpvbnRhbFNjcm9sbCB8fCB0aGlzLnNjcm9sbGVyLmhhc1ZlcnRpY2FsU2Nyb2xsID8gJ2Jsb2NrJyA6ICdub25lJztcblx0XHRcdH1cblxuXHRcdFx0dGhpcy53cmFwcGVyLm9mZnNldEhlaWdodDsgLy8gZm9yY2UgcmVmcmVzaFxuXG5cdFx0XHRpZiAodGhpcy5vcHRpb25zLmxpc3RlblgpIHtcblx0XHRcdFx0dGhpcy53cmFwcGVyV2lkdGggPSB0aGlzLndyYXBwZXIuY2xpZW50V2lkdGg7XG5cdFx0XHRcdHRoaXMuaW5kaWNhdG9yV2lkdGggPSBNYXRoLm1heChNYXRoLnJvdW5kKHRoaXMud3JhcHBlcldpZHRoICogdGhpcy53cmFwcGVyV2lkdGggLyAodGhpcy5zY3JvbGxlci5zY3JvbGxlcldpZHRoIHx8IHRoaXMud3JhcHBlcldpZHRoIHx8IDEpKSwgOCk7XG5cdFx0XHRcdHRoaXMuaW5kaWNhdG9yU3R5bGUud2lkdGggPSB0aGlzLmluZGljYXRvcldpZHRoICsgJ3B4JztcblxuXHRcdFx0XHR0aGlzLm1heFBvc1ggPSB0aGlzLndyYXBwZXJXaWR0aCAtIHRoaXMuaW5kaWNhdG9yV2lkdGg7XG5cblx0XHRcdFx0dGhpcy5taW5Cb3VuZGFyeVggPSAwO1xuXHRcdFx0XHR0aGlzLm1heEJvdW5kYXJ5WCA9IHRoaXMubWF4UG9zWDtcblxuXHRcdFx0XHR0aGlzLnNpemVSYXRpb1ggPSB0aGlzLm9wdGlvbnMuc3BlZWRSYXRpb1ggfHwgKHRoaXMuc2Nyb2xsZXIubWF4U2Nyb2xsWCAmJiAodGhpcy5tYXhQb3NYIC8gdGhpcy5zY3JvbGxlci5tYXhTY3JvbGxYKSk7XG5cdFx0XHR9XG5cblx0XHRcdGlmICh0aGlzLm9wdGlvbnMubGlzdGVuWSkge1xuXHRcdFx0XHR0aGlzLndyYXBwZXJIZWlnaHQgPSB0aGlzLndyYXBwZXIuY2xpZW50SGVpZ2h0O1xuXHRcdFx0XHR0aGlzLmluZGljYXRvckhlaWdodCA9IE1hdGgubWF4KE1hdGgucm91bmQodGhpcy53cmFwcGVySGVpZ2h0ICogdGhpcy53cmFwcGVySGVpZ2h0IC8gKHRoaXMuc2Nyb2xsZXIuc2Nyb2xsZXJIZWlnaHQgfHwgdGhpcy53cmFwcGVySGVpZ2h0IHx8IDEpKSwgOCk7XG5cdFx0XHRcdHRoaXMuaW5kaWNhdG9yU3R5bGUuaGVpZ2h0ID0gdGhpcy5pbmRpY2F0b3JIZWlnaHQgKyAncHgnO1xuXG5cdFx0XHRcdHRoaXMubWF4UG9zWSA9IHRoaXMud3JhcHBlckhlaWdodCAtIHRoaXMuaW5kaWNhdG9ySGVpZ2h0O1xuXG5cdFx0XHRcdHRoaXMubWluQm91bmRhcnlZID0gMDtcblx0XHRcdFx0dGhpcy5tYXhCb3VuZGFyeVkgPSB0aGlzLm1heFBvc1k7XG5cblx0XHRcdFx0dGhpcy5zaXplUmF0aW9ZID0gdGhpcy5vcHRpb25zLnNwZWVkUmF0aW9ZIHx8ICh0aGlzLnNjcm9sbGVyLm1heFNjcm9sbFkgJiYgKHRoaXMubWF4UG9zWSAvIHRoaXMuc2Nyb2xsZXIubWF4U2Nyb2xsWSkpO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLnVwZGF0ZVBvc2l0aW9uKCk7XG5cdFx0fSxcblxuXHRcdHVwZGF0ZVBvc2l0aW9uOiBmdW5jdGlvbigpIHtcblx0XHRcdHZhciB4ID0gdGhpcy5vcHRpb25zLmxpc3RlblggJiYgTWF0aC5yb3VuZCh0aGlzLnNpemVSYXRpb1ggKiB0aGlzLnNjcm9sbGVyLngpIHx8IDAsXG5cdFx0XHRcdHkgPSB0aGlzLm9wdGlvbnMubGlzdGVuWSAmJiBNYXRoLnJvdW5kKHRoaXMuc2l6ZVJhdGlvWSAqIHRoaXMuc2Nyb2xsZXIueSkgfHwgMDtcblxuXHRcdFx0aWYgKHggPCB0aGlzLm1pbkJvdW5kYXJ5WCkge1xuXHRcdFx0XHR0aGlzLndpZHRoID0gTWF0aC5tYXgodGhpcy5pbmRpY2F0b3JXaWR0aCArIHgsIDgpO1xuXHRcdFx0XHR0aGlzLmluZGljYXRvclN0eWxlLndpZHRoID0gdGhpcy53aWR0aCArICdweCc7XG5cdFx0XHRcdHggPSB0aGlzLm1pbkJvdW5kYXJ5WDtcblx0XHRcdH0gZWxzZSBpZiAoeCA+IHRoaXMubWF4Qm91bmRhcnlYKSB7XG5cdFx0XHRcdHRoaXMud2lkdGggPSBNYXRoLm1heCh0aGlzLmluZGljYXRvcldpZHRoIC0gKHggLSB0aGlzLm1heFBvc1gpLCA4KTtcblx0XHRcdFx0dGhpcy5pbmRpY2F0b3JTdHlsZS53aWR0aCA9IHRoaXMud2lkdGggKyAncHgnO1xuXHRcdFx0XHR4ID0gdGhpcy5tYXhQb3NYICsgdGhpcy5pbmRpY2F0b3JXaWR0aCAtIHRoaXMud2lkdGg7XG5cdFx0XHR9IGVsc2UgaWYgKHRoaXMud2lkdGggIT0gdGhpcy5pbmRpY2F0b3JXaWR0aCkge1xuXHRcdFx0XHR0aGlzLndpZHRoID0gdGhpcy5pbmRpY2F0b3JXaWR0aDtcblx0XHRcdFx0dGhpcy5pbmRpY2F0b3JTdHlsZS53aWR0aCA9IHRoaXMud2lkdGggKyAncHgnO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoeSA8IHRoaXMubWluQm91bmRhcnlZKSB7XG5cdFx0XHRcdHRoaXMuaGVpZ2h0ID0gTWF0aC5tYXgodGhpcy5pbmRpY2F0b3JIZWlnaHQgKyB5ICogMywgOCk7XG5cdFx0XHRcdHRoaXMuaW5kaWNhdG9yU3R5bGUuaGVpZ2h0ID0gdGhpcy5oZWlnaHQgKyAncHgnO1xuXHRcdFx0XHR5ID0gdGhpcy5taW5Cb3VuZGFyeVk7XG5cdFx0XHR9IGVsc2UgaWYgKHkgPiB0aGlzLm1heEJvdW5kYXJ5WSkge1xuXHRcdFx0XHR0aGlzLmhlaWdodCA9IE1hdGgubWF4KHRoaXMuaW5kaWNhdG9ySGVpZ2h0IC0gKHkgLSB0aGlzLm1heFBvc1kpICogMywgOCk7XG5cdFx0XHRcdHRoaXMuaW5kaWNhdG9yU3R5bGUuaGVpZ2h0ID0gdGhpcy5oZWlnaHQgKyAncHgnO1xuXHRcdFx0XHR5ID0gdGhpcy5tYXhQb3NZICsgdGhpcy5pbmRpY2F0b3JIZWlnaHQgLSB0aGlzLmhlaWdodDtcblx0XHRcdH0gZWxzZSBpZiAodGhpcy5oZWlnaHQgIT0gdGhpcy5pbmRpY2F0b3JIZWlnaHQpIHtcblx0XHRcdFx0dGhpcy5oZWlnaHQgPSB0aGlzLmluZGljYXRvckhlaWdodDtcblx0XHRcdFx0dGhpcy5pbmRpY2F0b3JTdHlsZS5oZWlnaHQgPSB0aGlzLmhlaWdodCArICdweCc7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMueCA9IHg7XG5cdFx0XHR0aGlzLnkgPSB5O1xuXG5cdFx0XHR0aGlzLmluZGljYXRvclN0eWxlWyd3ZWJraXRUcmFuc2Zvcm0nXSA9IHRoaXMuc2Nyb2xsZXIuX2dldFRyYW5zbGF0ZVN0cih4LCB5KTtcblxuXHRcdH0sXG5cdFx0ZmFkZTogZnVuY3Rpb24odmFsLCBob2xkKSB7XG5cdFx0XHRpZiAoaG9sZCAmJiAhdGhpcy52aXNpYmxlKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0Y2xlYXJUaW1lb3V0KHRoaXMuZmFkZVRpbWVvdXQpO1xuXHRcdFx0dGhpcy5mYWRlVGltZW91dCA9IG51bGw7XG5cblx0XHRcdHZhciB0aW1lID0gdmFsID8gMjUwIDogNTAwLFxuXHRcdFx0XHRkZWxheSA9IHZhbCA/IDAgOiAzMDA7XG5cblx0XHRcdHZhbCA9IHZhbCA/ICcxJyA6ICcwJztcblxuXHRcdFx0dGhpcy53cmFwcGVyU3R5bGVbJ3dlYmtpdFRyYW5zaXRpb25EdXJhdGlvbiddID0gdGltZSArICdtcyc7XG5cblx0XHRcdHRoaXMuZmFkZVRpbWVvdXQgPSBzZXRUaW1lb3V0KChmdW5jdGlvbih2YWwpIHtcblx0XHRcdFx0dGhpcy53cmFwcGVyU3R5bGUub3BhY2l0eSA9IHZhbDtcblx0XHRcdFx0dGhpcy52aXNpYmxlID0gK3ZhbDtcblx0XHRcdH0pLmJpbmQodGhpcywgdmFsKSwgZGVsYXkpO1xuXHRcdH1cblx0fTtcblxuXHQkLlNjcm9sbCA9IFNjcm9sbDtcblxuXHQkLmZuLnNjcm9sbCA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHR2YXIgc2Nyb2xsQXBpcyA9IFtdO1xuXHRcdHRoaXMuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdHZhciBzY3JvbGxBcGkgPSBudWxsO1xuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0dmFyIGlkID0gc2VsZi5nZXRBdHRyaWJ1dGUoJ2RhdGEtc2Nyb2xsJyk7XG5cdFx0XHRpZiAoIWlkKSB7XG5cdFx0XHRcdGlkID0gKyskLnV1aWQ7XG5cdFx0XHRcdHZhciBfb3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCBvcHRpb25zKTtcblx0XHRcdFx0aWYgKHNlbGYuY2xhc3NMaXN0LmNvbnRhaW5zKCdtdWktc2VnbWVudGVkLWNvbnRyb2wnKSkge1xuXHRcdFx0XHRcdF9vcHRpb25zID0gJC5leHRlbmQoX29wdGlvbnMsIHtcblx0XHRcdFx0XHRcdHNjcm9sbFk6IGZhbHNlLFxuXHRcdFx0XHRcdFx0c2Nyb2xsWDogdHJ1ZSxcblx0XHRcdFx0XHRcdGluZGljYXRvcnM6IGZhbHNlLFxuXHRcdFx0XHRcdFx0c25hcDogJy5tdWktY29udHJvbC1pdGVtJ1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHRcdCQuZGF0YVtpZF0gPSBzY3JvbGxBcGkgPSBuZXcgU2Nyb2xsKHNlbGYsIF9vcHRpb25zKTtcblx0XHRcdFx0c2VsZi5zZXRBdHRyaWJ1dGUoJ2RhdGEtc2Nyb2xsJywgaWQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0c2Nyb2xsQXBpID0gJC5kYXRhW2lkXTtcblx0XHRcdH1cblx0XHRcdHNjcm9sbEFwaXMucHVzaChzY3JvbGxBcGkpO1xuXHRcdH0pO1xuXHRcdHJldHVybiBzY3JvbGxBcGlzLmxlbmd0aCA9PT0gMSA/IHNjcm9sbEFwaXNbMF0gOiBzY3JvbGxBcGlzO1xuXHR9O1xufSkobXVpLCB3aW5kb3csIGRvY3VtZW50KTtcbihmdW5jdGlvbigkLCB3aW5kb3csIGRvY3VtZW50LCB1bmRlZmluZWQpIHtcblxuXHR2YXIgQ0xBU1NfVklTSUJJTElUWSA9ICdtdWktdmlzaWJpbGl0eSc7XG5cdHZhciBDTEFTU19ISURERU4gPSAnbXVpLWhpZGRlbic7XG5cblx0dmFyIFB1bGxSZWZyZXNoID0gJC5TY3JvbGwuZXh0ZW5kKCQuZXh0ZW5kKHtcblx0XHRoYW5kbGVFdmVudDogZnVuY3Rpb24oZSkge1xuXHRcdFx0dGhpcy5fc3VwZXIoZSk7XG5cdFx0XHRpZiAoZS50eXBlID09PSAnc2Nyb2xsYm90dG9tJykge1xuXHRcdFx0XHRpZiAoZS50YXJnZXQgPT09IHRoaXMuc2Nyb2xsZXIpIHtcblx0XHRcdFx0XHR0aGlzLl9zY3JvbGxib3R0b20oKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0sXG5cdFx0X3Njcm9sbGJvdHRvbTogZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoIXRoaXMucHVsbGRvd24gJiYgIXRoaXMubG9hZGluZykge1xuXHRcdFx0XHR0aGlzLnB1bGxkb3duID0gZmFsc2U7XG5cdFx0XHRcdHRoaXMuX2luaXRQdWxsdXBSZWZyZXNoKCk7XG5cdFx0XHRcdHRoaXMucHVsbHVwTG9hZGluZygpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0X3N0YXJ0OiBmdW5jdGlvbihlKSB7XG5cdFx0XHQvL+S7heS4i+aLieWIt+aWsOWcqHN0YXJ06Zi75q2i6buY6K6k5LqL5Lu2XG5cdFx0XHRpZiAoZS50b3VjaGVzICYmIGUudG91Y2hlcy5sZW5ndGggJiYgZS50b3VjaGVzWzBdLmNsaWVudFggPiAzMCkge1xuXHRcdFx0XHRlLnRhcmdldCAmJiAhdGhpcy5fcHJldmVudERlZmF1bHRFeGNlcHRpb24oZS50YXJnZXQsIHRoaXMub3B0aW9ucy5wcmV2ZW50RGVmYXVsdEV4Y2VwdGlvbikgJiYgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKCF0aGlzLmxvYWRpbmcpIHtcblx0XHRcdFx0dGhpcy5wdWxsZG93biA9IHRoaXMucHVsbFBvY2tldCA9IHRoaXMucHVsbENhcHRpb24gPSB0aGlzLnB1bGxMb2FkaW5nID0gZmFsc2Vcblx0XHRcdH1cblx0XHRcdHRoaXMuX3N1cGVyKGUpO1xuXHRcdH0sXG5cdFx0X2RyYWc6IGZ1bmN0aW9uKGUpIHtcblx0XHRcdHRoaXMuX3N1cGVyKGUpO1xuXHRcdFx0aWYgKCF0aGlzLnB1bGxkb3duICYmICF0aGlzLmxvYWRpbmcgJiYgdGhpcy50b3BQb2NrZXQgJiYgZS5kZXRhaWwuZGlyZWN0aW9uID09PSAnZG93bicgJiYgdGhpcy55ID49IDApIHtcblx0XHRcdFx0dGhpcy5faW5pdFB1bGxkb3duUmVmcmVzaCgpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHRoaXMucHVsbGRvd24pIHtcblx0XHRcdFx0dGhpcy5fc2V0Q2FwdGlvbih0aGlzLnkgPiB0aGlzLm9wdGlvbnMuZG93bi5oZWlnaHQgPyB0aGlzLm9wdGlvbnMuZG93bi5jb250ZW50b3ZlciA6IHRoaXMub3B0aW9ucy5kb3duLmNvbnRlbnRkb3duKTtcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0X3JlTGF5b3V0OiBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMuaGFzVmVydGljYWxTY3JvbGwgPSB0cnVlO1xuXHRcdFx0dGhpcy5fc3VwZXIoKTtcblx0XHR9LFxuXHRcdC8vQVBJXG5cdFx0cmVzZXRQb3NpdGlvbjogZnVuY3Rpb24odGltZSkge1xuXHRcdFx0aWYgKHRoaXMucHVsbGRvd24pIHtcblx0XHRcdFx0aWYgKHRoaXMueSA+PSB0aGlzLm9wdGlvbnMuZG93bi5oZWlnaHQpIHtcblx0XHRcdFx0XHR0aGlzLnB1bGxkb3duTG9hZGluZyh1bmRlZmluZWQsIHRpbWUgfHwgMCk7XG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0IXRoaXMubG9hZGluZyAmJiB0aGlzLnRvcFBvY2tldC5jbGFzc0xpc3QucmVtb3ZlKENMQVNTX1ZJU0lCSUxJVFkpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdGhpcy5fc3VwZXIodGltZSk7XG5cdFx0fSxcblx0XHRwdWxsZG93bkxvYWRpbmc6IGZ1bmN0aW9uKHksIHRpbWUpIHtcblx0XHRcdHR5cGVvZiB5ID09PSAndW5kZWZpbmVkJyAmJiAoeSA9IHRoaXMub3B0aW9ucy5kb3duLmhlaWdodCk7IC8v6buY6K6k6auY5bqmXG5cdFx0XHR0aGlzLnNjcm9sbFRvKDAsIHksIHRpbWUsIHRoaXMub3B0aW9ucy5ib3VuY2VFYXNpbmcpO1xuXHRcdFx0aWYgKHRoaXMubG9hZGluZykge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHQvL1x0XHRcdGlmICghdGhpcy5wdWxsZG93bikge1xuXHRcdFx0dGhpcy5faW5pdFB1bGxkb3duUmVmcmVzaCgpO1xuXHRcdFx0Ly9cdFx0XHR9XG5cdFx0XHR0aGlzLl9zZXRDYXB0aW9uKHRoaXMub3B0aW9ucy5kb3duLmNvbnRlbnRyZWZyZXNoKTtcblx0XHRcdHRoaXMubG9hZGluZyA9IHRydWU7XG5cdFx0XHR0aGlzLmluZGljYXRvcnMubWFwKGZ1bmN0aW9uKGluZGljYXRvcikge1xuXHRcdFx0XHRpbmRpY2F0b3IuZmFkZSgwKTtcblx0XHRcdH0pO1xuXHRcdFx0dmFyIGNhbGxiYWNrID0gdGhpcy5vcHRpb25zLmRvd24uY2FsbGJhY2s7XG5cdFx0XHRjYWxsYmFjayAmJiBjYWxsYmFjay5jYWxsKHRoaXMpO1xuXHRcdH0sXG5cdFx0ZW5kUHVsbGRvd25Ub1JlZnJlc2g6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0aWYgKHNlbGYudG9wUG9ja2V0ICYmIHNlbGYubG9hZGluZyAmJiB0aGlzLnB1bGxkb3duKSB7XG5cdFx0XHRcdHNlbGYuc2Nyb2xsVG8oMCwgMCwgc2VsZi5vcHRpb25zLmJvdW5jZVRpbWUsIHNlbGYub3B0aW9ucy5ib3VuY2VFYXNpbmcpO1xuXHRcdFx0XHRzZWxmLmxvYWRpbmcgPSBmYWxzZTtcblx0XHRcdFx0c2VsZi5fc2V0Q2FwdGlvbihzZWxmLm9wdGlvbnMuZG93bi5jb250ZW50ZG93biwgdHJ1ZSk7XG5cdFx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0c2VsZi5sb2FkaW5nIHx8IHNlbGYudG9wUG9ja2V0LmNsYXNzTGlzdC5yZW1vdmUoQ0xBU1NfVklTSUJJTElUWSk7XG5cdFx0XHRcdH0sIDM1MCk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRwdWxsdXBMb2FkaW5nOiBmdW5jdGlvbihjYWxsYmFjaywgeCwgdGltZSkge1xuXHRcdFx0eCA9IHggfHwgMDtcblx0XHRcdHRoaXMuc2Nyb2xsVG8oeCwgdGhpcy5tYXhTY3JvbGxZLCB0aW1lLCB0aGlzLm9wdGlvbnMuYm91bmNlRWFzaW5nKTtcblx0XHRcdGlmICh0aGlzLmxvYWRpbmcpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5faW5pdFB1bGx1cFJlZnJlc2goKTtcblx0XHRcdHRoaXMuX3NldENhcHRpb24odGhpcy5vcHRpb25zLnVwLmNvbnRlbnRyZWZyZXNoKTtcblx0XHRcdHRoaXMuaW5kaWNhdG9ycy5tYXAoZnVuY3Rpb24oaW5kaWNhdG9yKSB7XG5cdFx0XHRcdGluZGljYXRvci5mYWRlKDApO1xuXHRcdFx0fSk7XG5cdFx0XHR0aGlzLmxvYWRpbmcgPSB0cnVlO1xuXHRcdFx0Y2FsbGJhY2sgPSBjYWxsYmFjayB8fCB0aGlzLm9wdGlvbnMudXAuY2FsbGJhY2s7XG5cdFx0XHRjYWxsYmFjayAmJiBjYWxsYmFjay5jYWxsKHRoaXMpO1xuXHRcdH0sXG5cdFx0ZW5kUHVsbHVwVG9SZWZyZXNoOiBmdW5jdGlvbihmaW5pc2hlZCkge1xuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0aWYgKHNlbGYuYm90dG9tUG9ja2V0KSB7IC8vICYmIHNlbGYubG9hZGluZyAmJiAhdGhpcy5wdWxsZG93blxuXHRcdFx0XHRzZWxmLmxvYWRpbmcgPSBmYWxzZTtcblx0XHRcdFx0aWYgKGZpbmlzaGVkKSB7XG5cdFx0XHRcdFx0dGhpcy5maW5pc2hlZCA9IHRydWU7XG5cdFx0XHRcdFx0c2VsZi5fc2V0Q2FwdGlvbihzZWxmLm9wdGlvbnMudXAuY29udGVudG5vbW9yZSk7XG5cdFx0XHRcdFx0Ly9cdFx0XHRcdFx0c2VsZi5ib3R0b21Qb2NrZXQuY2xhc3NMaXN0LnJlbW92ZShDTEFTU19WSVNJQklMSVRZKTtcblx0XHRcdFx0XHQvL1x0XHRcdFx0XHRzZWxmLmJvdHRvbVBvY2tldC5jbGFzc0xpc3QuYWRkKENMQVNTX0hJRERFTik7XG5cdFx0XHRcdFx0c2VsZi53cmFwcGVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbGJvdHRvbScsIHNlbGYpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHNlbGYuX3NldENhcHRpb24oc2VsZi5vcHRpb25zLnVwLmNvbnRlbnRkb3duKTtcblx0XHRcdFx0XHQvL1x0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHNlbGYubG9hZGluZyB8fCBzZWxmLmJvdHRvbVBvY2tldC5jbGFzc0xpc3QucmVtb3ZlKENMQVNTX1ZJU0lCSUxJVFkpO1xuXHRcdFx0XHRcdC8vXHRcdFx0XHRcdH0sIDMwMCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9LFxuXHRcdGRpc2FibGVQdWxsdXBUb1JlZnJlc2g6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5faW5pdFB1bGx1cFJlZnJlc2goKTtcblx0XHRcdHRoaXMuYm90dG9tUG9ja2V0LmNsYXNzTmFtZSA9ICdtdWktcHVsbC1ib3R0b20tcG9ja2V0JyArICcgJyArIENMQVNTX0hJRERFTjtcblx0XHRcdHRoaXMud3JhcHBlci5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGxib3R0b20nLCB0aGlzKTtcblx0XHR9LFxuXHRcdGVuYWJsZVB1bGx1cFRvUmVmcmVzaDogZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLl9pbml0UHVsbHVwUmVmcmVzaCgpO1xuXHRcdFx0dGhpcy5ib3R0b21Qb2NrZXQuY2xhc3NMaXN0LnJlbW92ZShDTEFTU19ISURERU4pO1xuXHRcdFx0dGhpcy5fc2V0Q2FwdGlvbih0aGlzLm9wdGlvbnMudXAuY29udGVudGRvd24pO1xuXHRcdFx0dGhpcy53cmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbGJvdHRvbScsIHRoaXMpO1xuXHRcdH0sXG5cdFx0cmVmcmVzaDogZnVuY3Rpb24oaXNSZXNldCkge1xuXHRcdFx0aWYgKGlzUmVzZXQgJiYgdGhpcy5maW5pc2hlZCkge1xuXHRcdFx0XHR0aGlzLmVuYWJsZVB1bGx1cFRvUmVmcmVzaCgpO1xuXHRcdFx0XHR0aGlzLmZpbmlzaGVkID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLl9zdXBlcigpO1xuXHRcdH0sXG5cdH0sICQuUHVsbFJlZnJlc2gpKTtcblx0JC5mbi5wdWxsUmVmcmVzaCA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRpZiAodGhpcy5sZW5ndGggPT09IDEpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpc1swXTtcblx0XHRcdHZhciBwdWxsUmVmcmVzaEFwaSA9IG51bGw7XG5cdFx0XHR2YXIgaWQgPSBzZWxmLmdldEF0dHJpYnV0ZSgnZGF0YS1wdWxscmVmcmVzaCcpO1xuXHRcdFx0aWYgKCFpZCAmJiB0eXBlb2Ygb3B0aW9ucyA9PT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdFx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdFx0XHRpZiAoIWlkKSB7XG5cdFx0XHRcdGlkID0gKyskLnV1aWQ7XG5cdFx0XHRcdCQuZGF0YVtpZF0gPSBwdWxsUmVmcmVzaEFwaSA9IG5ldyBQdWxsUmVmcmVzaChzZWxmLCBvcHRpb25zKTtcblx0XHRcdFx0c2VsZi5zZXRBdHRyaWJ1dGUoJ2RhdGEtcHVsbHJlZnJlc2gnLCBpZCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRwdWxsUmVmcmVzaEFwaSA9ICQuZGF0YVtpZF07XG5cdFx0XHR9XG5cdFx0XHRpZiAob3B0aW9ucy5kb3duICYmIG9wdGlvbnMuZG93bi5hdXRvKSB7IC8v5aaC5p6c6K6+572u5LqGYXV0b++8jOWImeiHquWKqOS4i+aLieS4gOasoVxuXHRcdFx0XHRwdWxsUmVmcmVzaEFwaS5wdWxsZG93bkxvYWRpbmcob3B0aW9ucy5kb3duLmF1dG9ZKTtcblx0XHRcdH0gZWxzZSBpZiAob3B0aW9ucy51cCAmJiBvcHRpb25zLnVwLmF1dG8pIHsgLy/lpoLmnpzorr7nva7kuoZhdXRv77yM5YiZ6Ieq5Yqo5LiK5ouJ5LiA5qyhXG5cdFx0XHRcdHB1bGxSZWZyZXNoQXBpLnB1bGx1cExvYWRpbmcoKTtcblx0XHRcdH1cblx0XHRcdC8v5pqC5LiN5o+Q5L6b6L+Z56eN6LCD55So5pa55byP5ZCnXG5cdFx0XHQvL1x0XHRcdGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ3N0cmluZycpIHtcblx0XHRcdC8vXHRcdFx0XHR2YXIgbWV0aG9kVmFsdWUgPSBwdWxsUmVmcmVzaEFwaVtvcHRpb25zXS5hcHBseShwdWxsUmVmcmVzaEFwaSwgJC5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpO1xuXHRcdFx0Ly9cdFx0XHRcdGlmIChtZXRob2RWYWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHQvL1x0XHRcdFx0XHRyZXR1cm4gbWV0aG9kVmFsdWU7XG5cdFx0XHQvL1x0XHRcdFx0fVxuXHRcdFx0Ly9cdFx0XHR9XG5cdFx0XHRyZXR1cm4gcHVsbFJlZnJlc2hBcGk7XG5cdFx0fVxuXHR9O1xufSkobXVpLCB3aW5kb3csIGRvY3VtZW50KTtcbi8qKlxuICogc25hcCDph43mnoRcbiAqIEBwYXJhbSB7T2JqZWN0fSAkXG4gKiBAcGFyYW0ge09iamVjdH0gd2luZG93XG4gKi9cbihmdW5jdGlvbigkLCB3aW5kb3cpIHtcblx0dmFyIENMQVNTX1NMSURFUiA9ICdtdWktc2xpZGVyJztcblx0dmFyIENMQVNTX1NMSURFUl9HUk9VUCA9ICdtdWktc2xpZGVyLWdyb3VwJztcblx0dmFyIENMQVNTX1NMSURFUl9MT09QID0gJ211aS1zbGlkZXItbG9vcCc7XG5cdHZhciBDTEFTU19TTElERVJfSU5ESUNBVE9SID0gJ211aS1zbGlkZXItaW5kaWNhdG9yJztcblx0dmFyIENMQVNTX0FDVElPTl9QUkVWSU9VUyA9ICdtdWktYWN0aW9uLXByZXZpb3VzJztcblx0dmFyIENMQVNTX0FDVElPTl9ORVhUID0gJ211aS1hY3Rpb24tbmV4dCc7XG5cdHZhciBDTEFTU19TTElERVJfSVRFTSA9ICdtdWktc2xpZGVyLWl0ZW0nO1xuXG5cdHZhciBDTEFTU19BQ1RJVkUgPSAnbXVpLWFjdGl2ZSc7XG5cblx0dmFyIFNFTEVDVE9SX1NMSURFUl9JVEVNID0gJy4nICsgQ0xBU1NfU0xJREVSX0lURU07XG5cdHZhciBTRUxFQ1RPUl9TTElERVJfSU5ESUNBVE9SID0gJy4nICsgQ0xBU1NfU0xJREVSX0lORElDQVRPUjtcblx0dmFyIFNFTEVDVE9SX1NMSURFUl9QUk9HUkVTU19CQVIgPSAnLm11aS1zbGlkZXItcHJvZ3Jlc3MtYmFyJztcblxuXHR2YXIgU2xpZGVyID0gJC5TbGlkZXIgPSAkLlNjcm9sbC5leHRlbmQoe1xuXHRcdGluaXQ6IGZ1bmN0aW9uKGVsZW1lbnQsIG9wdGlvbnMpIHtcblx0XHRcdHRoaXMuX3N1cGVyKGVsZW1lbnQsICQuZXh0ZW5kKHRydWUsIHtcblx0XHRcdFx0ZmluZ2VyczogMSxcblx0XHRcdFx0aW50ZXJ2YWw6IDAsIC8v6K6+572u5Li6MO+8jOWImeS4jeWumuaXtui9ruaSrVxuXHRcdFx0XHRzY3JvbGxZOiBmYWxzZSxcblx0XHRcdFx0c2Nyb2xsWDogdHJ1ZSxcblx0XHRcdFx0aW5kaWNhdG9yczogZmFsc2UsXG5cdFx0XHRcdHNjcm9sbFRpbWU6IDEwMDAsXG5cdFx0XHRcdHN0YXJ0WDogZmFsc2UsXG5cdFx0XHRcdHNsaWRlVGltZTogMCwgLy/mu5HliqjliqjnlLvml7bpl7Rcblx0XHRcdFx0c25hcDogU0VMRUNUT1JfU0xJREVSX0lURU1cblx0XHRcdH0sIG9wdGlvbnMpKTtcblx0XHRcdGlmICh0aGlzLm9wdGlvbnMuc3RhcnRYKSB7XG5cdFx0XHRcdC8vXHRcdFx0XHQkLnRyaWdnZXIodGhpcy53cmFwcGVyLCAnc2Nyb2xsZW5kJywgdGhpcyk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRfaW5pdDogZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLl9yZUluaXQoKTtcblx0XHRcdGlmICh0aGlzLnNjcm9sbGVyKSB7XG5cdFx0XHRcdHRoaXMuc2Nyb2xsZXJTdHlsZSA9IHRoaXMuc2Nyb2xsZXIuc3R5bGU7XG5cdFx0XHRcdHRoaXMucHJvZ3Jlc3NCYXIgPSB0aGlzLndyYXBwZXIucXVlcnlTZWxlY3RvcihTRUxFQ1RPUl9TTElERVJfUFJPR1JFU1NfQkFSKTtcblx0XHRcdFx0aWYgKHRoaXMucHJvZ3Jlc3NCYXIpIHtcblx0XHRcdFx0XHR0aGlzLnByb2dyZXNzQmFyV2lkdGggPSB0aGlzLnByb2dyZXNzQmFyLm9mZnNldFdpZHRoO1xuXHRcdFx0XHRcdHRoaXMucHJvZ3Jlc3NCYXJTdHlsZSA9IHRoaXMucHJvZ3Jlc3NCYXIuc3R5bGU7XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly/lv5jorrDov5nkuKrku6PnoIHmmK/lubLku4DkuYjnmoTkuobvvJ9cblx0XHRcdFx0Ly9cdFx0XHRcdHRoaXMueCA9IHRoaXMuX2dldFNjcm9sbCgpO1xuXHRcdFx0XHQvL1x0XHRcdFx0aWYgKHRoaXMub3B0aW9ucy5zdGFydFggPT09IGZhbHNlKSB7XG5cdFx0XHRcdC8vXHRcdFx0XHRcdHRoaXMub3B0aW9ucy5zdGFydFggPSB0aGlzLng7XG5cdFx0XHRcdC8vXHRcdFx0XHR9XG5cdFx0XHRcdC8v5qC55o2uYWN0aXZl5L+u5q2jc3RhcnRYXG5cblx0XHRcdFx0dGhpcy5fc3VwZXIoKTtcblx0XHRcdFx0dGhpcy5faW5pdFRpbWVyKCk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRfdHJpZ2dlclNsaWRlOiBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdHNlbGYuaXNJblRyYW5zaXRpb24gPSBmYWxzZTtcblx0XHRcdHZhciBwYWdlID0gc2VsZi5jdXJyZW50UGFnZTtcblx0XHRcdHNlbGYuc2xpZGVOdW1iZXIgPSBzZWxmLl9maXhlZFNsaWRlTnVtYmVyKCk7XG5cdFx0XHRpZiAoc2VsZi5sb29wKSB7XG5cdFx0XHRcdGlmIChzZWxmLnNsaWRlTnVtYmVyID09PSAwKSB7XG5cdFx0XHRcdFx0c2VsZi5zZXRUcmFuc2xhdGUoc2VsZi5wYWdlc1sxXVswXS54LCAwKTtcblx0XHRcdFx0fSBlbHNlIGlmIChzZWxmLnNsaWRlTnVtYmVyID09PSBzZWxmLml0ZW1MZW5ndGggLSAzKSB7XG5cdFx0XHRcdFx0c2VsZi5zZXRUcmFuc2xhdGUoc2VsZi5wYWdlc1tzZWxmLml0ZW1MZW5ndGggLSAyXVswXS54LCAwKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0aWYgKHNlbGYubGFzdFNsaWRlTnVtYmVyICE9IHNlbGYuc2xpZGVOdW1iZXIpIHtcblx0XHRcdFx0c2VsZi5sYXN0U2xpZGVOdW1iZXIgPSBzZWxmLnNsaWRlTnVtYmVyO1xuXHRcdFx0XHRzZWxmLmxhc3RQYWdlID0gc2VsZi5jdXJyZW50UGFnZTtcblx0XHRcdFx0JC50cmlnZ2VyKHNlbGYud3JhcHBlciwgJ3NsaWRlJywge1xuXHRcdFx0XHRcdHNsaWRlTnVtYmVyOiBzZWxmLnNsaWRlTnVtYmVyXG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdFx0c2VsZi5faW5pdFRpbWVyKCk7XG5cdFx0fSxcblx0XHRfaGFuZGxlU2xpZGU6IGZ1bmN0aW9uKGUpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdGlmIChlLnRhcmdldCAhPT0gc2VsZi53cmFwcGVyKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdHZhciBkZXRhaWwgPSBlLmRldGFpbDtcblx0XHRcdGRldGFpbC5zbGlkZU51bWJlciA9IGRldGFpbC5zbGlkZU51bWJlciB8fCAwO1xuXHRcdFx0dmFyIHRlbXBzID0gc2VsZi5zY3JvbGxlci5xdWVyeVNlbGVjdG9yQWxsKFNFTEVDVE9SX1NMSURFUl9JVEVNKTtcblx0XHRcdHZhciBpdGVtcyA9IFtdO1xuXHRcdFx0Zm9yICh2YXIgaSA9IDAsIGxlbiA9IHRlbXBzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdFx0XHRcdHZhciBpdGVtID0gdGVtcHNbaV07XG5cdFx0XHRcdGlmIChpdGVtLnBhcmVudE5vZGUgPT09IHNlbGYuc2Nyb2xsZXIpIHtcblx0XHRcdFx0XHRpdGVtcy5wdXNoKGl0ZW0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHR2YXIgX3NsaWRlTnVtYmVyID0gZGV0YWlsLnNsaWRlTnVtYmVyO1xuXHRcdFx0aWYgKHNlbGYubG9vcCkge1xuXHRcdFx0XHRfc2xpZGVOdW1iZXIgKz0gMTtcblx0XHRcdH1cblx0XHRcdGlmICghc2VsZi53cmFwcGVyLmNsYXNzTGlzdC5jb250YWlucygnbXVpLXNlZ21lbnRlZC1jb250cm9sJykpIHtcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDAsIGxlbiA9IGl0ZW1zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdFx0XHRcdFx0dmFyIGl0ZW0gPSBpdGVtc1tpXTtcblx0XHRcdFx0XHRpZiAoaXRlbS5wYXJlbnROb2RlID09PSBzZWxmLnNjcm9sbGVyKSB7XG5cdFx0XHRcdFx0XHRpZiAoaSA9PT0gX3NsaWRlTnVtYmVyKSB7XG5cdFx0XHRcdFx0XHRcdGl0ZW0uY2xhc3NMaXN0LmFkZChDTEFTU19BQ1RJVkUpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0aXRlbS5jbGFzc0xpc3QucmVtb3ZlKENMQVNTX0FDVElWRSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHR2YXIgaW5kaWNhdG9yV3JhcCA9IHNlbGYud3JhcHBlci5xdWVyeVNlbGVjdG9yKCcubXVpLXNsaWRlci1pbmRpY2F0b3InKTtcblx0XHRcdGlmIChpbmRpY2F0b3JXcmFwKSB7XG5cdFx0XHRcdGlmIChpbmRpY2F0b3JXcmFwLmdldEF0dHJpYnV0ZSgnZGF0YS1zY3JvbGwnKSkgeyAvL3Njcm9sbFxuXHRcdFx0XHRcdCQoaW5kaWNhdG9yV3JhcCkuc2Nyb2xsKCkuZ290b1BhZ2UoZGV0YWlsLnNsaWRlTnVtYmVyKTtcblx0XHRcdFx0fVxuXHRcdFx0XHR2YXIgaW5kaWNhdG9ycyA9IGluZGljYXRvcldyYXAucXVlcnlTZWxlY3RvckFsbCgnLm11aS1pbmRpY2F0b3InKTtcblx0XHRcdFx0aWYgKGluZGljYXRvcnMubGVuZ3RoID4gMCkgeyAvL+WbvueJh+i9ruaSrVxuXHRcdFx0XHRcdGZvciAodmFyIGkgPSAwLCBsZW4gPSBpbmRpY2F0b3JzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdFx0XHRcdFx0XHRpbmRpY2F0b3JzW2ldLmNsYXNzTGlzdFtpID09PSBkZXRhaWwuc2xpZGVOdW1iZXIgPyAnYWRkJyA6ICdyZW1vdmUnXShDTEFTU19BQ1RJVkUpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR2YXIgbnVtYmVyID0gaW5kaWNhdG9yV3JhcC5xdWVyeVNlbGVjdG9yKCcubXVpLW51bWJlciBzcGFuJyk7XG5cdFx0XHRcdFx0aWYgKG51bWJlcikgeyAvL+WbvuaWh+ihqOagvFxuXHRcdFx0XHRcdFx0bnVtYmVyLmlubmVyVGV4dCA9IChkZXRhaWwuc2xpZGVOdW1iZXIgKyAxKTtcblx0XHRcdFx0XHR9IGVsc2UgeyAvL3NlZ21lbnRlZCBjb250cm9sc1xuXHRcdFx0XHRcdFx0dmFyIGNvbnRyb2xJdGVtcyA9IGluZGljYXRvcldyYXAucXVlcnlTZWxlY3RvckFsbCgnLm11aS1jb250cm9sLWl0ZW0nKTtcblx0XHRcdFx0XHRcdGZvciAodmFyIGkgPSAwLCBsZW4gPSBjb250cm9sSXRlbXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0Y29udHJvbEl0ZW1zW2ldLmNsYXNzTGlzdFtpID09PSBkZXRhaWwuc2xpZGVOdW1iZXIgPyAnYWRkJyA6ICdyZW1vdmUnXShDTEFTU19BQ1RJVkUpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHR9LFxuXHRcdF9oYW5kbGVUYWJTaG93OiBmdW5jdGlvbihlKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHRzZWxmLmdvdG9JdGVtKChlLmRldGFpbC50YWJOdW1iZXIgfHwgMCksIHNlbGYub3B0aW9ucy5zbGlkZVRpbWUpO1xuXHRcdH0sXG5cdFx0X2hhbmRsZUluZGljYXRvclRhcDogZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQ7XG5cdFx0XHRpZiAodGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhDTEFTU19BQ1RJT05fUFJFVklPVVMpIHx8IHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfQUNUSU9OX05FWFQpKSB7XG5cdFx0XHRcdHNlbGZbdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhDTEFTU19BQ1RJT05fUFJFVklPVVMpID8gJ3ByZXZJdGVtJyA6ICduZXh0SXRlbSddKCk7XG5cdFx0XHRcdGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0X2luaXRFdmVudDogZnVuY3Rpb24oZGV0YWNoKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHRzZWxmLl9zdXBlcihkZXRhY2gpO1xuXHRcdFx0dmFyIGFjdGlvbiA9IGRldGFjaCA/ICdyZW1vdmVFdmVudExpc3RlbmVyJyA6ICdhZGRFdmVudExpc3RlbmVyJztcblx0XHRcdHNlbGYud3JhcHBlclthY3Rpb25dKCdzbGlkZScsIHRoaXMpO1xuXHRcdFx0c2VsZi53cmFwcGVyW2FjdGlvbl0oJC5ldmVudE5hbWUoJ3Nob3duJywgJ3RhYicpLCB0aGlzKTtcblx0XHR9LFxuXHRcdGhhbmRsZUV2ZW50OiBmdW5jdGlvbihlKSB7XG5cdFx0XHR0aGlzLl9zdXBlcihlKTtcblx0XHRcdHN3aXRjaCAoZS50eXBlKSB7XG5cdFx0XHRcdGNhc2UgJ3NsaWRlJzpcblx0XHRcdFx0XHR0aGlzLl9oYW5kbGVTbGlkZShlKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAkLmV2ZW50TmFtZSgnc2hvd24nLCAndGFiJyk6XG5cdFx0XHRcdFx0aWYgKH50aGlzLnNuYXBzLmluZGV4T2YoZS50YXJnZXQpKSB7IC8v6YG/5YWN5bWM5aWX55uR5ZCs6ZSZ6K+v55qEdGFiIHNob3dcblx0XHRcdFx0XHRcdHRoaXMuX2hhbmRsZVRhYlNob3coZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0X3Njcm9sbGVuZDogZnVuY3Rpb24oZSkge1xuXHRcdFx0dGhpcy5fc3VwZXIoZSk7XG5cdFx0XHR0aGlzLl90cmlnZ2VyU2xpZGUoZSk7XG5cdFx0fSxcblx0XHRfZHJhZzogZnVuY3Rpb24oZSkge1xuXHRcdFx0dGhpcy5fc3VwZXIoZSk7XG5cdFx0XHR2YXIgZGlyZWN0aW9uID0gZS5kZXRhaWwuZGlyZWN0aW9uO1xuXHRcdFx0aWYgKGRpcmVjdGlvbiA9PT0gJ2xlZnQnIHx8IGRpcmVjdGlvbiA9PT0gJ3JpZ2h0Jykge1xuXHRcdFx0XHQvL+aLluaLveacn+mXtOWPlua2iOWumuaXtlxuXHRcdFx0XHR2YXIgc2xpZGVyc2hvd1RpbWVyID0gdGhpcy53cmFwcGVyLmdldEF0dHJpYnV0ZSgnZGF0YS1zbGlkZXJzaG93VGltZXInKTtcblx0XHRcdFx0c2xpZGVyc2hvd1RpbWVyICYmIHdpbmRvdy5jbGVhclRpbWVvdXQoc2xpZGVyc2hvd1RpbWVyKTtcblxuXHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0X2luaXRUaW1lcjogZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHR2YXIgc2xpZGVyID0gc2VsZi53cmFwcGVyO1xuXHRcdFx0dmFyIGludGVydmFsID0gc2VsZi5vcHRpb25zLmludGVydmFsO1xuXHRcdFx0dmFyIHNsaWRlcnNob3dUaW1lciA9IHNsaWRlci5nZXRBdHRyaWJ1dGUoJ2RhdGEtc2xpZGVyc2hvd1RpbWVyJyk7XG5cdFx0XHRzbGlkZXJzaG93VGltZXIgJiYgd2luZG93LmNsZWFyVGltZW91dChzbGlkZXJzaG93VGltZXIpO1xuXHRcdFx0aWYgKGludGVydmFsKSB7XG5cdFx0XHRcdHNsaWRlcnNob3dUaW1lciA9IHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGlmICghc2xpZGVyKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdC8v5LuFc2xpZGVy5pi+56S654q25oCB6L+b6KGM6Ieq5Yqo6L2u5pKtXG5cdFx0XHRcdFx0aWYgKCEhKHNsaWRlci5vZmZzZXRXaWR0aCB8fCBzbGlkZXIub2Zmc2V0SGVpZ2h0KSkge1xuXHRcdFx0XHRcdFx0c2VsZi5uZXh0SXRlbSh0cnVlKTtcblx0XHRcdFx0XHRcdC8v5LiL5LiA5LiqXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHNlbGYuX2luaXRUaW1lcigpO1xuXHRcdFx0XHR9LCBpbnRlcnZhbCk7XG5cdFx0XHRcdHNsaWRlci5zZXRBdHRyaWJ1dGUoJ2RhdGEtc2xpZGVyc2hvd1RpbWVyJywgc2xpZGVyc2hvd1RpbWVyKTtcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0X2ZpeGVkU2xpZGVOdW1iZXI6IGZ1bmN0aW9uKHBhZ2UpIHtcblx0XHRcdHBhZ2UgPSBwYWdlIHx8IHRoaXMuY3VycmVudFBhZ2U7XG5cdFx0XHR2YXIgc2xpZGVOdW1iZXIgPSBwYWdlLnBhZ2VYO1xuXHRcdFx0aWYgKHRoaXMubG9vcCkge1xuXHRcdFx0XHRpZiAocGFnZS5wYWdlWCA9PT0gMCkge1xuXHRcdFx0XHRcdHNsaWRlTnVtYmVyID0gdGhpcy5pdGVtTGVuZ3RoIC0gMztcblx0XHRcdFx0fSBlbHNlIGlmIChwYWdlLnBhZ2VYID09PSAodGhpcy5pdGVtTGVuZ3RoIC0gMSkpIHtcblx0XHRcdFx0XHRzbGlkZU51bWJlciA9IDA7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0c2xpZGVOdW1iZXIgPSBwYWdlLnBhZ2VYIC0gMTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHNsaWRlTnVtYmVyO1xuXHRcdH0sXG5cdFx0X3JlTGF5b3V0OiBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMuaGFzSG9yaXpvbnRhbFNjcm9sbCA9IHRydWU7XG5cdFx0XHR0aGlzLmxvb3AgPSB0aGlzLnNjcm9sbGVyLmNsYXNzTGlzdC5jb250YWlucyhDTEFTU19TTElERVJfTE9PUCk7XG5cdFx0XHR0aGlzLl9zdXBlcigpO1xuXHRcdH0sXG5cdFx0X2dldFNjcm9sbDogZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgcmVzdWx0ID0gJC5wYXJzZVRyYW5zbGF0ZU1hdHJpeCgkLmdldFN0eWxlcyh0aGlzLnNjcm9sbGVyLCAnd2Via2l0VHJhbnNmb3JtJykpO1xuXHRcdFx0cmV0dXJuIHJlc3VsdCA/IHJlc3VsdC54IDogMDtcblx0XHR9LFxuXHRcdF90cmFuc2l0aW9uRW5kOiBmdW5jdGlvbihlKSB7XG5cdFx0XHRpZiAoZS50YXJnZXQgIT09IHRoaXMuc2Nyb2xsZXIgfHwgIXRoaXMuaXNJblRyYW5zaXRpb24pIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5fdHJhbnNpdGlvblRpbWUoKTtcblx0XHRcdHRoaXMuaXNJblRyYW5zaXRpb24gPSBmYWxzZTtcblx0XHRcdCQudHJpZ2dlcih0aGlzLndyYXBwZXIsICdzY3JvbGxlbmQnLCB0aGlzKTtcblx0XHR9LFxuXHRcdF9mbGljazogZnVuY3Rpb24oZSkge1xuXHRcdFx0aWYgKCF0aGlzLm1vdmVkKSB7IC8v5pegbW92ZWRcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0dmFyIGRldGFpbCA9IGUuZGV0YWlsO1xuXHRcdFx0dmFyIGRpcmVjdGlvbiA9IGRldGFpbC5kaXJlY3Rpb247XG5cdFx0XHR0aGlzLl9jbGVhclJlcXVlc3RBbmltYXRpb25GcmFtZSgpO1xuXHRcdFx0dGhpcy5pc0luVHJhbnNpdGlvbiA9IHRydWU7XG5cdFx0XHQvL1x0XHRcdGlmIChkaXJlY3Rpb24gPT09ICd1cCcgfHwgZGlyZWN0aW9uID09PSAnZG93bicpIHtcblx0XHRcdC8vXHRcdFx0XHR0aGlzLnJlc2V0UG9zaXRpb24odGhpcy5vcHRpb25zLmJvdW5jZVRpbWUpO1xuXHRcdFx0Ly9cdFx0XHRcdHJldHVybjtcblx0XHRcdC8vXHRcdFx0fVxuXHRcdFx0aWYgKGUudHlwZSA9PT0gJ2ZsaWNrJykge1xuXHRcdFx0XHRpZiAoZGV0YWlsLmRlbHRhVGltZSA8IDIwMCkgeyAvL2ZsaWNr77yM5aSq5a655piT6Kem5Y+R77yM6aKd5aSW5qCh6aqM5LiA5LiLZGVsdGFUaW1lXG5cdFx0XHRcdFx0dGhpcy54ID0gdGhpcy5fZ2V0UGFnZSgodGhpcy5zbGlkZU51bWJlciArIChkaXJlY3Rpb24gPT09ICdyaWdodCcgPyAtMSA6IDEpKSwgdHJ1ZSkueDtcblx0XHRcdFx0fVxuXHRcdFx0XHR0aGlzLnJlc2V0UG9zaXRpb24odGhpcy5vcHRpb25zLmJvdW5jZVRpbWUpO1xuXHRcdFx0fSBlbHNlIGlmIChlLnR5cGUgPT09ICdkcmFnZW5kJyAmJiAhZGV0YWlsLmZsaWNrKSB7XG5cdFx0XHRcdHRoaXMucmVzZXRQb3NpdGlvbih0aGlzLm9wdGlvbnMuYm91bmNlVGltZSk7XG5cdFx0XHR9XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdH0sXG5cdFx0X2luaXRTbmFwOiBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMuc2Nyb2xsZXJXaWR0aCA9IHRoaXMuaXRlbUxlbmd0aCAqIHRoaXMuc2Nyb2xsZXJXaWR0aDtcblx0XHRcdHRoaXMubWF4U2Nyb2xsWCA9IE1hdGgubWluKHRoaXMud3JhcHBlcldpZHRoIC0gdGhpcy5zY3JvbGxlcldpZHRoLCAwKTtcblx0XHRcdHRoaXMuX3N1cGVyKCk7XG5cdFx0XHRpZiAoIXRoaXMuY3VycmVudFBhZ2UueCkge1xuXHRcdFx0XHQvL+W9k3NsaWRlcuWkhOS6jumakOiXj+eKtuaAgeaXtu+8jOWvvOiHtHNuYXDorqHnrpfmmK/plJnor6/nmoTvvIzkuLTml7blhYjov5nkuYjliKTmlq3kuIDkuIvvvIzlkI7nu63opoHogIPomZHop6PlhrPmiYDmnIlzY3JvbGzlnKjpmpDol4/nirbmgIHkuIvliJ3lp4vljJblsZ7mgKfkuI3mraPnoa7nmoTpl67pophcblx0XHRcdFx0dmFyIGN1cnJlbnRQYWdlID0gdGhpcy5wYWdlc1t0aGlzLmxvb3AgPyAxIDogMF07XG5cdFx0XHRcdGN1cnJlbnRQYWdlID0gY3VycmVudFBhZ2UgfHwgdGhpcy5wYWdlc1swXTtcblx0XHRcdFx0aWYgKCFjdXJyZW50UGFnZSkge1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0XHR0aGlzLmN1cnJlbnRQYWdlID0gY3VycmVudFBhZ2VbMF07XG5cdFx0XHRcdHRoaXMuc2xpZGVOdW1iZXIgPSAwO1xuXHRcdFx0XHR0aGlzLmxhc3RTbGlkZU51bWJlciA9IHR5cGVvZiB0aGlzLmxhc3RTbGlkZU51bWJlciA9PT0gJ3VuZGVmaW5lZCcgPyAwIDogdGhpcy5sYXN0U2xpZGVOdW1iZXI7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLnNsaWRlTnVtYmVyID0gdGhpcy5fZml4ZWRTbGlkZU51bWJlcigpO1xuXHRcdFx0XHR0aGlzLmxhc3RTbGlkZU51bWJlciA9IHR5cGVvZiB0aGlzLmxhc3RTbGlkZU51bWJlciA9PT0gJ3VuZGVmaW5lZCcgPyB0aGlzLnNsaWRlTnVtYmVyIDogdGhpcy5sYXN0U2xpZGVOdW1iZXI7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLm9wdGlvbnMuc3RhcnRYID0gdGhpcy5jdXJyZW50UGFnZS54IHx8IDA7XG5cdFx0fSxcblx0XHRfZ2V0U25hcFg6IGZ1bmN0aW9uKG9mZnNldExlZnQpIHtcblx0XHRcdHJldHVybiBNYXRoLm1heCgtb2Zmc2V0TGVmdCwgdGhpcy5tYXhTY3JvbGxYKTtcblx0XHR9LFxuXHRcdF9nZXRQYWdlOiBmdW5jdGlvbihzbGlkZU51bWJlciwgaXNGbGljaykge1xuXHRcdFx0aWYgKHRoaXMubG9vcCkge1xuXHRcdFx0XHRpZiAoc2xpZGVOdW1iZXIgPiAodGhpcy5pdGVtTGVuZ3RoIC0gKGlzRmxpY2sgPyAyIDogMykpKSB7XG5cdFx0XHRcdFx0c2xpZGVOdW1iZXIgPSAxO1xuXHRcdFx0XHRcdHRpbWUgPSAwO1xuXHRcdFx0XHR9IGVsc2UgaWYgKHNsaWRlTnVtYmVyIDwgKGlzRmxpY2sgPyAtMSA6IDApKSB7XG5cdFx0XHRcdFx0c2xpZGVOdW1iZXIgPSB0aGlzLml0ZW1MZW5ndGggLSAyO1xuXHRcdFx0XHRcdHRpbWUgPSAwO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHNsaWRlTnVtYmVyICs9IDE7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmICghaXNGbGljaykge1xuXHRcdFx0XHRcdGlmIChzbGlkZU51bWJlciA+ICh0aGlzLml0ZW1MZW5ndGggLSAxKSkge1xuXHRcdFx0XHRcdFx0c2xpZGVOdW1iZXIgPSAwO1xuXHRcdFx0XHRcdFx0dGltZSA9IDA7XG5cdFx0XHRcdFx0fSBlbHNlIGlmIChzbGlkZU51bWJlciA8IDApIHtcblx0XHRcdFx0XHRcdHNsaWRlTnVtYmVyID0gdGhpcy5pdGVtTGVuZ3RoIC0gMTtcblx0XHRcdFx0XHRcdHRpbWUgPSAwO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRzbGlkZU51bWJlciA9IE1hdGgubWluKE1hdGgubWF4KDAsIHNsaWRlTnVtYmVyKSwgdGhpcy5pdGVtTGVuZ3RoIC0gMSk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdGhpcy5wYWdlc1tzbGlkZU51bWJlcl1bMF07XG5cdFx0fSxcblx0XHRfZ290b0l0ZW06IGZ1bmN0aW9uKHNsaWRlTnVtYmVyLCB0aW1lKSB7XG5cdFx0XHR0aGlzLmN1cnJlbnRQYWdlID0gdGhpcy5fZ2V0UGFnZShzbGlkZU51bWJlciwgdHJ1ZSk7IC8v5q2k5aSE5LygdHJ1ZeOAguWPr+S/neivgeeoi+W6j+WIh+aNouaXtu+8jOWKqOeUu+S4juS6uuaJi+aTjeS9nOS4gOiHtCjnrKzkuIDlvKDvvIzmnIDlkI7kuIDlvKDnmoTliIfmjaLliqjnlLspXG5cdFx0XHR0aGlzLnNjcm9sbFRvKHRoaXMuY3VycmVudFBhZ2UueCwgMCwgdGltZSwgdGhpcy5vcHRpb25zLnNjcm9sbEVhc2luZyk7XG5cdFx0XHRpZiAodGltZSA9PT0gMCkge1xuXHRcdFx0XHQkLnRyaWdnZXIodGhpcy53cmFwcGVyLCAnc2Nyb2xsZW5kJywgdGhpcyk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHQvL0FQSVxuXHRcdHNldFRyYW5zbGF0ZTogZnVuY3Rpb24oeCwgeSkge1xuXHRcdFx0dGhpcy5fc3VwZXIoeCwgeSk7XG5cdFx0XHR2YXIgcHJvZ3Jlc3NCYXIgPSB0aGlzLnByb2dyZXNzQmFyO1xuXHRcdFx0aWYgKHByb2dyZXNzQmFyKSB7XG5cdFx0XHRcdHRoaXMucHJvZ3Jlc3NCYXJTdHlsZS53ZWJraXRUcmFuc2Zvcm0gPSB0aGlzLl9nZXRUcmFuc2xhdGVTdHIoKC14ICogKHRoaXMucHJvZ3Jlc3NCYXJXaWR0aCAvIHRoaXMud3JhcHBlcldpZHRoKSksIDApO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0cmVzZXRQb3NpdGlvbjogZnVuY3Rpb24odGltZSkge1xuXHRcdFx0dGltZSA9IHRpbWUgfHwgMDtcblx0XHRcdGlmICh0aGlzLnggPiAwKSB7XG5cdFx0XHRcdHRoaXMueCA9IDA7XG5cdFx0XHR9IGVsc2UgaWYgKHRoaXMueCA8IHRoaXMubWF4U2Nyb2xsWCkge1xuXHRcdFx0XHR0aGlzLnggPSB0aGlzLm1heFNjcm9sbFg7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLmN1cnJlbnRQYWdlID0gdGhpcy5fbmVhcmVzdFNuYXAodGhpcy54KTtcblx0XHRcdHRoaXMuc2Nyb2xsVG8odGhpcy5jdXJyZW50UGFnZS54LCAwLCB0aW1lLCB0aGlzLm9wdGlvbnMuc2Nyb2xsRWFzaW5nKTtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH0sXG5cdFx0Z290b0l0ZW06IGZ1bmN0aW9uKHNsaWRlTnVtYmVyLCB0aW1lKSB7XG5cdFx0XHR0aGlzLl9nb3RvSXRlbShzbGlkZU51bWJlciwgdHlwZW9mIHRpbWUgPT09ICd1bmRlZmluZWQnID8gdGhpcy5vcHRpb25zLnNjcm9sbFRpbWUgOiB0aW1lKTtcblx0XHR9LFxuXHRcdG5leHRJdGVtOiBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMuX2dvdG9JdGVtKHRoaXMuc2xpZGVOdW1iZXIgKyAxLCB0aGlzLm9wdGlvbnMuc2Nyb2xsVGltZSk7XG5cdFx0fSxcblx0XHRwcmV2SXRlbTogZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLl9nb3RvSXRlbSh0aGlzLnNsaWRlTnVtYmVyIC0gMSwgdGhpcy5vcHRpb25zLnNjcm9sbFRpbWUpO1xuXHRcdH0sXG5cdFx0Z2V0U2xpZGVOdW1iZXI6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuc2xpZGVOdW1iZXIgfHwgMDtcblx0XHR9LFxuXHRcdF9yZUluaXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIGdyb3VwcyA9IHRoaXMud3JhcHBlci5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIENMQVNTX1NMSURFUl9HUk9VUCk7XG5cdFx0XHRmb3IgKHZhciBpID0gMCwgbGVuID0gZ3JvdXBzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdFx0XHRcdGlmIChncm91cHNbaV0ucGFyZW50Tm9kZSA9PT0gdGhpcy53cmFwcGVyKSB7XG5cdFx0XHRcdFx0dGhpcy5zY3JvbGxlciA9IGdyb3Vwc1tpXTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0dGhpcy5zY3JvbGxlclN0eWxlID0gdGhpcy5zY3JvbGxlciAmJiB0aGlzLnNjcm9sbGVyLnN0eWxlO1xuXHRcdFx0aWYgKHRoaXMucHJvZ3Jlc3NCYXIpIHtcblx0XHRcdFx0dGhpcy5wcm9ncmVzc0JhcldpZHRoID0gdGhpcy5wcm9ncmVzc0Jhci5vZmZzZXRXaWR0aDtcblx0XHRcdFx0dGhpcy5wcm9ncmVzc0JhclN0eWxlID0gdGhpcy5wcm9ncmVzc0Jhci5zdHlsZTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdHJlZnJlc2g6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRcdGlmIChvcHRpb25zKSB7XG5cdFx0XHRcdCQuZXh0ZW5kKHRoaXMub3B0aW9ucywgb3B0aW9ucyk7XG5cdFx0XHRcdHRoaXMuX3N1cGVyKCk7XG5cdFx0XHRcdHRoaXMuX2luaXRUaW1lcigpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5fc3VwZXIoKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5faW5pdEV2ZW50KHRydWUpOyAvL2RldGFjaFxuXHRcdFx0ZGVsZXRlICQuZGF0YVt0aGlzLndyYXBwZXIuZ2V0QXR0cmlidXRlKCdkYXRhLXNsaWRlcicpXTtcblx0XHRcdHRoaXMud3JhcHBlci5zZXRBdHRyaWJ1dGUoJ2RhdGEtc2xpZGVyJywgJycpO1xuXHRcdH1cblx0fSk7XG5cdCQuZm4uc2xpZGVyID0gZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdHZhciBzbGlkZXIgPSBudWxsO1xuXHRcdHRoaXMuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdHZhciBzbGlkZXJFbGVtZW50ID0gdGhpcztcblx0XHRcdGlmICghdGhpcy5jbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfU0xJREVSKSkge1xuXHRcdFx0XHRzbGlkZXJFbGVtZW50ID0gdGhpcy5xdWVyeVNlbGVjdG9yKCcuJyArIENMQVNTX1NMSURFUik7XG5cdFx0XHR9XG5cdFx0XHRpZiAoc2xpZGVyRWxlbWVudCAmJiBzbGlkZXJFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoU0VMRUNUT1JfU0xJREVSX0lURU0pKSB7XG5cdFx0XHRcdHZhciBpZCA9IHNsaWRlckVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLXNsaWRlcicpO1xuXHRcdFx0XHRpZiAoIWlkKSB7XG5cdFx0XHRcdFx0aWQgPSArKyQudXVpZDtcblx0XHRcdFx0XHQkLmRhdGFbaWRdID0gc2xpZGVyID0gbmV3IFNsaWRlcihzbGlkZXJFbGVtZW50LCBvcHRpb25zKTtcblx0XHRcdFx0XHRzbGlkZXJFbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1zbGlkZXInLCBpZCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0c2xpZGVyID0gJC5kYXRhW2lkXTtcblx0XHRcdFx0XHRpZiAoc2xpZGVyICYmIG9wdGlvbnMpIHtcblx0XHRcdFx0XHRcdHNsaWRlci5yZWZyZXNoKG9wdGlvbnMpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdHJldHVybiBzbGlkZXI7XG5cdH07XG5cdCQucmVhZHkoZnVuY3Rpb24oKSB7XG5cdFx0Ly9cdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHQkKCcubXVpLXNsaWRlcicpLnNsaWRlcigpO1xuXHRcdCQoJy5tdWktc2Nyb2xsLXdyYXBwZXIubXVpLXNsaWRlci1pbmRpY2F0b3IubXVpLXNlZ21lbnRlZC1jb250cm9sJykuc2Nyb2xsKHtcblx0XHRcdHNjcm9sbFk6IGZhbHNlLFxuXHRcdFx0c2Nyb2xsWDogdHJ1ZSxcblx0XHRcdGluZGljYXRvcnM6IGZhbHNlLFxuXHRcdFx0c25hcDogJy5tdWktY29udHJvbC1pdGVtJ1xuXHRcdH0pO1xuXHRcdC8vXHRcdH0sIDUwMCk7IC8v5Li05pe25aSE55CGc2xpZGVy5a695bqm6K6h566X5LiN5q2j56Gu55qE6Zeu6aKYKOWIneatpeehruiupOaYr3Njcm9sbGJhcuWvvOiHtOeahClcblxuXHR9KTtcbn0pKG11aSwgd2luZG93KTtcbi8qKlxuICogcHVsbFJlZnJlc2ggNStcbiAqIEBwYXJhbSB7dHlwZX0gJFxuICogQHJldHVybnMge3VuZGVmaW5lZH1cbiAqL1xuKGZ1bmN0aW9uKCQsIGRvY3VtZW50KSB7XG4gICAgaWYgKCEoJC5vcy5wbHVzKSkgeyAvL+S7heWcqDUrYW5kcm9pZOaUr+aMgeWkmndlYnZpZXfnmoTkvb/nlKhcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAkLnBsdXNSZWFkeShmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHdpbmRvdy5fX05XaW5fRW5hYmxlX18gPT09IGZhbHNlKSB7IC8v5LiN5pSv5oyB5aSad2Vidmlld++8jOWImeS4jeeUqDUr5LiL5ouJ5Yi35pawXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIENMQVNTX1BMVVNfUFVMTFJFRlJFU0ggPSAnbXVpLXBsdXMtcHVsbHJlZnJlc2gnO1xuICAgICAgICB2YXIgQ0xBU1NfVklTSUJJTElUWSA9ICdtdWktdmlzaWJpbGl0eSc7XG4gICAgICAgIHZhciBDTEFTU19ISURERU4gPSAnbXVpLWhpZGRlbic7XG4gICAgICAgIHZhciBDTEFTU19CTE9DSyA9ICdtdWktYmxvY2snO1xuXG4gICAgICAgIHZhciBDTEFTU19QVUxMX0NBUFRJT04gPSAnbXVpLXB1bGwtY2FwdGlvbic7XG4gICAgICAgIHZhciBDTEFTU19QVUxMX0NBUFRJT05fRE9XTiA9ICdtdWktcHVsbC1jYXB0aW9uLWRvd24nO1xuICAgICAgICB2YXIgQ0xBU1NfUFVMTF9DQVBUSU9OX1JFRlJFU0ggPSAnbXVpLXB1bGwtY2FwdGlvbi1yZWZyZXNoJztcbiAgICAgICAgdmFyIENMQVNTX1BVTExfQ0FQVElPTl9OT01PUkUgPSAnbXVpLXB1bGwtY2FwdGlvbi1ub21vcmUnO1xuXG4gICAgICAgIHZhciBQbHVzUHVsbFJlZnJlc2ggPSAkLkNsYXNzLmV4dGVuZCh7XG4gICAgICAgICAgICBpbml0OiBmdW5jdGlvbihlbGVtZW50LCBvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlciA9IHRoaXMuc2Nyb2xsZXIgPSBlbGVtZW50O1xuICAgICAgICAgICAgICAgIHRoaXMuX2luaXQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9pbml0UHVsbGRvd25SZWZyZXNoRXZlbnQoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgICAgIC8vZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigncGx1c3Njcm9sbGJvdHRvbScsIHRoaXMpO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdkcmFndXAnLCBzZWxmKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwicGx1c3Njcm9sbGJvdHRvbVwiLCBzZWxmKTtcbiAgICAgICAgICAgICAgICBzZWxmLnNjcm9sbEludGVydmFsID0gd2luZG93LnNldEludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5pc1Njcm9sbCAmJiAhc2VsZi5sb2FkaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LnBhZ2VZT2Zmc2V0ICsgd2luZG93LmlubmVySGVpZ2h0ICsgMTAgPj0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbEhlaWdodCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuaXNTY3JvbGwgPSBmYWxzZTsgLy/mlL7lnKjov5nph4zmmK/lm6DkuLrlv6vpgJ/mu5rliqjnmoTor53vvIzmnInlj6/og73mo4DmtYvml7bvvIzov5jmsqHliLDlupXvvIzmiYDku6Xlj6ropoHmnInmu5rliqjvvIzmsqHliLDlupXkuYvliY3kuIDnm7Tmo4DmtYvpq5jluqblj5jljJZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5ib3R0b21Qb2NrZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5wdWxsdXBMb2FkaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdFB1bGxkb3duUmVmcmVzaEV2ZW50OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICAgICAgJC5wbHVzUmVhZHkoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgXHRcdGlmKHNlbGYub3B0aW9ucy5kb3duLnN0eWxlID09IFwiY2lyY2xlXCIpe1xuXHQgICAgICAgICAgICAgICAgXHRcdC8v5Y2Vd2Vidmlld+OAgeWOn+eUn+i9rOWciFxuXHQgICAgICAgICAgICAgICAgXHRcdHNlbGYub3B0aW9ucy53ZWJ2aWV3ID0gcGx1cy53ZWJ2aWV3LmN1cnJlbnRXZWJ2aWV3KCk7XG5cdFx0XHRcdFx0XHRzZWxmLm9wdGlvbnMud2Vidmlldy5zZXRQdWxsVG9SZWZyZXNoKHtcblx0XHRcdFx0XHRcdFx0c3VwcG9ydDogdHJ1ZSxcblx0XHRcdFx0XHRcdFx0Y29sb3I6c2VsZi5vcHRpb25zLmRvd24uY29sb3IgfHwgJyMyQkQwMDknLFxuXHRcdFx0XHRcdFx0XHRoZWlnaHQ6IHNlbGYub3B0aW9ucy5kb3duLmhlaWdodCB8fCAnNTBweCcsXG5cdFx0XHRcdFx0XHRcdHJhbmdlOiBzZWxmLm9wdGlvbnMuZG93bi5yYW5nZSB8fCAnMTAwcHgnLFxuXHRcdFx0XHRcdFx0XHRzdHlsZTogJ2NpcmNsZScsXG5cdFx0XHRcdFx0XHRcdG9mZnNldDogc2VsZi5vcHRpb25zLmRvd24ub2Zmc2V0IHx8ICcwcHgnXG5cdFx0XHRcdFx0XHR9LCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0c2VsZi5vcHRpb25zLmRvd24uY2FsbGJhY2soKTtcblx0XHRcdFx0XHRcdH0pO1xuXHQgICAgICAgICAgICAgICB9ZWxzZSBpZiAoc2VsZi50b3BQb2NrZXQgJiYgc2VsZi5vcHRpb25zLndlYnZpZXdJZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdlYnZpZXcgPSBwbHVzLndlYnZpZXcuZ2V0V2Vidmlld0J5SWQoc2VsZi5vcHRpb25zLndlYnZpZXdJZCk7Ly/lrZDnqpflj6NcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghd2Vidmlldykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYub3B0aW9ucy53ZWJ2aWV3ID0gd2VidmlldztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkb3duT3B0aW9ucyA9IHNlbGYub3B0aW9ucy5kb3duO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IGRvd25PcHRpb25zLmhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdlYnZpZXcuYWRkRXZlbnRMaXN0ZW5lcignY2xvc2UnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0cldlYnZpZXdJZCA9IHNlbGYub3B0aW9ucy53ZWJ2aWV3SWQgJiYgc2VsZi5vcHRpb25zLndlYnZpZXdJZC5yZXBsYWNlKC9cXC8vZywgXCJfXCIpOyAvL+abv+aNouaJgOaciVwiL1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5lbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1wdWxscmVmcmVzaC1wbHVzLScgKyBhdHRyV2Vidmlld0lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2Vidmlldy5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ0JvdW5jZVwiLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzZWxmLnB1bGxkb3duKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2luaXRQdWxsZG93blJlZnJlc2goKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnB1bGxQb2NrZXQuY2xhc3NMaXN0LmFkZChDTEFTU19CTE9DSyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoZS5zdGF0dXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImJlZm9yZUNoYW5nZU9mZnNldFwiOiAvL+S4i+aLieWPr+WIt+aWsOeKtuaAgVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fc2V0Q2FwdGlvbihkb3duT3B0aW9ucy5jb250ZW50ZG93bik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImFmdGVyQ2hhbmdlT2Zmc2V0XCI6IC8v5p2+5byA5Y+v5Yi35paw54q25oCBXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9zZXRDYXB0aW9uKGRvd25PcHRpb25zLmNvbnRlbnRvdmVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZHJhZ0VuZEFmdGVyQ2hhbmdlT2Zmc2V0XCI6IC8v5q2j5Zyo5Yi35paw54q25oCBXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+aJp+ihjOS4i+aLieWIt+aWsOaJgOWcqHdlYnZpZXfnmoTlm57osIPlh73mlbBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdlYnZpZXcuZXZhbEpTKFwid2luZG93Lm11aSYmbXVpLm9wdGlvbnMucHVsbFJlZnJlc2guZG93bi5jYWxsYmFjaygpXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fc2V0Q2FwdGlvbihkb3duT3B0aW9ucy5jb250ZW50cmVmcmVzaCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZhbHNlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgd2Vidmlldy5zZXRCb3VuY2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogaGVpZ2h0ICogMiArICdweCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZW9mZnNldDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3A6IGhlaWdodCArICdweCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXHQgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGhhbmRsZUV2ZW50OiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLnN0b3BwZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZWxmLmlzU2Nyb2xsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKGUudHlwZSA9PT0gJ2RyYWd1cCcgfHwgZS50eXBlID09PSAncGx1c3Njcm9sbGJvdHRvbScpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5pc1Njcm9sbCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmlzU2Nyb2xsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH0sIDEwMDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkuZXh0ZW5kKCQuZXh0ZW5kKHtcbiAgICAgICAgICAgIHNldFN0b3BwZWQ6IGZ1bmN0aW9uKHN0b3BwZWQpIHsgLy/or6Xmlrnms5XmmK/lrZDpobXpnaLosIPnlKjnmoRcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3BwZWQgPSAhIXN0b3BwZWQ7XG4gICAgICAgICAgICAgICAgLy9UT0RPIOatpOWkhOmcgOimgeiuvue9ruW9k+WJjXdlYnZpZXfnmoRib3VuY2XkuLpub25lLOebruWJjTUr5pyJQlVHXG4gICAgICAgICAgICAgICAgdmFyIHdlYnZpZXcgPSBwbHVzLndlYnZpZXcuY3VycmVudFdlYnZpZXcoKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zdG9wcGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHdlYnZpZXcuc2V0U3R5bGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgYm91bmNlOiAnbm9uZSdcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHdlYnZpZXcuc2V0Qm91bmNlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiAnbm9uZSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IHRoaXMub3B0aW9ucy5kb3duLmhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgd2Vidmlldy5zZXRTdHlsZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICBib3VuY2U6ICd2ZXJ0aWNhbCdcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHdlYnZpZXcuc2V0Qm91bmNlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiBoZWlnaHQgKiAyICsgJ3B4J1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZW9mZnNldDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogaGVpZ2h0ICsgJ3B4J1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYmVnaW5QdWxsZG93bjpmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkLnBsdXNSZWFkeShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBcdFx0dmFyIF93diA9IHBsdXMud2Vidmlldy5jdXJyZW50V2VidmlldygpO1xuICAgICAgICAgICAgICAgIFx0XHR2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICAgICAgXHRcdC8v6L+Z6YeM5bu25pe255qE55uu55qE5piv5Li65LqG5L+d6K+B5LiL5ouJ5Yi35paw57uE5Lu25Yid5aeL5YyW5a6M5oiQ77yM5ZCO57ut5bqU6K+l5YGa5oiQ5pyJ54q25oCB55qEXG4gICAgICAgICAgICAgICAgXHRcdHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIFx0XHRcdGlmKHNlbGYub3B0aW9ucy5kb3duLnN0eWxlID09IFwiY2lyY2xlXCIpe1xuXHQgICAgICAgICAgICAgICAgXHRcdFx0X3d2LmJlZ2luUHVsbFRvUmVmcmVzaCgpO1xuXHQgICAgICAgICAgICAgICAgXHRcdH1lbHNle1xuXHQgICAgICAgICAgICAgICAgXHRcdFx0X3d2LnNldEJvdW5jZSh7XG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiB7XG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogdGhpcy5vcHRpb25zLmRvd24uaGVpZ2h0ICsgXCJweFwiXG5cdFx0ICAgICAgICAgICAgICAgICAgICAgICAgfVxuXHRcdCAgICAgICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgICAgICBcdFx0fVxuICAgICAgICAgICAgICAgIFx0XHR9LDE1KTtcbiAgICAgICAgICAgICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHB1bGxkb3duTG9hZGluZzogZnVuY3Rpb24gKCkgey8v6K+l5pa55rOV5piv5a2Q6aG16Z2i6LCD55So55qE77yM5YW85a656ICB55qE5Y6G5Y+yQVBJXG4gICAgICAgICAgICBcdFx0dGhpcy5iZWdpblB1bGxkb3duKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX3B1bGxkb3duTG9hZGluZzogZnVuY3Rpb24oKSB7IC8v6K+l5pa55rOV5piv54i26aG16Z2i6LCD55So55qEXG4gICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgICAgICQucGx1c1JlYWR5KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGRXZWJ2aWV3ID0gcGx1cy53ZWJ2aWV3LmdldFdlYnZpZXdCeUlkKHNlbGYub3B0aW9ucy53ZWJ2aWV3SWQpO1xuICAgICAgICAgICAgICAgICAgIFx0Y2hpbGRXZWJ2aWV3ICYmIGNoaWxkV2Vidmlldy5zZXRCb3VuY2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiBzZWxmLm9wdGlvbnMuZG93bi5oZWlnaHQgKyBcInB4XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZW5kUHVsbGRvd246ZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIFx0XHR2YXIgX3d2ID0gdGhpcy5vcHRpb25zLndlYnZpZXc7XG4gICAgICAgICAgICAgICAgX3d2LmVuZFB1bGxUb1JlZnJlc2goKTtcbiAgICAgICAgICAgICAgICAvL+WPjHdlYnZpZXfnmoTkuIvmi4nliLfmlrDvvIzpnIDopoHkv67mlLnniLbnqpflj6Pmj5DnpLrkv6Hmga9cbiAgICAgICAgICAgICAgICBpZihfd3YucGFyZW50KCkgJiYgdGhpcy5vcHRpb25zLmRvd24uc3R5bGUgIT09IFwiY2lyY2xlXCIpe1xuXHQgICAgICAgICAgICAgICAgXHRfd3YucGFyZW50KCkuZXZhbEpTKFwibXVpJiZtdWkoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm11aS1jb250ZW50JykpLnB1bGxSZWZyZXNoKCdcIiArIEpTT04uc3RyaW5naWZ5KHtcblx0ICAgICAgICAgICAgICAgICAgICB3ZWJ2aWV3SWQ6IF93di5pZFxuXHQgICAgICAgICAgICAgICAgfSkgKyBcIicpLl9lbmRQdWxsZG93blRvUmVmcmVzaCgpXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbmRQdWxsZG93blRvUmVmcmVzaDogZnVuY3Rpb24gKCkgey8v6K+l5pa55rOV5piv5a2Q6aG16Z2i6LCD55So55qE77yM5YW85a656ICB55qE5Y6G5Y+yQVBJXG4gICAgICAgICAgIFx0IFx0dGhpcy5lbmRQdWxsZG93bigpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9lbmRQdWxsZG93blRvUmVmcmVzaDogZnVuY3Rpb24oKSB7IC8v6K+l5pa55rOV5piv54i26aG16Z2i6LCD55So55qEXG4gICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLnRvcFBvY2tldCAmJiBzZWxmLm9wdGlvbnMud2Vidmlldykge1xuICAgICAgICAgICAgICAgICAgICAvL3NlbGYub3B0aW9ucy53ZWJ2aWV3LmVuZFB1bGxUb1JlZnJlc2goKTsgLy/kuIvmi4nliLfmlrDmiYDlnKh3ZWJ2aWV35Zue5by5XG4gICAgICAgICAgICAgICAgICAgIHNlbGYubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9zZXRDYXB0aW9uKHNlbGYub3B0aW9ucy5kb3duLmNvbnRlbnRkb3duLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubG9hZGluZyB8fCBzZWxmLnRvcFBvY2tldC5jbGFzc0xpc3QucmVtb3ZlKENMQVNTX0JMT0NLKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgMzUwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYmVnaW5QdWxsdXA6ZnVuY3Rpb24oY2FsbGJhY2spIHsvL+W8gOWni+S4iuaLieWKoOi9vVxuICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5pc0xvYWRpbmcpIHJldHVybjtcbiAgICAgICAgICAgICAgICBzZWxmLmlzTG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYucHVsbGRvd24gIT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX2luaXRQdWxsdXBSZWZyZXNoKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wdWxsUG9ja2V0LmNsYXNzTGlzdC5hZGQoQ0xBU1NfQkxPQ0spO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnB1bGxMb2FkaW5nLmNsYXNzTGlzdC5hZGQoQ0xBU1NfVklTSUJJTElUWSk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYucHVsbExvYWRpbmcuY2xhc3NMaXN0LnJlbW92ZShDTEFTU19ISURERU4pO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnB1bGxDYXB0aW9uLmlubmVySFRNTCA9ICcnOyAvL+S/ruatozUr6YeM6L6556ys5LiA5qyh5Yqg6L295pe277yM5paH5a2X5pi+56S655qEYnVnKOi/mOS8muaYvuekuuWHuuadpeS4quKAnOWkmuKAnSznjJzmtYvlupTor6XmmK/muLLmn5Ppl67popjlr7zoh7TnmoQpXG4gICAgICAgICAgICAgICAgICAgIHNlbGYucHVsbENhcHRpb24uY2xhc3NOYW1lID0gQ0xBU1NfUFVMTF9DQVBUSU9OICsgJyAnICsgQ0xBU1NfUFVMTF9DQVBUSU9OX1JFRlJFU0g7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYucHVsbENhcHRpb24uaW5uZXJIVE1MID0gc2VsZi5vcHRpb25zLnVwLmNvbnRlbnRyZWZyZXNoO1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayA9IGNhbGxiYWNrIHx8IHNlbGYub3B0aW9ucy51cC5jYWxsYmFjaztcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2suY2FsbChzZWxmKTtcbiAgICAgICAgICAgICAgICB9LCAzMDApO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHB1bGx1cExvYWRpbmc6ZnVuY3Rpb24gKGNhbGxiYWNrKSB7Ly/lhbzlrrnogIHnmoRBUElcbiAgICAgICAgICAgIFx0XHR0aGlzLmJlZ2luUHVsbHVwKGNhbGxiYWNrKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbmRQdWxsdXA6ZnVuY3Rpb24oZmluaXNoZWQpIHsvL+S4iuaLieWKoOi9vee7k+adn1xuICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5wdWxsTG9hZGluZykge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnB1bGxMb2FkaW5nLmNsYXNzTGlzdC5yZW1vdmUoQ0xBU1NfVklTSUJJTElUWSk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYucHVsbExvYWRpbmcuY2xhc3NMaXN0LmFkZChDTEFTU19ISURERU4pO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmlzTG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZmluaXNoZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZmluaXNoZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5wdWxsQ2FwdGlvbi5jbGFzc05hbWUgPSBDTEFTU19QVUxMX0NBUFRJT04gKyAnICcgKyBDTEFTU19QVUxMX0NBUFRJT05fTk9NT1JFO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5wdWxsQ2FwdGlvbi5pbm5lckhUTUwgPSBzZWxmLm9wdGlvbnMudXAuY29udGVudG5vbW9yZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v5Y+W5raINSvnmoRwbHVzc2Nyb2xsYm90dG9t5LqL5Lu2XG4gICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdwbHVzc2Nyb2xsYm90dG9tJywgc2VsZik7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignZHJhZ3VwJywgc2VsZik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7IC8v5Yid5aeL5YyW5pe26ZqQ6JeP77yM5ZCO57ut5LiN5YaN6ZqQ6JePXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnB1bGxDYXB0aW9uLmNsYXNzTmFtZSA9IENMQVNTX1BVTExfQ0FQVElPTiArICcgJyArIENMQVNTX1BVTExfQ0FQVElPTl9ET1dOO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5wdWxsQ2FwdGlvbi5pbm5lckhUTUwgPSBzZWxmLm9wdGlvbnMudXAuY29udGVudGRvd247XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZW5kUHVsbHVwVG9SZWZyZXNoOiBmdW5jdGlvbiAoZmluaXNoZWQpIHsvL+S4iuaLieWKoOi9vee7k+adn++8jOWFvOWuueiAgeeahEFQSVxuICAgICAgICAgICAgXHRcdHRoaXMuZW5kUHVsbHVwKGZpbmlzaGVkKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkaXNhYmxlUHVsbHVwVG9SZWZyZXNoOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pbml0UHVsbHVwUmVmcmVzaCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuYm90dG9tUG9ja2V0LmNsYXNzTmFtZSA9ICdtdWktcHVsbC1ib3R0b20tcG9ja2V0JyArICcgJyArIENMQVNTX0hJRERFTjtcbiAgICAgICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignZHJhZ3VwJywgdGhpcyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZW5hYmxlUHVsbHVwVG9SZWZyZXNoOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pbml0UHVsbHVwUmVmcmVzaCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuYm90dG9tUG9ja2V0LmNsYXNzTGlzdC5yZW1vdmUoQ0xBU1NfSElEREVOKTtcbiAgICAgICAgICAgICAgICB0aGlzLnB1bGxDYXB0aW9uLmNsYXNzTmFtZSA9IENMQVNTX1BVTExfQ0FQVElPTiArICcgJyArIENMQVNTX1BVTExfQ0FQVElPTl9ET1dOO1xuICAgICAgICAgICAgICAgIHRoaXMucHVsbENhcHRpb24uaW5uZXJIVE1MID0gdGhpcy5vcHRpb25zLnVwLmNvbnRlbnRkb3duO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJwbHVzc2Nyb2xsYm90dG9tXCIsIHRoaXMpO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdkcmFndXAnLCB0aGlzKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzY3JvbGxUbzogZnVuY3Rpb24oeCwgeSwgdGltZSkge1xuICAgICAgICAgICAgICAgICQuc2Nyb2xsVG8oeSwgdGltZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2Nyb2xsVG9Cb3R0b206IGZ1bmN0aW9uKHRpbWUpIHtcbiAgICAgICAgICAgICAgICAkLnNjcm9sbFRvKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxIZWlnaHQsIHRpbWUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJlZnJlc2g6IGZ1bmN0aW9uKGlzUmVzZXQpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNSZXNldCAmJiB0aGlzLmZpbmlzaGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW5hYmxlUHVsbHVwVG9SZWZyZXNoKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmluaXNoZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sICQuUHVsbFJlZnJlc2gpKTtcblxuICAgICAgICAvL292ZXJyaWRlIGg1IHB1bGxSZWZyZXNoXG4gICAgICAgICQuZm4ucHVsbFJlZnJlc2hfbmF0aXZlID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICAgICAgdmFyIHNlbGY7XG4gICAgICAgICAgICBpZiAodGhpcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBzZWxmID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICAgICAgc2VsZi5jbGFzc05hbWUgPSAnbXVpLWNvbnRlbnQnO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoc2VsZik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHNlbGYgPSB0aGlzWzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBvcHRpb25zO1xuICAgICAgICAgICAgLy/kuIDkuKrniLbpnIDopoHmlK/mjIHlpJrkuKrlrZDkuIvmi4nliLfmlrBcbiAgICAgICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9XG4gICAgICAgICAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9ICQucGFyc2VKU09OKG9wdGlvbnMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICFvcHRpb25zLndlYnZpZXdJZCAmJiAob3B0aW9ucy53ZWJ2aWV3SWQgPSAocGx1cy53ZWJ2aWV3LmN1cnJlbnRXZWJ2aWV3KCkuaWQgfHwgcGx1cy53ZWJ2aWV3LmN1cnJlbnRXZWJ2aWV3KCkuZ2V0VVJMKCkpKTtcbiAgICAgICAgICAgIHZhciBwdWxsUmVmcmVzaEFwaSA9IG51bGw7XG4gICAgICAgICAgICB2YXIgYXR0cldlYnZpZXdJZCA9IG9wdGlvbnMud2Vidmlld0lkICYmIG9wdGlvbnMud2Vidmlld0lkLnJlcGxhY2UoL1xcLy9nLCBcIl9cIik7IC8v5pu/5o2i5omA5pyJXCIvXCJcbiAgICAgICAgICAgIHZhciBpZCA9IHNlbGYuZ2V0QXR0cmlidXRlKCdkYXRhLXB1bGxyZWZyZXNoLXBsdXMtJyArIGF0dHJXZWJ2aWV3SWQpO1xuICAgICAgICAgICAgaWYgKCFpZCAmJiB0eXBlb2YgYXJncyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWlkKSB7IC8v6YG/5YWN6YeN5aSN5Yid5aeL5YyWNSsgcHVsbHJlZnJlc2hcbiAgICAgICAgICAgICAgICBpZCA9ICsrJC51dWlkO1xuICAgICAgICAgICAgICAgIHNlbGYuc2V0QXR0cmlidXRlKCdkYXRhLXB1bGxyZWZyZXNoLXBsdXMtJyArIGF0dHJXZWJ2aWV3SWQsIGlkKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoQ0xBU1NfUExVU19QVUxMUkVGUkVTSCk7XG4gICAgICAgICAgICAgICAgJC5kYXRhW2lkXSA9IHB1bGxSZWZyZXNoQXBpID0gbmV3IFBsdXNQdWxsUmVmcmVzaChzZWxmLCBvcHRpb25zKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcHVsbFJlZnJlc2hBcGkgPSAkLmRhdGFbaWRdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZG93biAmJiBvcHRpb25zLmRvd24uYXV0bykgeyAvL+WmguaenOiuvue9ruS6hmF1dG/vvIzliJnoh6rliqjkuIvmi4nkuIDmrKFcbiAgICAgICAgICAgICAgICAvL3B1bGxSZWZyZXNoQXBpLl9wdWxsZG93bkxvYWRpbmcoKTsgLy9wYXJlbnQgd2Vidmlld1xuICAgICAgICAgICAgICAgIHB1bGxSZWZyZXNoQXBpLmJlZ2luUHVsbGRvd24oKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAob3B0aW9ucy51cCAmJiBvcHRpb25zLnVwLmF1dG8pIHsgLy/lpoLmnpzorr7nva7kuoZhdXRv77yM5YiZ6Ieq5Yqo5LiK5ouJ5LiA5qyhXG4gICAgICAgICAgICAgICAgcHVsbFJlZnJlc2hBcGkuYmVnaW5QdWxsdXAoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBwdWxsUmVmcmVzaEFwaTtcbiAgICAgICAgfTtcbiAgICB9KTtcblxufSkobXVpLCBkb2N1bWVudCk7XG4vKipcbiAqIG9mZi1jYW52YXNcbiAqIEBwYXJhbSB7dHlwZX0gJFxuICogQHBhcmFtIHt0eXBlfSB3aW5kb3dcbiAqIEBwYXJhbSB7dHlwZX0gZG9jdW1lbnRcbiAqIEBwYXJhbSB7dHlwZX0gYWN0aW9uXG4gKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxuICovXG4oZnVuY3Rpb24oJCwgd2luZG93LCBkb2N1bWVudCwgbmFtZSkge1xuXHR2YXIgQ0xBU1NfT0ZGX0NBTlZBU19MRUZUID0gJ211aS1vZmYtY2FudmFzLWxlZnQnO1xuXHR2YXIgQ0xBU1NfT0ZGX0NBTlZBU19SSUdIVCA9ICdtdWktb2ZmLWNhbnZhcy1yaWdodCc7XG5cdHZhciBDTEFTU19BQ1RJT05fQkFDS0RST1AgPSAnbXVpLW9mZi1jYW52YXMtYmFja2Ryb3AnO1xuXHR2YXIgQ0xBU1NfT0ZGX0NBTlZBU19XUkFQID0gJ211aS1vZmYtY2FudmFzLXdyYXAnO1xuXG5cdHZhciBDTEFTU19TTElERV9JTiA9ICdtdWktc2xpZGUtaW4nO1xuXHR2YXIgQ0xBU1NfQUNUSVZFID0gJ211aS1hY3RpdmUnO1xuXG5cblx0dmFyIENMQVNTX1RSQU5TSVRJT05JTkcgPSAnbXVpLXRyYW5zaXRpb25pbmcnO1xuXG5cdHZhciBTRUxFQ1RPUl9JTk5FUl9XUkFQID0gJy5tdWktaW5uZXItd3JhcCc7XG5cblxuXHR2YXIgT2ZmQ2FudmFzID0gJC5DbGFzcy5leHRlbmQoe1xuXHRcdGluaXQ6IGZ1bmN0aW9uKGVsZW1lbnQsIG9wdGlvbnMpIHtcblx0XHRcdHRoaXMud3JhcHBlciA9IHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG5cdFx0XHR0aGlzLnNjcm9sbGVyID0gdGhpcy53cmFwcGVyLnF1ZXJ5U2VsZWN0b3IoU0VMRUNUT1JfSU5ORVJfV1JBUCk7XG5cdFx0XHR0aGlzLmNsYXNzTGlzdCA9IHRoaXMud3JhcHBlci5jbGFzc0xpc3Q7XG5cdFx0XHRpZiAodGhpcy5zY3JvbGxlcikge1xuXHRcdFx0XHR0aGlzLm9wdGlvbnMgPSAkLmV4dGVuZCh0cnVlLCB7XG5cdFx0XHRcdFx0ZHJhZ1RocmVzaG9sZFg6IDEwLFxuXHRcdFx0XHRcdHNjYWxlOiAwLjgsXG5cdFx0XHRcdFx0b3BhY2l0eTogMC4xLFxuXHRcdFx0XHRcdHByZXZlbnREZWZhdWx0RXhjZXB0aW9uOiB7XG5cdFx0XHRcdFx0XHR0YWdOYW1lOiAvXihJTlBVVHxURVhUQVJFQXxCVVRUT058U0VMRUNUfFZJREVPKSQvXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0fSwgb3B0aW9ucyk7XG5cdFx0XHRcdGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgnbXVpLWZ1bGxzY3JlZW4nKTsgLy9mdWxsc2NyZWVuXG5cdFx0XHRcdHRoaXMucmVmcmVzaCgpO1xuXHRcdFx0XHR0aGlzLmluaXRFdmVudCgpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0X3ByZXZlbnREZWZhdWx0RXhjZXB0aW9uOiBmdW5jdGlvbihlbCwgZXhjZXB0aW9ucykge1xuXHRcdFx0Zm9yICh2YXIgaSBpbiBleGNlcHRpb25zKSB7XG5cdFx0XHRcdGlmIChleGNlcHRpb25zW2ldLnRlc3QoZWxbaV0pKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9LFxuXHRcdHJlZnJlc2g6IGZ1bmN0aW9uKG9mZkNhbnZhcykge1xuXHRcdFx0Ly9cdFx0XHRvZmZDYW52YXMgJiYgIW9mZkNhbnZhcy5jbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfQUNUSVZFKSAmJiB0aGlzLmNsYXNzTGlzdC5yZW1vdmUoQ0xBU1NfQUNUSVZFKTtcblx0XHRcdHRoaXMuc2xpZGVJbiA9IHRoaXMuY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX1NMSURFX0lOKTtcblx0XHRcdHRoaXMuc2NhbGFibGUgPSB0aGlzLmNsYXNzTGlzdC5jb250YWlucygnbXVpLXNjYWxhYmxlJykgJiYgIXRoaXMuc2xpZGVJbjtcblx0XHRcdHRoaXMuc2Nyb2xsZXIgPSB0aGlzLndyYXBwZXIucXVlcnlTZWxlY3RvcihTRUxFQ1RPUl9JTk5FUl9XUkFQKTtcblx0XHRcdC8vXHRcdFx0IW9mZkNhbnZhcyAmJiB0aGlzLnNjcm9sbGVyLmNsYXNzTGlzdC5yZW1vdmUoQ0xBU1NfVFJBTlNJVElPTklORyk7XG5cdFx0XHQvL1x0XHRcdCFvZmZDYW52YXMgJiYgdGhpcy5zY3JvbGxlci5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgJycpO1xuXHRcdFx0dGhpcy5vZmZDYW52YXNMZWZ0cyA9IHRoaXMud3JhcHBlci5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIENMQVNTX09GRl9DQU5WQVNfTEVGVCk7XG5cdFx0XHR0aGlzLm9mZkNhbnZhc1JpZ2h0cyA9IHRoaXMud3JhcHBlci5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIENMQVNTX09GRl9DQU5WQVNfUklHSFQpO1xuXHRcdFx0aWYgKG9mZkNhbnZhcykge1xuXHRcdFx0XHRpZiAob2ZmQ2FudmFzLmNsYXNzTGlzdC5jb250YWlucyhDTEFTU19PRkZfQ0FOVkFTX0xFRlQpKSB7XG5cdFx0XHRcdFx0dGhpcy5vZmZDYW52YXNMZWZ0ID0gb2ZmQ2FudmFzO1xuXHRcdFx0XHR9IGVsc2UgaWYgKG9mZkNhbnZhcy5jbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfT0ZGX0NBTlZBU19SSUdIVCkpIHtcblx0XHRcdFx0XHR0aGlzLm9mZkNhbnZhc1JpZ2h0ID0gb2ZmQ2FudmFzO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLm9mZkNhbnZhc1JpZ2h0ID0gdGhpcy53cmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJy4nICsgQ0xBU1NfT0ZGX0NBTlZBU19SSUdIVCk7XG5cdFx0XHRcdHRoaXMub2ZmQ2FudmFzTGVmdCA9IHRoaXMud3JhcHBlci5xdWVyeVNlbGVjdG9yKCcuJyArIENMQVNTX09GRl9DQU5WQVNfTEVGVCk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLm9mZkNhbnZhc1JpZ2h0V2lkdGggPSB0aGlzLm9mZkNhbnZhc0xlZnRXaWR0aCA9IDA7XG5cdFx0XHR0aGlzLm9mZkNhbnZhc0xlZnRTbGlkZUluID0gdGhpcy5vZmZDYW52YXNSaWdodFNsaWRlSW4gPSBmYWxzZTtcblx0XHRcdGlmICh0aGlzLm9mZkNhbnZhc1JpZ2h0KSB7XG5cdFx0XHRcdHRoaXMub2ZmQ2FudmFzUmlnaHRXaWR0aCA9IHRoaXMub2ZmQ2FudmFzUmlnaHQub2Zmc2V0V2lkdGg7XG5cdFx0XHRcdHRoaXMub2ZmQ2FudmFzUmlnaHRTbGlkZUluID0gdGhpcy5zbGlkZUluICYmICh0aGlzLm9mZkNhbnZhc1JpZ2h0LnBhcmVudE5vZGUgPT09IHRoaXMud3JhcHBlcik7XG5cdFx0XHRcdC8vXHRcdFx0XHR0aGlzLm9mZkNhbnZhc1JpZ2h0LmNsYXNzTGlzdC5yZW1vdmUoQ0xBU1NfVFJBTlNJVElPTklORyk7XG5cdFx0XHRcdC8vXHRcdFx0XHR0aGlzLm9mZkNhbnZhc1JpZ2h0LmNsYXNzTGlzdC5yZW1vdmUoQ0xBU1NfQUNUSVZFKTtcblx0XHRcdFx0Ly9cdFx0XHRcdHRoaXMub2ZmQ2FudmFzUmlnaHQuc2V0QXR0cmlidXRlKCdzdHlsZScsICcnKTtcblx0XHRcdH1cblx0XHRcdGlmICh0aGlzLm9mZkNhbnZhc0xlZnQpIHtcblx0XHRcdFx0dGhpcy5vZmZDYW52YXNMZWZ0V2lkdGggPSB0aGlzLm9mZkNhbnZhc0xlZnQub2Zmc2V0V2lkdGg7XG5cdFx0XHRcdHRoaXMub2ZmQ2FudmFzTGVmdFNsaWRlSW4gPSB0aGlzLnNsaWRlSW4gJiYgKHRoaXMub2ZmQ2FudmFzTGVmdC5wYXJlbnROb2RlID09PSB0aGlzLndyYXBwZXIpO1xuXHRcdFx0XHQvL1x0XHRcdFx0dGhpcy5vZmZDYW52YXNMZWZ0LmNsYXNzTGlzdC5yZW1vdmUoQ0xBU1NfVFJBTlNJVElPTklORyk7XG5cdFx0XHRcdC8vXHRcdFx0XHR0aGlzLm9mZkNhbnZhc0xlZnQuY2xhc3NMaXN0LnJlbW92ZShDTEFTU19BQ1RJVkUpO1xuXHRcdFx0XHQvL1x0XHRcdFx0dGhpcy5vZmZDYW52YXNMZWZ0LnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnJyk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLmJhY2tkcm9wID0gdGhpcy5zY3JvbGxlci5xdWVyeVNlbGVjdG9yKCcuJyArIENMQVNTX0FDVElPTl9CQUNLRFJPUCk7XG5cblx0XHRcdHRoaXMub3B0aW9ucy5kcmFnVGhyZXNob2xkWCA9IHRoaXMub3B0aW9ucy5kcmFnVGhyZXNob2xkWCB8fCAxMDtcblxuXHRcdFx0dGhpcy52aXNpYmxlID0gZmFsc2U7XG5cdFx0XHR0aGlzLnN0YXJ0WCA9IG51bGw7XG5cdFx0XHR0aGlzLmxhc3RYID0gbnVsbDtcblx0XHRcdHRoaXMub2Zmc2V0WCA9IG51bGw7XG5cdFx0XHR0aGlzLmxhc3RUcmFuc2xhdGVYID0gbnVsbDtcblx0XHR9LFxuXHRcdGhhbmRsZUV2ZW50OiBmdW5jdGlvbihlKSB7XG5cdFx0XHRzd2l0Y2ggKGUudHlwZSkge1xuXHRcdFx0XHRjYXNlICQuRVZFTlRfU1RBUlQ6XG5cdFx0XHRcdFx0ZS50YXJnZXQgJiYgIXRoaXMuX3ByZXZlbnREZWZhdWx0RXhjZXB0aW9uKGUudGFyZ2V0LCB0aGlzLm9wdGlvbnMucHJldmVudERlZmF1bHRFeGNlcHRpb24pICYmIGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnd2Via2l0VHJhbnNpdGlvbkVuZCc6IC8v5pyJ5LiqYnVn6ZyA6KaB5aSE55CG77yM6ZyA6KaB6ICD6JmR5YGH6K6+5rKh5pyJ6Kem5Y+Rd2Via2l0VHJhbnNpdGlvbkVuZOeahOaDheWGtVxuXHRcdFx0XHRcdGlmIChlLnRhcmdldCA9PT0gdGhpcy5zY3JvbGxlcikge1xuXHRcdFx0XHRcdFx0dGhpcy5fZGlzcGF0Y2hFdmVudCgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZHJhZyc6XG5cdFx0XHRcdFx0dmFyIGRldGFpbCA9IGUuZGV0YWlsO1xuXHRcdFx0XHRcdGlmICghdGhpcy5zdGFydFgpIHtcblx0XHRcdFx0XHRcdHRoaXMuc3RhcnRYID0gZGV0YWlsLmNlbnRlci54O1xuXHRcdFx0XHRcdFx0dGhpcy5sYXN0WCA9IHRoaXMuc3RhcnRYO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR0aGlzLmxhc3RYID0gZGV0YWlsLmNlbnRlci54O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAoIXRoaXMuaXNEcmFnZ2luZyAmJiBNYXRoLmFicyh0aGlzLmxhc3RYIC0gdGhpcy5zdGFydFgpID4gdGhpcy5vcHRpb25zLmRyYWdUaHJlc2hvbGRYICYmIChkZXRhaWwuZGlyZWN0aW9uID09PSAnbGVmdCcgfHwgKGRldGFpbC5kaXJlY3Rpb24gPT09ICdyaWdodCcpKSkge1xuXHRcdFx0XHRcdFx0aWYgKHRoaXMuc2xpZGVJbikge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnNjcm9sbGVyID0gdGhpcy53cmFwcGVyLnF1ZXJ5U2VsZWN0b3IoU0VMRUNUT1JfSU5ORVJfV1JBUCk7XG5cdFx0XHRcdFx0XHRcdGlmICh0aGlzLmNsYXNzTGlzdC5jb250YWlucyhDTEFTU19BQ1RJVkUpKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKHRoaXMub2ZmQ2FudmFzUmlnaHQgJiYgdGhpcy5vZmZDYW52YXNSaWdodC5jbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfQUNUSVZFKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5vZmZDYW52YXMgPSB0aGlzLm9mZkNhbnZhc1JpZ2h0O1xuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5vZmZDYW52YXNXaWR0aCA9IHRoaXMub2ZmQ2FudmFzUmlnaHRXaWR0aDtcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5vZmZDYW52YXMgPSB0aGlzLm9mZkNhbnZhc0xlZnQ7XG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLm9mZkNhbnZhc1dpZHRoID0gdGhpcy5vZmZDYW52YXNMZWZ0V2lkdGg7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdGlmIChkZXRhaWwuZGlyZWN0aW9uID09PSAnbGVmdCcgJiYgdGhpcy5vZmZDYW52YXNSaWdodCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5vZmZDYW52YXMgPSB0aGlzLm9mZkNhbnZhc1JpZ2h0O1xuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5vZmZDYW52YXNXaWR0aCA9IHRoaXMub2ZmQ2FudmFzUmlnaHRXaWR0aDtcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGRldGFpbC5kaXJlY3Rpb24gPT09ICdyaWdodCcgJiYgdGhpcy5vZmZDYW52YXNMZWZ0KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLm9mZkNhbnZhcyA9IHRoaXMub2ZmQ2FudmFzTGVmdDtcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMub2ZmQ2FudmFzV2lkdGggPSB0aGlzLm9mZkNhbnZhc0xlZnRXaWR0aDtcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5zY3JvbGxlciA9IG51bGw7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRpZiAodGhpcy5jbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfQUNUSVZFKSkge1xuXHRcdFx0XHRcdFx0XHRcdGlmIChkZXRhaWwuZGlyZWN0aW9uID09PSAnbGVmdCcpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMub2ZmQ2FudmFzID0gdGhpcy5vZmZDYW52YXNMZWZ0O1xuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5vZmZDYW52YXNXaWR0aCA9IHRoaXMub2ZmQ2FudmFzTGVmdFdpZHRoO1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLm9mZkNhbnZhcyA9IHRoaXMub2ZmQ2FudmFzUmlnaHQ7XG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLm9mZkNhbnZhc1dpZHRoID0gdGhpcy5vZmZDYW52YXNSaWdodFdpZHRoO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRpZiAoZGV0YWlsLmRpcmVjdGlvbiA9PT0gJ3JpZ2h0Jykge1xuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5vZmZDYW52YXMgPSB0aGlzLm9mZkNhbnZhc0xlZnQ7XG5cdFx0XHRcdFx0XHRcdFx0XHR0aGlzLm9mZkNhbnZhc1dpZHRoID0gdGhpcy5vZmZDYW52YXNMZWZ0V2lkdGg7XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMub2ZmQ2FudmFzID0gdGhpcy5vZmZDYW52YXNSaWdodDtcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMub2ZmQ2FudmFzV2lkdGggPSB0aGlzLm9mZkNhbnZhc1JpZ2h0V2lkdGg7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRpZiAodGhpcy5vZmZDYW52YXMgJiYgdGhpcy5zY3JvbGxlcikge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnN0YXJ0WCA9IHRoaXMubGFzdFg7XG5cdFx0XHRcdFx0XHRcdHRoaXMuaXNEcmFnZ2luZyA9IHRydWU7XG5cblx0XHRcdFx0XHRcdFx0JC5nZXN0dXJlcy5zZXNzaW9uLmxvY2tEaXJlY3Rpb24gPSB0cnVlOyAvL+mUgeWumuaWueWQkVxuXHRcdFx0XHRcdFx0XHQkLmdlc3R1cmVzLnNlc3Npb24uc3RhcnREaXJlY3Rpb24gPSBkZXRhaWwuZGlyZWN0aW9uO1xuXG5cdFx0XHRcdFx0XHRcdHRoaXMub2ZmQ2FudmFzLmNsYXNzTGlzdC5yZW1vdmUoQ0xBU1NfVFJBTlNJVElPTklORyk7XG5cdFx0XHRcdFx0XHRcdHRoaXMuc2Nyb2xsZXIuY2xhc3NMaXN0LnJlbW92ZShDTEFTU19UUkFOU0lUSU9OSU5HKTtcblx0XHRcdFx0XHRcdFx0dGhpcy5vZmZzZXRYID0gdGhpcy5nZXRUcmFuc2xhdGVYKCk7XG5cdFx0XHRcdFx0XHRcdHRoaXMuX2luaXRPZmZDYW52YXNWaXNpYmxlKCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmICh0aGlzLmlzRHJhZ2dpbmcpIHtcblx0XHRcdFx0XHRcdHRoaXMudXBkYXRlVHJhbnNsYXRlKHRoaXMub2Zmc2V0WCArICh0aGlzLmxhc3RYIC0gdGhpcy5zdGFydFgpKTtcblx0XHRcdFx0XHRcdGRldGFpbC5nZXN0dXJlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnZHJhZ2VuZCc6XG5cdFx0XHRcdFx0aWYgKHRoaXMuaXNEcmFnZ2luZykge1xuXHRcdFx0XHRcdFx0dmFyIGRldGFpbCA9IGUuZGV0YWlsO1xuXHRcdFx0XHRcdFx0dmFyIGRpcmVjdGlvbiA9IGRldGFpbC5kaXJlY3Rpb247XG5cdFx0XHRcdFx0XHR0aGlzLmlzRHJhZ2dpbmcgPSBmYWxzZTtcblx0XHRcdFx0XHRcdHRoaXMub2ZmQ2FudmFzLmNsYXNzTGlzdC5hZGQoQ0xBU1NfVFJBTlNJVElPTklORyk7XG5cdFx0XHRcdFx0XHR0aGlzLnNjcm9sbGVyLmNsYXNzTGlzdC5hZGQoQ0xBU1NfVFJBTlNJVElPTklORyk7XG5cdFx0XHRcdFx0XHR2YXIgcmF0aW8gPSAwO1xuXHRcdFx0XHRcdFx0dmFyIHggPSB0aGlzLmdldFRyYW5zbGF0ZVgoKTtcblx0XHRcdFx0XHRcdGlmICghdGhpcy5zbGlkZUluKSB7XG5cdFx0XHRcdFx0XHRcdGlmICh4ID49IDApIHtcblx0XHRcdFx0XHRcdFx0XHRyYXRpbyA9ICh0aGlzLm9mZkNhbnZhc0xlZnRXaWR0aCAmJiAoeCAvIHRoaXMub2ZmQ2FudmFzTGVmdFdpZHRoKSkgfHwgMDtcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRyYXRpbyA9ICh0aGlzLm9mZkNhbnZhc1JpZ2h0V2lkdGggJiYgKHggLyB0aGlzLm9mZkNhbnZhc1JpZ2h0V2lkdGgpKSB8fCAwO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdGlmIChyYXRpbyA9PT0gMCkge1xuXHRcdFx0XHRcdFx0XHRcdHRoaXMub3BlblBlcmNlbnRhZ2UoMCk7XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5fZGlzcGF0Y2hFdmVudCgpOyAvL+atpOWkhOS4jeinpuWPkXdlYmtpdFRyYW5zaXRpb25FbmQs5omA5Lul5omL5YqoZGlzcGF0Y2hcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0aWYgKGRpcmVjdGlvbiA9PT0gJ3JpZ2h0JyAmJiByYXRpbyA+PSAwICYmIChyYXRpbyA+PSAwLjUgfHwgZGV0YWlsLnN3aXBlKSkgeyAvL+WPs+a7keaJk+W8gFxuXHRcdFx0XHRcdFx0XHRcdHRoaXMub3BlblBlcmNlbnRhZ2UoMTAwKTtcblx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChkaXJlY3Rpb24gPT09ICdyaWdodCcgJiYgcmF0aW8gPCAwICYmIChyYXRpbyA+IC0wLjUgfHwgZGV0YWlsLnN3aXBlKSkgeyAvL+WPs+a7keWFs+mXrVxuXHRcdFx0XHRcdFx0XHRcdHRoaXMub3BlblBlcmNlbnRhZ2UoMCk7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoZGlyZWN0aW9uID09PSAncmlnaHQnICYmIHJhdGlvID4gMCAmJiByYXRpbyA8IDAuNSkgeyAvL+WPs+a7kei/mOWOn+WFs+mXrVxuXHRcdFx0XHRcdFx0XHRcdHRoaXMub3BlblBlcmNlbnRhZ2UoMCk7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoZGlyZWN0aW9uID09PSAncmlnaHQnICYmIHJhdGlvIDwgMC41KSB7IC8v5Y+z5ruR6L+Y5Y6f5omT5byAXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5vcGVuUGVyY2VudGFnZSgtMTAwKTtcblx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChkaXJlY3Rpb24gPT09ICdsZWZ0JyAmJiByYXRpbyA8PSAwICYmIChyYXRpbyA8PSAtMC41IHx8IGRldGFpbC5zd2lwZSkpIHsgLy/lt6bmu5HmiZPlvIBcblx0XHRcdFx0XHRcdFx0XHR0aGlzLm9wZW5QZXJjZW50YWdlKC0xMDApO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ2xlZnQnICYmIHJhdGlvID4gMCAmJiAocmF0aW8gPD0gMC41IHx8IGRldGFpbC5zd2lwZSkpIHsgLy/lt6bmu5HlhbPpl61cblx0XHRcdFx0XHRcdFx0XHR0aGlzLm9wZW5QZXJjZW50YWdlKDApO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ2xlZnQnICYmIHJhdGlvIDwgMCAmJiByYXRpbyA+PSAtMC41KSB7IC8v5bem5ruR6L+Y5Y6f5YWz6ZetXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5vcGVuUGVyY2VudGFnZSgwKTtcblx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChkaXJlY3Rpb24gPT09ICdsZWZ0JyAmJiByYXRpbyA+IDAuNSkgeyAvL+W3pua7kei/mOWOn+aJk+W8gFxuXHRcdFx0XHRcdFx0XHRcdHRoaXMub3BlblBlcmNlbnRhZ2UoMTAwKTtcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHsgLy/pu5jorqTlhbPpl61cblx0XHRcdFx0XHRcdFx0XHR0aGlzLm9wZW5QZXJjZW50YWdlKDApO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdGlmIChyYXRpbyA9PT0gMSB8fCByYXRpbyA9PT0gLTEpIHsgLy/mraTlpITkuI3op6blj5F3ZWJraXRUcmFuc2l0aW9uRW5kLOaJgOS7peaJi+WKqGRpc3BhdGNoXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5fZGlzcGF0Y2hFdmVudCgpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRpZiAoeCA+PSAwKSB7XG5cdFx0XHRcdFx0XHRcdFx0cmF0aW8gPSAodGhpcy5vZmZDYW52YXNSaWdodFdpZHRoICYmICh4IC8gdGhpcy5vZmZDYW52YXNSaWdodFdpZHRoKSkgfHwgMDtcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRyYXRpbyA9ICh0aGlzLm9mZkNhbnZhc0xlZnRXaWR0aCAmJiAoeCAvIHRoaXMub2ZmQ2FudmFzTGVmdFdpZHRoKSkgfHwgMDtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRpZiAoZGlyZWN0aW9uID09PSAncmlnaHQnICYmIHJhdGlvIDw9IDAgJiYgKHJhdGlvID49IC0wLjUgfHwgZGV0YWlsLnN3aXBlKSkgeyAvL+WPs+a7keaJk+W8gFxuXHRcdFx0XHRcdFx0XHRcdHRoaXMub3BlblBlcmNlbnRhZ2UoMTAwKTtcblx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChkaXJlY3Rpb24gPT09ICdyaWdodCcgJiYgcmF0aW8gPiAwICYmIChyYXRpbyA+PSAwLjUgfHwgZGV0YWlsLnN3aXBlKSkgeyAvL+WPs+a7keWFs+mXrVxuXHRcdFx0XHRcdFx0XHRcdHRoaXMub3BlblBlcmNlbnRhZ2UoMCk7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoZGlyZWN0aW9uID09PSAncmlnaHQnICYmIHJhdGlvIDw9IC0wLjUpIHsgLy/lj7Pmu5Hov5jljp/lhbPpl61cblx0XHRcdFx0XHRcdFx0XHR0aGlzLm9wZW5QZXJjZW50YWdlKDApO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ3JpZ2h0JyAmJiByYXRpbyA+IDAgJiYgcmF0aW8gPD0gMC41KSB7IC8v5Y+z5ruR6L+Y5Y6f5omT5byAXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5vcGVuUGVyY2VudGFnZSgtMTAwKTtcblx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChkaXJlY3Rpb24gPT09ICdsZWZ0JyAmJiByYXRpbyA+PSAwICYmIChyYXRpbyA8PSAwLjUgfHwgZGV0YWlsLnN3aXBlKSkgeyAvL+W3pua7keaJk+W8gFxuXHRcdFx0XHRcdFx0XHRcdHRoaXMub3BlblBlcmNlbnRhZ2UoLTEwMCk7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoZGlyZWN0aW9uID09PSAnbGVmdCcgJiYgcmF0aW8gPCAwICYmIChyYXRpbyA8PSAtMC41IHx8IGRldGFpbC5zd2lwZSkpIHsgLy/lt6bmu5HlhbPpl61cblx0XHRcdFx0XHRcdFx0XHR0aGlzLm9wZW5QZXJjZW50YWdlKDApO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ2xlZnQnICYmIHJhdGlvID49IDAuNSkgeyAvL+W3pua7kei/mOWOn+WFs+mXrVxuXHRcdFx0XHRcdFx0XHRcdHRoaXMub3BlblBlcmNlbnRhZ2UoMCk7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoZGlyZWN0aW9uID09PSAnbGVmdCcgJiYgcmF0aW8gPj0gLTAuNSAmJiByYXRpbyA8IDApIHsgLy/lt6bmu5Hov5jljp/miZPlvIBcblx0XHRcdFx0XHRcdFx0XHR0aGlzLm9wZW5QZXJjZW50YWdlKDEwMCk7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5vcGVuUGVyY2VudGFnZSgwKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRpZiAocmF0aW8gPT09IDEgfHwgcmF0aW8gPT09IC0xIHx8IHJhdGlvID09PSAwKSB7XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5fZGlzcGF0Y2hFdmVudCgpO1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0X2Rpc3BhdGNoRXZlbnQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKHRoaXMuY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX0FDVElWRSkpIHtcblx0XHRcdFx0JC50cmlnZ2VyKHRoaXMud3JhcHBlciwgJ3Nob3duJywgdGhpcyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQkLnRyaWdnZXIodGhpcy53cmFwcGVyLCAnaGlkZGVuJywgdGhpcyk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRfaW5pdE9mZkNhbnZhc1Zpc2libGU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCF0aGlzLnZpc2libGUpIHtcblx0XHRcdFx0dGhpcy52aXNpYmxlID0gdHJ1ZTtcblx0XHRcdFx0aWYgKHRoaXMub2ZmQ2FudmFzTGVmdCkge1xuXHRcdFx0XHRcdHRoaXMub2ZmQ2FudmFzTGVmdC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICh0aGlzLm9mZkNhbnZhc1JpZ2h0KSB7XG5cdFx0XHRcdFx0dGhpcy5vZmZDYW52YXNSaWdodC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRpbml0RXZlbnQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0aWYgKHNlbGYuYmFja2Ryb3ApIHtcblx0XHRcdFx0c2VsZi5iYWNrZHJvcC5hZGRFdmVudExpc3RlbmVyKCd0YXAnLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0c2VsZi5jbG9zZSgpO1xuXHRcdFx0XHRcdGUuZGV0YWlsLmdlc3R1cmUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0XHRpZiAodGhpcy5jbGFzc0xpc3QuY29udGFpbnMoJ211aS1kcmFnZ2FibGUnKSkge1xuXHRcdFx0XHR0aGlzLndyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcigkLkVWRU5UX1NUQVJULCB0aGlzKTsgLy/kuLTml7blpITnkIZcblx0XHRcdFx0dGhpcy53cmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWcnLCB0aGlzKTtcblx0XHRcdFx0dGhpcy53cmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbmQnLCB0aGlzKTtcblx0XHRcdH1cblx0XHRcdHRoaXMud3JhcHBlci5hZGRFdmVudExpc3RlbmVyKCd3ZWJraXRUcmFuc2l0aW9uRW5kJywgdGhpcyk7XG5cdFx0fSxcblx0XHRvcGVuUGVyY2VudGFnZTogZnVuY3Rpb24ocGVyY2VudGFnZSkge1xuXHRcdFx0dmFyIHAgPSBwZXJjZW50YWdlIC8gMTAwO1xuXHRcdFx0aWYgKCF0aGlzLnNsaWRlSW4pIHtcblx0XHRcdFx0aWYgKHRoaXMub2ZmQ2FudmFzTGVmdCAmJiBwZXJjZW50YWdlID49IDApIHtcblx0XHRcdFx0XHR0aGlzLnVwZGF0ZVRyYW5zbGF0ZSh0aGlzLm9mZkNhbnZhc0xlZnRXaWR0aCAqIHApO1xuXHRcdFx0XHRcdHRoaXMub2ZmQ2FudmFzTGVmdC5jbGFzc0xpc3RbcCAhPT0gMCA/ICdhZGQnIDogJ3JlbW92ZSddKENMQVNTX0FDVElWRSk7XG5cdFx0XHRcdH0gZWxzZSBpZiAodGhpcy5vZmZDYW52YXNSaWdodCAmJiBwZXJjZW50YWdlIDw9IDApIHtcblx0XHRcdFx0XHR0aGlzLnVwZGF0ZVRyYW5zbGF0ZSh0aGlzLm9mZkNhbnZhc1JpZ2h0V2lkdGggKiBwKTtcblx0XHRcdFx0XHR0aGlzLm9mZkNhbnZhc1JpZ2h0LmNsYXNzTGlzdFtwICE9PSAwID8gJ2FkZCcgOiAncmVtb3ZlJ10oQ0xBU1NfQUNUSVZFKTtcblx0XHRcdFx0fVxuXHRcdFx0XHR0aGlzLmNsYXNzTGlzdFtwICE9PSAwID8gJ2FkZCcgOiAncmVtb3ZlJ10oQ0xBU1NfQUNUSVZFKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmICh0aGlzLm9mZkNhbnZhc0xlZnQgJiYgcGVyY2VudGFnZSA+PSAwKSB7XG5cdFx0XHRcdFx0cCA9IHAgPT09IDAgPyAtMSA6IDA7XG5cdFx0XHRcdFx0dGhpcy51cGRhdGVUcmFuc2xhdGUodGhpcy5vZmZDYW52YXNMZWZ0V2lkdGggKiBwKTtcblx0XHRcdFx0XHR0aGlzLm9mZkNhbnZhc0xlZnQuY2xhc3NMaXN0W3BlcmNlbnRhZ2UgIT09IDAgPyAnYWRkJyA6ICdyZW1vdmUnXShDTEFTU19BQ1RJVkUpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKHRoaXMub2ZmQ2FudmFzUmlnaHQgJiYgcGVyY2VudGFnZSA8PSAwKSB7XG5cdFx0XHRcdFx0cCA9IHAgPT09IDAgPyAxIDogMDtcblx0XHRcdFx0XHR0aGlzLnVwZGF0ZVRyYW5zbGF0ZSh0aGlzLm9mZkNhbnZhc1JpZ2h0V2lkdGggKiBwKTtcblx0XHRcdFx0XHR0aGlzLm9mZkNhbnZhc1JpZ2h0LmNsYXNzTGlzdFtwZXJjZW50YWdlICE9PSAwID8gJ2FkZCcgOiAncmVtb3ZlJ10oQ0xBU1NfQUNUSVZFKTtcblx0XHRcdFx0fVxuXHRcdFx0XHR0aGlzLmNsYXNzTGlzdFtwZXJjZW50YWdlICE9PSAwID8gJ2FkZCcgOiAncmVtb3ZlJ10oQ0xBU1NfQUNUSVZFKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdHVwZGF0ZVRyYW5zbGF0ZTogZnVuY3Rpb24oeCkge1xuXHRcdFx0aWYgKHggIT09IHRoaXMubGFzdFRyYW5zbGF0ZVgpIHtcblx0XHRcdFx0aWYgKCF0aGlzLnNsaWRlSW4pIHtcblx0XHRcdFx0XHRpZiAoKCF0aGlzLm9mZkNhbnZhc0xlZnQgJiYgeCA+IDApIHx8ICghdGhpcy5vZmZDYW52YXNSaWdodCAmJiB4IDwgMCkpIHtcblx0XHRcdFx0XHRcdHRoaXMuc2V0VHJhbnNsYXRlWCgwKTtcblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKHRoaXMubGVmdFNob3dpbmcgJiYgeCA+IHRoaXMub2ZmQ2FudmFzTGVmdFdpZHRoKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnNldFRyYW5zbGF0ZVgodGhpcy5vZmZDYW52YXNMZWZ0V2lkdGgpO1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAodGhpcy5yaWdodFNob3dpbmcgJiYgeCA8IC10aGlzLm9mZkNhbnZhc1JpZ2h0V2lkdGgpIHtcblx0XHRcdFx0XHRcdHRoaXMuc2V0VHJhbnNsYXRlWCgtdGhpcy5vZmZDYW52YXNSaWdodFdpZHRoKTtcblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dGhpcy5zZXRUcmFuc2xhdGVYKHgpO1xuXHRcdFx0XHRcdGlmICh4ID49IDApIHtcblx0XHRcdFx0XHRcdHRoaXMubGVmdFNob3dpbmcgPSB0cnVlO1xuXHRcdFx0XHRcdFx0dGhpcy5yaWdodFNob3dpbmcgPSBmYWxzZTtcblx0XHRcdFx0XHRcdGlmICh4ID4gMCkge1xuXHRcdFx0XHRcdFx0XHRpZiAodGhpcy5vZmZDYW52YXNMZWZ0KSB7XG5cdFx0XHRcdFx0XHRcdFx0JC5lYWNoKHRoaXMub2ZmQ2FudmFzTGVmdHMsIGZ1bmN0aW9uKGluZGV4LCBvZmZDYW52YXMpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChvZmZDYW52YXMgPT09IHRoaXMub2ZmQ2FudmFzTGVmdCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR0aGlzLm9mZkNhbnZhc0xlZnQuc3R5bGUuekluZGV4ID0gMDtcblx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdG9mZkNhbnZhcy5zdHlsZS56SW5kZXggPSAtMTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9LmJpbmQodGhpcykpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdGlmICh0aGlzLm9mZkNhbnZhc1JpZ2h0KSB7XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5vZmZDYW52YXNSaWdodC5zdHlsZS56SW5kZXggPSAtMTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR0aGlzLnJpZ2h0U2hvd2luZyA9IHRydWU7XG5cdFx0XHRcdFx0XHR0aGlzLmxlZnRTaG93aW5nID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRpZiAodGhpcy5vZmZDYW52YXNSaWdodCkge1xuXHRcdFx0XHRcdFx0XHQkLmVhY2godGhpcy5vZmZDYW52YXNSaWdodHMsIGZ1bmN0aW9uKGluZGV4LCBvZmZDYW52YXMpIHtcblx0XHRcdFx0XHRcdFx0XHRpZiAob2ZmQ2FudmFzID09PSB0aGlzLm9mZkNhbnZhc1JpZ2h0KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRvZmZDYW52YXMuc3R5bGUuekluZGV4ID0gMDtcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdFx0b2ZmQ2FudmFzLnN0eWxlLnpJbmRleCA9IC0xO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fS5iaW5kKHRoaXMpKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGlmICh0aGlzLm9mZkNhbnZhc0xlZnQpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5vZmZDYW52YXNMZWZ0LnN0eWxlLnpJbmRleCA9IC0xO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRpZiAodGhpcy5vZmZDYW52YXMuY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX09GRl9DQU5WQVNfUklHSFQpKSB7XG5cdFx0XHRcdFx0XHRpZiAoeCA8IDApIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5zZXRUcmFuc2xhdGVYKDApO1xuXHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRpZiAoeCA+IHRoaXMub2ZmQ2FudmFzUmlnaHRXaWR0aCkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnNldFRyYW5zbGF0ZVgodGhpcy5vZmZDYW52YXNSaWdodFdpZHRoKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRpZiAoeCA+IDApIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5zZXRUcmFuc2xhdGVYKDApO1xuXHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRpZiAoeCA8IC10aGlzLm9mZkNhbnZhc0xlZnRXaWR0aCkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnNldFRyYW5zbGF0ZVgoLXRoaXMub2ZmQ2FudmFzTGVmdFdpZHRoKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR0aGlzLnNldFRyYW5zbGF0ZVgoeCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0dGhpcy5sYXN0VHJhbnNsYXRlWCA9IHg7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRzZXRUcmFuc2xhdGVYOiAkLmFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKHgpIHtcblx0XHRcdGlmICh0aGlzLnNjcm9sbGVyKSB7XG5cdFx0XHRcdGlmICh0aGlzLnNjYWxhYmxlICYmIHRoaXMub2ZmQ2FudmFzLnBhcmVudE5vZGUgPT09IHRoaXMud3JhcHBlcikge1xuXHRcdFx0XHRcdHZhciBwZXJjZW50ID0gTWF0aC5hYnMoeCkgLyB0aGlzLm9mZkNhbnZhc1dpZHRoO1xuXHRcdFx0XHRcdHZhciB6b29tT3V0U2NhbGUgPSAxIC0gKDEgLSB0aGlzLm9wdGlvbnMuc2NhbGUpICogcGVyY2VudDtcblx0XHRcdFx0XHR2YXIgem9vbUluU2NhbGUgPSB0aGlzLm9wdGlvbnMuc2NhbGUgKyAoMSAtIHRoaXMub3B0aW9ucy5zY2FsZSkgKiBwZXJjZW50O1xuXHRcdFx0XHRcdHZhciB6b29tT3V0T3BhY2l0eSA9IDEgLSAoMSAtIHRoaXMub3B0aW9ucy5vcGFjaXR5KSAqIHBlcmNlbnQ7XG5cdFx0XHRcdFx0dmFyIHpvb21Jbk9wYWNpdHkgPSB0aGlzLm9wdGlvbnMub3BhY2l0eSArICgxIC0gdGhpcy5vcHRpb25zLm9wYWNpdHkpICogcGVyY2VudDtcblx0XHRcdFx0XHRpZiAodGhpcy5vZmZDYW52YXMuY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX09GRl9DQU5WQVNfTEVGVCkpIHtcblx0XHRcdFx0XHRcdHRoaXMub2ZmQ2FudmFzLnN0eWxlLndlYmtpdFRyYW5zZm9ybU9yaWdpbiA9ICctMTAwJSc7XG5cdFx0XHRcdFx0XHR0aGlzLnNjcm9sbGVyLnN0eWxlLndlYmtpdFRyYW5zZm9ybU9yaWdpbiA9ICdsZWZ0Jztcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0dGhpcy5vZmZDYW52YXMuc3R5bGUud2Via2l0VHJhbnNmb3JtT3JpZ2luID0gJzIwMCUnO1xuXHRcdFx0XHRcdFx0dGhpcy5zY3JvbGxlci5zdHlsZS53ZWJraXRUcmFuc2Zvcm1PcmlnaW4gPSAncmlnaHQnO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR0aGlzLm9mZkNhbnZhcy5zdHlsZS5vcGFjaXR5ID0gem9vbUluT3BhY2l0eTtcblx0XHRcdFx0XHR0aGlzLm9mZkNhbnZhcy5zdHlsZS53ZWJraXRUcmFuc2Zvcm0gPSAndHJhbnNsYXRlM2QoMCwwLDApIHNjYWxlKCcgKyB6b29tSW5TY2FsZSArICcpJztcblx0XHRcdFx0XHR0aGlzLnNjcm9sbGVyLnN0eWxlLndlYmtpdFRyYW5zZm9ybSA9ICd0cmFuc2xhdGUzZCgnICsgeCArICdweCwwLDApIHNjYWxlKCcgKyB6b29tT3V0U2NhbGUgKyAnKSc7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0aWYgKHRoaXMuc2xpZGVJbikge1xuXHRcdFx0XHRcdFx0dGhpcy5vZmZDYW52YXMuc3R5bGUud2Via2l0VHJhbnNmb3JtID0gJ3RyYW5zbGF0ZTNkKCcgKyB4ICsgJ3B4LDAsMCknO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR0aGlzLnNjcm9sbGVyLnN0eWxlLndlYmtpdFRyYW5zZm9ybSA9ICd0cmFuc2xhdGUzZCgnICsgeCArICdweCwwLDApJztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KSxcblx0XHRnZXRUcmFuc2xhdGVYOiBmdW5jdGlvbigpIHtcblx0XHRcdGlmICh0aGlzLm9mZkNhbnZhcykge1xuXHRcdFx0XHR2YXIgc2Nyb2xsZXIgPSB0aGlzLnNsaWRlSW4gPyB0aGlzLm9mZkNhbnZhcyA6IHRoaXMuc2Nyb2xsZXI7XG5cdFx0XHRcdHZhciByZXN1bHQgPSAkLnBhcnNlVHJhbnNsYXRlTWF0cml4KCQuZ2V0U3R5bGVzKHNjcm9sbGVyLCAnd2Via2l0VHJhbnNmb3JtJykpO1xuXHRcdFx0XHRyZXR1cm4gKHJlc3VsdCAmJiByZXN1bHQueCkgfHwgMDtcblx0XHRcdH1cblx0XHRcdHJldHVybiAwO1xuXHRcdH0sXG5cdFx0aXNTaG93bjogZnVuY3Rpb24oZGlyZWN0aW9uKSB7XG5cdFx0XHR2YXIgc2hvd24gPSBmYWxzZTtcblx0XHRcdGlmICghdGhpcy5zbGlkZUluKSB7XG5cdFx0XHRcdHZhciB4ID0gdGhpcy5nZXRUcmFuc2xhdGVYKCk7XG5cdFx0XHRcdGlmIChkaXJlY3Rpb24gPT09ICdyaWdodCcpIHtcblx0XHRcdFx0XHRzaG93biA9IHRoaXMuY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX0FDVElWRSkgJiYgeCA8IDA7XG5cdFx0XHRcdH0gZWxzZSBpZiAoZGlyZWN0aW9uID09PSAnbGVmdCcpIHtcblx0XHRcdFx0XHRzaG93biA9IHRoaXMuY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX0FDVElWRSkgJiYgeCA+IDA7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0c2hvd24gPSB0aGlzLmNsYXNzTGlzdC5jb250YWlucyhDTEFTU19BQ1RJVkUpICYmIHggIT09IDA7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmIChkaXJlY3Rpb24gPT09ICdsZWZ0Jykge1xuXHRcdFx0XHRcdHNob3duID0gdGhpcy5jbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfQUNUSVZFKSAmJiB0aGlzLndyYXBwZXIucXVlcnlTZWxlY3RvcignLicgKyBDTEFTU19PRkZfQ0FOVkFTX0xFRlQgKyAnLicgKyBDTEFTU19BQ1RJVkUpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ3JpZ2h0Jykge1xuXHRcdFx0XHRcdHNob3duID0gdGhpcy5jbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfQUNUSVZFKSAmJiB0aGlzLndyYXBwZXIucXVlcnlTZWxlY3RvcignLicgKyBDTEFTU19PRkZfQ0FOVkFTX1JJR0hUICsgJy4nICsgQ0xBU1NfQUNUSVZFKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRzaG93biA9IHRoaXMuY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX0FDVElWRSkgJiYgKHRoaXMud3JhcHBlci5xdWVyeVNlbGVjdG9yKCcuJyArIENMQVNTX09GRl9DQU5WQVNfTEVGVCArICcuJyArIENMQVNTX0FDVElWRSkgfHwgdGhpcy53cmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJy4nICsgQ0xBU1NfT0ZGX0NBTlZBU19SSUdIVCArICcuJyArIENMQVNTX0FDVElWRSkpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gc2hvd247XG5cdFx0fSxcblx0XHRjbG9zZTogZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLl9pbml0T2ZmQ2FudmFzVmlzaWJsZSgpO1xuXHRcdFx0dGhpcy5vZmZDYW52YXMgPSB0aGlzLndyYXBwZXIucXVlcnlTZWxlY3RvcignLicgKyBDTEFTU19PRkZfQ0FOVkFTX1JJR0hUICsgJy4nICsgQ0xBU1NfQUNUSVZFKSB8fCB0aGlzLndyYXBwZXIucXVlcnlTZWxlY3RvcignLicgKyBDTEFTU19PRkZfQ0FOVkFTX0xFRlQgKyAnLicgKyBDTEFTU19BQ1RJVkUpO1xuXHRcdFx0dGhpcy5vZmZDYW52YXNXaWR0aCA9IHRoaXMub2ZmQ2FudmFzLm9mZnNldFdpZHRoO1xuXHRcdFx0aWYgKHRoaXMuc2Nyb2xsZXIpIHtcblx0XHRcdFx0dGhpcy5vZmZDYW52YXMub2Zmc2V0SGVpZ2h0O1xuXHRcdFx0XHR0aGlzLm9mZkNhbnZhcy5jbGFzc0xpc3QuYWRkKENMQVNTX1RSQU5TSVRJT05JTkcpO1xuXHRcdFx0XHR0aGlzLnNjcm9sbGVyLmNsYXNzTGlzdC5hZGQoQ0xBU1NfVFJBTlNJVElPTklORyk7XG5cdFx0XHRcdHRoaXMub3BlblBlcmNlbnRhZ2UoMCk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRzaG93OiBmdW5jdGlvbihkaXJlY3Rpb24pIHtcblx0XHRcdHRoaXMuX2luaXRPZmZDYW52YXNWaXNpYmxlKCk7XG5cdFx0XHRpZiAodGhpcy5pc1Nob3duKGRpcmVjdGlvbikpIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdFx0aWYgKCFkaXJlY3Rpb24pIHtcblx0XHRcdFx0ZGlyZWN0aW9uID0gdGhpcy53cmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJy4nICsgQ0xBU1NfT0ZGX0NBTlZBU19SSUdIVCkgPyAncmlnaHQnIDogJ2xlZnQnO1xuXHRcdFx0fVxuXHRcdFx0aWYgKGRpcmVjdGlvbiA9PT0gJ3JpZ2h0Jykge1xuXHRcdFx0XHR0aGlzLm9mZkNhbnZhcyA9IHRoaXMub2ZmQ2FudmFzUmlnaHQ7XG5cdFx0XHRcdHRoaXMub2ZmQ2FudmFzV2lkdGggPSB0aGlzLm9mZkNhbnZhc1JpZ2h0V2lkdGg7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLm9mZkNhbnZhcyA9IHRoaXMub2ZmQ2FudmFzTGVmdDtcblx0XHRcdFx0dGhpcy5vZmZDYW52YXNXaWR0aCA9IHRoaXMub2ZmQ2FudmFzTGVmdFdpZHRoO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHRoaXMuc2Nyb2xsZXIpIHtcblx0XHRcdFx0dGhpcy5vZmZDYW52YXMub2Zmc2V0SGVpZ2h0O1xuXHRcdFx0XHR0aGlzLm9mZkNhbnZhcy5jbGFzc0xpc3QuYWRkKENMQVNTX1RSQU5TSVRJT05JTkcpO1xuXHRcdFx0XHR0aGlzLnNjcm9sbGVyLmNsYXNzTGlzdC5hZGQoQ0xBU1NfVFJBTlNJVElPTklORyk7XG5cdFx0XHRcdHRoaXMub3BlblBlcmNlbnRhZ2UoZGlyZWN0aW9uID09PSAnbGVmdCcgPyAxMDAgOiAtMTAwKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH0sXG5cdFx0dG9nZ2xlOiBmdW5jdGlvbihkaXJlY3Rpb25Pck9mZkNhbnZhcykge1xuXHRcdFx0dmFyIGRpcmVjdGlvbiA9IGRpcmVjdGlvbk9yT2ZmQ2FudmFzO1xuXHRcdFx0aWYgKGRpcmVjdGlvbk9yT2ZmQ2FudmFzICYmIGRpcmVjdGlvbk9yT2ZmQ2FudmFzLmNsYXNzTGlzdCkge1xuXHRcdFx0XHRkaXJlY3Rpb24gPSBkaXJlY3Rpb25Pck9mZkNhbnZhcy5jbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfT0ZGX0NBTlZBU19MRUZUKSA/ICdsZWZ0JyA6ICdyaWdodCc7XG5cdFx0XHRcdHRoaXMucmVmcmVzaChkaXJlY3Rpb25Pck9mZkNhbnZhcyk7XG5cdFx0XHR9XG5cdFx0XHRpZiAoIXRoaXMuc2hvdyhkaXJlY3Rpb24pKSB7XG5cdFx0XHRcdHRoaXMuY2xvc2UoKTtcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXG5cdC8vaGFzaCB0byBvZmZjYW52YXNcblx0dmFyIGZpbmRPZmZDYW52YXNDb250YWluZXIgPSBmdW5jdGlvbih0YXJnZXQpIHtcblx0XHRwYXJlbnROb2RlID0gdGFyZ2V0LnBhcmVudE5vZGU7XG5cdFx0aWYgKHBhcmVudE5vZGUpIHtcblx0XHRcdGlmIChwYXJlbnROb2RlLmNsYXNzTGlzdC5jb250YWlucyhDTEFTU19PRkZfQ0FOVkFTX1dSQVApKSB7XG5cdFx0XHRcdHJldHVybiBwYXJlbnROb2RlO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cGFyZW50Tm9kZSA9IHBhcmVudE5vZGUucGFyZW50Tm9kZTtcblx0XHRcdFx0aWYgKHBhcmVudE5vZGUuY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX09GRl9DQU5WQVNfV1JBUCkpIHtcblx0XHRcdFx0XHRyZXR1cm4gcGFyZW50Tm9kZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fTtcblx0dmFyIGhhbmRsZSA9IGZ1bmN0aW9uKGV2ZW50LCB0YXJnZXQpIHtcblx0XHRpZiAodGFyZ2V0LnRhZ05hbWUgPT09ICdBJyAmJiB0YXJnZXQuaGFzaCkge1xuXHRcdFx0dmFyIG9mZmNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhcmdldC5oYXNoLnJlcGxhY2UoJyMnLCAnJykpO1xuXHRcdFx0aWYgKG9mZmNhbnZhcykge1xuXHRcdFx0XHR2YXIgY29udGFpbmVyID0gZmluZE9mZkNhbnZhc0NvbnRhaW5lcihvZmZjYW52YXMpO1xuXHRcdFx0XHRpZiAoY29udGFpbmVyKSB7XG5cdFx0XHRcdFx0JC50YXJnZXRzLl9jb250YWluZXIgPSBjb250YWluZXI7XG5cdFx0XHRcdFx0cmV0dXJuIG9mZmNhbnZhcztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH07XG5cblx0JC5yZWdpc3RlclRhcmdldCh7XG5cdFx0bmFtZTogbmFtZSxcblx0XHRpbmRleDogNjAsXG5cdFx0aGFuZGxlOiBoYW5kbGUsXG5cdFx0dGFyZ2V0OiBmYWxzZSxcblx0XHRpc1Jlc2V0OiBmYWxzZSxcblx0XHRpc0NvbnRpbnVlOiB0cnVlXG5cdH0pO1xuXG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd0YXAnLCBmdW5jdGlvbihlKSB7XG5cdFx0aWYgKCEkLnRhcmdldHMub2ZmY2FudmFzKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdC8vVE9ETyDmraTlpITnsbvlnovnmoTku6PnoIHlkI7nu63ogIPomZHnu5/kuIDkvJjljJYodGFyZ2V05py65Yi2Ke+8jOeOsOWcqOeahOWunueOsOi0ueWKm+S4jeiuqOWlvVxuXHRcdHZhciB0YXJnZXQgPSBlLnRhcmdldDtcblx0XHRmb3IgKDsgdGFyZ2V0ICYmIHRhcmdldCAhPT0gZG9jdW1lbnQ7IHRhcmdldCA9IHRhcmdldC5wYXJlbnROb2RlKSB7XG5cdFx0XHRpZiAodGFyZ2V0LnRhZ05hbWUgPT09ICdBJyAmJiB0YXJnZXQuaGFzaCAmJiB0YXJnZXQuaGFzaCA9PT0gKCcjJyArICQudGFyZ2V0cy5vZmZjYW52YXMuaWQpKSB7XG5cdFx0XHRcdGUuZGV0YWlsICYmIGUuZGV0YWlsLmdlc3R1cmUgJiYgZS5kZXRhaWwuZ2VzdHVyZS5wcmV2ZW50RGVmYXVsdCgpOyAvL2ZpeGVkIGhhc2hjaGFuZ2Vcblx0XHRcdFx0JCgkLnRhcmdldHMuX2NvbnRhaW5lcikub2ZmQ2FudmFzKCkudG9nZ2xlKCQudGFyZ2V0cy5vZmZjYW52YXMpO1xuXHRcdFx0XHQkLnRhcmdldHMub2ZmY2FudmFzID0gJC50YXJnZXRzLl9jb250YWluZXIgPSBudWxsO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXG5cdCQuZm4ub2ZmQ2FudmFzID0gZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdHZhciBvZmZDYW52YXNBcGlzID0gW107XG5cdFx0dGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIG9mZkNhbnZhc0FwaSA9IG51bGw7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHQvL2hhY2sgb2xkIHZlcnNpb25cblx0XHRcdGlmICghc2VsZi5jbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfT0ZGX0NBTlZBU19XUkFQKSkge1xuXHRcdFx0XHRzZWxmID0gZmluZE9mZkNhbnZhc0NvbnRhaW5lcihzZWxmKTtcblx0XHRcdH1cblx0XHRcdHZhciBpZCA9IHNlbGYuZ2V0QXR0cmlidXRlKCdkYXRhLW9mZkNhbnZhcycpO1xuXHRcdFx0aWYgKCFpZCkge1xuXHRcdFx0XHRpZCA9ICsrJC51dWlkO1xuXHRcdFx0XHQkLmRhdGFbaWRdID0gb2ZmQ2FudmFzQXBpID0gbmV3IE9mZkNhbnZhcyhzZWxmLCBvcHRpb25zKTtcblx0XHRcdFx0c2VsZi5zZXRBdHRyaWJ1dGUoJ2RhdGEtb2ZmQ2FudmFzJywgaWQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0b2ZmQ2FudmFzQXBpID0gJC5kYXRhW2lkXTtcblx0XHRcdH1cblx0XHRcdGlmIChvcHRpb25zID09PSAnc2hvdycgfHwgb3B0aW9ucyA9PT0gJ2Nsb3NlJyB8fCBvcHRpb25zID09PSAndG9nZ2xlJykge1xuXHRcdFx0XHRvZmZDYW52YXNBcGkudG9nZ2xlKCk7XG5cdFx0XHR9XG5cdFx0XHRvZmZDYW52YXNBcGlzLnB1c2gob2ZmQ2FudmFzQXBpKTtcblx0XHR9KTtcblx0XHRyZXR1cm4gb2ZmQ2FudmFzQXBpcy5sZW5ndGggPT09IDEgPyBvZmZDYW52YXNBcGlzWzBdIDogb2ZmQ2FudmFzQXBpcztcblx0fTtcblx0JC5yZWFkeShmdW5jdGlvbigpIHtcblx0XHQkKCcubXVpLW9mZi1jYW52YXMtd3JhcCcpLm9mZkNhbnZhcygpO1xuXHR9KTtcbn0pKG11aSwgd2luZG93LCBkb2N1bWVudCwgJ29mZmNhbnZhcycpO1xuLyoqXG4gKiBhY3Rpb25zXG4gKiBAcGFyYW0ge3R5cGV9ICRcbiAqIEBwYXJhbSB7dHlwZX0gbmFtZVxuICogQHJldHVybnMge3VuZGVmaW5lZH1cbiAqL1xuKGZ1bmN0aW9uKCQsIG5hbWUpIHtcblx0dmFyIENMQVNTX0FDVElPTiA9ICdtdWktYWN0aW9uJztcblxuXHR2YXIgaGFuZGxlID0gZnVuY3Rpb24oZXZlbnQsIHRhcmdldCkge1xuXHRcdHZhciBjbGFzc05hbWUgPSB0YXJnZXQuY2xhc3NOYW1lIHx8ICcnO1xuXHRcdGlmICh0eXBlb2YgY2xhc3NOYW1lICE9PSAnc3RyaW5nJykgeyAvL3N2ZyBjbGFzc05hbWUoU1ZHQW5pbWF0ZWRTdHJpbmcpXG5cdFx0XHRjbGFzc05hbWUgPSAnJztcblx0XHR9XG5cdFx0aWYgKGNsYXNzTmFtZSAmJiB+Y2xhc3NOYW1lLmluZGV4T2YoQ0xBU1NfQUNUSU9OKSkge1xuXHRcdFx0aWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ211aS1hY3Rpb24tYmFjaycpKSB7XG5cdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdGFyZ2V0O1xuXHRcdH1cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH07XG5cblx0JC5yZWdpc3RlclRhcmdldCh7XG5cdFx0bmFtZTogbmFtZSxcblx0XHRpbmRleDogNTAsXG5cdFx0aGFuZGxlOiBoYW5kbGUsXG5cdFx0dGFyZ2V0OiBmYWxzZSxcblx0XHRpc0NvbnRpbnVlOiB0cnVlXG5cdH0pO1xuXG59KShtdWksICdhY3Rpb24nKTtcbi8qKlxuICogTW9kYWxzXG4gKiBAcGFyYW0ge3R5cGV9ICRcbiAqIEBwYXJhbSB7dHlwZX0gd2luZG93XG4gKiBAcGFyYW0ge3R5cGV9IGRvY3VtZW50XG4gKiBAcGFyYW0ge3R5cGV9IG5hbWVcbiAqIEByZXR1cm5zIHt1bmRlZmluZWR9XG4gKi9cbihmdW5jdGlvbigkLCB3aW5kb3csIGRvY3VtZW50LCBuYW1lKSB7XG5cdHZhciBDTEFTU19NT0RBTCA9ICdtdWktbW9kYWwnO1xuXG5cdHZhciBoYW5kbGUgPSBmdW5jdGlvbihldmVudCwgdGFyZ2V0KSB7XG5cdFx0aWYgKHRhcmdldC50YWdOYW1lID09PSAnQScgJiYgdGFyZ2V0Lmhhc2gpIHtcblx0XHRcdHZhciBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhcmdldC5oYXNoLnJlcGxhY2UoJyMnLCAnJykpO1xuXHRcdFx0aWYgKG1vZGFsICYmIG1vZGFsLmNsYXNzTGlzdC5jb250YWlucyhDTEFTU19NT0RBTCkpIHtcblx0XHRcdFx0cmV0dXJuIG1vZGFsO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH07XG5cblx0JC5yZWdpc3RlclRhcmdldCh7XG5cdFx0bmFtZTogbmFtZSxcblx0XHRpbmRleDogNTAsXG5cdFx0aGFuZGxlOiBoYW5kbGUsXG5cdFx0dGFyZ2V0OiBmYWxzZSxcblx0XHRpc1Jlc2V0OiBmYWxzZSxcblx0XHRpc0NvbnRpbnVlOiB0cnVlXG5cdH0pO1xuXG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd0YXAnLCBmdW5jdGlvbihldmVudCkge1xuXHRcdGlmICgkLnRhcmdldHMubW9kYWwpIHtcblx0XHRcdGV2ZW50LmRldGFpbC5nZXN0dXJlLnByZXZlbnREZWZhdWx0KCk7IC8vZml4ZWQgaGFzaGNoYW5nZVxuXHRcdFx0JC50YXJnZXRzLm1vZGFsLmNsYXNzTGlzdC50b2dnbGUoJ211aS1hY3RpdmUnKTtcblx0XHR9XG5cdH0pO1xufSkobXVpLCB3aW5kb3csIGRvY3VtZW50LCAnbW9kYWwnKTtcbi8qKlxuICogUG9wb3ZlcnNcbiAqIEBwYXJhbSB7dHlwZX0gJFxuICogQHBhcmFtIHt0eXBlfSB3aW5kb3dcbiAqIEBwYXJhbSB7dHlwZX0gZG9jdW1lbnRcbiAqIEBwYXJhbSB7dHlwZX0gbmFtZVxuICogQHBhcmFtIHt0eXBlfSB1bmRlZmluZWRcbiAqIEByZXR1cm5zIHt1bmRlZmluZWR9XG4gKi9cbihmdW5jdGlvbigkLCB3aW5kb3csIGRvY3VtZW50LCBuYW1lKSB7XG5cblx0dmFyIENMQVNTX1BPUE9WRVIgPSAnbXVpLXBvcG92ZXInO1xuXHR2YXIgQ0xBU1NfUE9QT1ZFUl9BUlJPVyA9ICdtdWktcG9wb3Zlci1hcnJvdyc7XG5cdHZhciBDTEFTU19BQ1RJT05fUE9QT1ZFUiA9ICdtdWktcG9wb3Zlci1hY3Rpb24nO1xuXHR2YXIgQ0xBU1NfQkFDS0RST1AgPSAnbXVpLWJhY2tkcm9wJztcblx0dmFyIENMQVNTX0JBUl9QT1BPVkVSID0gJ211aS1iYXItcG9wb3Zlcic7XG5cdHZhciBDTEFTU19CQVJfQkFDS0RST1AgPSAnbXVpLWJhci1iYWNrZHJvcCc7XG5cdHZhciBDTEFTU19BQ1RJT05fQkFDS0RST1AgPSAnbXVpLWJhY2tkcm9wLWFjdGlvbic7XG5cdHZhciBDTEFTU19BQ1RJVkUgPSAnbXVpLWFjdGl2ZSc7XG5cdHZhciBDTEFTU19CT1RUT00gPSAnbXVpLWJvdHRvbSc7XG5cblxuXG5cdHZhciBoYW5kbGUgPSBmdW5jdGlvbihldmVudCwgdGFyZ2V0KSB7XG5cdFx0aWYgKHRhcmdldC50YWdOYW1lID09PSAnQScgJiYgdGFyZ2V0Lmhhc2gpIHtcblx0XHRcdCQudGFyZ2V0cy5fcG9wb3ZlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhcmdldC5oYXNoLnJlcGxhY2UoJyMnLCAnJykpO1xuXHRcdFx0aWYgKCQudGFyZ2V0cy5fcG9wb3ZlciAmJiAkLnRhcmdldHMuX3BvcG92ZXIuY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX1BPUE9WRVIpKSB7XG5cdFx0XHRcdHJldHVybiB0YXJnZXQ7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQkLnRhcmdldHMuX3BvcG92ZXIgPSBudWxsO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH07XG5cblx0JC5yZWdpc3RlclRhcmdldCh7XG5cdFx0bmFtZTogbmFtZSxcblx0XHRpbmRleDogNjAsXG5cdFx0aGFuZGxlOiBoYW5kbGUsXG5cdFx0dGFyZ2V0OiBmYWxzZSxcblx0XHRpc1Jlc2V0OiBmYWxzZSxcblx0XHRpc0NvbnRpbnVlOiB0cnVlXG5cdH0pO1xuXG5cdHZhciBvblBvcG92ZXJTaG93biA9IGZ1bmN0aW9uKGUpIHtcblx0XHR0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3dlYmtpdFRyYW5zaXRpb25FbmQnLCBvblBvcG92ZXJTaG93bik7XG5cdFx0dGhpcy5hZGRFdmVudExpc3RlbmVyKCQuRVZFTlRfTU9WRSwgJC5wcmV2ZW50RGVmYXVsdCk7XG5cdFx0JC50cmlnZ2VyKHRoaXMsICdzaG93bicsIHRoaXMpO1xuXHR9XG5cdHZhciBvblBvcG92ZXJIaWRkZW4gPSBmdW5jdGlvbihlKSB7XG5cdFx0c2V0U3R5bGUodGhpcywgJ25vbmUnKTtcblx0XHR0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3dlYmtpdFRyYW5zaXRpb25FbmQnLCBvblBvcG92ZXJIaWRkZW4pO1xuXHRcdHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigkLkVWRU5UX01PVkUsICQucHJldmVudERlZmF1bHQpO1xuXHRcdCQudHJpZ2dlcih0aGlzLCAnaGlkZGVuJywgdGhpcyk7XG5cdH07XG5cblx0dmFyIGJhY2tkcm9wID0gKGZ1bmN0aW9uKCkge1xuXHRcdHZhciBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0ZWxlbWVudC5jbGFzc0xpc3QuYWRkKENMQVNTX0JBQ0tEUk9QKTtcblx0XHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJC5FVkVOVF9NT1ZFLCAkLnByZXZlbnREZWZhdWx0KTtcblx0XHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RhcCcsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdHZhciBwb3BvdmVyID0gJC50YXJnZXRzLl9wb3BvdmVyO1xuXHRcdFx0aWYgKHBvcG92ZXIpIHtcblx0XHRcdFx0cG9wb3Zlci5hZGRFdmVudExpc3RlbmVyKCd3ZWJraXRUcmFuc2l0aW9uRW5kJywgb25Qb3BvdmVySGlkZGVuKTtcblx0XHRcdFx0cG9wb3Zlci5jbGFzc0xpc3QucmVtb3ZlKENMQVNTX0FDVElWRSk7XG5cdFx0XHRcdHJlbW92ZUJhY2tkcm9wKHBvcG92ZXIpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIGVsZW1lbnQ7XG5cdH0oKSk7XG5cdHZhciByZW1vdmVCYWNrZHJvcFRpbWVyO1xuXHR2YXIgcmVtb3ZlQmFja2Ryb3AgPSBmdW5jdGlvbihwb3BvdmVyKSB7XG5cdFx0YmFja2Ryb3Auc2V0QXR0cmlidXRlKCdzdHlsZScsICdvcGFjaXR5OjAnKTtcblx0XHQkLnRhcmdldHMucG9wb3ZlciA9ICQudGFyZ2V0cy5fcG9wb3ZlciA9IG51bGw7IC8vcmVzZXRcblx0XHRyZW1vdmVCYWNrZHJvcFRpbWVyID0gJC5sYXRlcihmdW5jdGlvbigpIHtcblx0XHRcdGlmICghcG9wb3Zlci5jbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfQUNUSVZFKSAmJiBiYWNrZHJvcC5wYXJlbnROb2RlICYmIGJhY2tkcm9wLnBhcmVudE5vZGUgPT09IGRvY3VtZW50LmJvZHkpIHtcblx0XHRcdFx0ZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChiYWNrZHJvcCk7XG5cdFx0XHR9XG5cdFx0fSwgMzUwKTtcblx0fTtcblx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3RhcCcsIGZ1bmN0aW9uKGUpIHtcblx0XHRpZiAoISQudGFyZ2V0cy5wb3BvdmVyKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdHZhciB0b2dnbGUgPSBmYWxzZTtcblx0XHR2YXIgdGFyZ2V0ID0gZS50YXJnZXQ7XG5cdFx0Zm9yICg7IHRhcmdldCAmJiB0YXJnZXQgIT09IGRvY3VtZW50OyB0YXJnZXQgPSB0YXJnZXQucGFyZW50Tm9kZSkge1xuXHRcdFx0aWYgKHRhcmdldCA9PT0gJC50YXJnZXRzLnBvcG92ZXIpIHtcblx0XHRcdFx0dG9nZ2xlID0gdHJ1ZTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKHRvZ2dsZSkge1xuXHRcdFx0ZS5kZXRhaWwuZ2VzdHVyZS5wcmV2ZW50RGVmYXVsdCgpOyAvL2ZpeGVkIGhhc2hjaGFuZ2Vcblx0XHRcdHRvZ2dsZVBvcG92ZXIoJC50YXJnZXRzLl9wb3BvdmVyLCAkLnRhcmdldHMucG9wb3Zlcik7XG5cdFx0fVxuXG5cdH0pO1xuXG5cdHZhciB0b2dnbGVQb3BvdmVyID0gZnVuY3Rpb24ocG9wb3ZlciwgYW5jaG9yLCBzdGF0ZSkge1xuXHRcdGlmICgoc3RhdGUgPT09ICdzaG93JyAmJiBwb3BvdmVyLmNsYXNzTGlzdC5jb250YWlucyhDTEFTU19BQ1RJVkUpKSB8fCAoc3RhdGUgPT09ICdoaWRlJyAmJiAhcG9wb3Zlci5jbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfQUNUSVZFKSkpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0cmVtb3ZlQmFja2Ryb3BUaW1lciAmJiByZW1vdmVCYWNrZHJvcFRpbWVyLmNhbmNlbCgpOyAvL+WPlua2iHJlbW92ZeeahHRpbWVyXG5cdFx0Ly9yZW1vdmXkuIDpgY3vvIzku6XlhY3mnaXlm57lv6vpgJ/liIfmjaLvvIzlr7zoh7R3ZWJraXRUcmFuc2l0aW9uRW5k5LiN6Kem5Y+R77yM5peg5rOVcmVtb3ZlXG5cdFx0cG9wb3Zlci5yZW1vdmVFdmVudExpc3RlbmVyKCd3ZWJraXRUcmFuc2l0aW9uRW5kJywgb25Qb3BvdmVyU2hvd24pO1xuXHRcdHBvcG92ZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcignd2Via2l0VHJhbnNpdGlvbkVuZCcsIG9uUG9wb3ZlckhpZGRlbik7XG5cdFx0YmFja2Ryb3AuY2xhc3NMaXN0LnJlbW92ZShDTEFTU19CQVJfQkFDS0RST1ApO1xuXHRcdGJhY2tkcm9wLmNsYXNzTGlzdC5yZW1vdmUoQ0xBU1NfQUNUSU9OX0JBQ0tEUk9QKTtcblx0XHR2YXIgX3BvcG92ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubXVpLXBvcG92ZXIubXVpLWFjdGl2ZScpO1xuXHRcdGlmIChfcG9wb3Zlcikge1xuXHRcdFx0Ly9cdFx0XHRfcG9wb3Zlci5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgJycpO1xuXHRcdFx0X3BvcG92ZXIuYWRkRXZlbnRMaXN0ZW5lcignd2Via2l0VHJhbnNpdGlvbkVuZCcsIG9uUG9wb3ZlckhpZGRlbik7XG5cdFx0XHRfcG9wb3Zlci5jbGFzc0xpc3QucmVtb3ZlKENMQVNTX0FDVElWRSk7XG5cdFx0XHQvL1x0XHRcdF9wb3BvdmVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3dlYmtpdFRyYW5zaXRpb25FbmQnLCBvblBvcG92ZXJIaWRkZW4pO1xuXHRcdFx0Ly/lkIzkuIDkuKrlvLnlh7rliJnnm7TmjqXov5Tlm57vvIzop6PlhrPlkIzkuIDkuKpwb3BvdmVy55qEdG9nZ2xlXG5cdFx0XHRpZiAocG9wb3ZlciA9PT0gX3BvcG92ZXIpIHtcblx0XHRcdFx0cmVtb3ZlQmFja2Ryb3AoX3BvcG92ZXIpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHZhciBpc0FjdGlvblNoZWV0ID0gZmFsc2U7XG5cdFx0aWYgKHBvcG92ZXIuY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX0JBUl9QT1BPVkVSKSB8fCBwb3BvdmVyLmNsYXNzTGlzdC5jb250YWlucyhDTEFTU19BQ1RJT05fUE9QT1ZFUikpIHsgLy9uYXZCYXJcblx0XHRcdGlmIChwb3BvdmVyLmNsYXNzTGlzdC5jb250YWlucyhDTEFTU19BQ1RJT05fUE9QT1ZFUikpIHsgLy9hY3Rpb24gc2hlZXQgcG9wb3ZlclxuXHRcdFx0XHRpc0FjdGlvblNoZWV0ID0gdHJ1ZTtcblx0XHRcdFx0YmFja2Ryb3AuY2xhc3NMaXN0LmFkZChDTEFTU19BQ1RJT05fQkFDS0RST1ApO1xuXHRcdFx0fSBlbHNlIHsgLy9iYXIgcG9wb3ZlclxuXHRcdFx0XHRiYWNrZHJvcC5jbGFzc0xpc3QuYWRkKENMQVNTX0JBUl9CQUNLRFJPUCk7XG5cdFx0XHRcdC8vXHRcdFx0XHRpZiAoYW5jaG9yKSB7XG5cdFx0XHRcdC8vXHRcdFx0XHRcdGlmIChhbmNob3IucGFyZW50Tm9kZSkge1xuXHRcdFx0XHQvL1x0XHRcdFx0XHRcdHZhciBvZmZzZXRXaWR0aCA9IGFuY2hvci5vZmZzZXRXaWR0aDtcblx0XHRcdFx0Ly9cdFx0XHRcdFx0XHR2YXIgb2Zmc2V0TGVmdCA9IGFuY2hvci5vZmZzZXRMZWZ0O1xuXHRcdFx0XHQvL1x0XHRcdFx0XHRcdHZhciBpbm5lcldpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XG5cdFx0XHRcdC8vXHRcdFx0XHRcdFx0cG9wb3Zlci5zdHlsZS5sZWZ0ID0gKE1hdGgubWluKE1hdGgubWF4KG9mZnNldExlZnQsIGRlZmF1bHRQYWRkaW5nKSwgaW5uZXJXaWR0aCAtIG9mZnNldFdpZHRoIC0gZGVmYXVsdFBhZGRpbmcpKSArIFwicHhcIjtcblx0XHRcdFx0Ly9cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly9cdFx0XHRcdFx0XHQvL1RPRE8gYW5jaG9yIGlzIHBvc2l0aW9uOntsZWZ0LHRvcCxib3R0b20scmlnaHR9XG5cdFx0XHRcdC8vXHRcdFx0XHRcdH1cblx0XHRcdFx0Ly9cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0c2V0U3R5bGUocG9wb3ZlciwgJ2Jsb2NrJyk7IC8vYWN0aW9uc2hlZXQgdHJhbnNmb3JtXG5cdFx0cG9wb3Zlci5vZmZzZXRIZWlnaHQ7XG5cdFx0cG9wb3Zlci5jbGFzc0xpc3QuYWRkKENMQVNTX0FDVElWRSk7XG5cdFx0YmFja2Ryb3Auc2V0QXR0cmlidXRlKCdzdHlsZScsICcnKTtcblx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGJhY2tkcm9wKTtcblx0XHRjYWxQb3NpdGlvbihwb3BvdmVyLCBhbmNob3IsIGlzQWN0aW9uU2hlZXQpOyAvL3Bvc2l0aW9uXG5cdFx0YmFja2Ryb3AuY2xhc3NMaXN0LmFkZChDTEFTU19BQ1RJVkUpO1xuXHRcdHBvcG92ZXIuYWRkRXZlbnRMaXN0ZW5lcignd2Via2l0VHJhbnNpdGlvbkVuZCcsIG9uUG9wb3ZlclNob3duKTtcblx0fTtcblx0dmFyIHNldFN0eWxlID0gZnVuY3Rpb24ocG9wb3ZlciwgZGlzcGxheSwgdG9wLCBsZWZ0KSB7XG5cdFx0dmFyIHN0eWxlID0gcG9wb3Zlci5zdHlsZTtcblx0XHRpZiAodHlwZW9mIGRpc3BsYXkgIT09ICd1bmRlZmluZWQnKVxuXHRcdFx0c3R5bGUuZGlzcGxheSA9IGRpc3BsYXk7XG5cdFx0aWYgKHR5cGVvZiB0b3AgIT09ICd1bmRlZmluZWQnKVxuXHRcdFx0c3R5bGUudG9wID0gdG9wICsgJ3B4Jztcblx0XHRpZiAodHlwZW9mIGxlZnQgIT09ICd1bmRlZmluZWQnKVxuXHRcdFx0c3R5bGUubGVmdCA9IGxlZnQgKyAncHgnO1xuXHR9O1xuXHR2YXIgY2FsUG9zaXRpb24gPSBmdW5jdGlvbihwb3BvdmVyLCBhbmNob3IsIGlzQWN0aW9uU2hlZXQpIHtcblx0XHRpZiAoIXBvcG92ZXIgfHwgIWFuY2hvcikge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGlmIChpc0FjdGlvblNoZWV0KSB7IC8vYWN0aW9uc2hlZXRcblx0XHRcdHNldFN0eWxlKHBvcG92ZXIsICdibG9jaycpXG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dmFyIHdXaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xuXHRcdHZhciB3SGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xuXG5cdFx0dmFyIHBXaWR0aCA9IHBvcG92ZXIub2Zmc2V0V2lkdGg7XG5cdFx0dmFyIHBIZWlnaHQgPSBwb3BvdmVyLm9mZnNldEhlaWdodDtcblxuXHRcdHZhciBhV2lkdGggPSBhbmNob3Iub2Zmc2V0V2lkdGg7XG5cdFx0dmFyIGFIZWlnaHQgPSBhbmNob3Iub2Zmc2V0SGVpZ2h0O1xuXHRcdHZhciBvZmZzZXQgPSAkLm9mZnNldChhbmNob3IpO1xuXG5cdFx0dmFyIGFycm93ID0gcG9wb3Zlci5xdWVyeVNlbGVjdG9yKCcuJyArIENMQVNTX1BPUE9WRVJfQVJST1cpO1xuXHRcdGlmICghYXJyb3cpIHtcblx0XHRcdGFycm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0XHRhcnJvdy5jbGFzc05hbWUgPSBDTEFTU19QT1BPVkVSX0FSUk9XO1xuXHRcdFx0cG9wb3Zlci5hcHBlbmRDaGlsZChhcnJvdyk7XG5cdFx0fVxuXHRcdHZhciBhcnJvd1NpemUgPSBhcnJvdyAmJiBhcnJvdy5vZmZzZXRXaWR0aCAvIDIgfHwgMDtcblxuXG5cblx0XHR2YXIgcFRvcCA9IDA7XG5cdFx0dmFyIHBMZWZ0ID0gMDtcblx0XHR2YXIgZGlmZiA9IDA7XG5cdFx0dmFyIGFycm93TGVmdCA9IDA7XG5cdFx0dmFyIGRlZmF1bHRQYWRkaW5nID0gcG9wb3Zlci5jbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfQUNUSU9OX1BPUE9WRVIpID8gMCA6IDU7XG5cblx0XHR2YXIgcG9zaXRpb24gPSAndG9wJztcblx0XHRpZiAoKHBIZWlnaHQgKyBhcnJvd1NpemUpIDwgKG9mZnNldC50b3AgLSB3aW5kb3cucGFnZVlPZmZzZXQpKSB7IC8vdG9wXG5cdFx0XHRwVG9wID0gb2Zmc2V0LnRvcCAtIHBIZWlnaHQgLSBhcnJvd1NpemU7XG5cdFx0fSBlbHNlIGlmICgocEhlaWdodCArIGFycm93U2l6ZSkgPCAod0hlaWdodCAtIChvZmZzZXQudG9wIC0gd2luZG93LnBhZ2VZT2Zmc2V0KSAtIGFIZWlnaHQpKSB7IC8vYm90dG9tXG5cdFx0XHRwb3NpdGlvbiA9ICdib3R0b20nO1xuXHRcdFx0cFRvcCA9IG9mZnNldC50b3AgKyBhSGVpZ2h0ICsgYXJyb3dTaXplO1xuXHRcdH0gZWxzZSB7IC8vbWlkZGxlXG5cdFx0XHRwb3NpdGlvbiA9ICdtaWRkbGUnO1xuXHRcdFx0cFRvcCA9IE1hdGgubWF4KCh3SGVpZ2h0IC0gcEhlaWdodCkgLyAyICsgd2luZG93LnBhZ2VZT2Zmc2V0LCAwKTtcblx0XHRcdHBMZWZ0ID0gTWF0aC5tYXgoKHdXaWR0aCAtIHBXaWR0aCkgLyAyICsgd2luZG93LnBhZ2VYT2Zmc2V0LCAwKTtcblx0XHR9XG5cdFx0aWYgKHBvc2l0aW9uID09PSAndG9wJyB8fCBwb3NpdGlvbiA9PT0gJ2JvdHRvbScpIHtcblx0XHRcdHBMZWZ0ID0gYVdpZHRoIC8gMiArIG9mZnNldC5sZWZ0IC0gcFdpZHRoIC8gMjtcblx0XHRcdGRpZmYgPSBwTGVmdDtcblx0XHRcdGlmIChwTGVmdCA8IGRlZmF1bHRQYWRkaW5nKSBwTGVmdCA9IGRlZmF1bHRQYWRkaW5nO1xuXHRcdFx0aWYgKHBMZWZ0ICsgcFdpZHRoID4gd1dpZHRoKSBwTGVmdCA9IHdXaWR0aCAtIHBXaWR0aCAtIGRlZmF1bHRQYWRkaW5nO1xuXG5cdFx0XHRpZiAoYXJyb3cpIHtcblx0XHRcdFx0aWYgKHBvc2l0aW9uID09PSAndG9wJykge1xuXHRcdFx0XHRcdGFycm93LmNsYXNzTGlzdC5hZGQoQ0xBU1NfQk9UVE9NKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRhcnJvdy5jbGFzc0xpc3QucmVtb3ZlKENMQVNTX0JPVFRPTSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZGlmZiA9IGRpZmYgLSBwTGVmdDtcblx0XHRcdFx0YXJyb3dMZWZ0ID0gKHBXaWR0aCAvIDIgLSBhcnJvd1NpemUgLyAyICsgZGlmZik7XG5cdFx0XHRcdGFycm93TGVmdCA9IE1hdGgubWF4KE1hdGgubWluKGFycm93TGVmdCwgcFdpZHRoIC0gYXJyb3dTaXplICogMiAtIDYpLCA2KTtcblx0XHRcdFx0YXJyb3cuc2V0QXR0cmlidXRlKCdzdHlsZScsICdsZWZ0OicgKyBhcnJvd0xlZnQgKyAncHgnKTtcblx0XHRcdH1cblx0XHR9IGVsc2UgaWYgKHBvc2l0aW9uID09PSAnbWlkZGxlJykge1xuXHRcdFx0YXJyb3cuc2V0QXR0cmlidXRlKCdzdHlsZScsICdkaXNwbGF5Om5vbmUnKTtcblx0XHR9XG5cdFx0c2V0U3R5bGUocG9wb3ZlciwgJ2Jsb2NrJywgcFRvcCwgcExlZnQpO1xuXHR9O1xuXG5cdCQuY3JlYXRlTWFzayA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG5cdFx0dmFyIGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHRlbGVtZW50LmNsYXNzTGlzdC5hZGQoQ0xBU1NfQkFDS0RST1ApO1xuXHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigkLkVWRU5UX01PVkUsICQucHJldmVudERlZmF1bHQpO1xuXHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndGFwJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRtYXNrLmNsb3NlKCk7XG5cdFx0fSk7XG5cdFx0dmFyIG1hc2sgPSBbZWxlbWVudF07XG5cdFx0bWFzay5fc2hvdyA9IGZhbHNlO1xuXHRcdG1hc2suc2hvdyA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0bWFzay5fc2hvdyA9IHRydWU7XG5cdFx0XHRlbGVtZW50LnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnb3BhY2l0eToxJyk7XG5cdFx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuXHRcdFx0cmV0dXJuIG1hc2s7XG5cdFx0fTtcblx0XHRtYXNrLl9yZW1vdmUgPSBmdW5jdGlvbigpIHtcblx0XHRcdGlmIChtYXNrLl9zaG93KSB7XG5cdFx0XHRcdG1hc2suX3Nob3cgPSBmYWxzZTtcblx0XHRcdFx0ZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgJ29wYWNpdHk6MCcpO1xuXHRcdFx0XHQkLmxhdGVyKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHZhciBib2R5ID0gZG9jdW1lbnQuYm9keTtcblx0XHRcdFx0XHRlbGVtZW50LnBhcmVudE5vZGUgPT09IGJvZHkgJiYgYm9keS5yZW1vdmVDaGlsZChlbGVtZW50KTtcblx0XHRcdFx0fSwgMzUwKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBtYXNrO1xuXHRcdH07XG5cdFx0bWFzay5jbG9zZSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKGNhbGxiYWNrKSB7XG5cdFx0XHRcdGlmIChjYWxsYmFjaygpICE9PSBmYWxzZSkge1xuXHRcdFx0XHRcdG1hc2suX3JlbW92ZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRtYXNrLl9yZW1vdmUoKTtcblx0XHRcdH1cblx0XHR9O1xuXHRcdHJldHVybiBtYXNrO1xuXHR9O1xuXHQkLmZuLnBvcG92ZXIgPSBmdW5jdGlvbigpIHtcblx0XHR2YXIgYXJncyA9IGFyZ3VtZW50cztcblx0XHR0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHQkLnRhcmdldHMuX3BvcG92ZXIgPSB0aGlzO1xuXHRcdFx0aWYgKGFyZ3NbMF0gPT09ICdzaG93JyB8fCBhcmdzWzBdID09PSAnaGlkZScgfHwgYXJnc1swXSA9PT0gJ3RvZ2dsZScpIHtcblx0XHRcdFx0dG9nZ2xlUG9wb3Zlcih0aGlzLCBhcmdzWzFdLCBhcmdzWzBdKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fTtcblxufSkobXVpLCB3aW5kb3csIGRvY3VtZW50LCAncG9wb3ZlcicpO1xuLyoqXG4gKiBzZWdtZW50ZWQtY29udHJvbGxlcnNcbiAqIEBwYXJhbSB7dHlwZX0gJFxuICogQHBhcmFtIHt0eXBlfSB3aW5kb3dcbiAqIEBwYXJhbSB7dHlwZX0gZG9jdW1lbnRcbiAqIEBwYXJhbSB7dHlwZX0gdW5kZWZpbmVkXG4gKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxuICovXG4oZnVuY3Rpb24oJCwgd2luZG93LCBkb2N1bWVudCwgbmFtZSwgdW5kZWZpbmVkKSB7XG5cblx0dmFyIENMQVNTX0NPTlRST0xfSVRFTSA9ICdtdWktY29udHJvbC1pdGVtJztcblx0dmFyIENMQVNTX1NFR01FTlRFRF9DT05UUk9MID0gJ211aS1zZWdtZW50ZWQtY29udHJvbCc7XG5cdHZhciBDTEFTU19TRUdNRU5URURfQ09OVFJPTF9WRVJUSUNBTCA9ICdtdWktc2VnbWVudGVkLWNvbnRyb2wtdmVydGljYWwnO1xuXHR2YXIgQ0xBU1NfQ09OVFJPTF9DT05URU5UID0gJ211aS1jb250cm9sLWNvbnRlbnQnO1xuXHR2YXIgQ0xBU1NfVEFCX0JBUiA9ICdtdWktYmFyLXRhYic7XG5cdHZhciBDTEFTU19UQUJfSVRFTSA9ICdtdWktdGFiLWl0ZW0nO1xuXHR2YXIgQ0xBU1NfU0xJREVSX0lURU0gPSAnbXVpLXNsaWRlci1pdGVtJztcblxuXHR2YXIgaGFuZGxlID0gZnVuY3Rpb24oZXZlbnQsIHRhcmdldCkge1xuXHRcdGlmICh0YXJnZXQuY2xhc3NMaXN0ICYmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX0NPTlRST0xfSVRFTSkgfHwgdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhDTEFTU19UQUJfSVRFTSkpKSB7XG5cdFx0XHRpZiAodGFyZ2V0LnBhcmVudE5vZGUgJiYgdGFyZ2V0LnBhcmVudE5vZGUuY2xhc3NMaXN0ICYmIHRhcmdldC5wYXJlbnROb2RlLmNsYXNzTGlzdC5jb250YWlucyhDTEFTU19TRUdNRU5URURfQ09OVFJPTF9WRVJUSUNBTCkpIHtcblx0XHRcdFx0Ly92ZXJ0aWNhbCDlpoLmnpxwcmV2ZW50RGVmYXVsdOS8muWvvOiHtOaXoOazlea7muWKqFxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTsgLy9zdG9wIGhhc2ggY2hhbmdlXG5cdFx0XHR9XG5cdFx0XHQvL1x0XHRcdGlmICh0YXJnZXQuaGFzaCkge1xuXHRcdFx0cmV0dXJuIHRhcmdldDtcblx0XHRcdC8vXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH07XG5cblx0JC5yZWdpc3RlclRhcmdldCh7XG5cdFx0bmFtZTogbmFtZSxcblx0XHRpbmRleDogODAsXG5cdFx0aGFuZGxlOiBoYW5kbGUsXG5cdFx0dGFyZ2V0OiBmYWxzZVxuXHR9KTtcblxuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndGFwJywgZnVuY3Rpb24oZSkge1xuXG5cdFx0dmFyIHRhcmdldFRhYiA9ICQudGFyZ2V0cy50YWI7XG5cdFx0aWYgKCF0YXJnZXRUYWIpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0dmFyIGFjdGl2ZVRhYjtcblx0XHR2YXIgYWN0aXZlQm9kaWVzO1xuXHRcdHZhciB0YXJnZXRCb2R5O1xuXHRcdHZhciBjbGFzc05hbWUgPSAnbXVpLWFjdGl2ZSc7XG5cdFx0dmFyIGNsYXNzU2VsZWN0b3IgPSAnLicgKyBjbGFzc05hbWU7XG5cdFx0dmFyIHNlZ21lbnRlZENvbnRyb2wgPSB0YXJnZXRUYWIucGFyZW50Tm9kZTtcblxuXHRcdGZvciAoOyBzZWdtZW50ZWRDb250cm9sICYmIHNlZ21lbnRlZENvbnRyb2wgIT09IGRvY3VtZW50OyBzZWdtZW50ZWRDb250cm9sID0gc2VnbWVudGVkQ29udHJvbC5wYXJlbnROb2RlKSB7XG5cdFx0XHRpZiAoc2VnbWVudGVkQ29udHJvbC5jbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfU0VHTUVOVEVEX0NPTlRST0wpKSB7XG5cdFx0XHRcdGFjdGl2ZVRhYiA9IHNlZ21lbnRlZENvbnRyb2wucXVlcnlTZWxlY3RvcihjbGFzc1NlbGVjdG9yICsgJy4nICsgQ0xBU1NfQ09OVFJPTF9JVEVNKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9IGVsc2UgaWYgKHNlZ21lbnRlZENvbnRyb2wuY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX1RBQl9CQVIpKSB7XG5cdFx0XHRcdGFjdGl2ZVRhYiA9IHNlZ21lbnRlZENvbnRyb2wucXVlcnlTZWxlY3RvcihjbGFzc1NlbGVjdG9yICsgJy4nICsgQ0xBU1NfVEFCX0lURU0pO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmIChhY3RpdmVUYWIpIHtcblx0XHRcdGFjdGl2ZVRhYi5jbGFzc0xpc3QucmVtb3ZlKGNsYXNzTmFtZSk7XG5cdFx0fVxuXG5cdFx0dmFyIGlzTGFzdEFjdGl2ZSA9IHRhcmdldFRhYiA9PT0gYWN0aXZlVGFiO1xuXHRcdGlmICh0YXJnZXRUYWIpIHtcblx0XHRcdHRhcmdldFRhYi5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSk7XG5cdFx0fVxuXG5cdFx0aWYgKCF0YXJnZXRUYWIuaGFzaCkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHR0YXJnZXRCb2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFyZ2V0VGFiLmhhc2gucmVwbGFjZSgnIycsICcnKSk7XG5cblx0XHRpZiAoIXRhcmdldEJvZHkpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0aWYgKCF0YXJnZXRCb2R5LmNsYXNzTGlzdC5jb250YWlucyhDTEFTU19DT05UUk9MX0NPTlRFTlQpKSB7IC8vdGFiIGJhciBwb3BvdmVyXG5cdFx0XHR0YXJnZXRUYWIuY2xhc3NMaXN0W2lzTGFzdEFjdGl2ZSA/ICdyZW1vdmUnIDogJ2FkZCddKGNsYXNzTmFtZSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdGlmIChpc0xhc3RBY3RpdmUpIHsgLy9zYW1lXG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdHZhciBwYXJlbnROb2RlID0gdGFyZ2V0Qm9keS5wYXJlbnROb2RlO1xuXHRcdGFjdGl2ZUJvZGllcyA9IHBhcmVudE5vZGUucXVlcnlTZWxlY3RvckFsbCgnLicgKyBDTEFTU19DT05UUk9MX0NPTlRFTlQgKyBjbGFzc1NlbGVjdG9yKTtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGFjdGl2ZUJvZGllcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIGFjdGl2ZUJvZHkgPSBhY3RpdmVCb2RpZXNbaV07XG5cdFx0XHRhY3RpdmVCb2R5LnBhcmVudE5vZGUgPT09IHBhcmVudE5vZGUgJiYgYWN0aXZlQm9keS5jbGFzc0xpc3QucmVtb3ZlKGNsYXNzTmFtZSk7XG5cdFx0fVxuXG5cdFx0dGFyZ2V0Qm9keS5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSk7XG5cblx0XHR2YXIgY29udGVudHMgPSBbXTtcblx0XHR2YXIgX2NvbnRlbnRzID0gcGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIENMQVNTX0NPTlRST0xfQ09OVEVOVCk7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBfY29udGVudHMubGVuZ3RoOyBpKyspIHsgLy/mn6Xmib7nm7TlsZ7lrZDoioLngrlcblx0XHRcdF9jb250ZW50c1tpXS5wYXJlbnROb2RlID09PSBwYXJlbnROb2RlICYmIChjb250ZW50cy5wdXNoKF9jb250ZW50c1tpXSkpO1xuXHRcdH1cblx0XHQkLnRyaWdnZXIodGFyZ2V0Qm9keSwgJC5ldmVudE5hbWUoJ3Nob3duJywgbmFtZSksIHtcblx0XHRcdHRhYk51bWJlcjogQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChjb250ZW50cywgdGFyZ2V0Qm9keSlcblx0XHR9KTtcblx0XHRlLmRldGFpbCAmJiBlLmRldGFpbC5nZXN0dXJlLnByZXZlbnREZWZhdWx0KCk7IC8vZml4ZWQgaGFzaGNoYW5nZVxuXHR9KTtcblxufSkobXVpLCB3aW5kb3csIGRvY3VtZW50LCAndGFiJyk7XG4vKipcbiAqIFRvZ2dsZXMgc3dpdGNoXG4gKiBAcGFyYW0ge3R5cGV9ICRcbiAqIEBwYXJhbSB7dHlwZX0gd2luZG93XG4gKiBAcGFyYW0ge3R5cGV9IG5hbWVcbiAqIEByZXR1cm5zIHt1bmRlZmluZWR9XG4gKi9cbihmdW5jdGlvbigkLCB3aW5kb3csIG5hbWUpIHtcblxuXHR2YXIgQ0xBU1NfU1dJVENIID0gJ211aS1zd2l0Y2gnO1xuXHR2YXIgQ0xBU1NfU1dJVENIX0hBTkRMRSA9ICdtdWktc3dpdGNoLWhhbmRsZSc7XG5cdHZhciBDTEFTU19BQ1RJVkUgPSAnbXVpLWFjdGl2ZSc7XG5cdHZhciBDTEFTU19EUkFHR0lORyA9ICdtdWktZHJhZ2dpbmcnO1xuXG5cdHZhciBDTEFTU19ESVNBQkxFRCA9ICdtdWktZGlzYWJsZWQnO1xuXG5cdHZhciBTRUxFQ1RPUl9TV0lUQ0hfSEFORExFID0gJy4nICsgQ0xBU1NfU1dJVENIX0hBTkRMRTtcblxuXHR2YXIgaGFuZGxlID0gZnVuY3Rpb24oZXZlbnQsIHRhcmdldCkge1xuXHRcdGlmICh0YXJnZXQuY2xhc3NMaXN0ICYmIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfU1dJVENIKSkge1xuXHRcdFx0cmV0dXJuIHRhcmdldDtcblx0XHR9XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9O1xuXG5cdCQucmVnaXN0ZXJUYXJnZXQoe1xuXHRcdG5hbWU6IG5hbWUsXG5cdFx0aW5kZXg6IDEwMCxcblx0XHRoYW5kbGU6IGhhbmRsZSxcblx0XHR0YXJnZXQ6IGZhbHNlXG5cdH0pO1xuXG5cblx0dmFyIFRvZ2dsZSA9IGZ1bmN0aW9uKGVsZW1lbnQpIHtcblx0XHR0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuXHRcdHRoaXMuY2xhc3NMaXN0ID0gdGhpcy5lbGVtZW50LmNsYXNzTGlzdDtcblx0XHR0aGlzLmhhbmRsZSA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SX1NXSVRDSF9IQU5ETEUpO1xuXHRcdHRoaXMuaW5pdCgpO1xuXHRcdHRoaXMuaW5pdEV2ZW50KCk7XG5cdH07XG5cdFRvZ2dsZS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMudG9nZ2xlV2lkdGggPSB0aGlzLmVsZW1lbnQub2Zmc2V0V2lkdGg7XG5cdFx0dGhpcy5oYW5kbGVXaWR0aCA9IHRoaXMuaGFuZGxlLm9mZnNldFdpZHRoO1xuXHRcdHRoaXMuaGFuZGxlWCA9IHRoaXMudG9nZ2xlV2lkdGggLSB0aGlzLmhhbmRsZVdpZHRoIC0gMztcblx0fTtcblx0VG9nZ2xlLnByb3RvdHlwZS5pbml0RXZlbnQgPSBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigkLkVWRU5UX1NUQVJULCB0aGlzKTtcblx0XHR0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZycsIHRoaXMpO1xuXHRcdHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzd2lwZXJpZ2h0JywgdGhpcyk7XG5cdFx0dGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJC5FVkVOVF9FTkQsIHRoaXMpO1xuXHRcdHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCQuRVZFTlRfQ0FOQ0VMLCB0aGlzKTtcblxuXHR9O1xuXHRUb2dnbGUucHJvdG90eXBlLmhhbmRsZUV2ZW50ID0gZnVuY3Rpb24oZSkge1xuXHRcdGlmICh0aGlzLmNsYXNzTGlzdC5jb250YWlucyhDTEFTU19ESVNBQkxFRCkpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0c3dpdGNoIChlLnR5cGUpIHtcblx0XHRcdGNhc2UgJC5FVkVOVF9TVEFSVDpcblx0XHRcdFx0dGhpcy5zdGFydChlKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlICdkcmFnJzpcblx0XHRcdFx0dGhpcy5kcmFnKGUpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgJ3N3aXBlcmlnaHQnOlxuXHRcdFx0XHR0aGlzLnN3aXBlcmlnaHQoKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlICQuRVZFTlRfRU5EOlxuXHRcdFx0Y2FzZSAkLkVWRU5UX0NBTkNFTDpcblx0XHRcdFx0dGhpcy5lbmQoZSk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fTtcblx0VG9nZ2xlLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uKGUpIHtcblx0XHR0aGlzLmhhbmRsZS5zdHlsZS53ZWJraXRUcmFuc2l0aW9uRHVyYXRpb24gPSB0aGlzLmVsZW1lbnQuc3R5bGUud2Via2l0VHJhbnNpdGlvbkR1cmF0aW9uID0gJy4ycyc7XG5cdFx0dGhpcy5jbGFzc0xpc3QuYWRkKENMQVNTX0RSQUdHSU5HKTtcblx0XHRpZiAodGhpcy50b2dnbGVXaWR0aCA9PT0gMCB8fCB0aGlzLmhhbmRsZVdpZHRoID09PSAwKSB7IC8v5b2Tc3dpdGNo5aSE5LqO6ZqQ6JeP54q25oCB5pe277yMd2lkdGjkuLow77yM6ZyA6KaB6YeN5paw5Yid5aeL5YyWXG5cdFx0XHR0aGlzLmluaXQoKTtcblx0XHR9XG5cdH07XG5cdFRvZ2dsZS5wcm90b3R5cGUuZHJhZyA9IGZ1bmN0aW9uKGUpIHtcblx0XHR2YXIgZGV0YWlsID0gZS5kZXRhaWw7XG5cdFx0aWYgKCF0aGlzLmlzRHJhZ2dpbmcpIHtcblx0XHRcdGlmIChkZXRhaWwuZGlyZWN0aW9uID09PSAnbGVmdCcgfHwgZGV0YWlsLmRpcmVjdGlvbiA9PT0gJ3JpZ2h0Jykge1xuXHRcdFx0XHR0aGlzLmlzRHJhZ2dpbmcgPSB0cnVlO1xuXHRcdFx0XHR0aGlzLmxhc3RDaGFuZ2VkID0gdW5kZWZpbmVkO1xuXHRcdFx0XHR0aGlzLmluaXRpYWxTdGF0ZSA9IHRoaXMuY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX0FDVElWRSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmICh0aGlzLmlzRHJhZ2dpbmcpIHtcblx0XHRcdHRoaXMuc2V0VHJhbnNsYXRlWChkZXRhaWwuZGVsdGFYKTtcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRkZXRhaWwuZ2VzdHVyZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdH1cblx0fTtcblx0VG9nZ2xlLnByb3RvdHlwZS5zd2lwZXJpZ2h0ID0gZnVuY3Rpb24oZSkge1xuXHRcdGlmICh0aGlzLmlzRHJhZ2dpbmcpIHtcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0fVxuXHR9O1xuXHRUb2dnbGUucHJvdG90eXBlLmVuZCA9IGZ1bmN0aW9uKGUpIHtcblx0XHR0aGlzLmNsYXNzTGlzdC5yZW1vdmUoQ0xBU1NfRFJBR0dJTkcpO1xuXHRcdGlmICh0aGlzLmlzRHJhZ2dpbmcpIHtcblx0XHRcdHRoaXMuaXNEcmFnZ2luZyA9IGZhbHNlO1xuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdCQudHJpZ2dlcih0aGlzLmVsZW1lbnQsICd0b2dnbGUnLCB7XG5cdFx0XHRcdGlzQWN0aXZlOiB0aGlzLmNsYXNzTGlzdC5jb250YWlucyhDTEFTU19BQ1RJVkUpXG5cdFx0XHR9KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy50b2dnbGUoKTtcblx0XHR9XG5cdH07XG5cdFRvZ2dsZS5wcm90b3R5cGUudG9nZ2xlID0gZnVuY3Rpb24oYW5pbWF0ZSkge1xuXHRcdHZhciBjbGFzc0xpc3QgPSB0aGlzLmNsYXNzTGlzdDtcblx0XHRpZiAoYW5pbWF0ZSA9PT0gZmFsc2UpIHtcblx0XHRcdHRoaXMuaGFuZGxlLnN0eWxlLndlYmtpdFRyYW5zaXRpb25EdXJhdGlvbiA9IHRoaXMuZWxlbWVudC5zdHlsZS53ZWJraXRUcmFuc2l0aW9uRHVyYXRpb24gPSAnMHMnO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmhhbmRsZS5zdHlsZS53ZWJraXRUcmFuc2l0aW9uRHVyYXRpb24gPSB0aGlzLmVsZW1lbnQuc3R5bGUud2Via2l0VHJhbnNpdGlvbkR1cmF0aW9uID0gJy4ycyc7XG5cdFx0fVxuXHRcdGlmIChjbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfQUNUSVZFKSkge1xuXHRcdFx0Y2xhc3NMaXN0LnJlbW92ZShDTEFTU19BQ1RJVkUpO1xuXHRcdFx0dGhpcy5oYW5kbGUuc3R5bGUud2Via2l0VHJhbnNmb3JtID0gJ3RyYW5zbGF0ZSgwLDApJztcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y2xhc3NMaXN0LmFkZChDTEFTU19BQ1RJVkUpO1xuXHRcdFx0dGhpcy5oYW5kbGUuc3R5bGUud2Via2l0VHJhbnNmb3JtID0gJ3RyYW5zbGF0ZSgnICsgdGhpcy5oYW5kbGVYICsgJ3B4LDApJztcblx0XHR9XG5cdFx0JC50cmlnZ2VyKHRoaXMuZWxlbWVudCwgJ3RvZ2dsZScsIHtcblx0XHRcdGlzQWN0aXZlOiB0aGlzLmNsYXNzTGlzdC5jb250YWlucyhDTEFTU19BQ1RJVkUpXG5cdFx0fSk7XG5cdH07XG5cdFRvZ2dsZS5wcm90b3R5cGUuc2V0VHJhbnNsYXRlWCA9ICQuYW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oeCkge1xuXHRcdGlmICghdGhpcy5pc0RyYWdnaW5nKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdHZhciBpc0NoYW5nZWQgPSBmYWxzZTtcblx0XHRpZiAoKHRoaXMuaW5pdGlhbFN0YXRlICYmIC14ID4gKHRoaXMuaGFuZGxlWCAvIDIpKSB8fCAoIXRoaXMuaW5pdGlhbFN0YXRlICYmIHggPiAodGhpcy5oYW5kbGVYIC8gMikpKSB7XG5cdFx0XHRpc0NoYW5nZWQgPSB0cnVlO1xuXHRcdH1cblx0XHRpZiAodGhpcy5sYXN0Q2hhbmdlZCAhPT0gaXNDaGFuZ2VkKSB7XG5cdFx0XHRpZiAoaXNDaGFuZ2VkKSB7XG5cdFx0XHRcdHRoaXMuaGFuZGxlLnN0eWxlLndlYmtpdFRyYW5zZm9ybSA9ICd0cmFuc2xhdGUoJyArICh0aGlzLmluaXRpYWxTdGF0ZSA/IDAgOiB0aGlzLmhhbmRsZVgpICsgJ3B4LDApJztcblx0XHRcdFx0dGhpcy5jbGFzc0xpc3RbdGhpcy5pbml0aWFsU3RhdGUgPyAncmVtb3ZlJyA6ICdhZGQnXShDTEFTU19BQ1RJVkUpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5oYW5kbGUuc3R5bGUud2Via2l0VHJhbnNmb3JtID0gJ3RyYW5zbGF0ZSgnICsgKHRoaXMuaW5pdGlhbFN0YXRlID8gdGhpcy5oYW5kbGVYIDogMCkgKyAncHgsMCknO1xuXHRcdFx0XHR0aGlzLmNsYXNzTGlzdFt0aGlzLmluaXRpYWxTdGF0ZSA/ICdhZGQnIDogJ3JlbW92ZSddKENMQVNTX0FDVElWRSk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLmxhc3RDaGFuZ2VkID0gaXNDaGFuZ2VkO1xuXHRcdH1cblxuXHR9KTtcblxuXHQkLmZuWydzd2l0Y2gnXSA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHR2YXIgc3dpdGNoQXBpcyA9IFtdO1xuXHRcdHRoaXMuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdHZhciBzd2l0Y2hBcGkgPSBudWxsO1xuXHRcdFx0dmFyIGlkID0gdGhpcy5nZXRBdHRyaWJ1dGUoJ2RhdGEtc3dpdGNoJyk7XG5cdFx0XHRpZiAoIWlkKSB7XG5cdFx0XHRcdGlkID0gKyskLnV1aWQ7XG5cdFx0XHRcdCQuZGF0YVtpZF0gPSBuZXcgVG9nZ2xlKHRoaXMpO1xuXHRcdFx0XHR0aGlzLnNldEF0dHJpYnV0ZSgnZGF0YS1zd2l0Y2gnLCBpZCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRzd2l0Y2hBcGkgPSAkLmRhdGFbaWRdO1xuXHRcdFx0fVxuXHRcdFx0c3dpdGNoQXBpcy5wdXNoKHN3aXRjaEFwaSk7XG5cdFx0fSk7XG5cdFx0cmV0dXJuIHN3aXRjaEFwaXMubGVuZ3RoID4gMSA/IHN3aXRjaEFwaXMgOiBzd2l0Y2hBcGlzWzBdO1xuXHR9O1xuXHQkLnJlYWR5KGZ1bmN0aW9uKCkge1xuXHRcdCQoJy4nICsgQ0xBU1NfU1dJVENIKVsnc3dpdGNoJ10oKTtcblx0fSk7XG59KShtdWksIHdpbmRvdywgJ3RvZ2dsZScpO1xuLyoqXG4gKiBUYWJsZXZpZXdzXG4gKiBAcGFyYW0ge3R5cGV9ICRcbiAqIEBwYXJhbSB7dHlwZX0gd2luZG93XG4gKiBAcGFyYW0ge3R5cGV9IGRvY3VtZW50XG4gKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxuICovXG4oZnVuY3Rpb24oJCwgd2luZG93LCBkb2N1bWVudCkge1xuXG5cdHZhciBDTEFTU19BQ1RJVkUgPSAnbXVpLWFjdGl2ZSc7XG5cdHZhciBDTEFTU19TRUxFQ1RFRCA9ICdtdWktc2VsZWN0ZWQnO1xuXHR2YXIgQ0xBU1NfR1JJRF9WSUVXID0gJ211aS1ncmlkLXZpZXcnO1xuXHR2YXIgQ0xBU1NfUkFESU9fVklFVyA9ICdtdWktdGFibGUtdmlldy1yYWRpbyc7XG5cdHZhciBDTEFTU19UQUJMRV9WSUVXX0NFTEwgPSAnbXVpLXRhYmxlLXZpZXctY2VsbCc7XG5cdHZhciBDTEFTU19DT0xMQVBTRV9DT05URU5UID0gJ211aS1jb2xsYXBzZS1jb250ZW50Jztcblx0dmFyIENMQVNTX0RJU0FCTEVEID0gJ211aS1kaXNhYmxlZCc7XG5cdHZhciBDTEFTU19UT0dHTEUgPSAnbXVpLXN3aXRjaCc7XG5cdHZhciBDTEFTU19CVE4gPSAnbXVpLWJ0bic7XG5cblx0dmFyIENMQVNTX1NMSURFUl9IQU5ETEUgPSAnbXVpLXNsaWRlci1oYW5kbGUnO1xuXHR2YXIgQ0xBU1NfU0xJREVSX0xFRlQgPSAnbXVpLXNsaWRlci1sZWZ0Jztcblx0dmFyIENMQVNTX1NMSURFUl9SSUdIVCA9ICdtdWktc2xpZGVyLXJpZ2h0Jztcblx0dmFyIENMQVNTX1RSQU5TSVRJT05JTkcgPSAnbXVpLXRyYW5zaXRpb25pbmcnO1xuXG5cblx0dmFyIFNFTEVDVE9SX1NMSURFUl9IQU5ETEUgPSAnLicgKyBDTEFTU19TTElERVJfSEFORExFO1xuXHR2YXIgU0VMRUNUT1JfU0xJREVSX0xFRlQgPSAnLicgKyBDTEFTU19TTElERVJfTEVGVDtcblx0dmFyIFNFTEVDVE9SX1NMSURFUl9SSUdIVCA9ICcuJyArIENMQVNTX1NMSURFUl9SSUdIVDtcblx0dmFyIFNFTEVDVE9SX1NFTEVDVEVEID0gJy4nICsgQ0xBU1NfU0VMRUNURUQ7XG5cdHZhciBTRUxFQ1RPUl9CVVRUT04gPSAnLicgKyBDTEFTU19CVE47XG5cdHZhciBvdmVyRmFjdG9yID0gMC44O1xuXHR2YXIgY2VsbCwgYTtcblxuXHR2YXIgaXNNb3ZlZCA9IGlzT3BlbmVkID0gb3BlbmVkQWN0aW9ucyA9IHByb2dyZXNzID0gZmFsc2U7XG5cdHZhciBzbGlkZXJIYW5kbGUgPSBzbGlkZXJBY3Rpb25MZWZ0ID0gc2xpZGVyQWN0aW9uUmlnaHQgPSBidXR0b25zTGVmdCA9IGJ1dHRvbnNSaWdodCA9IHNsaWRlckRpcmVjdGlvbiA9IHNsaWRlclJlcXVlc3RBbmltYXRpb25GcmFtZSA9IGZhbHNlO1xuXHR2YXIgdGltZXIgPSB0cmFuc2xhdGVYID0gbGFzdFRyYW5zbGF0ZVggPSBzbGlkZXJBY3Rpb25MZWZ0V2lkdGggPSBzbGlkZXJBY3Rpb25SaWdodFdpZHRoID0gMDtcblxuXG5cblx0dmFyIHRvZ2dsZUFjdGl2ZSA9IGZ1bmN0aW9uKGlzQWN0aXZlKSB7XG5cdFx0aWYgKGlzQWN0aXZlKSB7XG5cdFx0XHRpZiAoYSkge1xuXHRcdFx0XHRhLmNsYXNzTGlzdC5hZGQoQ0xBU1NfQUNUSVZFKTtcblx0XHRcdH0gZWxzZSBpZiAoY2VsbCkge1xuXHRcdFx0XHRjZWxsLmNsYXNzTGlzdC5hZGQoQ0xBU1NfQUNUSVZFKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0dGltZXIgJiYgdGltZXIuY2FuY2VsKCk7XG5cdFx0XHRpZiAoYSkge1xuXHRcdFx0XHRhLmNsYXNzTGlzdC5yZW1vdmUoQ0xBU1NfQUNUSVZFKTtcblx0XHRcdH0gZWxzZSBpZiAoY2VsbCkge1xuXHRcdFx0XHRjZWxsLmNsYXNzTGlzdC5yZW1vdmUoQ0xBU1NfQUNUSVZFKTtcblx0XHRcdH1cblx0XHR9XG5cdH07XG5cblx0dmFyIHVwZGF0ZVRyYW5zbGF0ZSA9IGZ1bmN0aW9uKCkge1xuXHRcdGlmICh0cmFuc2xhdGVYICE9PSBsYXN0VHJhbnNsYXRlWCkge1xuXHRcdFx0aWYgKGJ1dHRvbnNSaWdodCAmJiBidXR0b25zUmlnaHQubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRwcm9ncmVzcyA9IHRyYW5zbGF0ZVggLyBzbGlkZXJBY3Rpb25SaWdodFdpZHRoO1xuXHRcdFx0XHRpZiAodHJhbnNsYXRlWCA8IC1zbGlkZXJBY3Rpb25SaWdodFdpZHRoKSB7XG5cdFx0XHRcdFx0dHJhbnNsYXRlWCA9IC1zbGlkZXJBY3Rpb25SaWdodFdpZHRoIC0gTWF0aC5wb3coLXRyYW5zbGF0ZVggLSBzbGlkZXJBY3Rpb25SaWdodFdpZHRoLCBvdmVyRmFjdG9yKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRmb3IgKHZhciBpID0gMCwgbGVuID0gYnV0dG9uc1JpZ2h0Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdFx0XHRcdFx0dmFyIGJ1dHRvblJpZ2h0ID0gYnV0dG9uc1JpZ2h0W2ldO1xuXHRcdFx0XHRcdGlmICh0eXBlb2YgYnV0dG9uUmlnaHQuX2J1dHRvbk9mZnNldCA9PT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdFx0XHRcdGJ1dHRvblJpZ2h0Ll9idXR0b25PZmZzZXQgPSBidXR0b25SaWdodC5vZmZzZXRMZWZ0O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRidXR0b25PZmZzZXQgPSBidXR0b25SaWdodC5fYnV0dG9uT2Zmc2V0O1xuXHRcdFx0XHRcdHNldFRyYW5zbGF0ZShidXR0b25SaWdodCwgKHRyYW5zbGF0ZVggLSBidXR0b25PZmZzZXQgKiAoMSArIE1hdGgubWF4KHByb2dyZXNzLCAtMSkpKSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGlmIChidXR0b25zTGVmdCAmJiBidXR0b25zTGVmdC5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdHByb2dyZXNzID0gdHJhbnNsYXRlWCAvIHNsaWRlckFjdGlvbkxlZnRXaWR0aDtcblx0XHRcdFx0aWYgKHRyYW5zbGF0ZVggPiBzbGlkZXJBY3Rpb25MZWZ0V2lkdGgpIHtcblx0XHRcdFx0XHR0cmFuc2xhdGVYID0gc2xpZGVyQWN0aW9uTGVmdFdpZHRoICsgTWF0aC5wb3codHJhbnNsYXRlWCAtIHNsaWRlckFjdGlvbkxlZnRXaWR0aCwgb3ZlckZhY3Rvcik7XG5cdFx0XHRcdH1cblx0XHRcdFx0Zm9yICh2YXIgaSA9IDAsIGxlbiA9IGJ1dHRvbnNMZWZ0Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdFx0XHRcdFx0dmFyIGJ1dHRvbkxlZnQgPSBidXR0b25zTGVmdFtpXTtcblx0XHRcdFx0XHRpZiAodHlwZW9mIGJ1dHRvbkxlZnQuX2J1dHRvbk9mZnNldCA9PT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdFx0XHRcdGJ1dHRvbkxlZnQuX2J1dHRvbk9mZnNldCA9IHNsaWRlckFjdGlvbkxlZnRXaWR0aCAtIGJ1dHRvbkxlZnQub2Zmc2V0TGVmdCAtIGJ1dHRvbkxlZnQub2Zmc2V0V2lkdGg7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGJ1dHRvbk9mZnNldCA9IGJ1dHRvbkxlZnQuX2J1dHRvbk9mZnNldDtcblx0XHRcdFx0XHRpZiAoYnV0dG9uc0xlZnQubGVuZ3RoID4gMSkge1xuXHRcdFx0XHRcdFx0YnV0dG9uTGVmdC5zdHlsZS56SW5kZXggPSBidXR0b25zTGVmdC5sZW5ndGggLSBpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRzZXRUcmFuc2xhdGUoYnV0dG9uTGVmdCwgKHRyYW5zbGF0ZVggKyBidXR0b25PZmZzZXQgKiAoMSAtIE1hdGgubWluKHByb2dyZXNzLCAxKSkpKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0c2V0VHJhbnNsYXRlKHNsaWRlckhhbmRsZSwgdHJhbnNsYXRlWCk7XG5cdFx0XHRsYXN0VHJhbnNsYXRlWCA9IHRyYW5zbGF0ZVg7XG5cdFx0fVxuXHRcdHNsaWRlclJlcXVlc3RBbmltYXRpb25GcmFtZSA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpIHtcblx0XHRcdHVwZGF0ZVRyYW5zbGF0ZSgpO1xuXHRcdH0pO1xuXHR9O1xuXHR2YXIgc2V0VHJhbnNsYXRlID0gZnVuY3Rpb24oZWxlbWVudCwgeCkge1xuXHRcdGlmIChlbGVtZW50KSB7XG5cdFx0XHRlbGVtZW50LnN0eWxlLndlYmtpdFRyYW5zZm9ybSA9ICd0cmFuc2xhdGUoJyArIHggKyAncHgsMCknO1xuXHRcdH1cblx0fTtcblxuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigkLkVWRU5UX1NUQVJULCBmdW5jdGlvbihldmVudCkge1xuXHRcdGlmIChjZWxsKSB7XG5cdFx0XHR0b2dnbGVBY3RpdmUoZmFsc2UpO1xuXHRcdH1cblx0XHRjZWxsID0gYSA9IGZhbHNlO1xuXHRcdGlzTW92ZWQgPSBpc09wZW5lZCA9IG9wZW5lZEFjdGlvbnMgPSBmYWxzZTtcblx0XHR2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuXHRcdHZhciBpc0Rpc2FibGVkID0gZmFsc2U7XG5cdFx0Zm9yICg7IHRhcmdldCAmJiB0YXJnZXQgIT09IGRvY3VtZW50OyB0YXJnZXQgPSB0YXJnZXQucGFyZW50Tm9kZSkge1xuXHRcdFx0aWYgKHRhcmdldC5jbGFzc0xpc3QpIHtcblx0XHRcdFx0dmFyIGNsYXNzTGlzdCA9IHRhcmdldC5jbGFzc0xpc3Q7XG5cdFx0XHRcdGlmICgodGFyZ2V0LnRhZ05hbWUgPT09ICdJTlBVVCcgJiYgdGFyZ2V0LnR5cGUgIT09ICdyYWRpbycgJiYgdGFyZ2V0LnR5cGUgIT09ICdjaGVja2JveCcpIHx8IHRhcmdldC50YWdOYW1lID09PSAnQlVUVE9OJyB8fCBjbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfVE9HR0xFKSB8fCBjbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfQlROKSB8fCBjbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfRElTQUJMRUQpKSB7XG5cdFx0XHRcdFx0aXNEaXNhYmxlZCA9IHRydWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKGNsYXNzTGlzdC5jb250YWlucyhDTEFTU19DT0xMQVBTRV9DT05URU5UKSkgeyAvL2NvbGxhcHNlIGNvbnRlbnRcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX1RBQkxFX1ZJRVdfQ0VMTCkpIHtcblx0XHRcdFx0XHRjZWxsID0gdGFyZ2V0O1xuXHRcdFx0XHRcdC8vVE9ETyBzd2lwZSB0byBkZWxldGUgY2xvc2Vcblx0XHRcdFx0XHR2YXIgc2VsZWN0ZWQgPSBjZWxsLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcihTRUxFQ1RPUl9TRUxFQ1RFRCk7XG5cdFx0XHRcdFx0aWYgKCFjZWxsLnBhcmVudE5vZGUuY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX1JBRElPX1ZJRVcpICYmIHNlbGVjdGVkICYmIHNlbGVjdGVkICE9PSBjZWxsKSB7XG5cdFx0XHRcdFx0XHQkLnN3aXBlb3V0Q2xvc2Uoc2VsZWN0ZWQpO1xuXHRcdFx0XHRcdFx0Y2VsbCA9IGlzRGlzYWJsZWQgPSBmYWxzZTtcblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKCFjZWxsLnBhcmVudE5vZGUuY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX0dSSURfVklFVykpIHtcblx0XHRcdFx0XHRcdHZhciBsaW5rID0gY2VsbC5xdWVyeVNlbGVjdG9yKCdhJyk7XG5cdFx0XHRcdFx0XHRpZiAobGluayAmJiBsaW5rLnBhcmVudE5vZGUgPT09IGNlbGwpIHsgLy9saT5hXG5cdFx0XHRcdFx0XHRcdGEgPSBsaW5rO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR2YXIgaGFuZGxlID0gY2VsbC5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SX1NMSURFUl9IQU5ETEUpO1xuXHRcdFx0XHRcdGlmIChoYW5kbGUpIHtcblx0XHRcdFx0XHRcdHRvZ2dsZUV2ZW50cyhjZWxsKTtcblx0XHRcdFx0XHRcdGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAoIWlzRGlzYWJsZWQpIHtcblx0XHRcdFx0XHRcdGlmIChoYW5kbGUpIHtcblx0XHRcdFx0XHRcdFx0aWYgKHRpbWVyKSB7XG5cdFx0XHRcdFx0XHRcdFx0dGltZXIuY2FuY2VsKCk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0dGltZXIgPSAkLmxhdGVyKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdHRvZ2dsZUFjdGl2ZSh0cnVlKTtcblx0XHRcdFx0XHRcdFx0fSwgMTAwKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHRvZ2dsZUFjdGl2ZSh0cnVlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigkLkVWRU5UX01PVkUsIGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0dG9nZ2xlQWN0aXZlKGZhbHNlKTtcblx0fSk7XG5cblx0dmFyIGhhbmRsZUV2ZW50ID0ge1xuXHRcdGhhbmRsZUV2ZW50OiBmdW5jdGlvbihldmVudCkge1xuXHRcdFx0c3dpdGNoIChldmVudC50eXBlKSB7XG5cdFx0XHRcdGNhc2UgJ2RyYWcnOlxuXHRcdFx0XHRcdHRoaXMuZHJhZyhldmVudCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ2RyYWdlbmQnOlxuXHRcdFx0XHRcdHRoaXMuZHJhZ2VuZChldmVudCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ2ZsaWNrJzpcblx0XHRcdFx0XHR0aGlzLmZsaWNrKGV2ZW50KTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnc3dpcGVyaWdodCc6XG5cdFx0XHRcdFx0dGhpcy5zd2lwZXJpZ2h0KGV2ZW50KTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnc3dpcGVsZWZ0Jzpcblx0XHRcdFx0XHR0aGlzLnN3aXBlbGVmdChldmVudCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRkcmFnOiBmdW5jdGlvbihldmVudCkge1xuXHRcdFx0aWYgKCFjZWxsKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdGlmICghaXNNb3ZlZCkgeyAvL2luaXRcblx0XHRcdFx0c2xpZGVySGFuZGxlID0gc2xpZGVyQWN0aW9uTGVmdCA9IHNsaWRlckFjdGlvblJpZ2h0ID0gYnV0dG9uc0xlZnQgPSBidXR0b25zUmlnaHQgPSBzbGlkZXJEaXJlY3Rpb24gPSBzbGlkZXJSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSBmYWxzZTtcblx0XHRcdFx0c2xpZGVySGFuZGxlID0gY2VsbC5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SX1NMSURFUl9IQU5ETEUpO1xuXHRcdFx0XHRpZiAoc2xpZGVySGFuZGxlKSB7XG5cdFx0XHRcdFx0c2xpZGVyQWN0aW9uTGVmdCA9IGNlbGwucXVlcnlTZWxlY3RvcihTRUxFQ1RPUl9TTElERVJfTEVGVCk7XG5cdFx0XHRcdFx0c2xpZGVyQWN0aW9uUmlnaHQgPSBjZWxsLnF1ZXJ5U2VsZWN0b3IoU0VMRUNUT1JfU0xJREVSX1JJR0hUKTtcblx0XHRcdFx0XHRpZiAoc2xpZGVyQWN0aW9uTGVmdCkge1xuXHRcdFx0XHRcdFx0c2xpZGVyQWN0aW9uTGVmdFdpZHRoID0gc2xpZGVyQWN0aW9uTGVmdC5vZmZzZXRXaWR0aDtcblx0XHRcdFx0XHRcdGJ1dHRvbnNMZWZ0ID0gc2xpZGVyQWN0aW9uTGVmdC5xdWVyeVNlbGVjdG9yQWxsKFNFTEVDVE9SX0JVVFRPTik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmIChzbGlkZXJBY3Rpb25SaWdodCkge1xuXHRcdFx0XHRcdFx0c2xpZGVyQWN0aW9uUmlnaHRXaWR0aCA9IHNsaWRlckFjdGlvblJpZ2h0Lm9mZnNldFdpZHRoO1xuXHRcdFx0XHRcdFx0YnV0dG9uc1JpZ2h0ID0gc2xpZGVyQWN0aW9uUmlnaHQucXVlcnlTZWxlY3RvckFsbChTRUxFQ1RPUl9CVVRUT04pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRjZWxsLmNsYXNzTGlzdC5yZW1vdmUoQ0xBU1NfVFJBTlNJVElPTklORyk7XG5cdFx0XHRcdFx0aXNPcGVuZWQgPSBjZWxsLmNsYXNzTGlzdC5jb250YWlucyhDTEFTU19TRUxFQ1RFRCk7XG5cdFx0XHRcdFx0aWYgKGlzT3BlbmVkKSB7XG5cdFx0XHRcdFx0XHRvcGVuZWRBY3Rpb25zID0gY2VsbC5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SX1NMSURFUl9MRUZUICsgU0VMRUNUT1JfU0VMRUNURUQpID8gJ2xlZnQnIDogJ3JpZ2h0Jztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHZhciBkZXRhaWwgPSBldmVudC5kZXRhaWw7XG5cdFx0XHR2YXIgZGlyZWN0aW9uID0gZGV0YWlsLmRpcmVjdGlvbjtcblx0XHRcdHZhciBhbmdsZSA9IGRldGFpbC5hbmdsZTtcblx0XHRcdGlmIChkaXJlY3Rpb24gPT09ICdsZWZ0JyAmJiAoYW5nbGUgPiAxNTAgfHwgYW5nbGUgPCAtMTUwKSkge1xuXHRcdFx0XHRpZiAoYnV0dG9uc1JpZ2h0IHx8IChidXR0b25zTGVmdCAmJiBpc09wZW5lZCkpIHsgLy/lrZjlnKjlj7PkvqfmjInpkq7miJblrZjlnKjlt6bkvqfmjInpkq7kuJTmmK/lt7LmiZPlvIDnirbmgIFcblx0XHRcdFx0XHRpc01vdmVkID0gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIGlmIChkaXJlY3Rpb24gPT09ICdyaWdodCcgJiYgKGFuZ2xlID4gLTMwICYmIGFuZ2xlIDwgMzApKSB7XG5cdFx0XHRcdGlmIChidXR0b25zTGVmdCB8fCAoYnV0dG9uc1JpZ2h0ICYmIGlzT3BlbmVkKSkgeyAvL+WtmOWcqOW3puS+p+aMiemSruaIluWtmOWcqOWPs+S+p+aMiemSruS4lOaYr+W3suaJk+W8gOeKtuaAgVxuXHRcdFx0XHRcdGlzTW92ZWQgPSB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRpZiAoaXNNb3ZlZCkge1xuXHRcdFx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0ZXZlbnQuZGV0YWlsLmdlc3R1cmUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0dmFyIHRyYW5zbGF0ZSA9IGV2ZW50LmRldGFpbC5kZWx0YVg7XG5cdFx0XHRcdGlmIChpc09wZW5lZCkge1xuXHRcdFx0XHRcdGlmIChvcGVuZWRBY3Rpb25zID09PSAncmlnaHQnKSB7XG5cdFx0XHRcdFx0XHR0cmFuc2xhdGUgPSB0cmFuc2xhdGUgLSBzbGlkZXJBY3Rpb25SaWdodFdpZHRoO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR0cmFuc2xhdGUgPSB0cmFuc2xhdGUgKyBzbGlkZXJBY3Rpb25MZWZ0V2lkdGg7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICgodHJhbnNsYXRlID4gMCAmJiAhYnV0dG9uc0xlZnQpIHx8ICh0cmFuc2xhdGUgPCAwICYmICFidXR0b25zUmlnaHQpKSB7XG5cdFx0XHRcdFx0aWYgKCFpc09wZW5lZCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR0cmFuc2xhdGUgPSAwO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICh0cmFuc2xhdGUgPCAwKSB7XG5cdFx0XHRcdFx0c2xpZGVyRGlyZWN0aW9uID0gJ3RvTGVmdCc7XG5cdFx0XHRcdH0gZWxzZSBpZiAodHJhbnNsYXRlID4gMCkge1xuXHRcdFx0XHRcdHNsaWRlckRpcmVjdGlvbiA9ICd0b1JpZ2h0Jztcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRpZiAoIXNsaWRlckRpcmVjdGlvbikge1xuXHRcdFx0XHRcdFx0c2xpZGVyRGlyZWN0aW9uID0gJ3RvTGVmdCc7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICghc2xpZGVyUmVxdWVzdEFuaW1hdGlvbkZyYW1lKSB7XG5cdFx0XHRcdFx0dXBkYXRlVHJhbnNsYXRlKCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0dHJhbnNsYXRlWCA9IHRyYW5zbGF0ZTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdGZsaWNrOiBmdW5jdGlvbihldmVudCkge1xuXHRcdFx0aWYgKGlzTW92ZWQpIHtcblx0XHRcdFx0ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRzd2lwZWxlZnQ6IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRpZiAoaXNNb3ZlZCkge1xuXHRcdFx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdHN3aXBlcmlnaHQ6IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRpZiAoaXNNb3ZlZCkge1xuXHRcdFx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdGRyYWdlbmQ6IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRpZiAoIWlzTW92ZWQpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRpZiAoc2xpZGVyUmVxdWVzdEFuaW1hdGlvbkZyYW1lKSB7XG5cdFx0XHRcdGNhbmNlbEFuaW1hdGlvbkZyYW1lKHNsaWRlclJlcXVlc3RBbmltYXRpb25GcmFtZSk7XG5cdFx0XHRcdHNsaWRlclJlcXVlc3RBbmltYXRpb25GcmFtZSA9IG51bGw7XG5cdFx0XHR9XG5cdFx0XHR2YXIgZGV0YWlsID0gZXZlbnQuZGV0YWlsO1xuXHRcdFx0aXNNb3ZlZCA9IGZhbHNlO1xuXHRcdFx0dmFyIGFjdGlvbiA9ICdjbG9zZSc7XG5cdFx0XHR2YXIgYWN0aW9uc1dpZHRoID0gc2xpZGVyRGlyZWN0aW9uID09PSAndG9MZWZ0JyA/IHNsaWRlckFjdGlvblJpZ2h0V2lkdGggOiBzbGlkZXJBY3Rpb25MZWZ0V2lkdGg7XG5cdFx0XHR2YXIgaXNUb2dnbGUgPSBkZXRhaWwuc3dpcGUgfHwgKE1hdGguYWJzKHRyYW5zbGF0ZVgpID4gYWN0aW9uc1dpZHRoIC8gMik7XG5cdFx0XHRpZiAoaXNUb2dnbGUpIHtcblx0XHRcdFx0aWYgKCFpc09wZW5lZCkge1xuXHRcdFx0XHRcdGFjdGlvbiA9ICdvcGVuJztcblx0XHRcdFx0fSBlbHNlIGlmIChkZXRhaWwuZGlyZWN0aW9uID09PSAnbGVmdCcgJiYgb3BlbmVkQWN0aW9ucyA9PT0gJ3JpZ2h0Jykge1xuXHRcdFx0XHRcdGFjdGlvbiA9ICdvcGVuJztcblx0XHRcdFx0fSBlbHNlIGlmIChkZXRhaWwuZGlyZWN0aW9uID09PSAncmlnaHQnICYmIG9wZW5lZEFjdGlvbnMgPT09ICdsZWZ0Jykge1xuXHRcdFx0XHRcdGFjdGlvbiA9ICdvcGVuJztcblx0XHRcdFx0fVxuXG5cdFx0XHR9XG5cdFx0XHRjZWxsLmNsYXNzTGlzdC5hZGQoQ0xBU1NfVFJBTlNJVElPTklORyk7XG5cdFx0XHR2YXIgYnV0dG9ucztcblx0XHRcdGlmIChhY3Rpb24gPT09ICdvcGVuJykge1xuXHRcdFx0XHR2YXIgbmV3VHJhbnNsYXRlID0gc2xpZGVyRGlyZWN0aW9uID09PSAndG9MZWZ0JyA/IC1hY3Rpb25zV2lkdGggOiBhY3Rpb25zV2lkdGg7XG5cdFx0XHRcdHNldFRyYW5zbGF0ZShzbGlkZXJIYW5kbGUsIG5ld1RyYW5zbGF0ZSk7XG5cdFx0XHRcdGJ1dHRvbnMgPSBzbGlkZXJEaXJlY3Rpb24gPT09ICd0b0xlZnQnID8gYnV0dG9uc1JpZ2h0IDogYnV0dG9uc0xlZnQ7XG5cdFx0XHRcdGlmICh0eXBlb2YgYnV0dG9ucyAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdFx0XHR2YXIgYnV0dG9uID0gbnVsbDtcblx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGJ1dHRvbnMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdGJ1dHRvbiA9IGJ1dHRvbnNbaV07XG5cdFx0XHRcdFx0XHRzZXRUcmFuc2xhdGUoYnV0dG9uLCBuZXdUcmFuc2xhdGUpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRidXR0b24ucGFyZW50Tm9kZS5jbGFzc0xpc3QuYWRkKENMQVNTX1NFTEVDVEVEKTtcblx0XHRcdFx0XHRjZWxsLmNsYXNzTGlzdC5hZGQoQ0xBU1NfU0VMRUNURUQpO1xuXHRcdFx0XHRcdGlmICghaXNPcGVuZWQpIHtcblx0XHRcdFx0XHRcdCQudHJpZ2dlcihjZWxsLCBzbGlkZXJEaXJlY3Rpb24gPT09ICd0b0xlZnQnID8gJ3NsaWRlbGVmdCcgOiAnc2xpZGVyaWdodCcpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0c2V0VHJhbnNsYXRlKHNsaWRlckhhbmRsZSwgMCk7XG5cdFx0XHRcdHNsaWRlckFjdGlvbkxlZnQgJiYgc2xpZGVyQWN0aW9uTGVmdC5jbGFzc0xpc3QucmVtb3ZlKENMQVNTX1NFTEVDVEVEKTtcblx0XHRcdFx0c2xpZGVyQWN0aW9uUmlnaHQgJiYgc2xpZGVyQWN0aW9uUmlnaHQuY2xhc3NMaXN0LnJlbW92ZShDTEFTU19TRUxFQ1RFRCk7XG5cdFx0XHRcdGNlbGwuY2xhc3NMaXN0LnJlbW92ZShDTEFTU19TRUxFQ1RFRCk7XG5cdFx0XHR9XG5cdFx0XHR2YXIgYnV0dG9uT2Zmc2V0O1xuXHRcdFx0aWYgKGJ1dHRvbnNMZWZ0ICYmIGJ1dHRvbnNMZWZ0Lmxlbmd0aCA+IDAgJiYgYnV0dG9uc0xlZnQgIT09IGJ1dHRvbnMpIHtcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDAsIGxlbiA9IGJ1dHRvbnNMZWZ0Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdFx0XHRcdFx0dmFyIGJ1dHRvbkxlZnQgPSBidXR0b25zTGVmdFtpXTtcblx0XHRcdFx0XHRidXR0b25PZmZzZXQgPSBidXR0b25MZWZ0Ll9idXR0b25PZmZzZXQ7XG5cdFx0XHRcdFx0aWYgKHR5cGVvZiBidXR0b25PZmZzZXQgPT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRcdFx0XHRidXR0b25MZWZ0Ll9idXR0b25PZmZzZXQgPSBzbGlkZXJBY3Rpb25MZWZ0V2lkdGggLSBidXR0b25MZWZ0Lm9mZnNldExlZnQgLSBidXR0b25MZWZ0Lm9mZnNldFdpZHRoO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRzZXRUcmFuc2xhdGUoYnV0dG9uTGVmdCwgYnV0dG9uT2Zmc2V0KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0aWYgKGJ1dHRvbnNSaWdodCAmJiBidXR0b25zUmlnaHQubGVuZ3RoID4gMCAmJiBidXR0b25zUmlnaHQgIT09IGJ1dHRvbnMpIHtcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDAsIGxlbiA9IGJ1dHRvbnNSaWdodC5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHRcdFx0XHRcdHZhciBidXR0b25SaWdodCA9IGJ1dHRvbnNSaWdodFtpXTtcblx0XHRcdFx0XHRidXR0b25PZmZzZXQgPSBidXR0b25SaWdodC5fYnV0dG9uT2Zmc2V0O1xuXHRcdFx0XHRcdGlmICh0eXBlb2YgYnV0dG9uT2Zmc2V0ID09PSAndW5kZWZpbmVkJykge1xuXHRcdFx0XHRcdFx0YnV0dG9uUmlnaHQuX2J1dHRvbk9mZnNldCA9IGJ1dHRvblJpZ2h0Lm9mZnNldExlZnQ7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHNldFRyYW5zbGF0ZShidXR0b25SaWdodCwgLWJ1dHRvbk9mZnNldCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH07XG5cblx0ZnVuY3Rpb24gdG9nZ2xlRXZlbnRzKGVsZW1lbnQsIGlzUmVtb3ZlKSB7XG5cdFx0dmFyIG1ldGhvZCA9ICEhaXNSZW1vdmUgPyAncmVtb3ZlRXZlbnRMaXN0ZW5lcicgOiAnYWRkRXZlbnRMaXN0ZW5lcic7XG5cdFx0ZWxlbWVudFttZXRob2RdKCdkcmFnJywgaGFuZGxlRXZlbnQpO1xuXHRcdGVsZW1lbnRbbWV0aG9kXSgnZHJhZ2VuZCcsIGhhbmRsZUV2ZW50KTtcblx0XHRlbGVtZW50W21ldGhvZF0oJ3N3aXBlcmlnaHQnLCBoYW5kbGVFdmVudCk7XG5cdFx0ZWxlbWVudFttZXRob2RdKCdzd2lwZWxlZnQnLCBoYW5kbGVFdmVudCk7XG5cdFx0ZWxlbWVudFttZXRob2RdKCdmbGljaycsIGhhbmRsZUV2ZW50KTtcblx0fTtcblx0LyoqXG5cdCAqIOaJk+W8gOa7keWKqOiPnOWNlVxuXHQgKiBAcGFyYW0ge09iamVjdH0gZWxcblx0ICogQHBhcmFtIHtPYmplY3R9IGRpcmVjdGlvblxuXHQgKi9cblx0JC5zd2lwZW91dE9wZW4gPSBmdW5jdGlvbihlbCwgZGlyZWN0aW9uKSB7XG5cdFx0aWYgKCFlbCkgcmV0dXJuO1xuXHRcdHZhciBjbGFzc0xpc3QgPSBlbC5jbGFzc0xpc3Q7XG5cdFx0aWYgKGNsYXNzTGlzdC5jb250YWlucyhDTEFTU19TRUxFQ1RFRCkpIHJldHVybjtcblx0XHRpZiAoIWRpcmVjdGlvbikge1xuXHRcdFx0aWYgKGVsLnF1ZXJ5U2VsZWN0b3IoU0VMRUNUT1JfU0xJREVSX1JJR0hUKSkge1xuXHRcdFx0XHRkaXJlY3Rpb24gPSAncmlnaHQnO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZGlyZWN0aW9uID0gJ2xlZnQnO1xuXHRcdFx0fVxuXHRcdH1cblx0XHR2YXIgc3dpcGVvdXRBY3Rpb24gPSBlbC5xdWVyeVNlbGVjdG9yKCQuY2xhc3NTZWxlY3RvcihcIi5zbGlkZXItXCIgKyBkaXJlY3Rpb24pKTtcblx0XHRpZiAoIXN3aXBlb3V0QWN0aW9uKSByZXR1cm47XG5cdFx0c3dpcGVvdXRBY3Rpb24uY2xhc3NMaXN0LmFkZChDTEFTU19TRUxFQ1RFRCk7XG5cdFx0Y2xhc3NMaXN0LmFkZChDTEFTU19TRUxFQ1RFRCk7XG5cdFx0Y2xhc3NMaXN0LnJlbW92ZShDTEFTU19UUkFOU0lUSU9OSU5HKTtcblx0XHR2YXIgYnV0dG9ucyA9IHN3aXBlb3V0QWN0aW9uLnF1ZXJ5U2VsZWN0b3JBbGwoU0VMRUNUT1JfQlVUVE9OKTtcblx0XHR2YXIgc3dpcGVvdXRXaWR0aCA9IHN3aXBlb3V0QWN0aW9uLm9mZnNldFdpZHRoO1xuXHRcdHZhciB0cmFuc2xhdGUgPSAoZGlyZWN0aW9uID09PSAncmlnaHQnKSA/IC1zd2lwZW91dFdpZHRoIDogc3dpcGVvdXRXaWR0aDtcblx0XHR2YXIgbGVuZ3RoID0gYnV0dG9ucy5sZW5ndGg7XG5cdFx0dmFyIGJ1dHRvbjtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG5cdFx0XHRidXR0b24gPSBidXR0b25zW2ldO1xuXHRcdFx0aWYgKGRpcmVjdGlvbiA9PT0gJ3JpZ2h0Jykge1xuXHRcdFx0XHRzZXRUcmFuc2xhdGUoYnV0dG9uLCAtYnV0dG9uLm9mZnNldExlZnQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0c2V0VHJhbnNsYXRlKGJ1dHRvbiwgKHN3aXBlb3V0V2lkdGggLSBidXR0b24ub2Zmc2V0V2lkdGggLSBidXR0b24ub2Zmc2V0TGVmdCkpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRjbGFzc0xpc3QuYWRkKENMQVNTX1RSQU5TSVRJT05JTkcpO1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcblx0XHRcdHNldFRyYW5zbGF0ZShidXR0b25zW2ldLCB0cmFuc2xhdGUpO1xuXHRcdH1cblx0XHRzZXRUcmFuc2xhdGUoZWwucXVlcnlTZWxlY3RvcihTRUxFQ1RPUl9TTElERVJfSEFORExFKSwgdHJhbnNsYXRlKTtcblx0fTtcblx0LyoqXG5cdCAqIOWFs+mXrea7keWKqOiPnOWNlVxuXHQgKiBAcGFyYW0ge09iamVjdH0gZWxcblx0ICovXG5cdCQuc3dpcGVvdXRDbG9zZSA9IGZ1bmN0aW9uKGVsKSB7XG5cdFx0aWYgKCFlbCkgcmV0dXJuO1xuXHRcdHZhciBjbGFzc0xpc3QgPSBlbC5jbGFzc0xpc3Q7XG5cdFx0aWYgKCFjbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfU0VMRUNURUQpKSByZXR1cm47XG5cdFx0dmFyIGRpcmVjdGlvbiA9IGVsLnF1ZXJ5U2VsZWN0b3IoU0VMRUNUT1JfU0xJREVSX1JJR0hUICsgU0VMRUNUT1JfU0VMRUNURUQpID8gJ3JpZ2h0JyA6ICdsZWZ0Jztcblx0XHR2YXIgc3dpcGVvdXRBY3Rpb24gPSBlbC5xdWVyeVNlbGVjdG9yKCQuY2xhc3NTZWxlY3RvcihcIi5zbGlkZXItXCIgKyBkaXJlY3Rpb24pKTtcblx0XHRpZiAoIXN3aXBlb3V0QWN0aW9uKSByZXR1cm47XG5cdFx0c3dpcGVvdXRBY3Rpb24uY2xhc3NMaXN0LnJlbW92ZShDTEFTU19TRUxFQ1RFRCk7XG5cdFx0Y2xhc3NMaXN0LnJlbW92ZShDTEFTU19TRUxFQ1RFRCk7XG5cdFx0Y2xhc3NMaXN0LmFkZChDTEFTU19UUkFOU0lUSU9OSU5HKTtcblx0XHR2YXIgYnV0dG9ucyA9IHN3aXBlb3V0QWN0aW9uLnF1ZXJ5U2VsZWN0b3JBbGwoU0VMRUNUT1JfQlVUVE9OKTtcblx0XHR2YXIgc3dpcGVvdXRXaWR0aCA9IHN3aXBlb3V0QWN0aW9uLm9mZnNldFdpZHRoO1xuXHRcdHZhciBsZW5ndGggPSBidXR0b25zLmxlbmd0aDtcblx0XHR2YXIgYnV0dG9uO1xuXHRcdHNldFRyYW5zbGF0ZShlbC5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SX1NMSURFUl9IQU5ETEUpLCAwKTtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG5cdFx0XHRidXR0b24gPSBidXR0b25zW2ldO1xuXHRcdFx0aWYgKGRpcmVjdGlvbiA9PT0gJ3JpZ2h0Jykge1xuXHRcdFx0XHRzZXRUcmFuc2xhdGUoYnV0dG9uLCAoLWJ1dHRvbi5vZmZzZXRMZWZ0KSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRzZXRUcmFuc2xhdGUoYnV0dG9uLCAoc3dpcGVvdXRXaWR0aCAtIGJ1dHRvbi5vZmZzZXRXaWR0aCAtIGJ1dHRvbi5vZmZzZXRMZWZ0KSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9O1xuXG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCQuRVZFTlRfRU5ELCBmdW5jdGlvbihldmVudCkgeyAvL+S9v+eUqHRvdWNoZW5k5p2l5Y+W5raI6auY5Lqu77yM6YG/5YWN5LiA5qyh54K55Ye75pei5LiN6Kem5Y+RdGFw77yMZG91YmxldGFw77yMbG9uZ3RhcOeahOS6i+S7tlxuXHRcdGlmICghY2VsbCkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHR0b2dnbGVBY3RpdmUoZmFsc2UpO1xuXHRcdHNsaWRlckhhbmRsZSAmJiB0b2dnbGVFdmVudHMoY2VsbCwgdHJ1ZSk7XG5cdH0pO1xuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigkLkVWRU5UX0NBTkNFTCwgZnVuY3Rpb24oZXZlbnQpIHsgLy/kvb/nlKh0b3VjaGNhbmNlbOadpeWPlua2iOmrmOS6ru+8jOmBv+WFjeS4gOasoeeCueWHu+aXouS4jeinpuWPkXRhcO+8jGRvdWJsZXRhcO+8jGxvbmd0YXDnmoTkuovku7Zcblx0XHRpZiAoIWNlbGwpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0dG9nZ2xlQWN0aXZlKGZhbHNlKTtcblx0XHRzbGlkZXJIYW5kbGUgJiYgdG9nZ2xlRXZlbnRzKGNlbGwsIHRydWUpO1xuXHR9KTtcblx0dmFyIHJhZGlvT3JDaGVja2JveENsaWNrID0gZnVuY3Rpb24oZXZlbnQpIHtcblx0XHR2YXIgdHlwZSA9IGV2ZW50LnRhcmdldCAmJiBldmVudC50YXJnZXQudHlwZSB8fCAnJztcblx0XHRpZiAodHlwZSA9PT0gJ3JhZGlvJyB8fCB0eXBlID09PSAnY2hlY2tib3gnKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdHZhciBjbGFzc0xpc3QgPSBjZWxsLmNsYXNzTGlzdDtcblx0XHRpZiAoY2xhc3NMaXN0LmNvbnRhaW5zKCdtdWktcmFkaW8nKSkge1xuXHRcdFx0dmFyIGlucHV0ID0gY2VsbC5xdWVyeVNlbGVjdG9yKCdpbnB1dFt0eXBlPXJhZGlvXScpO1xuXHRcdFx0aWYgKGlucHV0KSB7XG5cdFx0XHRcdC8vXHRcdFx0XHRpbnB1dC5jbGljaygpO1xuXHRcdFx0XHRpZiAoIWlucHV0LmRpc2FibGVkICYmICFpbnB1dC5yZWFkT25seSkge1xuXHRcdFx0XHRcdGlucHV0LmNoZWNrZWQgPSAhaW5wdXQuY2hlY2tlZDtcblx0XHRcdFx0XHQkLnRyaWdnZXIoaW5wdXQsICdjaGFuZ2UnKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAoY2xhc3NMaXN0LmNvbnRhaW5zKCdtdWktY2hlY2tib3gnKSkge1xuXHRcdFx0dmFyIGlucHV0ID0gY2VsbC5xdWVyeVNlbGVjdG9yKCdpbnB1dFt0eXBlPWNoZWNrYm94XScpO1xuXHRcdFx0aWYgKGlucHV0KSB7XG5cdFx0XHRcdC8vXHRcdFx0XHRpbnB1dC5jbGljaygpO1xuXHRcdFx0XHRpZiAoIWlucHV0LmRpc2FibGVkICYmICFpbnB1dC5yZWFkT25seSkge1xuXHRcdFx0XHRcdGlucHV0LmNoZWNrZWQgPSAhaW5wdXQuY2hlY2tlZDtcblx0XHRcdFx0XHQkLnRyaWdnZXIoaW5wdXQsICdjaGFuZ2UnKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fTtcblx0Ly9maXhlZCBoYXNoY2hhbmdlKGFuZHJvaWQpXG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCQuRVZFTlRfQ0xJQ0ssIGZ1bmN0aW9uKGUpIHtcblx0XHRpZiAoY2VsbCAmJiBjZWxsLmNsYXNzTGlzdC5jb250YWlucygnbXVpLWNvbGxhcHNlJykpIHtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHR9XG5cdH0pO1xuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignZG91YmxldGFwJywgZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRpZiAoY2VsbCkge1xuXHRcdFx0cmFkaW9PckNoZWNrYm94Q2xpY2soZXZlbnQpO1xuXHRcdH1cblx0fSk7XG5cdHZhciBwcmV2ZW50RGVmYXVsdEV4Y2VwdGlvbiA9IC9eKElOUFVUfFRFWFRBUkVBfEJVVFRPTnxTRUxFQ1QpJC87XG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd0YXAnLCBmdW5jdGlvbihldmVudCkge1xuXHRcdGlmICghY2VsbCkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHR2YXIgaXNFeHBhbmQgPSBmYWxzZTtcblx0XHR2YXIgY2xhc3NMaXN0ID0gY2VsbC5jbGFzc0xpc3Q7XG5cdFx0dmFyIHVsID0gY2VsbC5wYXJlbnROb2RlO1xuXHRcdGlmICh1bCAmJiB1bC5jbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfUkFESU9fVklFVykpIHtcblx0XHRcdGlmIChjbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfU0VMRUNURUQpKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdHZhciBzZWxlY3RlZCA9IHVsLnF1ZXJ5U2VsZWN0b3IoJ2xpJyArIFNFTEVDVE9SX1NFTEVDVEVEKTtcblx0XHRcdGlmIChzZWxlY3RlZCkge1xuXHRcdFx0XHRzZWxlY3RlZC5jbGFzc0xpc3QucmVtb3ZlKENMQVNTX1NFTEVDVEVEKTtcblx0XHRcdH1cblx0XHRcdGNsYXNzTGlzdC5hZGQoQ0xBU1NfU0VMRUNURUQpO1xuXHRcdFx0JC50cmlnZ2VyKGNlbGwsICdzZWxlY3RlZCcsIHtcblx0XHRcdFx0ZWw6IGNlbGxcblx0XHRcdH0pO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRpZiAoY2xhc3NMaXN0LmNvbnRhaW5zKCdtdWktY29sbGFwc2UnKSAmJiAhY2VsbC5wYXJlbnROb2RlLmNsYXNzTGlzdC5jb250YWlucygnbXVpLXVuZm9sZCcpKSB7XG5cdFx0XHRpZiAoIXByZXZlbnREZWZhdWx0RXhjZXB0aW9uLnRlc3QoZXZlbnQudGFyZ2V0LnRhZ05hbWUpKSB7XG5cdFx0XHRcdGV2ZW50LmRldGFpbC5nZXN0dXJlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR9XG5cblx0XHRcdGlmICghY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX0FDVElWRSkpIHsgLy/lsZXlvIDml7Ys6ZyA6KaB5pS257yp5YW25LuW5ZCM57G7XG5cdFx0XHRcdHZhciBjb2xsYXBzZSA9IGNlbGwucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCcubXVpLWNvbGxhcHNlLm11aS1hY3RpdmUnKTtcblx0XHRcdFx0aWYgKGNvbGxhcHNlKSB7XG5cdFx0XHRcdFx0Y29sbGFwc2UuY2xhc3NMaXN0LnJlbW92ZShDTEFTU19BQ1RJVkUpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlzRXhwYW5kID0gdHJ1ZTtcblx0XHRcdH1cblx0XHRcdGNsYXNzTGlzdC50b2dnbGUoQ0xBU1NfQUNUSVZFKTtcblx0XHRcdGlmIChpc0V4cGFuZCkge1xuXHRcdFx0XHQvL+inpuWPkeWxleW8gOS6i+S7tlxuXHRcdFx0XHQkLnRyaWdnZXIoY2VsbCwgJ2V4cGFuZCcpO1xuXG5cdFx0XHRcdC8vc2Nyb2xsXG5cdFx0XHRcdC8v5pqC5LiN5rua5YqoXG5cdFx0XHRcdC8vIHZhciBvZmZzZXRUb3AgPSAkLm9mZnNldChjZWxsKS50b3A7XG5cdFx0XHRcdC8vIHZhciBzY3JvbGxUb3AgPSBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcDtcblx0XHRcdFx0Ly8gdmFyIGhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcblx0XHRcdFx0Ly8gdmFyIG9mZnNldEhlaWdodCA9IGNlbGwub2Zmc2V0SGVpZ2h0O1xuXHRcdFx0XHQvLyB2YXIgY2VsbEhlaWdodCA9IChvZmZzZXRUb3AgLSBzY3JvbGxUb3AgKyBvZmZzZXRIZWlnaHQpO1xuXHRcdFx0XHQvLyBpZiAob2Zmc2V0SGVpZ2h0ID4gaGVpZ2h0KSB7XG5cdFx0XHRcdC8vIFx0JC5zY3JvbGxUbyhvZmZzZXRUb3AsIDMwMCk7XG5cdFx0XHRcdC8vIH0gZWxzZSBpZiAoY2VsbEhlaWdodCA+IGhlaWdodCkge1xuXHRcdFx0XHQvLyBcdCQuc2Nyb2xsVG8oY2VsbEhlaWdodCAtIGhlaWdodCArIHNjcm9sbFRvcCwgMzAwKTtcblx0XHRcdFx0Ly8gfVxuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRyYWRpb09yQ2hlY2tib3hDbGljayhldmVudCk7XG5cdFx0fVxuXHR9KTtcbn0pKG11aSwgd2luZG93LCBkb2N1bWVudCk7XG4oZnVuY3Rpb24oJCwgd2luZG93KSB7XG5cdC8qKlxuXHQgKiDorablkYrmtojmga/moYZcblx0ICovXG5cdCQuYWxlcnQgPSBmdW5jdGlvbihtZXNzYWdlLCB0aXRsZSwgYnRuVmFsdWUsIGNhbGxiYWNrKSB7XG5cdFx0aWYgKCQub3MucGx1cykge1xuXHRcdFx0aWYgKHR5cGVvZiBtZXNzYWdlID09PSAndW5kZWZpbmVkJykge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAodHlwZW9mIHRpdGxlID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHRcdFx0Y2FsbGJhY2sgPSB0aXRsZTtcblx0XHRcdFx0XHR0aXRsZSA9IG51bGw7XG5cdFx0XHRcdFx0YnRuVmFsdWUgPSAn56Gu5a6aJztcblx0XHRcdFx0fSBlbHNlIGlmICh0eXBlb2YgYnRuVmFsdWUgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdFx0XHRjYWxsYmFjayA9IGJ0blZhbHVlO1xuXHRcdFx0XHRcdGJ0blZhbHVlID0gbnVsbDtcblx0XHRcdFx0fVxuXHRcdFx0XHQkLnBsdXNSZWFkeShmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRwbHVzLm5hdGl2ZVVJLmFsZXJ0KG1lc3NhZ2UsIGNhbGxiYWNrLCB0aXRsZSwgYnRuVmFsdWUpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvL1RPRE8gSDXniYjmnKxcblx0XHRcdHdpbmRvdy5hbGVydChtZXNzYWdlKTtcblx0XHR9XG5cdH07XG5cbn0pKG11aSwgd2luZG93KTtcbihmdW5jdGlvbigkLCB3aW5kb3cpIHtcblx0LyoqXG5cdCAqIOehruiupOa2iOaBr+ahhlxuXHQgKi9cblx0JC5jb25maXJtID0gZnVuY3Rpb24obWVzc2FnZSwgdGl0bGUsIGJ0bkFycmF5LCBjYWxsYmFjaykge1xuXHRcdGlmICgkLm9zLnBsdXMpIHtcblx0XHRcdGlmICh0eXBlb2YgbWVzc2FnZSA9PT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYgKHR5cGVvZiB0aXRsZSA9PT0gJ2Z1bmN0aW9uJykge1xuXHRcdFx0XHRcdGNhbGxiYWNrID0gdGl0bGU7XG5cdFx0XHRcdFx0dGl0bGUgPSBudWxsO1xuXHRcdFx0XHRcdGJ0bkFycmF5ID0gbnVsbDtcblx0XHRcdFx0fSBlbHNlIGlmICh0eXBlb2YgYnRuQXJyYXkgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdFx0XHRjYWxsYmFjayA9IGJ0bkFycmF5O1xuXHRcdFx0XHRcdGJ0bkFycmF5ID0gbnVsbDtcblx0XHRcdFx0fVxuXHRcdFx0XHQkLnBsdXNSZWFkeShmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRwbHVzLm5hdGl2ZVVJLmNvbmZpcm0obWVzc2FnZSwgY2FsbGJhY2ssIHRpdGxlLCBidG5BcnJheSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vSDXniYjmnKzvvIww5Li656Gu6K6k77yMMeS4uuWPlua2iFxuXHRcdFx0aWYgKHdpbmRvdy5jb25maXJtKG1lc3NhZ2UpKSB7XG5cdFx0XHRcdGNhbGxiYWNrKHtcblx0XHRcdFx0XHRpbmRleDogMFxuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNhbGxiYWNrKHtcblx0XHRcdFx0XHRpbmRleDogMVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cdH07XG5cbn0pKG11aSwgd2luZG93KTtcbihmdW5jdGlvbigkLCB3aW5kb3cpIHtcblx0LyoqXG5cdCAqIOi+k+WFpeWvueivneahhlxuXHQgKi9cblx0JC5wcm9tcHQgPSBmdW5jdGlvbih0ZXh0LCBkZWZhdWx0VGV4dCwgdGl0bGUsIGJ0bkFycmF5LCBjYWxsYmFjaykge1xuXHRcdGlmICgkLm9zLnBsdXMpIHtcblx0XHRcdGlmICh0eXBlb2YgbWVzc2FnZSA9PT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRpZiAodHlwZW9mIGRlZmF1bHRUZXh0ID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHRcdFx0Y2FsbGJhY2sgPSBkZWZhdWx0VGV4dDtcblx0XHRcdFx0XHRkZWZhdWx0VGV4dCA9IG51bGw7XG5cdFx0XHRcdFx0dGl0bGUgPSBudWxsO1xuXHRcdFx0XHRcdGJ0bkFycmF5ID0gbnVsbDtcblx0XHRcdFx0fSBlbHNlIGlmICh0eXBlb2YgdGl0bGUgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdFx0XHRjYWxsYmFjayA9IHRpdGxlO1xuXHRcdFx0XHRcdHRpdGxlID0gbnVsbDtcblx0XHRcdFx0XHRidG5BcnJheSA9IG51bGw7XG5cdFx0XHRcdH0gZWxzZSBpZiAodHlwZW9mIGJ0bkFycmF5ID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHRcdFx0Y2FsbGJhY2sgPSBidG5BcnJheTtcblx0XHRcdFx0XHRidG5BcnJheSA9IG51bGw7XG5cdFx0XHRcdH1cblx0XHRcdFx0JC5wbHVzUmVhZHkoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0cGx1cy5uYXRpdmVVSS5wcm9tcHQodGV4dCwgY2FsbGJhY2ssIHRpdGxlLCBkZWZhdWx0VGV4dCwgYnRuQXJyYXkpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvL0g154mI5pysKOehruiupGluZGV45Li6MO+8jOWPlua2iGluZGV45Li6MSlcblx0XHRcdHZhciByZXN1bHQgPSB3aW5kb3cucHJvbXB0KHRleHQpO1xuXHRcdFx0aWYgKHJlc3VsdCkge1xuXHRcdFx0XHRjYWxsYmFjayh7XG5cdFx0XHRcdFx0aW5kZXg6IDAsXG5cdFx0XHRcdFx0dmFsdWU6IHJlc3VsdFxuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNhbGxiYWNrKHtcblx0XHRcdFx0XHRpbmRleDogMSxcblx0XHRcdFx0XHR2YWx1ZTogJydcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9O1xuXG59KShtdWksIHdpbmRvdyk7XG4oZnVuY3Rpb24oJCwgd2luZG93KSB7XG5cdHZhciBDTEFTU19BQ1RJVkUgPSAnbXVpLWFjdGl2ZSc7XG5cdC8qKlxuXHQgKiDoh6rliqjmtojlpLHmj5DnpLrmoYZcblx0ICovXG5cdCQudG9hc3QgPSBmdW5jdGlvbihtZXNzYWdlLG9wdGlvbnMpIHtcblx0XHR2YXIgZHVyYXRpb25zID0ge1xuXHRcdCAgICAnbG9uZyc6IDM1MDAsXG5cdFx0ICAgICdzaG9ydCc6IDIwMDBcblx0XHR9O1xuXG5cdFx0Ly/orqHnrpfmmL7npLrml7bpl7Rcblx0XHQgb3B0aW9ucyA9ICQuZXh0ZW5kKHtcblx0ICAgICAgICBkdXJhdGlvbjogJ3Nob3J0J1xuXHQgICAgfSwgb3B0aW9ucyB8fCB7fSk7XG5cblxuXHRcdGlmICgkLm9zLnBsdXMgJiYgb3B0aW9ucy50eXBlICE9PSAnZGl2Jykge1xuXHRcdFx0Ly/pu5jorqTmmL7npLrlnKjlupXpg6jvvJtcblx0XHRcdCQucGx1c1JlYWR5KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRwbHVzLm5hdGl2ZVVJLnRvYXN0KG1lc3NhZ2UsIHtcblx0XHRcdFx0XHR2ZXJ0aWNhbEFsaWduOiAnYm90dG9tJyxcblx0XHRcdFx0XHRkdXJhdGlvbjpvcHRpb25zLmR1cmF0aW9uXG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGlmICh0eXBlb2Ygb3B0aW9ucy5kdXJhdGlvbiA9PT0gJ251bWJlcicpIHtcblx0XHQgICAgICAgIGR1cmF0aW9uID0gb3B0aW9ucy5kdXJhdGlvbj4wID8gb3B0aW9ucy5kdXJhdGlvbjpkdXJhdGlvbnNbJ3Nob3J0J107XG5cdFx0ICAgIH0gZWxzZSB7XG5cdFx0ICAgICAgICBkdXJhdGlvbiA9IGR1cmF0aW9uc1tvcHRpb25zLmR1cmF0aW9uXTtcblx0XHQgICAgfVxuXHRcdCAgICBpZiAoIWR1cmF0aW9uKSB7XG5cdFx0ICAgICAgICBkdXJhdGlvbiA9IGR1cmF0aW9uc1snc2hvcnQnXTtcblx0XHQgICAgfVxuXHRcdFx0dmFyIHRvYXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0XHR0b2FzdC5jbGFzc0xpc3QuYWRkKCdtdWktdG9hc3QtY29udGFpbmVyJyk7XG5cdFx0XHR0b2FzdC5pbm5lckhUTUwgPSAnPGRpdiBjbGFzcz1cIicgKyAnbXVpLXRvYXN0LW1lc3NhZ2UnICsgJ1wiPicgKyBtZXNzYWdlICsgJzwvZGl2Pic7XG5cdFx0XHR0b2FzdC5hZGRFdmVudExpc3RlbmVyKCd3ZWJraXRUcmFuc2l0aW9uRW5kJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmICghdG9hc3QuY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX0FDVElWRSkpIHtcblx0XHRcdFx0XHR0b2FzdC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRvYXN0KTtcblx0XHRcdFx0XHR0b2FzdCA9IG51bGw7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0Ly/ngrnlh7vliJnoh6rliqjmtojlpLFcblx0XHRcdHRvYXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0ICAgICAgICB0b2FzdC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRvYXN0KTtcblx0XHQgICAgICAgIHRvYXN0ID0gbnVsbDtcblx0XHQgICAgfSk7XG5cdFx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRvYXN0KTtcblx0XHRcdHRvYXN0Lm9mZnNldEhlaWdodDtcblx0XHRcdHRvYXN0LmNsYXNzTGlzdC5hZGQoQ0xBU1NfQUNUSVZFKTtcblx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRvYXN0ICYmIHRvYXN0LmNsYXNzTGlzdC5yZW1vdmUoQ0xBU1NfQUNUSVZFKTtcblx0XHRcdH0sIGR1cmF0aW9uKTtcblxuXHRcdFx0cmV0dXJuIHtcblx0XHQgICAgICAgIGlzVmlzaWJsZTogZnVuY3Rpb24oKSB7cmV0dXJuICEhdG9hc3Q7fVxuXHRcdCAgICB9XG5cdFx0fVxuXHR9O1xuXG59KShtdWksIHdpbmRvdyk7XG4vKipcbiAqIFBvcHVwKGFsZXJ0LGNvbmZpcm0scHJvbXB0KVxuICogQHBhcmFtIHtPYmplY3R9ICRcbiAqIEBwYXJhbSB7T2JqZWN0fSB3aW5kb3dcbiAqIEBwYXJhbSB7T2JqZWN0fSBkb2N1bWVudFxuICovXG4oZnVuY3Rpb24oJCwgd2luZG93LCBkb2N1bWVudCkge1xuICAgIHZhciBDTEFTU19QT1BVUCA9ICdtdWktcG9wdXAnO1xuICAgIHZhciBDTEFTU19QT1BVUF9CQUNLRFJPUCA9ICdtdWktcG9wdXAtYmFja2Ryb3AnO1xuICAgIHZhciBDTEFTU19QT1BVUF9JTiA9ICdtdWktcG9wdXAtaW4nO1xuICAgIHZhciBDTEFTU19QT1BVUF9PVVQgPSAnbXVpLXBvcHVwLW91dCc7XG4gICAgdmFyIENMQVNTX1BPUFVQX0lOTkVSID0gJ211aS1wb3B1cC1pbm5lcic7XG4gICAgdmFyIENMQVNTX1BPUFVQX1RJVExFID0gJ211aS1wb3B1cC10aXRsZSc7XG4gICAgdmFyIENMQVNTX1BPUFVQX1RFWFQgPSAnbXVpLXBvcHVwLXRleHQnO1xuICAgIHZhciBDTEFTU19QT1BVUF9JTlBVVCA9ICdtdWktcG9wdXAtaW5wdXQnO1xuICAgIHZhciBDTEFTU19QT1BVUF9CVVRUT05TID0gJ211aS1wb3B1cC1idXR0b25zJztcbiAgICB2YXIgQ0xBU1NfUE9QVVBfQlVUVE9OID0gJ211aS1wb3B1cC1idXR0b24nO1xuICAgIHZhciBDTEFTU19QT1BVUF9CVVRUT05fQk9MRCA9ICdtdWktcG9wdXAtYnV0dG9uLWJvbGQnO1xuICAgIHZhciBDTEFTU19QT1BVUF9CQUNLRFJPUCA9ICdtdWktcG9wdXAtYmFja2Ryb3AnO1xuICAgIHZhciBDTEFTU19BQ1RJVkUgPSAnbXVpLWFjdGl2ZSc7XG5cbiAgICB2YXIgcG9wdXBTdGFjayA9IFtdO1xuICAgIHZhciBiYWNrZHJvcCA9IChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKENMQVNTX1BPUFVQX0JBQ0tEUk9QKTtcbiAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCQuRVZFTlRfTU9WRSwgJC5wcmV2ZW50RGVmYXVsdCk7XG4gICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignd2Via2l0VHJhbnNpdGlvbkVuZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmNsYXNzTGlzdC5jb250YWlucyhDTEFTU19BQ1RJVkUpKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5wYXJlbnROb2RlICYmIGVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlbGVtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBlbGVtZW50O1xuICAgIH0oKSk7XG5cbiAgICB2YXIgY3JlYXRlSW5wdXQgPSBmdW5jdGlvbihwbGFjZWhvbGRlcikge1xuICAgICAgICByZXR1cm4gJzxkaXYgY2xhc3M9XCInICsgQ0xBU1NfUE9QVVBfSU5QVVQgKyAnXCI+PGlucHV0IHR5cGU9XCJ0ZXh0XCIgYXV0b2ZvY3VzIHBsYWNlaG9sZGVyPVwiJyArIChwbGFjZWhvbGRlciB8fCAnJykgKyAnXCIvPjwvZGl2Pic7XG4gICAgfTtcbiAgICB2YXIgY3JlYXRlSW5uZXIgPSBmdW5jdGlvbihtZXNzYWdlLCB0aXRsZSwgZXh0cmEpIHtcbiAgICAgICAgcmV0dXJuICc8ZGl2IGNsYXNzPVwiJyArIENMQVNTX1BPUFVQX0lOTkVSICsgJ1wiPjxkaXYgY2xhc3M9XCInICsgQ0xBU1NfUE9QVVBfVElUTEUgKyAnXCI+JyArIHRpdGxlICsgJzwvZGl2PjxkaXYgY2xhc3M9XCInICsgQ0xBU1NfUE9QVVBfVEVYVCArICdcIj4nICsgbWVzc2FnZS5yZXBsYWNlKC9cXHJcXG4vZywgXCI8YnIvPlwiKS5yZXBsYWNlKC9cXG4vZywgXCI8YnIvPlwiKSArICc8L2Rpdj4nICsgKGV4dHJhIHx8ICcnKSArICc8L2Rpdj4nO1xuICAgIH07XG4gICAgdmFyIGNyZWF0ZUJ1dHRvbnMgPSBmdW5jdGlvbihidG5BcnJheSkge1xuICAgICAgICB2YXIgbGVuZ3RoID0gYnRuQXJyYXkubGVuZ3RoO1xuICAgICAgICB2YXIgYnRucyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBidG5zLnB1c2goJzxzcGFuIGNsYXNzPVwiJyArIENMQVNTX1BPUFVQX0JVVFRPTiArIChpID09PSBsZW5ndGggLSAxID8gKCcgJyArIENMQVNTX1BPUFVQX0JVVFRPTl9CT0xEKSA6ICcnKSArICdcIj4nICsgYnRuQXJyYXlbaV0gKyAnPC9zcGFuPicpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAnPGRpdiBjbGFzcz1cIicgKyBDTEFTU19QT1BVUF9CVVRUT05TICsgJ1wiPicgKyBidG5zLmpvaW4oJycpICsgJzwvZGl2Pic7XG4gICAgfTtcblxuICAgIHZhciBjcmVhdGVQb3B1cCA9IGZ1bmN0aW9uKGh0bWwsIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBwb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgcG9wdXBFbGVtZW50LmNsYXNzTmFtZSA9IENMQVNTX1BPUFVQO1xuICAgICAgICBwb3B1cEVsZW1lbnQuaW5uZXJIVE1MID0gaHRtbDtcbiAgICAgICAgdmFyIHJlbW92ZVBvcHVwRWxlbWVudCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcG9wdXBFbGVtZW50LnBhcmVudE5vZGUgJiYgcG9wdXBFbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQocG9wdXBFbGVtZW50KTtcbiAgICAgICAgICAgIHBvcHVwRWxlbWVudCA9IG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIHBvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCQuRVZFTlRfTU9WRSwgJC5wcmV2ZW50RGVmYXVsdCk7XG4gICAgICAgIHBvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCd3ZWJraXRUcmFuc2l0aW9uRW5kJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgaWYgKHBvcHVwRWxlbWVudCAmJiBlLnRhcmdldCA9PT0gcG9wdXBFbGVtZW50ICYmIHBvcHVwRWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfUE9QVVBfT1VUKSkge1xuICAgICAgICAgICAgICAgIHJlbW92ZVBvcHVwRWxlbWVudCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcG9wdXBFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHBvcHVwRWxlbWVudCk7XG4gICAgICAgIHBvcHVwRWxlbWVudC5vZmZzZXRIZWlnaHQ7XG4gICAgICAgIHBvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKENMQVNTX1BPUFVQX0lOKTtcblxuICAgICAgICBpZiAoIWJhY2tkcm9wLmNsYXNzTGlzdC5jb250YWlucyhDTEFTU19BQ1RJVkUpKSB7XG4gICAgICAgICAgICBiYWNrZHJvcC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYmFja2Ryb3ApO1xuICAgICAgICAgICAgYmFja2Ryb3Aub2Zmc2V0SGVpZ2h0O1xuICAgICAgICAgICAgYmFja2Ryb3AuY2xhc3NMaXN0LmFkZChDTEFTU19BQ1RJVkUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBidG5zID0gJC5xc2EoJy4nICsgQ0xBU1NfUE9QVVBfQlVUVE9OLCBwb3B1cEVsZW1lbnQpO1xuICAgICAgICB2YXIgaW5wdXQgPSBwb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcignLicgKyBDTEFTU19QT1BVUF9JTlBVVCArICcgaW5wdXQnKTtcbiAgICAgICAgdmFyIHBvcHVwID0ge1xuICAgICAgICAgICAgZWxlbWVudDogcG9wdXBFbGVtZW50LFxuICAgICAgICAgICAgY2xvc2U6IGZ1bmN0aW9uKGluZGV4LCBhbmltYXRlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBvcHVwRWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gY2FsbGJhY2sgJiYgY2FsbGJhY2soe1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXg6IGluZGV4IHx8IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogaW5wdXQgJiYgaW5wdXQudmFsdWUgfHwgJydcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgPT09IGZhbHNlKSB7IC8v6L+U5ZueZmFsc2XliJnkuI3lhbPpl63lvZPliY1wb3B1cFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChhbmltYXRlICE9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoQ0xBU1NfUE9QVVBfSU4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoQ0xBU1NfUE9QVVBfT1VUKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZVBvcHVwRWxlbWVudCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHBvcHVwU3RhY2sucG9wKCk7XG4gICAgICAgICAgICAgICAgICAgIC8v5aaC5p6c6L+Y5pyJ5YW25LuWcG9wdXDvvIzliJnkuI1yZW1vdmUgYmFja2Ryb3BcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvcHVwU3RhY2subGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb3B1cFN0YWNrW3BvcHVwU3RhY2subGVuZ3RoIC0gMV1bJ3Nob3cnXShhbmltYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tkcm9wLmNsYXNzTGlzdC5yZW1vdmUoQ0xBU1NfQUNUSVZFKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGhhbmRsZUV2ZW50ID0gZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgcG9wdXAuY2xvc2UoYnRucy5pbmRleE9mKGUudGFyZ2V0KSk7XG4gICAgICAgIH07XG4gICAgICAgICQocG9wdXBFbGVtZW50KS5vbigndGFwJywgJy4nICsgQ0xBU1NfUE9QVVBfQlVUVE9OLCBoYW5kbGVFdmVudCk7XG4gICAgICAgIGlmIChwb3B1cFN0YWNrLmxlbmd0aCkge1xuICAgICAgICAgICAgcG9wdXBTdGFja1twb3B1cFN0YWNrLmxlbmd0aCAtIDFdWydoaWRlJ10oKTtcbiAgICAgICAgfVxuICAgICAgICBwb3B1cFN0YWNrLnB1c2goe1xuICAgICAgICAgICAgY2xvc2U6IHBvcHVwLmNsb3NlLFxuICAgICAgICAgICAgc2hvdzogZnVuY3Rpb24oYW5pbWF0ZSkge1xuICAgICAgICAgICAgICAgIHBvcHVwRWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgICAgICBwb3B1cEVsZW1lbnQub2Zmc2V0SGVpZ2h0O1xuICAgICAgICAgICAgICAgIHBvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKENMQVNTX1BPUFVQX0lOKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBoaWRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBwb3B1cEVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgICAgICBwb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShDTEFTU19QT1BVUF9JTik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcG9wdXA7XG4gICAgfTtcbiAgICB2YXIgY3JlYXRlQWxlcnQgPSBmdW5jdGlvbihtZXNzYWdlLCB0aXRsZSwgYnRuVmFsdWUsIGNhbGxiYWNrLCB0eXBlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbWVzc2FnZSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdGl0bGUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayA9IHRpdGxlO1xuICAgICAgICAgICAgICAgIHR5cGUgPSBidG5WYWx1ZTtcbiAgICAgICAgICAgICAgICB0aXRsZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgYnRuVmFsdWUgPSBudWxsO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYnRuVmFsdWUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICB0eXBlID0gY2FsbGJhY2s7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2sgPSBidG5WYWx1ZTtcbiAgICAgICAgICAgICAgICBidG5WYWx1ZSA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCEkLm9zLnBsdXMgfHwgdHlwZSA9PT0gJ2RpdicpIHtcbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVQb3B1cChjcmVhdGVJbm5lcihtZXNzYWdlLCB0aXRsZSB8fCAn5o+Q56S6JykgKyBjcmVhdGVCdXR0b25zKFtidG5WYWx1ZSB8fCAn56Gu5a6aJ10pLCBjYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBsdXMubmF0aXZlVUkuYWxlcnQobWVzc2FnZSwgY2FsbGJhY2ssIHRpdGxlIHx8ICfmj5DnpLonLCBidG5WYWx1ZSB8fCAn56Gu5a6aJyk7XG4gICAgfTtcbiAgICB2YXIgY3JlYXRlQ29uZmlybSA9IGZ1bmN0aW9uKG1lc3NhZ2UsIHRpdGxlLCBidG5BcnJheSwgY2FsbGJhY2ssIHR5cGUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBtZXNzYWdlID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB0aXRsZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrID0gdGl0bGU7XG4gICAgICAgICAgICAgICAgdHlwZSA9IGJ0bkFycmF5O1xuICAgICAgICAgICAgICAgIHRpdGxlID0gbnVsbDtcbiAgICAgICAgICAgICAgICBidG5BcnJheSA9IG51bGw7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBidG5BcnJheSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIHR5cGUgPSBjYWxsYmFjaztcbiAgICAgICAgICAgICAgICBjYWxsYmFjayA9IGJ0bkFycmF5O1xuICAgICAgICAgICAgICAgIGJ0bkFycmF5ID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoISQub3MucGx1cyB8fCB0eXBlID09PSAnZGl2Jykge1xuICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZVBvcHVwKGNyZWF0ZUlubmVyKG1lc3NhZ2UsIHRpdGxlIHx8ICfmj5DnpLonKSArIGNyZWF0ZUJ1dHRvbnMoYnRuQXJyYXkgfHwgWyflj5bmtognLCAn56Gu6K6kJ10pLCBjYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBsdXMubmF0aXZlVUkuY29uZmlybShtZXNzYWdlLCBjYWxsYmFjaywgdGl0bGUsIGJ0bkFycmF5IHx8IFsn5Y+W5raIJywgJ+ehruiupCddKTtcbiAgICB9O1xuICAgIHZhciBjcmVhdGVQcm9tcHQgPSBmdW5jdGlvbihtZXNzYWdlLCBwbGFjZWhvbGRlciwgdGl0bGUsIGJ0bkFycmF5LCBjYWxsYmFjaywgdHlwZSkge1xuICAgICAgICBpZiAodHlwZW9mIG1lc3NhZ2UgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHBsYWNlaG9sZGVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2sgPSBwbGFjZWhvbGRlcjtcbiAgICAgICAgICAgICAgICB0eXBlID0gdGl0bGU7XG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXIgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRpdGxlID0gbnVsbDtcbiAgICAgICAgICAgICAgICBidG5BcnJheSA9IG51bGw7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB0aXRsZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrID0gdGl0bGU7XG4gICAgICAgICAgICAgICAgdHlwZSA9IGJ0bkFycmF5O1xuICAgICAgICAgICAgICAgIHRpdGxlID0gbnVsbDtcbiAgICAgICAgICAgICAgICBidG5BcnJheSA9IG51bGw7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBidG5BcnJheSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIHR5cGUgPSBjYWxsYmFjaztcbiAgICAgICAgICAgICAgICBjYWxsYmFjayA9IGJ0bkFycmF5O1xuICAgICAgICAgICAgICAgIGJ0bkFycmF5ID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoISQub3MucGx1cyB8fCB0eXBlID09PSAnZGl2Jykge1xuICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZVBvcHVwKGNyZWF0ZUlubmVyKG1lc3NhZ2UsIHRpdGxlIHx8ICfmj5DnpLonLCBjcmVhdGVJbnB1dChwbGFjZWhvbGRlcikpICsgY3JlYXRlQnV0dG9ucyhidG5BcnJheSB8fCBbJ+WPlua2iCcsICfnoa7orqQnXSksIGNhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGx1cy5uYXRpdmVVSS5wcm9tcHQobWVzc2FnZSwgY2FsbGJhY2ssIHRpdGxlIHx8ICfmj5DnpLonLCBwbGFjZWhvbGRlciwgYnRuQXJyYXkgfHwgWyflj5bmtognLCAn56Gu6K6kJ10pO1xuICAgIH07XG4gICAgdmFyIGNsb3NlUG9wdXAgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHBvcHVwU3RhY2subGVuZ3RoKSB7XG4gICAgICAgICAgICBwb3B1cFN0YWNrW3BvcHVwU3RhY2subGVuZ3RoIC0gMV1bJ2Nsb3NlJ10oKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB2YXIgY2xvc2VQb3B1cHMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgd2hpbGUgKHBvcHVwU3RhY2subGVuZ3RoKSB7XG4gICAgICAgICAgICBwb3B1cFN0YWNrW3BvcHVwU3RhY2subGVuZ3RoIC0gMV1bJ2Nsb3NlJ10oKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAkLmNsb3NlUG9wdXAgPSBjbG9zZVBvcHVwO1xuICAgICQuY2xvc2VQb3B1cHMgPSBjbG9zZVBvcHVwcztcbiAgICAkLmFsZXJ0ID0gY3JlYXRlQWxlcnQ7XG4gICAgJC5jb25maXJtID0gY3JlYXRlQ29uZmlybTtcbiAgICAkLnByb21wdCA9IGNyZWF0ZVByb21wdDtcbn0pKG11aSwgd2luZG93LCBkb2N1bWVudCk7XG4oZnVuY3Rpb24oJCwgZG9jdW1lbnQpIHtcblx0dmFyIENMQVNTX1BST0dSRVNTQkFSID0gJ211aS1wcm9ncmVzc2Jhcic7XG5cdHZhciBDTEFTU19QUk9HUkVTU0JBUl9JTiA9ICdtdWktcHJvZ3Jlc3NiYXItaW4nO1xuXHR2YXIgQ0xBU1NfUFJPR1JFU1NCQVJfT1VUID0gJ211aS1wcm9ncmVzc2Jhci1vdXQnO1xuXHR2YXIgQ0xBU1NfUFJPR1JFU1NCQVJfSU5GSU5JVEUgPSAnbXVpLXByb2dyZXNzYmFyLWluZmluaXRlJztcblxuXHR2YXIgU0VMRUNUT1JfUFJPR1JFU1NCQVIgPSAnLm11aS1wcm9ncmVzc2Jhcic7XG5cblx0dmFyIF9maW5kUHJvZ3Jlc3NiYXIgPSBmdW5jdGlvbihjb250YWluZXIpIHtcblx0XHRjb250YWluZXIgPSAkKGNvbnRhaW5lciB8fCAnYm9keScpO1xuXHRcdGlmIChjb250YWluZXIubGVuZ3RoID09PSAwKSByZXR1cm47XG5cdFx0Y29udGFpbmVyID0gY29udGFpbmVyWzBdO1xuXHRcdGlmIChjb250YWluZXIuY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX1BST0dSRVNTQkFSKSkge1xuXHRcdFx0cmV0dXJuIGNvbnRhaW5lcjtcblx0XHR9XG5cdFx0dmFyIHByb2dyZXNzYmFycyA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKFNFTEVDVE9SX1BST0dSRVNTQkFSKTtcblx0XHRpZiAocHJvZ3Jlc3NiYXJzKSB7XG5cdFx0XHRmb3IgKHZhciBpID0gMCwgbGVuID0gcHJvZ3Jlc3NiYXJzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdFx0XHRcdHZhciBwcm9ncmVzc2JhciA9IHByb2dyZXNzYmFyc1tpXTtcblx0XHRcdFx0aWYgKHByb2dyZXNzYmFyLnBhcmVudE5vZGUgPT09IGNvbnRhaW5lcikge1xuXHRcdFx0XHRcdHJldHVybiBwcm9ncmVzc2Jhcjtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fTtcblx0LyoqXG5cdCAqIOWIm+W7uuW5tuaYvuekuui/m+W6puadoVxuXHQgKiBAcGFyYW0ge09iamVjdH0gY29udGFpbmVyICDlj6/pgInvvIzpu5jorqRib2R577yM5pSv5oyBc2VsZWN0b3IsRE9NIE5vZGUsbXVpIHdyYXBwZXJcblx0ICogQHBhcmFtIHtPYmplY3R9IHByb2dyZXNzIOWPr+mAie+8jHVuZGVmaW5lZOihqOekuuW+queOr++8jOaVsOWtl+ihqOekuuWFt+S9k+i/m+W6plxuXHQgKiBAcGFyYW0ge09iamVjdH0gY29sb3Ig5Y+v6YCJ77yM5oyH5a6a6aKc6Imy5qC35byPKOebruWJjeaaguacquaPkOS+m+WunumZheagt+W8j++8jOWPr+aaguaXtuS4jeaatOmcsuatpOWPguaVsClcblx0ICovXG5cdHZhciBzaG93UHJvZ3Jlc3NiYXIgPSBmdW5jdGlvbihjb250YWluZXIsIHByb2dyZXNzLCBjb2xvcikge1xuXHRcdGlmICh0eXBlb2YgY29udGFpbmVyID09PSAnbnVtYmVyJykge1xuXHRcdFx0Y29sb3IgPSBwcm9ncmVzcztcblx0XHRcdHByb2dyZXNzID0gY29udGFpbmVyO1xuXHRcdFx0Y29udGFpbmVyID0gJ2JvZHknO1xuXHRcdH1cblx0XHRjb250YWluZXIgPSAkKGNvbnRhaW5lciB8fCAnYm9keScpO1xuXHRcdGlmIChjb250YWluZXIubGVuZ3RoID09PSAwKSByZXR1cm47XG5cdFx0Y29udGFpbmVyID0gY29udGFpbmVyWzBdO1xuXHRcdHZhciBwcm9ncmVzc2Jhcjtcblx0XHRpZiAoY29udGFpbmVyLmNsYXNzTGlzdC5jb250YWlucyhDTEFTU19QUk9HUkVTU0JBUikpIHtcblx0XHRcdHByb2dyZXNzYmFyID0gY29udGFpbmVyO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR2YXIgcHJvZ3Jlc3NiYXJzID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoU0VMRUNUT1JfUFJPR1JFU1NCQVIgKyAnOm5vdCguJyArIENMQVNTX1BST0dSRVNTQkFSX09VVCArICcpJyk7XG5cdFx0XHRpZiAocHJvZ3Jlc3NiYXJzKSB7XG5cdFx0XHRcdGZvciAodmFyIGkgPSAwLCBsZW4gPSBwcm9ncmVzc2JhcnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0XHRcdFx0XHR2YXIgX3Byb2dyZXNzYmFyID0gcHJvZ3Jlc3NiYXJzW2ldO1xuXHRcdFx0XHRcdGlmIChfcHJvZ3Jlc3NiYXIucGFyZW50Tm9kZSA9PT0gY29udGFpbmVyKSB7XG5cdFx0XHRcdFx0XHRwcm9ncmVzc2JhciA9IF9wcm9ncmVzc2Jhcjtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0aWYgKCFwcm9ncmVzc2Jhcikge1xuXHRcdFx0XHRwcm9ncmVzc2JhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcblx0XHRcdFx0cHJvZ3Jlc3NiYXIuY2xhc3NOYW1lID0gQ0xBU1NfUFJPR1JFU1NCQVIgKyAnICcgKyBDTEFTU19QUk9HUkVTU0JBUl9JTiArICh0eXBlb2YgcHJvZ3Jlc3MgIT09ICd1bmRlZmluZWQnID8gJycgOiAoJyAnICsgQ0xBU1NfUFJPR1JFU1NCQVJfSU5GSU5JVEUpKSArIChjb2xvciA/ICgnICcgKyBDTEFTU19QUk9HUkVTU0JBUiArICctJyArIGNvbG9yKSA6ICcnKTtcblx0XHRcdFx0aWYgKHR5cGVvZiBwcm9ncmVzcyAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdFx0XHRwcm9ncmVzc2Jhci5pbm5lckhUTUwgPSAnPHNwYW4+PC9zcGFuPic7XG5cdFx0XHRcdH1cblx0XHRcdFx0Y29udGFpbmVyLmFwcGVuZENoaWxkKHByb2dyZXNzYmFyKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHByb2dyZXNzYmFyLmNsYXNzTGlzdC5hZGQoQ0xBU1NfUFJPR1JFU1NCQVJfSU4pO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZiAocHJvZ3Jlc3MpIHNldFByb2dyZXNzYmFyKGNvbnRhaW5lciwgcHJvZ3Jlc3MpO1xuXHRcdHJldHVybiBwcm9ncmVzc2Jhcjtcblx0fTtcblx0LyoqXG5cdCAqIOWFs+mXrei/m+W6puadoVxuXHQgKiBAcGFyYW0ge09iamVjdH0gY29udGFpbmVyIOWPr+mAie+8jOm7mOiupGJvZHnvvIzmlK/mjIFzZWxlY3RvcixET00gTm9kZSxtdWkgd3JhcHBlclxuXHQgKi9cblx0dmFyIGhpZGVQcm9ncmVzc2JhciA9IGZ1bmN0aW9uKGNvbnRhaW5lcikge1xuXHRcdHZhciBwcm9ncmVzc2JhciA9IF9maW5kUHJvZ3Jlc3NiYXIoY29udGFpbmVyKTtcblx0XHRpZiAoIXByb2dyZXNzYmFyKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdHZhciBjbGFzc0xpc3QgPSBwcm9ncmVzc2Jhci5jbGFzc0xpc3Q7XG5cdFx0aWYgKCFjbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfUFJPR1JFU1NCQVJfSU4pIHx8IGNsYXNzTGlzdC5jb250YWlucyhDTEFTU19QUk9HUkVTU0JBUl9PVVQpKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdGNsYXNzTGlzdC5yZW1vdmUoQ0xBU1NfUFJPR1JFU1NCQVJfSU4pO1xuXHRcdGNsYXNzTGlzdC5hZGQoQ0xBU1NfUFJPR1JFU1NCQVJfT1VUKTtcblx0XHRwcm9ncmVzc2Jhci5hZGRFdmVudExpc3RlbmVyKCd3ZWJraXRBbmltYXRpb25FbmQnLCBmdW5jdGlvbigpIHtcblx0XHRcdHByb2dyZXNzYmFyLnBhcmVudE5vZGUgJiYgcHJvZ3Jlc3NiYXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChwcm9ncmVzc2Jhcik7XG5cdFx0XHRwcm9ncmVzc2JhciA9IG51bGw7XG5cdFx0fSk7XG5cdFx0cmV0dXJuO1xuXHR9O1xuXHQvKipcblx0ICog6K6+572u5oyH5a6a6L+b5bqm5p2h6L+b5bqmXG5cdCAqIEBwYXJhbSB7T2JqZWN0fSBjb250YWluZXIgIOWPr+mAie+8jOm7mOiupGJvZHnvvIzmlK/mjIFzZWxlY3RvcixET00gTm9kZSxtdWkgd3JhcHBlclxuXHQgKiBAcGFyYW0ge09iamVjdH0gcHJvZ3Jlc3Mg5Y+v6YCJ77yM6buY6K6kMCDlj5blgLzojIPlm7RbMC0xMDBdXG5cdCAqIEBwYXJhbSB7T2JqZWN0fSBzcGVlZCDov5vluqbmnaHliqjnlLvml7bpl7Rcblx0ICovXG5cdHZhciBzZXRQcm9ncmVzc2JhciA9IGZ1bmN0aW9uKGNvbnRhaW5lciwgcHJvZ3Jlc3MsIHNwZWVkKSB7XG5cdFx0aWYgKHR5cGVvZiBjb250YWluZXIgPT09ICdudW1iZXInKSB7XG5cdFx0XHRzcGVlZCA9IHByb2dyZXNzO1xuXHRcdFx0cHJvZ3Jlc3MgPSBjb250YWluZXI7XG5cdFx0XHRjb250YWluZXIgPSBmYWxzZTtcblx0XHR9XG5cdFx0dmFyIHByb2dyZXNzYmFyID0gX2ZpbmRQcm9ncmVzc2Jhcihjb250YWluZXIpO1xuXHRcdGlmICghcHJvZ3Jlc3NiYXIgfHwgcHJvZ3Jlc3NiYXIuY2xhc3NMaXN0LmNvbnRhaW5zKENMQVNTX1BST0dSRVNTQkFSX0lORklOSVRFKSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRpZiAocHJvZ3Jlc3MpIHByb2dyZXNzID0gTWF0aC5taW4oTWF0aC5tYXgocHJvZ3Jlc3MsIDApLCAxMDApO1xuXHRcdHByb2dyZXNzYmFyLm9mZnNldEhlaWdodDtcblx0XHR2YXIgc3BhbiA9IHByb2dyZXNzYmFyLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKTtcblx0XHRpZiAoc3Bhbikge1xuXHRcdFx0dmFyIHN0eWxlID0gc3Bhbi5zdHlsZTtcblx0XHRcdHN0eWxlLndlYmtpdFRyYW5zZm9ybSA9ICd0cmFuc2xhdGUzZCgnICsgKC0xMDAgKyBwcm9ncmVzcykgKyAnJSwwLDApJztcblx0XHRcdGlmICh0eXBlb2Ygc3BlZWQgIT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRcdHN0eWxlLndlYmtpdFRyYW5zaXRpb25EdXJhdGlvbiA9IHNwZWVkICsgJ21zJztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHN0eWxlLndlYmtpdFRyYW5zaXRpb25EdXJhdGlvbiA9ICcnO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gcHJvZ3Jlc3NiYXI7XG5cdH07XG5cdCQuZm4ucHJvZ3Jlc3NiYXIgPSBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0dmFyIHByb2dyZXNzYmFyQXBpcyA9IFtdO1xuXHRcdG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXHRcdHRoaXMuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdHZhciBwcm9ncmVzc2JhckFwaSA9IHNlbGYubXVpX3BsdWdpbl9wcm9ncmVzc2Jhcjtcblx0XHRcdGlmICghcHJvZ3Jlc3NiYXJBcGkpIHtcblx0XHRcdFx0c2VsZi5tdWlfcGx1Z2luX3Byb2dyZXNzYmFyID0gcHJvZ3Jlc3NiYXJBcGkgPSB7XG5cdFx0XHRcdFx0b3B0aW9uczogb3B0aW9ucyxcblx0XHRcdFx0XHRzZXRPcHRpb25zOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0XHRcdFx0XHR0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0c2hvdzogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gc2hvd1Byb2dyZXNzYmFyKHNlbGYsIHRoaXMub3B0aW9ucy5wcm9ncmVzcywgdGhpcy5vcHRpb25zLmNvbG9yKTtcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdHNldFByb2dyZXNzOiBmdW5jdGlvbihwcm9ncmVzcykge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHNldFByb2dyZXNzYmFyKHNlbGYsIHByb2dyZXNzKTtcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdGhpZGU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGhpZGVQcm9ncmVzc2JhcihzZWxmKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH07XG5cdFx0XHR9IGVsc2UgaWYgKG9wdGlvbnMpIHtcblx0XHRcdFx0cHJvZ3Jlc3NiYXJBcGkuc2V0T3B0aW9ucyhvcHRpb25zKTtcblx0XHRcdH1cblx0XHRcdHByb2dyZXNzYmFyQXBpcy5wdXNoKHByb2dyZXNzYmFyQXBpKTtcblx0XHR9KTtcblx0XHRyZXR1cm4gcHJvZ3Jlc3NiYXJBcGlzLmxlbmd0aCA9PT0gMSA/IHByb2dyZXNzYmFyQXBpc1swXSA6IHByb2dyZXNzYmFyQXBpcztcblx0fTtcblx0Ly9cdCQuc2V0UHJvZ3Jlc3NiYXIgPSBzZXRQcm9ncmVzc2Jhcjtcblx0Ly9cdCQuc2hvd1Byb2dyZXNzYmFyID0gc2hvd1Byb2dyZXNzYmFyO1xuXHQvL1x0JC5oaWRlUHJvZ3Jlc3NiYXIgPSBoaWRlUHJvZ3Jlc3NiYXI7XG59KShtdWksIGRvY3VtZW50KTtcbi8qKlxuICogSW5wdXQoVE9ETyByZXNpemUpXG4gKiBAcGFyYW0ge3R5cGV9ICRcbiAqIEBwYXJhbSB7dHlwZX0gd2luZG93XG4gKiBAcGFyYW0ge3R5cGV9IGRvY3VtZW50XG4gKiBAcmV0dXJucyB7dW5kZWZpbmVkfVxuICovXG4oZnVuY3Rpb24oJCwgd2luZG93LCBkb2N1bWVudCkge1xuXHR2YXIgQ0xBU1NfSUNPTiA9ICdtdWktaWNvbic7XG5cdHZhciBDTEFTU19JQ09OX0NMRUFSID0gJ211aS1pY29uLWNsZWFyJztcblx0dmFyIENMQVNTX0lDT05fU1BFRUNIID0gJ211aS1pY29uLXNwZWVjaCc7XG5cdHZhciBDTEFTU19JQ09OX1NFQVJDSCA9ICdtdWktaWNvbi1zZWFyY2gnO1xuXHR2YXIgQ0xBU1NfSUNPTl9QQVNTV09SRCA9ICdtdWktaWNvbi1leWUnO1xuXHR2YXIgQ0xBU1NfSU5QVVRfUk9XID0gJ211aS1pbnB1dC1yb3cnO1xuXHR2YXIgQ0xBU1NfUExBQ0VIT0xERVIgPSAnbXVpLXBsYWNlaG9sZGVyJztcblx0dmFyIENMQVNTX1RPT0xUSVAgPSAnbXVpLXRvb2x0aXAnO1xuXHR2YXIgQ0xBU1NfSElEREVOID0gJ211aS1oaWRkZW4nO1xuXHR2YXIgQ0xBU1NfRk9DVVNJTiA9ICdtdWktZm9jdXNpbic7XG5cdHZhciBTRUxFQ1RPUl9JQ09OX0NMT1NFID0gJy4nICsgQ0xBU1NfSUNPTl9DTEVBUjtcblx0dmFyIFNFTEVDVE9SX0lDT05fU1BFRUNIID0gJy4nICsgQ0xBU1NfSUNPTl9TUEVFQ0g7XG5cdHZhciBTRUxFQ1RPUl9JQ09OX1BBU1NXT1JEID0gJy4nICsgQ0xBU1NfSUNPTl9QQVNTV09SRDtcblx0dmFyIFNFTEVDVE9SX1BMQUNFSE9MREVSID0gJy4nICsgQ0xBU1NfUExBQ0VIT0xERVI7XG5cdHZhciBTRUxFQ1RPUl9UT09MVElQID0gJy4nICsgQ0xBU1NfVE9PTFRJUDtcblxuXHR2YXIgZmluZFJvdyA9IGZ1bmN0aW9uKHRhcmdldCkge1xuXHRcdGZvciAoOyB0YXJnZXQgJiYgdGFyZ2V0ICE9PSBkb2N1bWVudDsgdGFyZ2V0ID0gdGFyZ2V0LnBhcmVudE5vZGUpIHtcblx0XHRcdGlmICh0YXJnZXQuY2xhc3NMaXN0ICYmIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoQ0xBU1NfSU5QVVRfUk9XKSkge1xuXHRcdFx0XHRyZXR1cm4gdGFyZ2V0O1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gbnVsbDtcblx0fTtcblx0dmFyIElucHV0ID0gZnVuY3Rpb24oZWxlbWVudCwgb3B0aW9ucykge1xuXHRcdHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG5cdFx0dGhpcy5vcHRpb25zID0gb3B0aW9ucyB8fCB7XG5cdFx0XHRhY3Rpb25zOiAnY2xlYXInXG5cdFx0fTtcblx0XHRpZiAofnRoaXMub3B0aW9ucy5hY3Rpb25zLmluZGV4T2YoJ3NsaWRlcicpKSB7IC8vc2xpZGVyXG5cdFx0XHR0aGlzLnNsaWRlckFjdGlvbkNsYXNzID0gQ0xBU1NfVE9PTFRJUCArICcgJyArIENMQVNTX0hJRERFTjtcblx0XHRcdHRoaXMuc2xpZGVyQWN0aW9uU2VsZWN0b3IgPSBTRUxFQ1RPUl9UT09MVElQO1xuXHRcdH0gZWxzZSB7IC8vY2xlYXIsc3BlZWNoLHNlYXJjaFxuXHRcdFx0aWYgKH50aGlzLm9wdGlvbnMuYWN0aW9ucy5pbmRleE9mKCdjbGVhcicpKSB7XG5cdFx0XHRcdHRoaXMuY2xlYXJBY3Rpb25DbGFzcyA9IENMQVNTX0lDT04gKyAnICcgKyBDTEFTU19JQ09OX0NMRUFSICsgJyAnICsgQ0xBU1NfSElEREVOO1xuXHRcdFx0XHR0aGlzLmNsZWFyQWN0aW9uU2VsZWN0b3IgPSBTRUxFQ1RPUl9JQ09OX0NMT1NFO1xuXHRcdFx0fVxuXHRcdFx0aWYgKH50aGlzLm9wdGlvbnMuYWN0aW9ucy5pbmRleE9mKCdzcGVlY2gnKSkgeyAvL29ubHkgZm9yIDUrXG5cdFx0XHRcdHRoaXMuc3BlZWNoQWN0aW9uQ2xhc3MgPSBDTEFTU19JQ09OICsgJyAnICsgQ0xBU1NfSUNPTl9TUEVFQ0g7XG5cdFx0XHRcdHRoaXMuc3BlZWNoQWN0aW9uU2VsZWN0b3IgPSBTRUxFQ1RPUl9JQ09OX1NQRUVDSDtcblx0XHRcdH1cblx0XHRcdGlmICh+dGhpcy5vcHRpb25zLmFjdGlvbnMuaW5kZXhPZignc2VhcmNoJykpIHtcblx0XHRcdFx0dGhpcy5zZWFyY2hBY3Rpb25DbGFzcyA9IENMQVNTX1BMQUNFSE9MREVSO1xuXHRcdFx0XHR0aGlzLnNlYXJjaEFjdGlvblNlbGVjdG9yID0gU0VMRUNUT1JfUExBQ0VIT0xERVI7XG5cdFx0XHR9XG5cdFx0XHRpZiAofnRoaXMub3B0aW9ucy5hY3Rpb25zLmluZGV4T2YoJ3Bhc3N3b3JkJykpIHtcblx0XHRcdFx0dGhpcy5wYXNzd29yZEFjdGlvbkNsYXNzID0gQ0xBU1NfSUNPTiArICcgJyArIENMQVNTX0lDT05fUEFTU1dPUkQ7XG5cdFx0XHRcdHRoaXMucGFzc3dvcmRBY3Rpb25TZWxlY3RvciA9IFNFTEVDVE9SX0lDT05fUEFTU1dPUkQ7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHRoaXMuaW5pdCgpO1xuXHR9O1xuXHRJbnB1dC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuaW5pdEFjdGlvbigpO1xuXHRcdHRoaXMuaW5pdEVsZW1lbnRFdmVudCgpO1xuXHR9O1xuXHRJbnB1dC5wcm90b3R5cGUuaW5pdEFjdGlvbiA9IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdHZhciByb3cgPSBzZWxmLmVsZW1lbnQucGFyZW50Tm9kZTtcblx0XHRpZiAocm93KSB7XG5cdFx0XHRpZiAoc2VsZi5zbGlkZXJBY3Rpb25DbGFzcykge1xuXHRcdFx0XHRzZWxmLnNsaWRlckFjdGlvbiA9IHNlbGYuY3JlYXRlQWN0aW9uKHJvdywgc2VsZi5zbGlkZXJBY3Rpb25DbGFzcywgc2VsZi5zbGlkZXJBY3Rpb25TZWxlY3Rvcik7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAoc2VsZi5zZWFyY2hBY3Rpb25DbGFzcykge1xuXHRcdFx0XHRcdHNlbGYuc2VhcmNoQWN0aW9uID0gc2VsZi5jcmVhdGVBY3Rpb24ocm93LCBzZWxmLnNlYXJjaEFjdGlvbkNsYXNzLCBzZWxmLnNlYXJjaEFjdGlvblNlbGVjdG9yKTtcblx0XHRcdFx0XHRzZWxmLnNlYXJjaEFjdGlvbi5hZGRFdmVudExpc3RlbmVyKCd0YXAnLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdFx0XHQkLmZvY3VzKHNlbGYuZWxlbWVudCk7XG5cdFx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChzZWxmLnNwZWVjaEFjdGlvbkNsYXNzKSB7XG5cdFx0XHRcdFx0c2VsZi5zcGVlY2hBY3Rpb24gPSBzZWxmLmNyZWF0ZUFjdGlvbihyb3csIHNlbGYuc3BlZWNoQWN0aW9uQ2xhc3MsIHNlbGYuc3BlZWNoQWN0aW9uU2VsZWN0b3IpO1xuXHRcdFx0XHRcdHNlbGYuc3BlZWNoQWN0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgJC5zdG9wUHJvcGFnYXRpb24pO1xuXHRcdFx0XHRcdHNlbGYuc3BlZWNoQWN0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ3RhcCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRcdFx0XHRzZWxmLnNwZWVjaEFjdGlvbkNsaWNrKGV2ZW50KTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoc2VsZi5jbGVhckFjdGlvbkNsYXNzKSB7XG5cdFx0XHRcdFx0c2VsZi5jbGVhckFjdGlvbiA9IHNlbGYuY3JlYXRlQWN0aW9uKHJvdywgc2VsZi5jbGVhckFjdGlvbkNsYXNzLCBzZWxmLmNsZWFyQWN0aW9uU2VsZWN0b3IpO1xuXHRcdFx0XHRcdHNlbGYuY2xlYXJBY3Rpb24uYWRkRXZlbnRMaXN0ZW5lcigndGFwJywgZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRcdFx0XHRcdHNlbGYuY2xlYXJBY3Rpb25DbGljayhldmVudCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKHNlbGYucGFzc3dvcmRBY3Rpb25DbGFzcykge1xuXHRcdFx0XHRcdHNlbGYucGFzc3dvcmRBY3Rpb24gPSBzZWxmLmNyZWF0ZUFjdGlvbihyb3csIHNlbGYucGFzc3dvcmRBY3Rpb25DbGFzcywgc2VsZi5wYXNzd29yZEFjdGlvblNlbGVjdG9yKTtcblx0XHRcdFx0XHRzZWxmLnBhc3N3b3JkQWN0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ3RhcCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRcdFx0XHRzZWxmLnBhc3N3b3JkQWN0aW9uQ2xpY2soZXZlbnQpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9O1xuXHRJbnB1dC5wcm90b3R5cGUuY3JlYXRlQWN0aW9uID0gZnVuY3Rpb24ocm93LCBhY3Rpb25DbGFzcywgYWN0aW9uU2VsZWN0b3IpIHtcblx0XHR2YXIgYWN0aW9uID0gcm93LnF1ZXJ5U2VsZWN0b3IoYWN0aW9uU2VsZWN0b3IpO1xuXHRcdGlmICghYWN0aW9uKSB7XG5cdFx0XHR2YXIgYWN0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuXHRcdFx0YWN0aW9uLmNsYXNzTmFtZSA9IGFjdGlvbkNsYXNzO1xuXHRcdFx0aWYgKGFjdGlvbkNsYXNzID09PSB0aGlzLnNlYXJjaEFjdGlvbkNsYXNzKSB7XG5cdFx0XHRcdGFjdGlvbi5pbm5lckhUTUwgPSAnPHNwYW4gY2xhc3M9XCInICsgQ0xBU1NfSUNPTiArICcgJyArIENMQVNTX0lDT05fU0VBUkNIICsgJ1wiPjwvc3Bhbj48c3Bhbj4nICsgdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgncGxhY2Vob2xkZXInKSArICc8L3NwYW4+Jztcblx0XHRcdFx0dGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZSgncGxhY2Vob2xkZXInLCAnJyk7XG5cdFx0XHRcdGlmICh0aGlzLmVsZW1lbnQudmFsdWUudHJpbSgpKSB7XG5cdFx0XHRcdFx0cm93LmNsYXNzTGlzdC5hZGQoJ211aS1hY3RpdmUnKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0cm93Lmluc2VydEJlZm9yZShhY3Rpb24sIHRoaXMuZWxlbWVudC5uZXh0U2libGluZyk7XG5cdFx0fVxuXHRcdHJldHVybiBhY3Rpb247XG5cdH07XG5cdElucHV0LnByb3RvdHlwZS5pbml0RWxlbWVudEV2ZW50ID0gZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQ7XG5cblx0XHRpZiAodGhpcy5zbGlkZXJBY3Rpb25DbGFzcykge1xuXHRcdFx0dmFyIHRvb2x0aXAgPSB0aGlzLnNsaWRlckFjdGlvbjtcblx0XHRcdHZhciB0aW1lciA9IG51bGw7XG5cdFx0XHR2YXIgc2hvd1RpcCA9IGZ1bmN0aW9uKCkgeyAvL+avj+asoemHjeaWsOiuoeeul+aYr+WboOS4uuaOp+S7tuWPr+iDveiiq+makOiXj++8jOWIneWni+WMluaXtuiuoeeul+aYr+S4jeato+ehrueahFxuXHRcdFx0XHR0b29sdGlwLmNsYXNzTGlzdC5yZW1vdmUoQ0xBU1NfSElEREVOKTtcblx0XHRcdFx0dmFyIG9mZnNldExlZnQgPSBlbGVtZW50Lm9mZnNldExlZnQ7XG5cdFx0XHRcdHZhciB3aWR0aCA9IGVsZW1lbnQub2Zmc2V0V2lkdGggLSAyODtcblx0XHRcdFx0dmFyIHRvb2x0aXBXaWR0aCA9IHRvb2x0aXAub2Zmc2V0V2lkdGg7XG5cdFx0XHRcdHZhciBkaXN0aW5jZSA9IE1hdGguYWJzKGVsZW1lbnQubWF4IC0gZWxlbWVudC5taW4pO1xuXHRcdFx0XHR2YXIgc2NhbGVXaWR0aCA9ICh3aWR0aCAvIGRpc3RpbmNlKSAqIE1hdGguYWJzKGVsZW1lbnQudmFsdWUgLSBlbGVtZW50Lm1pbik7XG5cdFx0XHRcdHRvb2x0aXAuc3R5bGUubGVmdCA9ICgxNCArIG9mZnNldExlZnQgKyBzY2FsZVdpZHRoIC0gdG9vbHRpcFdpZHRoIC8gMikgKyAncHgnO1xuXHRcdFx0XHR0b29sdGlwLmlubmVyVGV4dCA9IGVsZW1lbnQudmFsdWU7XG5cdFx0XHRcdGlmICh0aW1lcikge1xuXHRcdFx0XHRcdGNsZWFyVGltZW91dCh0aW1lcik7XG5cdFx0XHRcdH1cblx0XHRcdFx0dGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHRvb2x0aXAuY2xhc3NMaXN0LmFkZChDTEFTU19ISURERU4pO1xuXHRcdFx0XHR9LCAxMDAwKTtcblx0XHRcdH07XG5cdFx0XHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgc2hvd1RpcCk7XG5cdFx0XHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RhcCcsIHNob3dUaXApO1xuXHRcdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCQuRVZFTlRfTU9WRSwgZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGlmICh0aGlzLmNsZWFyQWN0aW9uQ2xhc3MpIHtcblx0XHRcdFx0dmFyIGFjdGlvbiA9IHRoaXMuY2xlYXJBY3Rpb247XG5cdFx0XHRcdGlmICghYWN0aW9uKSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdCQuZWFjaChbJ2tleXVwJywgJ2NoYW5nZScsICdpbnB1dCcsICdmb2N1cycsICdjdXQnLCAncGFzdGUnXSwgZnVuY3Rpb24oaW5kZXgsIHR5cGUpIHtcblx0XHRcdFx0XHQoZnVuY3Rpb24odHlwZSkge1xuXHRcdFx0XHRcdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRhY3Rpb24uY2xhc3NMaXN0W2VsZW1lbnQudmFsdWUudHJpbSgpID8gJ3JlbW92ZScgOiAnYWRkJ10oQ0xBU1NfSElEREVOKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH0pKHR5cGUpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0YWN0aW9uLmNsYXNzTGlzdC5hZGQoQ0xBU1NfSElEREVOKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0XHRpZiAodGhpcy5zZWFyY2hBY3Rpb25DbGFzcykge1xuXHRcdFx0XHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0ZWxlbWVudC5wYXJlbnROb2RlLmNsYXNzTGlzdC5hZGQoJ211aS1hY3RpdmUnKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGlmICghZWxlbWVudC52YWx1ZS50cmltKCkpIHtcblx0XHRcdFx0XHRcdGVsZW1lbnQucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdtdWktYWN0aXZlJyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cdH07XG5cdElucHV0LnByb3RvdHlwZS5zZXRQbGFjZWhvbGRlciA9IGZ1bmN0aW9uKHRleHQpIHtcblx0XHRpZiAodGhpcy5zZWFyY2hBY3Rpb25DbGFzcykge1xuXHRcdFx0dmFyIHBsYWNlaG9sZGVyID0gdGhpcy5lbGVtZW50LnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcihTRUxFQ1RPUl9QTEFDRUhPTERFUik7XG5cdFx0XHRwbGFjZWhvbGRlciAmJiAocGxhY2Vob2xkZXIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NwYW4nKVsxXS5pbm5lclRleHQgPSB0ZXh0KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZSgncGxhY2Vob2xkZXInLCB0ZXh0KTtcblx0XHR9XG5cdH07XG5cdElucHV0LnByb3RvdHlwZS5wYXNzd29yZEFjdGlvbkNsaWNrID0gZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRpZiAodGhpcy5lbGVtZW50LnR5cGUgPT09ICd0ZXh0Jykge1xuXHRcdFx0dGhpcy5lbGVtZW50LnR5cGUgPSAncGFzc3dvcmQnO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmVsZW1lbnQudHlwZSA9ICd0ZXh0Jztcblx0XHR9XG5cdFx0dGhpcy5wYXNzd29yZEFjdGlvbi5jbGFzc0xpc3QudG9nZ2xlKCdtdWktYWN0aXZlJyk7XG5cdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0fTtcblx0SW5wdXQucHJvdG90eXBlLmNsZWFyQWN0aW9uQ2xpY2sgPSBmdW5jdGlvbihldmVudCkge1xuXHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRzZWxmLmVsZW1lbnQudmFsdWUgPSAnJztcblx0XHQkLmZvY3VzKHNlbGYuZWxlbWVudCk7XG5cdFx0c2VsZi5jbGVhckFjdGlvbi5jbGFzc0xpc3QuYWRkKENMQVNTX0hJRERFTik7XG5cdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0fTtcblx0SW5wdXQucHJvdG90eXBlLnNwZWVjaEFjdGlvbkNsaWNrID0gZnVuY3Rpb24oZXZlbnQpIHtcblx0XHRpZiAod2luZG93LnBsdXMpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdHZhciBvbGRWYWx1ZSA9IHNlbGYuZWxlbWVudC52YWx1ZTtcblx0XHRcdHNlbGYuZWxlbWVudC52YWx1ZSA9ICcnO1xuXHRcdFx0ZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKENMQVNTX0ZPQ1VTSU4pO1xuXHRcdFx0cGx1cy5zcGVlY2guc3RhcnRSZWNvZ25pemUoe1xuXHRcdFx0XHRlbmdpbmU6ICdpRmx5J1xuXHRcdFx0fSwgZnVuY3Rpb24ocykge1xuXHRcdFx0XHRzZWxmLmVsZW1lbnQudmFsdWUgKz0gcztcblx0XHRcdFx0JC5mb2N1cyhzZWxmLmVsZW1lbnQpO1xuXHRcdFx0XHRwbHVzLnNwZWVjaC5zdG9wUmVjb2duaXplKCk7XG5cdFx0XHRcdCQudHJpZ2dlcihzZWxmLmVsZW1lbnQsICdyZWNvZ25pemVkJywge1xuXHRcdFx0XHRcdHZhbHVlOiBzZWxmLmVsZW1lbnQudmFsdWVcblx0XHRcdFx0fSk7XG5cdFx0XHRcdGlmIChvbGRWYWx1ZSAhPT0gc2VsZi5lbGVtZW50LnZhbHVlKSB7XG5cdFx0XHRcdFx0JC50cmlnZ2VyKHNlbGYuZWxlbWVudCwgJ2NoYW5nZScpO1xuXHRcdFx0XHRcdCQudHJpZ2dlcihzZWxmLmVsZW1lbnQsICdpbnB1dCcpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdC8vIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZShDTEFTU19GT0NVU0lOKTtcblx0XHRcdH0sIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0ZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKENMQVNTX0ZPQ1VTSU4pO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGFsZXJ0KCdvbmx5IGZvciA1KycpO1xuXHRcdH1cblx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHR9O1xuXHQkLmZuLmlucHV0ID0gZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdHZhciBpbnB1dEFwaXMgPSBbXTtcblx0XHR0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgaW5wdXRBcGkgPSBudWxsO1xuXHRcdFx0dmFyIGFjdGlvbnMgPSBbXTtcblx0XHRcdHZhciByb3cgPSBmaW5kUm93KHRoaXMucGFyZW50Tm9kZSk7XG5cdFx0XHRpZiAodGhpcy50eXBlID09PSAncmFuZ2UnICYmIHJvdy5jbGFzc0xpc3QuY29udGFpbnMoJ211aS1pbnB1dC1yYW5nZScpKSB7XG5cdFx0XHRcdGFjdGlvbnMucHVzaCgnc2xpZGVyJyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR2YXIgY2xhc3NMaXN0ID0gdGhpcy5jbGFzc0xpc3Q7XG5cdFx0XHRcdGlmIChjbGFzc0xpc3QuY29udGFpbnMoJ211aS1pbnB1dC1jbGVhcicpKSB7XG5cdFx0XHRcdFx0YWN0aW9ucy5wdXNoKCdjbGVhcicpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICghKCQub3MuYW5kcm9pZCAmJiAkLm9zLnN0cmVhbSkgJiYgY2xhc3NMaXN0LmNvbnRhaW5zKCdtdWktaW5wdXQtc3BlZWNoJykpIHtcblx0XHRcdFx0XHRhY3Rpb25zLnB1c2goJ3NwZWVjaCcpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChjbGFzc0xpc3QuY29udGFpbnMoJ211aS1pbnB1dC1wYXNzd29yZCcpKSB7XG5cdFx0XHRcdFx0YWN0aW9ucy5wdXNoKCdwYXNzd29yZCcpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICh0aGlzLnR5cGUgPT09ICdzZWFyY2gnICYmIHJvdy5jbGFzc0xpc3QuY29udGFpbnMoJ211aS1zZWFyY2gnKSkge1xuXHRcdFx0XHRcdGFjdGlvbnMucHVzaCgnc2VhcmNoJyk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHZhciBpZCA9IHRoaXMuZ2V0QXR0cmlidXRlKCdkYXRhLWlucHV0LScgKyBhY3Rpb25zWzBdKTtcblx0XHRcdGlmICghaWQpIHtcblx0XHRcdFx0aWQgPSArKyQudXVpZDtcblx0XHRcdFx0aW5wdXRBcGkgPSAkLmRhdGFbaWRdID0gbmV3IElucHV0KHRoaXMsIHtcblx0XHRcdFx0XHRhY3Rpb25zOiBhY3Rpb25zLmpvaW4oJywnKVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDAsIGxlbiA9IGFjdGlvbnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0XHRcdFx0XHR0aGlzLnNldEF0dHJpYnV0ZSgnZGF0YS1pbnB1dC0nICsgYWN0aW9uc1tpXSwgaWQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpbnB1dEFwaSA9ICQuZGF0YVtpZF07XG5cdFx0XHR9XG5cdFx0XHRpbnB1dEFwaXMucHVzaChpbnB1dEFwaSk7XG5cdFx0fSk7XG5cdFx0cmV0dXJuIGlucHV0QXBpcy5sZW5ndGggPT09IDEgPyBpbnB1dEFwaXNbMF0gOiBpbnB1dEFwaXM7XG5cdH07XG5cdCQucmVhZHkoZnVuY3Rpb24oKSB7XG5cdFx0JCgnLm11aS1pbnB1dC1yb3cgaW5wdXQnKS5pbnB1dCgpO1xuXHR9KTtcbn0pKG11aSwgd2luZG93LCBkb2N1bWVudCk7XG4oZnVuY3Rpb24oJCwgd2luZG93KSB7XG4gICAgdmFyIENMQVNTX0FDVElWRSA9ICdtdWktYWN0aXZlJztcbiAgICB2YXIgcmdiYVJlZ2V4ID0gL15yZ2JhXFwoKFxcZHsxLDN9KSxcXHMqKFxcZHsxLDN9KSxcXHMqKFxcZHsxLDN9KSxcXHMqKFxcZCooPzpcXC5cXGQrKT8pXFwpJC87XG4gICAgdmFyIGdldENvbG9yID0gZnVuY3Rpb24oY29sb3JTdHIpIHtcbiAgICAgICAgdmFyIG1hdGNoZXMgPSBjb2xvclN0ci5tYXRjaChyZ2JhUmVnZXgpO1xuICAgICAgICBpZiAobWF0Y2hlcyAmJiBtYXRjaGVzLmxlbmd0aCA9PT0gNSkge1xuICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICBtYXRjaGVzWzFdLFxuICAgICAgICAgICAgICAgIG1hdGNoZXNbMl0sXG4gICAgICAgICAgICAgICAgbWF0Y2hlc1szXSxcbiAgICAgICAgICAgICAgICBtYXRjaGVzWzRdXG4gICAgICAgICAgICBdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9O1xuICAgIHZhciBUcmFuc3BhcmVudCA9IGZ1bmN0aW9uKGVsZW1lbnQsIG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gJC5leHRlbmQoe1xuICAgICAgICAgICAgdG9wOiAwLCAvL+i3neemu+mhtumDqOmrmOW6pijliLDovr7or6Xpq5jluqbljbPop6blj5EpXG4gICAgICAgICAgICBvZmZzZXQ6IDE1MCwgLy/mu5rliqjpgI/mmI7ot53nprtcbiAgICAgICAgICAgIGR1cmF0aW9uOiAxNiwgLy/ov4fmuKHml7bpl7RcbiAgICAgICAgICAgIHNjcm9sbGJ5OiB3aW5kb3cvL+ebkeWQrOa7muWKqOi3neemu+WuueWZqFxuICAgICAgICB9LCBvcHRpb25zIHx8IHt9KTtcblxuICAgICAgICB0aGlzLnNjcm9sbEJ5RWxlbSA9IHRoaXMub3B0aW9ucy5zY3JvbGxieSB8fCB3aW5kb3c7XG4gICAgICAgIGlmICghdGhpcy5zY3JvbGxCeUVsZW0pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIuebkeWQrOa7muWKqOeahOWFg+e0oOS4jeWtmOWcqFwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmlzTmF0aXZlU2Nyb2xsID0gZmFsc2U7XG4gICAgICAgIGlmICh0aGlzLnNjcm9sbEJ5RWxlbSA9PT0gd2luZG93KSB7XG4gICAgICAgICAgICB0aGlzLmlzTmF0aXZlU2Nyb2xsID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmICghfnRoaXMuc2Nyb2xsQnlFbGVtLmNsYXNzTmFtZS5pbmRleE9mKCdtdWktc2Nyb2xsLXdyYXBwZXInKSkge1xuICAgICAgICAgICAgdGhpcy5pc05hdGl2ZVNjcm9sbCA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9zdHlsZSA9IHRoaXMuZWxlbWVudC5zdHlsZTtcbiAgICAgICAgdGhpcy5fYmdDb2xvciA9IHRoaXMuX3N0eWxlLmJhY2tncm91bmRDb2xvcjtcbiAgICAgICAgdmFyIGNvbG9yID0gZ2V0Q29sb3IobXVpLmdldFN0eWxlcyh0aGlzLmVsZW1lbnQsICdiYWNrZ3JvdW5kQ29sb3InKSk7XG4gICAgICAgIGlmIChjb2xvci5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMuX1IgPSBjb2xvclswXTtcbiAgICAgICAgICAgIHRoaXMuX0cgPSBjb2xvclsxXTtcbiAgICAgICAgICAgIHRoaXMuX0IgPSBjb2xvclsyXTtcbiAgICAgICAgICAgIHRoaXMuX0EgPSBwYXJzZUZsb2F0KGNvbG9yWzNdKTtcbiAgICAgICAgICAgIHRoaXMubGFzdE9wYWNpdHkgPSB0aGlzLl9BO1xuICAgICAgICAgICAgdGhpcy5fYnVmZmVyRm4gPSAkLmJ1ZmZlcih0aGlzLmhhbmRsZVNjcm9sbCwgdGhpcy5vcHRpb25zLmR1cmF0aW9uLCB0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuaW5pdEV2ZW50KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCLlhYPntKDog4zmma/popzoibLlv4XpobvkuLpSR0JBXCIpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIFRyYW5zcGFyZW50LnByb3RvdHlwZS5pbml0RXZlbnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5zY3JvbGxCeUVsZW0uYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdGhpcy5fYnVmZmVyRm4pO1xuICAgICAgICBpZiAodGhpcy5pc05hdGl2ZVNjcm9sbCkgeyAvL+WOn+eUn3Njcm9sbFxuICAgICAgICAgICAgdGhpcy5zY3JvbGxCeUVsZW0uYWRkRXZlbnRMaXN0ZW5lcigkLkVWRU5UX01PVkUsIHRoaXMuX2J1ZmZlckZuKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBUcmFuc3BhcmVudC5wcm90b3R5cGUuaGFuZGxlU2Nyb2xsID0gZnVuY3Rpb24oZSkge1xuICAgICAgICB2YXIgeSA9IHdpbmRvdy5zY3JvbGxZO1xuICAgICAgICBpZiAoIXRoaXMuaXNOYXRpdmVTY3JvbGwgJiYgZSAmJiBlLmRldGFpbCkge1xuICAgICAgICAgICAgeSA9IC1lLmRldGFpbC55O1xuICAgICAgICB9XG4gICAgICAgIHZhciBvcGFjaXR5ID0gKHkgLSB0aGlzLm9wdGlvbnMudG9wKSAvIHRoaXMub3B0aW9ucy5vZmZzZXQgKyB0aGlzLl9BO1xuICAgICAgICBvcGFjaXR5ID0gTWF0aC5taW4oTWF0aC5tYXgodGhpcy5fQSwgb3BhY2l0eSksIDEpO1xuICAgICAgICB0aGlzLl9zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAncmdiYSgnICsgdGhpcy5fUiArICcsJyArIHRoaXMuX0cgKyAnLCcgKyB0aGlzLl9CICsgJywnICsgb3BhY2l0eSArICcpJztcbiAgICAgICAgaWYgKG9wYWNpdHkgPiB0aGlzLl9BKSB7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChDTEFTU19BQ1RJVkUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoQ0xBU1NfQUNUSVZFKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5sYXN0T3BhY2l0eSAhPT0gb3BhY2l0eSkge1xuICAgICAgICAgICAgJC50cmlnZ2VyKHRoaXMuZWxlbWVudCwgJ2FscGhhJywge1xuICAgICAgICAgICAgICAgIGFscGhhOiBvcGFjaXR5XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMubGFzdE9wYWNpdHkgPSBvcGFjaXR5O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUcmFuc3BhcmVudC5wcm90b3R5cGUuZGVzdG9yeSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnNjcm9sbEJ5RWxlbS5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB0aGlzLl9idWZmZXJGbik7XG4gICAgICAgIHRoaXMuc2Nyb2xsQnlFbGVtLnJlbW92ZUV2ZW50TGlzdGVuZXIoJC5FVkVOVF9NT1ZFLCB0aGlzLl9idWZmZXJGbik7XG4gICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSB0aGlzLl9iZ0NvbG9yO1xuICAgICAgICB0aGlzLmVsZW1lbnQubXVpX3BsdWdpbl90cmFuc3BhcmVudCA9IG51bGw7XG4gICAgfTtcbiAgICAkLmZuLnRyYW5zcGFyZW50ID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICAgICAgdmFyIHRyYW5zcGFyZW50QXBpcyA9IFtdO1xuICAgICAgICB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgdHJhbnNwYXJlbnRBcGkgPSB0aGlzLm11aV9wbHVnaW5fdHJhbnNwYXJlbnQ7XG4gICAgICAgICAgICBpZiAoIXRyYW5zcGFyZW50QXBpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRvcCA9IHRoaXMuZ2V0QXR0cmlidXRlKCdkYXRhLXRvcCcpO1xuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSB0aGlzLmdldEF0dHJpYnV0ZSgnZGF0YS1vZmZzZXQnKTtcbiAgICAgICAgICAgICAgICB2YXIgZHVyYXRpb24gPSB0aGlzLmdldEF0dHJpYnV0ZSgnZGF0YS1kdXJhdGlvbicpO1xuICAgICAgICAgICAgICAgIHZhciBzY3JvbGxieSA9IHRoaXMuZ2V0QXR0cmlidXRlKCdkYXRhLXNjcm9sbGJ5Jyk7XG4gICAgICAgICAgICAgICAgaWYgKHRvcCAhPT0gbnVsbCAmJiB0eXBlb2Ygb3B0aW9ucy50b3AgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMudG9wID0gdG9wO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAob2Zmc2V0ICE9PSBudWxsICYmIHR5cGVvZiBvcHRpb25zLm9mZnNldCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5vZmZzZXQgPSBvZmZzZXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChkdXJhdGlvbiAhPT0gbnVsbCAmJiB0eXBlb2Ygb3B0aW9ucy5kdXJhdGlvbiA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kdXJhdGlvbiA9IGR1cmF0aW9uO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc2Nyb2xsYnkgIT09IG51bGwgJiYgdHlwZW9mIG9wdGlvbnMuc2Nyb2xsYnkgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuc2Nyb2xsYnkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNjcm9sbGJ5KSB8fCB3aW5kb3c7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRyYW5zcGFyZW50QXBpID0gdGhpcy5tdWlfcGx1Z2luX3RyYW5zcGFyZW50ID0gbmV3IFRyYW5zcGFyZW50KHRoaXMsIG9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdHJhbnNwYXJlbnRBcGlzLnB1c2godHJhbnNwYXJlbnRBcGkpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRyYW5zcGFyZW50QXBpcy5sZW5ndGggPT09IDEgPyB0cmFuc3BhcmVudEFwaXNbMF0gOiB0cmFuc3BhcmVudEFwaXM7XG4gICAgfTtcbiAgICAkLnJlYWR5KGZ1bmN0aW9uKCkge1xuICAgICAgICAkKCcubXVpLWJhci10cmFuc3BhcmVudCcpLnRyYW5zcGFyZW50KCk7XG4gICAgfSk7XG59KShtdWksIHdpbmRvdyk7XG4vKipcbiAqIOaVsOWtl+i+k+WFpeahhlxuICogdmFyc3Rpb24gMS4wLjFcbiAqIGJ5IEhvdWZlbmdcbiAqIEhvdWZlbmdARENsb3VkLmlvXG4gKi9cblxuKGZ1bmN0aW9uKCQpIHtcblxuICAgIHZhciB0b3VjaFN1cHBvcnQgPSAoJ29udG91Y2hzdGFydCcgaW4gZG9jdW1lbnQpO1xuICAgIHZhciB0YXBFdmVudE5hbWUgPSB0b3VjaFN1cHBvcnQgPyAndGFwJyA6ICdjbGljayc7XG4gICAgdmFyIGNoYW5nZUV2ZW50TmFtZSA9ICdjaGFuZ2UnO1xuICAgIHZhciBob2xkZXJDbGFzc05hbWUgPSAnbXVpLW51bWJveCc7XG4gICAgdmFyIHBsdXNDbGFzc1NlbGVjdG9yID0gJy5tdWktYnRuLW51bWJveC1wbHVzLC5tdWktbnVtYm94LWJ0bi1wbHVzJztcbiAgICB2YXIgbWludXNDbGFzc1NlbGVjdG9yID0gJy5tdWktYnRuLW51bWJveC1taW51cywubXVpLW51bWJveC1idG4tbWludXMnO1xuICAgIHZhciBpbnB1dENsYXNzU2VsZWN0b3IgPSAnLm11aS1pbnB1dC1udW1ib3gsLm11aS1udW1ib3gtaW5wdXQnO1xuXG4gICAgdmFyIE51bWJveCA9ICQuTnVtYm94ID0gJC5DbGFzcy5leHRlbmQoe1xuICAgICAgICAvKipcbiAgICAgICAgICog5p6E6YCg5Ye95pWwXG4gICAgICAgICAqKi9cbiAgICAgICAgaW5pdDogZnVuY3Rpb24oaG9sZGVyLCBvcHRpb25zKSB7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICBpZiAoIWhvbGRlcikge1xuICAgICAgICAgICAgICAgIHRocm93IFwi5p6E6YCgIG51bWJveCDml7bnvLrlsJHlrrnlmajlhYPntKBcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNlbGYuaG9sZGVyID0gaG9sZGVyO1xuICAgICAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgICAgICAgICBvcHRpb25zLnN0ZXAgPSBwYXJzZUludChvcHRpb25zLnN0ZXAgfHwgMSk7XG4gICAgICAgICAgICBzZWxmLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICAgICAgc2VsZi5pbnB1dCA9ICQucXNhKGlucHV0Q2xhc3NTZWxlY3Rvciwgc2VsZi5ob2xkZXIpWzBdO1xuICAgICAgICAgICAgc2VsZi5wbHVzID0gJC5xc2EocGx1c0NsYXNzU2VsZWN0b3IsIHNlbGYuaG9sZGVyKVswXTtcbiAgICAgICAgICAgIHNlbGYubWludXMgPSAkLnFzYShtaW51c0NsYXNzU2VsZWN0b3IsIHNlbGYuaG9sZGVyKVswXTtcbiAgICAgICAgICAgIHNlbGYuY2hlY2tWYWx1ZSgpO1xuICAgICAgICAgICAgc2VsZi5pbml0RXZlbnQoKTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOWIneWni+WMluS6i+S7tue7keWumlxuICAgICAgICAgKiovXG4gICAgICAgIGluaXRFdmVudDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICBzZWxmLnBsdXMuYWRkRXZlbnRMaXN0ZW5lcih0YXBFdmVudE5hbWUsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIHZhbCA9IHBhcnNlSW50KHNlbGYuaW5wdXQudmFsdWUpICsgc2VsZi5vcHRpb25zLnN0ZXA7XG4gICAgICAgICAgICAgICAgc2VsZi5pbnB1dC52YWx1ZSA9IHZhbC50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgICQudHJpZ2dlcihzZWxmLmlucHV0LCBjaGFuZ2VFdmVudE5hbWUsIG51bGwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzZWxmLm1pbnVzLmFkZEV2ZW50TGlzdGVuZXIodGFwRXZlbnROYW1lLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICAgIHZhciB2YWwgPSBwYXJzZUludChzZWxmLmlucHV0LnZhbHVlKSAtIHNlbGYub3B0aW9ucy5zdGVwO1xuICAgICAgICAgICAgICAgIHNlbGYuaW5wdXQudmFsdWUgPSB2YWwudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAkLnRyaWdnZXIoc2VsZi5pbnB1dCwgY2hhbmdlRXZlbnROYW1lLCBudWxsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc2VsZi5pbnB1dC5hZGRFdmVudExpc3RlbmVyKGNoYW5nZUV2ZW50TmFtZSwgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmNoZWNrVmFsdWUoKTtcbiAgICAgICAgICAgICAgICB2YXIgdmFsID0gcGFyc2VJbnQoc2VsZi5pbnB1dC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgLy/op6blj5HpobblsYLlrrnlmahcbiAgICAgICAgICAgICAgICAkLnRyaWdnZXIoc2VsZi5ob2xkZXIsIGNoYW5nZUV2ZW50TmFtZSwge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdmFsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOiOt+WPluW9k+WJjeWAvFxuICAgICAgICAgKiovXG4gICAgICAgIGdldFZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiBwYXJzZUludChzZWxmLmlucHV0LnZhbHVlKTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIOmqjOivgeW9k+WJjeWAvOaYr+azleWQiOazlVxuICAgICAgICAgKiovXG4gICAgICAgIGNoZWNrVmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIHZhbCA9IHNlbGYuaW5wdXQudmFsdWU7XG4gICAgICAgICAgICBpZiAodmFsID09IG51bGwgfHwgdmFsID09ICcnIHx8IGlzTmFOKHZhbCkpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmlucHV0LnZhbHVlID0gc2VsZi5vcHRpb25zLm1pbiB8fCAwO1xuICAgICAgICAgICAgICAgIHNlbGYubWludXMuZGlzYWJsZWQgPSBzZWxmLm9wdGlvbnMubWluICE9IG51bGw7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciB2YWwgPSBwYXJzZUludCh2YWwpO1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLm9wdGlvbnMubWF4ICE9IG51bGwgJiYgIWlzTmFOKHNlbGYub3B0aW9ucy5tYXgpICYmIHZhbCA+PSBwYXJzZUludChzZWxmLm9wdGlvbnMubWF4KSkge1xuICAgICAgICAgICAgICAgICAgICB2YWwgPSBzZWxmLm9wdGlvbnMubWF4O1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnBsdXMuZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYucGx1cy5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5vcHRpb25zLm1pbiAhPSBudWxsICYmICFpc05hTihzZWxmLm9wdGlvbnMubWluKSAmJiB2YWwgPD0gcGFyc2VJbnQoc2VsZi5vcHRpb25zLm1pbikpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsID0gc2VsZi5vcHRpb25zLm1pbjtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5taW51cy5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5taW51cy5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZWxmLmlucHV0LnZhbHVlID0gdmFsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICog5pu05paw6YCJ6aG5XG4gICAgICAgICAqKi9cbiAgICAgICAgc2V0T3B0aW9uOiBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgc2VsZi5vcHRpb25zW25hbWVdID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDliqjmgIHorr7nva7mlrDlgLxcbiAgICAgICAgICoqL1xuICAgICAgICBzZXRWYWx1ZTogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuaW5wdXQudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuY2hlY2tWYWx1ZSgpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAkLmZuLm51bWJveCA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIGluc3RhbmNlQXJyYXkgPSBbXTtcbiAgICAgICAgLy/pgY3ljobpgInmi6nnmoTlhYPntKBcbiAgICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uKGksIGVsZW1lbnQpIHtcbiAgICAgICAgICAgIGlmIChlbGVtZW50Lm51bWJveCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5udW1ib3ggPSBuZXcgTnVtYm94KGVsZW1lbnQsIG9wdGlvbnMpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgb3B0aW9uc1RleHQgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1udW1ib3gtb3B0aW9ucycpO1xuICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0gb3B0aW9uc1RleHQgPyBKU09OLnBhcnNlKG9wdGlvbnNUZXh0KSA6IHt9O1xuICAgICAgICAgICAgICAgIG9wdGlvbnMuc3RlcCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLW51bWJveC1zdGVwJykgfHwgb3B0aW9ucy5zdGVwO1xuICAgICAgICAgICAgICAgIG9wdGlvbnMubWluID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbnVtYm94LW1pbicpIHx8IG9wdGlvbnMubWluO1xuICAgICAgICAgICAgICAgIG9wdGlvbnMubWF4ID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbnVtYm94LW1heCcpIHx8IG9wdGlvbnMubWF4O1xuICAgICAgICAgICAgICAgIGVsZW1lbnQubnVtYm94ID0gbmV3IE51bWJveChlbGVtZW50LCBvcHRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0aGlzWzBdID8gdGhpc1swXS5udW1ib3ggOiBudWxsO1xuICAgIH1cblxuICAgIC8v6Ieq5Yqo5aSE55CGIGNsYXNzPSdtdWktbG9ja2VyJyDnmoQgZG9tXG4gICAgJC5yZWFkeShmdW5jdGlvbigpIHtcbiAgICAgICAgJCgnLicgKyBob2xkZXJDbGFzc05hbWUpLm51bWJveCgpO1xuICAgIH0pO1xuXG59KG11aSkpO1xuLyoqXG4gKiBCdXR0b25cbiAqIEBwYXJhbSB7dHlwZX0gJFxuICogQHBhcmFtIHt0eXBlfSB3aW5kb3dcbiAqIEBwYXJhbSB7dHlwZX0gZG9jdW1lbnRcbiAqIEByZXR1cm5zIHt1bmRlZmluZWR9XG4gKi9cbihmdW5jdGlvbigkLCB3aW5kb3csIGRvY3VtZW50KSB7XG4gICAgdmFyIENMQVNTX0lDT04gPSAnbXVpLWljb24nO1xuICAgIHZhciBDTEFTU19ESVNBQkxFRCA9ICdtdWktZGlzYWJsZWQnO1xuXG4gICAgdmFyIFNUQVRFX1JFU0VUID0gJ3Jlc2V0JztcbiAgICB2YXIgU1RBVEVfTE9BRElORyA9ICdsb2FkaW5nJztcblxuICAgIHZhciBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICAgICAgbG9hZGluZ1RleHQ6ICdMb2FkaW5nLi4uJywgLy/mlofmoYhcbiAgICAgICAgbG9hZGluZ0ljb246ICdtdWktc3Bpbm5lcicgKyAnICcgKyAnbXVpLXNwaW5uZXItd2hpdGUnLCAvL+Wbvuagh++8jOWPr+S4uuepulxuICAgICAgICBsb2FkaW5nSWNvblBvc2l0aW9uOiAnbGVmdCcgLy/lm77moIfmiYDlpITkvY3nva7vvIzku4XmlK/mjIFsZWZ0fHJpZ2h0XG4gICAgfTtcblxuICAgIHZhciBCdXR0b24gPSBmdW5jdGlvbihlbGVtZW50LCBvcHRpb25zKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgICAgIHRoaXMub3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCBkZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7XG4gICAgICAgIGlmICghdGhpcy5vcHRpb25zLmxvYWRpbmdUZXh0KSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMubG9hZGluZ1RleHQgPSBkZWZhdWx0T3B0aW9ucy5sb2FkaW5nVGV4dDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmxvYWRpbmdJY29uID09PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMubG9hZGluZ0ljb24gPSAnbXVpLXNwaW5uZXInO1xuICAgICAgICAgICAgaWYgKCQuZ2V0U3R5bGVzKHRoaXMuZWxlbWVudCwgJ2NvbG9yJykgPT09ICdyZ2IoMjU1LCAyNTUsIDI1NSknKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLmxvYWRpbmdJY29uICs9ICcgJyArICdtdWktc3Bpbm5lci13aGl0ZSc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pc0lucHV0ID0gdGhpcy5lbGVtZW50LnRhZ05hbWUgPT09ICdJTlBVVCc7XG4gICAgICAgIHRoaXMucmVzZXRIVE1MID0gdGhpcy5pc0lucHV0ID8gdGhpcy5lbGVtZW50LnZhbHVlIDogdGhpcy5lbGVtZW50LmlubmVySFRNTDtcbiAgICAgICAgdGhpcy5zdGF0ZSA9ICcnO1xuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZS5sb2FkaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoU1RBVEVfTE9BRElORyk7XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoU1RBVEVfUkVTRVQpO1xuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZS5zZXRTdGF0ZSA9IGZ1bmN0aW9uKHN0YXRlKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlID09PSBzdGF0ZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcbiAgICAgICAgaWYgKHN0YXRlID09PSBTVEFURV9SRVNFVCkge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShDTEFTU19ESVNBQkxFRCk7XG4gICAgICAgICAgICB0aGlzLnNldEh0bWwodGhpcy5yZXNldEhUTUwpO1xuICAgICAgICB9IGVsc2UgaWYgKHN0YXRlID09PSBTVEFURV9MT0FESU5HKSB7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoQ0xBU1NfRElTQUJMRUQpO1xuICAgICAgICAgICAgdmFyIGh0bWwgPSB0aGlzLmlzSW5wdXQgPyB0aGlzLm9wdGlvbnMubG9hZGluZ1RleHQgOiAoJzxzcGFuPicgKyB0aGlzLm9wdGlvbnMubG9hZGluZ1RleHQgKyAnPC9zcGFuPicpO1xuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5sb2FkaW5nSWNvbiAmJiAhdGhpcy5pc0lucHV0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5sb2FkaW5nSWNvblBvc2l0aW9uID09PSAncmlnaHQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gJyZuYnNwOzxzcGFuIGNsYXNzPVwiJyArIHRoaXMub3B0aW9ucy5sb2FkaW5nSWNvbiArICdcIj48L3NwYW4+JztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBodG1sID0gJzxzcGFuIGNsYXNzPVwiJyArIHRoaXMub3B0aW9ucy5sb2FkaW5nSWNvbiArICdcIj48L3NwYW4+Jm5ic3A7JyArIGh0bWw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zZXRIdG1sKGh0bWwpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlLnNldEh0bWwgPSBmdW5jdGlvbihodG1sKSB7XG4gICAgICAgIGlmICh0aGlzLmlzSW5wdXQpIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC52YWx1ZSA9IGh0bWw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuaW5uZXJIVE1MID0gaHRtbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICAkLmZuLmJ1dHRvbiA9IGZ1bmN0aW9uKHN0YXRlKSB7XG4gICAgICAgIHZhciBidXR0b25BcGlzID0gW107XG4gICAgICAgIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBidXR0b25BcGkgPSB0aGlzLm11aV9wbHVnaW5fYnV0dG9uO1xuICAgICAgICAgICAgaWYgKCFidXR0b25BcGkpIHtcbiAgICAgICAgICAgICAgICB2YXIgbG9hZGluZ1RleHQgPSB0aGlzLmdldEF0dHJpYnV0ZSgnZGF0YS1sb2FkaW5nLXRleHQnKTtcbiAgICAgICAgICAgICAgICB2YXIgbG9hZGluZ0ljb24gPSB0aGlzLmdldEF0dHJpYnV0ZSgnZGF0YS1sb2FkaW5nLWljb24nKTtcbiAgICAgICAgICAgICAgICB2YXIgbG9hZGluZ0ljb25Qb3NpdGlvbiA9IHRoaXMuZ2V0QXR0cmlidXRlKCdkYXRhLWxvYWRpbmctaWNvbi1wb3NpdGlvbicpO1xuICAgICAgICAgICAgICAgIHRoaXMubXVpX3BsdWdpbl9idXR0b24gPSBidXR0b25BcGkgPSBuZXcgQnV0dG9uKHRoaXMsIHtcbiAgICAgICAgICAgICAgICAgICAgbG9hZGluZ1RleHQ6IGxvYWRpbmdUZXh0LFxuICAgICAgICAgICAgICAgICAgICBsb2FkaW5nSWNvbjogbG9hZGluZ0ljb24sXG4gICAgICAgICAgICAgICAgICAgIGxvYWRpbmdJY29uUG9zaXRpb246IGxvYWRpbmdJY29uUG9zaXRpb25cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzdGF0ZSA9PT0gU1RBVEVfTE9BRElORyB8fCBzdGF0ZSA9PT0gU1RBVEVfUkVTRVQpIHtcbiAgICAgICAgICAgICAgICBidXR0b25BcGkuc2V0U3RhdGUoc3RhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnV0dG9uQXBpcy5wdXNoKGJ1dHRvbkFwaSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gYnV0dG9uQXBpcy5sZW5ndGggPT09IDEgPyBidXR0b25BcGlzWzBdIDogYnV0dG9uQXBpcztcbiAgICB9O1xufSkobXVpLCB3aW5kb3csIGRvY3VtZW50KTtcbi8vIHdpbmRvdy5tdWkgPSBtdWlcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vbGliL211aS9qcy9tdWkuanNcbi8vIG1vZHVsZSBpZCA9IDk2NFxuLy8gbW9kdWxlIGNodW5rcyA9IDciXSwic291cmNlUm9vdCI6IiJ9");

/***/ })

});